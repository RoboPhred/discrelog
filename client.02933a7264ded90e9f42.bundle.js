(self.webpackChunkdiscrelog=self.webpackChunkdiscrelog||[]).push([[47],{1235:(e,t,n)=>{"use strict";n.d(t,{zN:()=>r,ke:()=>o});const i="@node/interact",r=(e,t)=>({type:i,payload:{circuitNodeIdPath:e,data:t}});function o(e){return e.type===i}},5766:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i=4},3667:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:[],outputPins:["OUT"],interact:(e,t)=>void 0===t?{transitions:[{tickOffset:1,valuesByPin:{OUT:!0}},{tickOffset:1+Math.round(1.5*i.v),valuesByPin:{OUT:!1}}]}:t?{transitions:{tickOffset:1,valuesByPin:{OUT:!0}}}:{transitions:{tickOffset:1,valuesByPin:{OUT:!1}}}}},2318:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const i={toggleState:!1},r={inputPins:[],outputPins:["OUT"],interact(e=i){const t=!e.toggleState;return{state:Object.assign({},e,{toggleState:t}),transitions:{tickOffset:1,valuesByPin:{OUT:t}}}},evolve:(e=i)=>({state:e,transitions:{tickOffset:1,valuesByPin:{OUT:e.toggleState}}})}},7909:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.A&&t.B}}})}},274:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.IN}}})}},4347:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!(t.A&&t.B)}}})}},8112:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!(t.A||t.B)}}})}},6559:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!t.IN}}})}},2649:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.A||t.B}}})}},8881:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:(t.A||t.B)&&t.A!=t.B}}})}},6567:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:["IN"],outputPins:[],evolve:(e,t)=>({state:{value:t.IN}})}},4257:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:["A","B","C","D","E","F","G"],outputPins:[],evolve:(e,t)=>({state:Object.assign({},t)})}},4420:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:[],outputPins:["OUT"],evolve:()=>({transitions:{tickOffset:1,valuesByPin:{OUT:!0}}})}},8370:(e,t,n)=>{"use strict";n.d(t,{tQ:()=>r,Ds:()=>o,rG:()=>c,NG:()=>s,R9:()=>l,VE:()=>a,Fv:()=>d,Ih:()=>u,bA:()=>p,Qu:()=>m,gQ:()=>y,ZO:()=>f,sj:()=>g,kg:()=>I,PL:()=>h,nF:()=>b,G0:()=>v,kK:()=>E});var i=n(7516);const r=i.Ry().shape({x:i.Rx().required(),y:i.Rx().required()}),o=Object.freeze({x:0,y:0}),c=Object.freeze({p1:o,p2:o});function s(e){return{p1:{x:e[0],y:e[1]},p2:{x:e[2],y:e[3]}}}function l(e,t){return{x:Math.round(e.x/t)*t,y:Math.round(e.y/t)*t}}function a(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function d(e){const t=a(e);return{x:e.x/t,y:e.y/t}}function u(e,t){return e.x*t.x+e.y*t.y}function p(e,t){return{x:e.x*t,y:e.y*t}}function m(...e){let t,n;if(1===e.length){const i=e[0];t=i.p1,n=i.p2}else t=e[0],n=e[1];return{p1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},p2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}}}function y(e,t){return{p1:f(e.p1,t),p2:f(e.p2,t)}}function f(e,t){return{x:e.x+t.x,y:e.y+t.y}}function g(e,t){return{x:e.x-t.x,y:e.y-t.y}}function I(e,t){return e.x===t.x&&e.y===t.y}function h(e,t){return!((t=m(t)).p1.x>e.x||t.p2.x<e.x||t.p1.y>e.y||t.p2.y<e.y)}function b(e){return{width:(e=m(e)).p2.x-e.p1.x,height:e.p2.y-e.p1.y}}function v(e,t){return e=m(e),t=m(t),{p1:{x:Math.min(e.p1.x,t.p1.x),y:Math.min(e.p1.y,t.p1.y)},p2:{x:Math.max(e.p2.x,t.p2.x),y:Math.max(e.p2.y,t.p2.y)}}}function E(e,t){return e=m(e),t=m(t),!(e.p1.x>t.p2.x||e.p2.x<t.p1.x||e.p1.y>t.p2.y||e.p2.y<t.p1.y)}},7093:(e,t,n)=>{"use strict";var i=n(7294),r=n(3935),o=n(1033),c=n(9242),s=n(5977),l=n(862),a=n(7865);const d=(0,n(7531).q_)(),u=Object.freeze({dragMode:null}),p="root",m="root-editor",y={circucitEditorsById:{[m]:{circuitId:p,circuitNodeIdPath:[]}},activeEditorId:null},f=Object.freeze(y),g={circuitNamesByCircuitId:{[p]:"Root"},nodeIdsByCircuitId:{[p]:[]}},I=Object.freeze(g);var h=n(8370);const b=Object.freeze({clipboardNodes:[],clipboardPasteOrigin:h.Ds}),v=Object.freeze({dialogType:null,data:null}),E=Object.freeze({nodesById:{},connectionsById:{}}),k=Object.freeze({nodePositionsById:{},wireJointIdsByConnectionId:{},wireJointPositionsByJointId:{}}),O=Object.freeze({projectName:"New Project",projectModified:!1}),N=Object.freeze({selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}),x=Object.freeze({initialized:!1,tick:0,lastTickProcessingTimeMs:0,nodeStatesByNodeId:{},nodeOutputValuesByNodeId:{},transitionsById:{},transitionWindows:[]}),C=Object.freeze({mode:"edit",ticksPerSecond:1e3});var j=n(7361),w=n.n(j);function P(...e){return e.filter((e=>Boolean(e)&&""!=e)).join(" ")}function B(...e){return M(e[0],e.slice(1,e.length-1).map(String),e[e.length-1])}function M(e,t,n){if(0===t.length)return"function"==typeof n?n(e):n;const i=t.slice(0,t.length-1).map(String),r=t[t.length-1],o=S(e);let c=o;for(const e of i)c[e]=S(c[e]),c=c[e];return c[r]="function"==typeof n?n(c[r]):n,o}function S(e){return Array.isArray(e)?e.slice():Object.assign({},e)}function z(e){return Boolean(e)}const L="fill-parent--3pw6U",T={"flex-row":"flex-row--sHjOY","flex-column":"flex-column--2LT64","flex-reverse":"flex-reverse--2Vn7L","flexitem-shrink":"flexitem-shrink--2U9EV","flexitem-fix":"flexitem-fix--1ARxk"};var D=n(8721),J=n.n(D);function R(e){return"string"==typeof e?{windowId:e}:e}function W(e){return J()(e,"windowId")}function A(e){return J()(e,"first")&&J()(e,"second")&&J()(e,"direction")}function U(e){return"number"==typeof e?{firstPercent:e}:e}function Z(e){return J()(e,"firstPercent")}function F(e){return J()(e,"firstSize")||J()(e,"secondSize")}var K=n(3493),H=n.n(K);function q(e){const t=i.useRef(e);return i.useEffect((()=>{t.current=e})),t}const G={tessel:"tessel--2Q3Xd","tessel-content":"tessel-content--3-kEA","tessel-drop-capture":"tessel-drop-capture--3TbuI","tessel-drop-capture--dragging":"tessel-drop-capture--dragging--Ihwyz","tessel-drop-marker":"tessel-drop-marker--1cqr2","drop-left":"drop-left--wqP1V","drop-right":"drop-right--2MyGz","drop-top":"drop-top--1S0co","drop-bottom":"drop-bottom--2f330","tessel-split":"tessel-split--2gDs5","tessel-split--row":"tessel-split--row--2fC6o","tessel-split--column":"tessel-split--column--1Hl4C","tessel-window":"tessel-window--1qDgp","tessel-window-titlebar":"tessel-window-titlebar--uHBdn","tessel-window-title":"tessel-window-title--2v0hT","tessel-window-controls":"tessel-window-controls--3i3ou","tessel-window-controls-close":"tessel-window-controls-close--2O8Zs","tessel-window-content":"tessel-window-content--sOnG-"},V=Object.freeze({top:0,left:0,bottom:0,right:0,x:0,y:0,height:0,width:0,toJSON:()=>({})}),$=({direction:e,onChangePercentage:t})=>{const n=i.useRef(null),r=i.useRef(null),o=q(e),c=q(t),s=i.useMemo((()=>H()((e=>{var t,i;if(null==r.current||null==n.current)return;const s=null!==(i=null===(t=n.current.parentElement)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==i?i:V;let l=0,a=0;"row"===o.current?(a=e.pageX-s.left,l=a/s.width,isNaN(l)?(l=0,a=s.left):l>1&&(l=1,a=s.right)):(a=e.pageY-s.top,l=a/s.height,isNaN(l)?(l=0,a=s.top):l>1&&(l=1,a=s.bottom)),c.current(100*l,a)}),1e3/60,{leading:!0})),[o,c]),l=i.useCallback((e=>{e.persist(),s(e)}),[s]),a=i.useCallback((e=>{!e.defaultPrevented&&n.current&&(r.current||(e.preventDefault(),n.current.setPointerCapture(e.pointerId),r.current=e.pointerId))}),[]),d=i.useCallback((()=>{n.current&&r.current&&(n.current.releasePointerCapture(r.current),r.current=null)}),[]);return i.createElement("div",{ref:n,className:P("tessel-split",G["tessel-split"],G["row"===e?"tessel-split--row":"tessel-split--column"]),onPointerDown:a,onPointerMove:l,onPointerUp:d})},_=i.createContext([]);function X(){return i.useContext(_)}const Y=({pathKey:e,children:t})=>{const n=X(),r=i.useMemo((()=>[...n,e]),[n,e]);return i.createElement(_.Provider,{value:r},t)};function Q(){}const ee=i.createContext({moveWindow:Q,closeWindow:Q});function te(){return i.useContext(ee)}const ne=({moveWindow:e,closeWindow:t,children:n})=>{const r=i.useMemo((()=>({moveWindow:e,closeWindow:t})),[e,t]);return i.createElement(ee.Provider,{value:r},n)};function ie(e,t,n){return Z(e)?{firstPercent:t}:F(e)?"number"==typeof e.secondSize?{secondSize:n}:{firstSize:n}:e}const re=({item:e,renderWindow:t,onLayoutChange:n})=>{const{direction:r,first:o,second:c,division:s}=e,l="row"===r?"width":"height",a=i.useCallback(((t,i)=>{const r=U(e.division);n(Object.assign(Object.assign({},e),{division:ie(r,t,i)}))}),[e,n]),d=i.useCallback((t=>{n(Object.assign(Object.assign({},e),{first:t}))}),[e,n]),u=i.useCallback((t=>{n(Object.assign(Object.assign({},e),{second:t}))}),[e,n]),p=U(s);let m="50%",y="50%",f=!1,g=!1;if(Z(p)){const{firstPercent:e}=p;m=e+"%",y=100-e+"%"}else if(F(p)){const{firstSize:e,secondSize:t}=p;e?(m=e+"px",f=!0,y="100%"):(m="100%",y=t+"px",g=!0)}return i.createElement("div",{className:P(L,T["row"===r?"flex-row":"flex-column"])},i.createElement("div",{className:P(f?T["flexitem-fix"]:T["flexitem-shrink"]),style:{[l]:m}},i.createElement(Y,{pathKey:"first"},i.createElement(oe,{value:o,renderWindow:t,onLayoutChange:d}))),i.createElement($,{direction:r,onChangePercentage:a}),i.createElement("div",{className:P(g?T["flexitem-fix"]:T["flexitem-shrink"]),style:{[l]:y}},i.createElement(Y,{pathKey:"second"},i.createElement(oe,{value:c,renderWindow:t,onLayoutChange:u}))))},oe=({value:e,renderWindow:t,onLayoutChange:n})=>{const r=R(e);return W(r)?t(r):A(r)?i.createElement(re,{item:r,renderWindow:t,onLayoutChange:n}):null};function ce(e){return Array.isArray(e)?e:[e]}function se(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>t[n]===e))}function le(e,t){const n=e.slice(0,t);for(let i=t+1;i<e.length;i++)n.push(e[i]);return n}function ae(e){const[t,n]=i.useState({left:0,top:0,right:0,bottom:0,width:0,height:0});return i.useLayoutEffect((()=>{if(!e.current)return;const t=new o.Z((()=>{const t=e.current;if(!t)return;const i=t.getBoundingClientRect();n({top:i.top,left:i.left,right:i.right,bottom:i.bottom,width:i.width,height:i.height})}));return t.observe(e.current),()=>{t.disconnect()}}),[e]),t}Object.freeze([]);var de=n(9240);const ue="@tessel/window",pe=e=>({type:ue,payload:{path:e}});function me(e){return e.type===ue}const ye=i.forwardRef((({className:e,children:t},n)=>{const r=X(),{moveWindow:o}=te(),c=i.useRef(null),{top:s,left:l,right:a,bottom:d}=ae(c),[u,p]=i.useState(null),m=i.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return void p(null);const n=t.getClientOffset();if(null==e||null==n||!me(e))return void p(null);if(n.x<l||n.x>a)return void p(null);if(n.y<s||n.y>d)return void p(null);const i=(n.x-l)/(a-l);if(i<=.3)return void p("left");if(i>=.6)return void p("right");const r=(n.y-s)/(d-s);p(r<=.3?"top":r>=.6?"bottom":null)}),[s,l,a,d]),y=i.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return;if(!me(e))return;const{path:n}=e.payload;se(n,r)||null!=u&&o(n,r,u)}),[r,u,o]),[{draggingSelf:f},g]=(0,de.L)({accept:ue,collect:e=>{e.isOver({shallow:!0})||p(null);const t=e.getItem();return t&&me(t)?{draggingSelf:se(t.payload.path,r)}:{}},hover:m,drop:y},[m,y]);let I=G["tessel-drop-marker"]+" ";if(null!=u&&!f)switch(u){case"bottom":I+=G["drop-bottom"];break;case"top":I+=G["drop-top"];break;case"left":I+=G["drop-left"];break;case"right":I+=G["drop-right"]}return i.createElement("div",{ref:e=>{c.current=e,g(e),"function"==typeof n?n(e):n&&(n.current=e)},className:P(G["tessel-drop-capture"],f&&G["tessel-drop-capture--dragging"],e)},t,i.createElement("div",{className:I}))}));function fe(e,t){var n;if(!t(e))return null;const i=R(e);if(A(i)){const r=fe(i.first,t),o=fe(i.second,t);return r&&o?e:null!==(n=null!=r?r:o)&&void 0!==n?n:null}return e}function ge(e){return"string"==typeof e?e:A(e)?null==e.first?ge(e.second):null==e.second?ge(e.first):Object.assign(Object.assign({},e),{first:ge(e.first),second:ge(e.second)}):e}const Ie=({className:e,rootItem:t,renderWindow:n,onLayoutChange:r})=>{const o=i.useCallback(((e,n,i)=>{if(0===e.length)return;let o=t;const c=w()(o,e);o&&"string"!=typeof o&&c&&(n.length>0&&!w()(o,n)||(o=M(o,e,null),o=M(o,n,(e=>{let t;if("left"===i||"right"===i)t={direction:"row",division:50,first:"left"===i?c:e,second:"right"===i?c:e};else{if("top"!==i&&"bottom"!==i)throw new Error("Unknown tessel position: "+i);t={direction:"column",division:50,first:"top"===i?c:e,second:"bottom"===i?c:e}}return t})),o=ge(o),r(o)))}),[t,r]),c=i.useCallback((e=>{let n=t;n&&("string"!=typeof n?(n=M(n,e,null),n=ge(n),r(n)):0===e.length&&r(null))}),[r,t]);return i.createElement("div",{className:P("tessel",G.tessel,e)},i.createElement(ne,{moveWindow:o,closeWindow:c},i.createElement(ye,null,i.createElement("div",{className:G["tessel-content"]},t&&i.createElement(oe,{value:t,renderWindow:n,onLayoutChange:r})))))},he="circuit-field",be=e=>({windowId:he,windowProps:{editorId:e}});function ve(e){return"string"!=typeof e&&!!W(e)&&e.windowId===he}const Ee={layout:{direction:"row",division:{firstSize:200},first:{direction:"column",division:30,first:"circuits-list",second:"node-tray"},second:be(m)}},ke=Object.freeze(Ee),Oe=Object.freeze({nodeNameMode:"named-only"}),Ne={circuitEditorDrag:u,circuitEditors:f,nodeGraph:E,nodeLayout:k,circuits:I,clipboard:b,dialog:v,project:O,selection:N,simulator:x,simulatorControl:C,uiLayout:ke,uiSettings:Oe},xe=Object.freeze(Ne),Ce=["circuits","nodeGraph","nodeLayout"],je={services:xe,undo:Object.freeze({undoStack:[],redoStack:[]})},we=Object.freeze(je);var Pe=n(4890),Be=(n(2729),n(7172));const Me=new URL(window.location.origin);Me.pathname=n.p;const Se=Me.toString(),ze="@init";var Le=n(4586);const Te="@circuit/add",De=({circuitName:e,circuitId:t,edit:n}={})=>({type:Te,payload:{circuitId:null!=t?t:(0,Le.Z)(),circuitName:e,edit:n}}),Je="@circuit/delete";function Re(e){return e.type===Je}const We="@circuit/rename",Ae="@node/add",Ue=(e,t,n,i)=>({type:Ae,payload:Object.assign({nodeId:(0,Le.Z)(),nodeType:e,circuitId:t,position:n},i||{})});function Ze(e){return e.type===Ae}const Fe="@node/delete",Ke=e=>({type:Fe,payload:{nodeIds:ce(e)}});function He(e){return e.type===Fe}const qe="@node/rename",Ge="@selection/align-to-grid",Ve="@selection/delete",$e=()=>({type:Ve}),_e="@selection/move",Xe="@wire/attach",Ye=(e,t,n)=>({type:Xe,payload:{connectionId:(0,Le.Z)(),p1:e,p2:t,joints:(null==n?void 0:n.joints)||[]}});function Qe(e){return e.type===Xe}const et="@wire/detatch";function tt(e){return e.type===et}const nt="@wire/joint/add",it="@wire/joint/move",rt=(e,t,n={})=>{var i,r;return{type:it,payload:{jointIds:ce(e),position:t,relative:null!==(i=n.relative)&&void 0!==i&&i,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},ot="@wire/joint/delete",ct="@clipboard/paste",st="@circuit-editor/drag/end",lt="@undo/undo",at=()=>({type:lt});function dt(e){return e.type===lt}const ut="@undo/redo",pt=()=>({type:ut});function mt(e){return e.type===ut}const yt="@project/new",ft=()=>({type:yt});function gt(e){return e.type===yt}const It="@project/receive",ht=(e,t)=>({type:It,payload:{fileName:e,saveData:t}}),bt=[Te,Je,We,Ae,Fe,qe,Ge,Ve,_e,Xe,et,nt,ot,it,lt,ut,ct,st];function vt(e){return-1!==bt.indexOf(e.type)}var Et=n(8718),kt=n.n(Et),Ot=n(8804),Nt=n.n(Ot);function xt(e){return t=>(n=we,i)=>{const r=t(n.services[e],i,n);return n.services[e]!=r?B(n,"services",e,r):n}}function Ct(e){return t=>{const n=(n,...i)=>t(n.services[e],...i);return n.local=t,n}}const jt=xt("circuitEditors"),wt=Ct("circuitEditors"),Pt=wt(((e,t)=>e.circucitEditorsById[t])),Bt=(e,t)=>{const n=Pt(e,t);return n?n.circuitId:null},Mt=wt((e=>e.activeEditorId)),St=wt((e=>e.activeEditorId?e.circucitEditorsById[e.activeEditorId]:null)),zt=wt(((e,t)=>Object.keys(e.circucitEditorsById).filter((n=>e.circucitEditorsById[n].circuitId===t))));function Lt(e){let t=null;const n=St(e);return n&&(t=n.circuitId),{serviceStates:kt()(e.services,Ce),viewCircuitId:t}}var Tt=n(928),Dt=n.n(Tt),Jt=n(9734),Rt=n.n(Jt);function Wt(...e){return[].concat(...e)}const At="@circuit-editor/drag/abort",Ut=()=>({type:At}),Zt=xt("circuitEditorDrag"),Ft=Ct("circuitEditorDrag"),Kt=Zt(((e,t)=>function(e){return e.type===At}(t)?u:e)),Ht="@circuit-editor/drag/continue",qt=Zt(((e,t)=>{if(!function(e){return e.type===Ht}(t))return e;const{dragPos:n,modifierKeys:i,editorId:r}=t.payload;return Object.assign(Object.assign({},e),{dragEnd:n,dragEndEditorId:r,dragModifierKeys:i})}));var Gt=n(3386),Vt=n.n(Gt),$t=n(1966),_t=n.n($t);function Xt(e,t="set"){return e.shiftKey&&e.ctrlMetaKey?"remove":e.shiftKey?"append":e.ctrlMetaKey?"toggle":t}function Yt(e,t,n){switch(n){case"set":return t;case"set-if-unselected":return t.every((t=>-1!==e.indexOf(t)))?e:t;case"append":return Vt()(e,t);case"remove":return _t()(e,t);case"toggle":return _t()(e,t).concat(_t()(t,e))}return t}const Qt="@select/region";var en=n(2222),tn=n(6604),nn=n.n(tn);const rn=xt("nodeGraph"),on=Ct("nodeGraph"),cn=on((e=>e.nodesById)),sn=on((0,en.P1)(cn.local,(e=>Object.keys(e)))),ln=on((0,en.P1)(cn.local,(e=>nn()(e,(e=>e.nodeType))))),an=on(((e,t)=>e.nodesById[t]||null)),dn=on(((e,t)=>{const n=[];for(const i of Object.keys(e.nodesById)){const{nodeType:r}=e.nodesById[i];r===t&&n.push(i)}return n})),un=on(((e,t)=>{const n=an.local(e,t);return n?n.nodeType:null})),pn=on((0,en.P1)((e=>e.nodesById),(e=>nn()(e,(e=>e.nodeName))))),mn=on(((e,t)=>{var n;const i=an.local(e,t);return i?null!==(n=i.nodeName)&&void 0!==n?n:t.substr(0,4):null})),yn=on(((e,t)=>{const n=an.local(e,t);return n?n.nodeName:null}));var fn=n(4654),gn=n.n(fn),In=n(3311),hn=n.n(In),bn=n(669),vn=n.n(bn);const En=xt("circuits"),kn=Ct("circuits"),On=kn((e=>e.nodeIdsByCircuitId)),Nn=kn(((e,t)=>e.nodeIdsByCircuitId[t])),xn=kn(((e,t)=>{for(const n of Object.keys(e.nodeIdsByCircuitId))if(-1!==e.nodeIdsByCircuitId[n].indexOf(t))return n;return null})),Cn=xt("nodeLayout"),jn=Ct("nodeLayout"),wn=jn((e=>e.nodePositionsById)),Pn=jn(((e,t)=>{var n;return null!==(n=e.nodePositionsById[t])&&void 0!==n?n:h.Ds}));function Bn(e){return"ic-"+e}function Mn(e){return e&&e.startsWith("ic-")?e.substr(3):null}function Sn(e,t){return`M10,10 h80 v${50*Math.max(e,t,1)-20} h-80 z`}const zn=kn((e=>Object.keys(e.circuitNamesByCircuitId))),Ln=kn((e=>e.circuitNamesByCircuitId)),Tn=kn(((e,t)=>e.circuitNamesByCircuitId[t])),Dn=kn(((e,t)=>{const{nodeIdsByCircuitId:n}=e,i=Object.keys(n);for(const e of i)if(-1!==n[e].indexOf(t))return e;return null})),Jn=(e,t,n)=>{if(!t)return!1;if(t===n)return!0;const i=Bn(n),{nodesById:r}=e.services.nodeGraph;return Object.keys(r).filter((e=>r[e].nodeType===i)).some((n=>{const i=Dn(e,n);return!!i&&Jn(e,t,i)}))};function Rn(e,t){return{x:"input"===t?0:100,y:50*e+25}}const Wn=[(0,en.P1)(On,ln,wn,Ln,((e,t,n,r)=>Object.keys(e).filter((e=>e!==p)).map((o=>{var c,s;const l=null!==(c=e[o])&&void 0!==c?c:[],a=null!==(s=r[o])&&void 0!==s?s:o.substr(0,5);let d=l.filter((e=>t[e].startsWith("pin-")));d=Rt()(d,(e=>n[e].y),(e=>n[e].x));const u={},p=[],m=[];for(const e of d){const n=t[e];"pin-input"===n?(u[e]=Object.assign({direction:"input"},Rn(p.length,"input")),p.push(e)):"pin-output"===n&&(u[e]=Object.assign({direction:"output"},Rn(m.length,"output")),m.push(e))}const y={circuitId:o,inputPinIds:p,outputPinIds:m};return{type:Bn(o),category:"integrated-circuit",displayName:a,elementProduction:{type:"circuit",circuitId:o},visual:{hitRect:(0,h.NG)(vn()(Sn(p.length,m.length))),trayComponent:()=>i.createElement("g",{stroke:"black",strokeWidth:1},i.createElement("rect",{x:10,y:10,width:30,height:30,fill:"none"}),i.createElement("line",{x1:10,y1:15,x2:5,y2:15}),i.createElement("line",{x1:40,y1:15,x2:45,y2:15}),i.createElement("line",{x1:10,y1:35,x2:5,y2:35}),i.createElement("line",{x1:40,y1:35,x2:45,y2:35})),component:"integrated-circuit",componentProps:y},pins:u}})))),n(4313).Z,n(9175).Z,n(4646).Z,n(2140).Z,n(6467).Z,n(8476).Z,n(3980).Z,n(9696).Z,n(2201).Z,n(6015).Z,n(5058).Z,n(3158).Z,n(7529).Z,n(4987).Z];let An=[];const Un=e=>{const t=gn()(Wn,(t=>function(e,t){let n;return n="function"==typeof e?e(t):e,ce(n)}(t,e)));return t.every(((e,t)=>e===An[t]))?An:(An=t,t)},Zn=(0,en.P1)(Un,(e=>{const t={};for(const n of e)t[n.type]=n;return t})),Fn=(e,t)=>{var n;const i=Un(e);return null!==(n=hn()(i,(e=>e.type===t)))&&void 0!==n?n:null};var Kn=n(7516);const Hn=Kn.Ry().shape({nodeId:Kn.Z_().required().min(1),pinId:Kn.Z_().required().min(1)});function qn(e,t){return e.nodeId===t.nodeId&&e.pinId===t.pinId}const Gn=(0,en.P1)(Zn,wn,ln,((e,t,n)=>{var i;const r={},o=Object.keys(n);for(const c of o){const o={};r[c]=o;const s=null!==(i=t[c])&&void 0!==i?i:h.Ds,l=n[c];if(!l)continue;const a=e[l];if(!a)continue;const d=Object.keys(a.pins);for(const e of d){const t=a.pins[e],n=(0,h.ZO)(s,t);o[e]=n}}return r}));let Vn=null;const $n=(e,t,n)=>{var i;const r=Gn(e),o=Nn(e,n);if(!o)return null;for(const e of o){const n=null!==(i=r[e])&&void 0!==i?i:h.Ds,o=Object.keys(n);for(const i of o){const r=n[i],o=(0,h.sj)(t,r);if((0,h.VE)(o)>6)continue;const c={nodeId:e,pinId:i};return Vn&&qn(c,Vn)||(Vn=c),Vn}}return null},_n=Ft((()=>50)),Xn=Ft((()=>5)),Yn=(e,t)=>{const n=_n(e);return(0,h.R9)(t,n)},Qn=(e,t)=>{const n=Xn(e);return(0,h.R9)(t,n)},ei="@circuit-editor/drag/start/joint",ti="@select/wire-joints",ni=(e,t="set")=>({type:ti,payload:{jointIds:Array.isArray(e)?e:[e],mode:t}}),ii=xt("selection"),ri=Ct("selection"),oi=ri((e=>e.selectedNodeIds)),ci=ri(((e,t)=>-1!==e.selectedNodeIds.indexOf(t))),si=((0,en.P1)(cn,oi,((e,t)=>kt()(e,t))),ri((e=>e.selectedConnectionIds)),ri(((e,t)=>-1!==e.selectedConnectionIds.indexOf(t)))),li=ri((e=>e.selectedJointIds)),ai=ri(((e,t)=>-1!==e.selectedJointIds.indexOf(t)));var di=n(6486);const ui=(0,en.P1)(((e,t)=>Nn(e,t)),(e=>e.services.nodeGraph.connectionsById),((e,t)=>Object.keys(t).filter((n=>{const{inputPin:i,outputPin:r}=t[n];return!!(0,di.includes)(e,i.nodeId)&&!!(0,di.includes)(e,r.nodeId)})))),pi=(e,t)=>{const{connectionsById:n}=e.services.nodeGraph,i=n[t];if(!i)return null;const{nodeId:r}=i.inputPin||i.outputPin;return xn(e,r)},mi="@circuit-editor/drag/start/new-joint",yi=Zt(((e,t,n)=>{if(!function(e){return e.type===mi}(t))return e;const{connectionId:i,addAfterJointId:r,modifierKeys:o,x:c,y:s,editorId:l}=t.payload;return pi(n,i)?Object.assign(Object.assign({},e),{dragMode:"new-joint",dragStart:{x:c,y:s},dragStartEditorId:l,dragEnd:null,dragEndEditorId:null,dragNewJointConnectionId:i,dragNewJointAfterJointId:r,dragModifierKeys:o}):e})),fi="@field/drag/start/node",gi="@select/nodes",Ii=(e,t="set")=>({type:gi,payload:{nodeIds:Array.isArray(e)?e:[e],mode:t}}),hi="@circuit-editor/drag/start/select",bi=Zt(((e,t)=>{if(!function(e){return e.type===hi}(t))return e;const{x:n,y:i,modifierKeys:r,editorId:o}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"select",dragStart:{x:n,y:i},dragStartEditorId:o,dragModifierKeys:r,dragEnd:null,dragEndEditorId:null})})),vi="@circuit-editor/drag/start/wire",Ei=Zt(((e,t,n)=>{if(!function(e){return e.type===vi}(t))return e;const{x:i,y:r,pin:o,editorId:c}=t.payload;return function(e,t){const n=On(t);for(const t of Object.keys(n))if(-1!==n[t].indexOf(e))return t;return null}(o.nodeId,n)?Object.assign(Object.assign({},e),{dragMode:"wire",dragStart:{x:i,y:r},dragStartEditorId:c,dragWireSource:o,dragEnd:null,dragEndEditorId:null}):e})),ki="@circuit-editor/mouse/leave",Oi=Wt(Kt,qt,(function(e=we,t){if(!function(e){return e.type===st}(t))return e;const n=e.services.circuitEditorDrag;if(null===n.dragMode)return e;const{x:i,y:r}=t.payload,{dragStart:o,dragStartEditorId:c,dragEndEditorId:s}=n;if(c!=s)return B(e,"services","circuitEditorDrag",u);switch(n.dragMode){case"select":{const t=Bt(e,c);if(t){const{dragModifierKeys:c}=n,s=Xt(c),l=(0,h.Qu)(o,{x:i,y:r});e=wc(e,((e,t,n="set")=>({type:Qt,payload:{region:e,circuitId:t,mode:n}}))(l,t,s))}break}case"move":{const{dragModifierKeys:t}=n;let c=(0,h.sj)({x:i,y:r},o);const s=e.services.selection.selectedNodeIds.length>0;t.ctrlMetaKey||(c=s?Yn(e,c):Qn(e,c)),e=wc(e,((e,t,n={})=>{var i;return{type:_e,payload:{offsetX:e,offsetY:t,snapMode:null!==(i=n.snapMode)&&void 0!==i?i:"none"}}})(c.x,c.y));break}case"new-joint":{const{dragNewJointConnectionId:t,dragNewJointAfterJointId:o}=n,c=Qn(e,{x:i,y:r});e=wc(e,((e,t,n,i)=>({type:nt,payload:{connectionId:e,jointId:(0,Le.Z)(),addAfterJointId:t,position:n}}))(t,o,c));break}case"wire":{const t=Bt(e,c);if(t){const{dragWireSource:o}=n,c=$n(e,{x:i,y:r},t);o&&c&&(e=wc(e,Ye(o,c)))}break}}return B(e,"services","circuitEditorDrag",u)}),(function(e=we,t){if(!function(e){return e.type===ei}(t))return e;const{jointId:n,x:i,y:r,modifierKeys:o,editorId:c}=t.payload;if(!((e,t)=>{const{wireJointIdsByConnectionId:n}=e.services.nodeLayout,i=Object.keys(n).find((e=>-1!==n[e].indexOf(t)));return i?pi(e,i):null})(e,n))return e;if(e=B(e,"services","circuitEditorDrag",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:i,y:r},dragStartEditorId:c,dragModifierKeys:o,dragEnd:null,dragEndEditorId:null}))),!ai(e,n)){const t=Xt(o);e=wc(e,ni(n,t))}return e}),yi,(function(e=we,t){if(!function(e){return e.type===fi}(t))return e;const{nodeId:n,x:i,y:r,modifierKeys:o,editorId:c}=t.payload;if(!xn(e,n))return e;if(e=B(e,"services","circuitEditorDrag",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:i,y:r},dragStartEditorId:c,dragModifierKeys:o,dragEnd:null,dragEndEditorId:null}))),!ci(e,n)){const t=Xt(o);e=wc(e,Ii(n,t))}return e}),bi,Ei,Zt(((e,t)=>function(e){return e.type===ki}(t)?null==e.dragMode?e:Object.assign(Object.assign({},e),{dragEnd:null}):e))),Ni=jt(((e,t)=>{if(!Re(t))return e;const{circuitId:n}=t.payload,i=Object.keys(e.circucitEditorsById).filter((t=>e.circucitEditorsById[t].circuitId!==n));let r=e.activeEditorId;return r&&-1!==i.indexOf(r)||(r=null),Object.assign(Object.assign({},e),{circucitEditorsById:kt()(e.circucitEditorsById,i),activeEditorId:r})})),xi="@circuit-editor/receive-focus",Ci=jt(((e,t)=>{if(!function(e){return e.type===xi}(t))return e;const{editorId:n}=t.payload;return-1===Object.keys(e.circucitEditorsById).indexOf(n)?e:Object.assign(Object.assign({},e),{activeEditorId:n})})),ji="@view/circuit",wi=(e,t=null,n={})=>({type:ji,payload:{circuitId:e,circuitNodeIdPath:t,newWindowId:n.newWindow?(0,Le.Z)():null}});function Pi(e){return e.type===ji}const Bi=Wt(Ni,Ci,jt(((e,t,n)=>{if(!Pi(t))return e;const{circuitId:i,circuitNodeIdPath:r,newWindowId:o}=t.payload;if(-1===zn(n).indexOf(i))return e;let c=o;return c||(c=function(e){var t;return e.activeEditorId?e.activeEditorId:null!==(t=Nt()(Object.keys(e.circucitEditorsById)))&&void 0!==t?t:null}(e)),c?Object.assign(Object.assign({},e),{circucitEditorsById:Object.assign(Object.assign({},e.circucitEditorsById),{[c]:{circuitId:i,circuitNodeIdPath:null!=r?r:[]}}),activeEditorId:c}):e}))),Mi=En(((e,t)=>{if(!function(e){return e.type===Te}(t))return e;const n=t.payload.circuitId;let i=t.payload.circuitName;return i||(i="Circuit "+(Object.keys(e.circuitNamesByCircuitId).length+1)),Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:i}),nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[n]:[]})})})),Si="@circuit/import",zi=Kn.Ry().shape({circuitId:Kn.Z_().required().min(1),circuitName:Kn.Z_().required().min(1)}),Li=Kn.Ry().shape({nodeId:Kn.Z_().required().min(1),nodeType:Kn.Z_().required().min(1),nodeName:Kn.Z_().nullable().min(1),circuitId:Kn.Z_().required().min(1),x:Kn.Rx().required(),y:Kn.Rx().required()}),Ti=Kn.Ry().shape({output:Hn.required(),input:Hn.required(),joints:Kn.IX().of(h.tQ)}),Di=Kn.Ry().shape({circuits:Kn.IX().of(zi).min(0),nodes:Kn.IX().of(Li).min(0),wires:Kn.IX().of(Ti).min(0)});var Ji=n(2628),Ri=n.n(Ji),Wi=n(4908),Ai=n.n(Wi);const Ui=on((e=>e.connectionsById)),Zi=on((0,en.P1)((e=>e.connectionsById),(e=>Object.keys(e)))),Fi=on(((e,t)=>e.connectionsById[t])),Ki=on((0,en.P1)((e=>e.connectionsById),(e=>Ri()(e)))),Hi=on(((e,t)=>{const{connectionsById:n}=e,i=Object.keys(n);for(const e of i)if(qn(n[e].inputPin,t))return e;return null})),qi=on(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].inputPin.nodeId===t)))),Gi=on(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].outputPin.nodeId===t)))),Vi=on(((e,t)=>{const n=qi.local(e,t),i=Gi.local(e,t);return Ai()([...n,...i])})),$i=(e,t)=>{const n=un(e,t);return n?Fn(e,n):null},_i={},Xi={},Yi=(jn((e=>Object.keys(e.wireJointPositionsByJointId))),jn((e=>e.wireJointIdsByConnectionId))),Qi=jn(((e,t)=>e.wireJointIdsByConnectionId[t])),er=jn(((e,t)=>e.wireJointPositionsByJointId[t])),tr=jn((e=>e.wireJointPositionsByJointId));class nr extends Error{constructor(e){super(e),this.message=e,this.code="SAVE_FORMAT_ERROR"}}function ir(e){const t=tr(e);return{circuits:zn(e).map((t=>({circuitId:t,circuitName:Tn(e,t)}))),nodes:sn(e).map((t=>{const n=an(e,t),i=Pn(e,t),r=xn(e,t);return{nodeId:t,nodeType:n.nodeType,nodeName:n.nodeName,circuitId:null!=r?r:p,x:i.x,y:i.y}})),wires:Zi(e).map((n=>{const i=Fi(e,n),r=Qi(e,n);return{input:i.inputPin,output:i.outputPin,joints:r.map((e=>t[e]))}}))}}function rr(e,t){var n,i,r;try{Di.validateSync(t)}catch(e){throw new nr(e.message)}e=we;try{e=(null!==(n=t.circuits)&&void 0!==n?n:[]).reduce(((e,{circuitId:t,circuitName:n})=>wc(e,De({circuitId:t,circuitName:n}))),e),e=(null!==(i=t.nodes)&&void 0!==i?i:[]).reduce(((e,t)=>{var n;return wc(e,Ue(t.nodeType,t.circuitId,{x:t.x,y:t.y},{nodeId:t.nodeId,nodeName:null!==(n=t.nodeName)&&void 0!==n?n:void 0}))}),e),e=(null!==(r=t.wires)&&void 0!==r?r:[]).reduce(((e,t)=>wc(e,Ye(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to rehydrate SaveData:",e),new nr("Failed to load project.")}return e}const or=En(((e,t)=>{if(!function(e){return e.type===We}(t))return e;const{circuitId:n,circuitName:i}=t.payload,r=i.trim();return""===r?e:Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:r})})})),cr=En(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,circuitId:i}=t.payload,r=i;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[r]:[...e.nodeIdsByCircuitId[r],n]})})})),sr=En(((e,t)=>{if(!He(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:nn()(e.nodeIdsByCircuitId,(e=>e.filter((e=>-1===n.indexOf(e)))))})})),lr=Wt(Mi,((e=we,t)=>{if(!Re(t))return e;const{circuitId:n}=t.payload,i=e.services.circuits.nodeIdsByCircuitId[n];if(!i)return e;e=[...dn(e,Bn(n)),...i].reduce(((e,t)=>wc(e,Ke(t))),e);const r=Object.keys(e.services.circuits.nodeIdsByCircuitId).filter((e=>e!==n));return B(e,"services","circuits",(e=>Object.assign(Object.assign({},e),{nodeIdsByCircuitId:kt()(e.nodeIdsByCircuitId,r),circuitNamesByCircuitId:kt()(e.circuitNamesByCircuitId,r)})))}),(function(e=we,t){if(!function(e){return e.type===Si}(t))return e;const{circuitIds:n,saveData:i}=t.payload;return function(e,t,n){var i,r;try{Di.validateSync(n)}catch(e){throw new nr(e.message)}const o=Object.keys(e.services.circuits.circuitNamesByCircuitId),c=n.circuits.filter((e=>-1!==t.indexOf(e.circuitId)&&-1===o.indexOf(e.circuitId)));if(0===c.length)return e;try{e=c.reduce(((e,{circuitId:t,circuitName:n})=>wc(e,De({circuitId:t,circuitName:n}))),e);const t=(null!==(i=n.nodes)&&void 0!==i?i:[]).filter((e=>c.some((({circuitId:t})=>t===e.circuitId))));e=t.reduce(((e,t)=>{var n;return wc(e,Ue(t.nodeType,t.circuitId,{x:t.x,y:t.y},{nodeId:t.nodeId,nodeName:null!==(n=t.nodeName)&&void 0!==n?n:void 0}))}),e),e=(null!==(r=n.wires)&&void 0!==r?r:[]).filter((function(e){return t.some((({nodeId:t})=>e.input.nodeId===t||e.output.nodeId===t))})).reduce(((e,t)=>wc(e,Ye(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to import circuit from SaveData:",e),new nr("Failed to import circuit.")}return e}(e,n,i)}),or,cr,sr,En(((e,t)=>gt(t)?Object.assign(Object.assign({},e),{circuitNamesByCircuitId:{[p]:"Root"},nodeIdsByCircuitId:{[p]:[]}}):e)));var ar=n(5161),dr=n.n(ar),ur=n(998),pr=n.n(ur),mr=n(7287),yr=n.n(mr);const fr="@clipboard/copy",gr=(e,t)=>{const n=un(e,t);if("pin-input"!==n&&"pin-output"!==n)return[];const i=xn(e,t);if(!i)return[];const r=Bn(i);return dn(e,r).map((e=>({nodeId:e,pinId:t})))},Ir=xt("clipboard");Ct("clipboard");const hr=Wt(Ir(((e,t,n)=>{if(!function(e){return e.type===fr}(t))return e;const{nodeIds:i}=t.payload;if(0===i.length)return e;const r=wn(n),o=yr()(i,dr()(i,(()=>(0,Le.Z)()))),c=r[i[0]],s=i.map((e=>{const t=an(n,e),s=((e,t)=>{const n=Ki(e),i=$i(e,t);if(!i)return{};let r=[];r=Object.keys(i.pins).filter((e=>"output"===i.pins[e].direction));const o=n.filter((e=>e.outputPin.nodeId===t)),c={};for(const e of r)c[e]=[];for(const e of o){const{outputPin:t,inputPin:n}=e;c[t.pinId].push(n)}return c})(n,e);return{id:o[e],nodeType:t.nodeType,offset:(0,h.sj)(r[e],c),outputs:nn()(s,(e=>e.filter((e=>{return t=e.nodeId,-1!==pr()(i,(e=>e===t));var t})).map((e=>({nodeId:o[e.nodeId],pinId:e.pinId})))))}}));return Object.assign(Object.assign({},e),{clipboardNodes:s,clipboardPasteOrigin:c})})),(function(e=we,t){if(!function(e){return e.type===ct}(t))return e;const{targetCircuitId:n}=t.payload,{clipboardNodes:i,clipboardPasteOrigin:r}=e.services.clipboard,o=_n(e),c=(0,h.ZO)(r,{x:o,y:o}),s=yr()(i.map((e=>e.id)),dr()(i,(()=>(0,Le.Z)())));for(const t of i){const{id:i,nodeType:r,offset:o}=t,l=(0,h.ZO)(c,o);e=wc(e,Ue(r,n,l,{nodeId:s[i]}))}for(const t of i){const{id:n,outputs:i}=t,r=s[n];for(const t of Object.keys(i))for(const n of i[t]){const{nodeId:i,pinId:o}=n,c=s[i];e=wc(e,Ye({nodeId:r,pinId:t},{nodeId:c,pinId:o}))}}return e=B(e,"services","clipboard","clipboardPasteOrigin",c),wc(e,Ii(Ri()(s)))})),br="@dialog/response/accept",vr=e=>({type:br,payload:{result:e}}),Er=xt("dialog"),kr=Ct("dialog"),Or=Er(((e,t)=>function(e){return e.type===br}(t)?v:e)),Nr="@dialog/response/cancel",xr=()=>({type:Nr}),Cr=Er(((e,t)=>function(e){return e.type===Nr}(t)?v:e)),jr="@dialog/show",wr=Wt(Or,Cr,Er(((e,t)=>{if(!function(e){return e.type===jr}(t))return e;const{dialogType:n,data:i}=t.payload;return Object.assign(Object.assign({},e),{dialogType:n,data:i})})));function Pr(e,t){return t.weight=e,t}function Br(e){var t;return(null!==(t=e.weight)&&void 0!==t?t:0)-1}const Mr=Pr(-10,rn(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,nodeType:i,nodeName:r}=t.payload;return Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:{nodeType:i,nodeName:null!=r?r:null}})})})));var Sr=n(5937),zr=n.n(Sr);const Lr=Pr(Br(sr),rn(((e,t,n)=>{if(!He(t))return e;const{nodeIds:i}=t.payload;return function(e,t,n){const i=_t()(Object.keys(e.nodesById),t),r=gn()(t,(e=>gr(n,e)));return Object.assign(Object.assign({},e),{nodesById:kt()(e.nodesById,i),connectionsById:zr()(e.connectionsById,(function({inputPin:e,outputPin:n}){return-1===t.indexOf(e.nodeId)&&-1===t.indexOf(n.nodeId)&&!r.some((t=>qn(t,e)||qn(t,n)))}))})}(e,i,n)}))),Tr=rn(((e,t)=>{if(!function(e){return e.type===qe}(t))return e;const{nodeId:n}=t.payload;if(!e.nodesById[n])return e;let i=t.payload.nodeName;return i||""!==i.trim()||(i=null),Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:Object.assign(Object.assign({},e.nodesById[n]),{nodeName:i})})})})),Dr=Wt(Mr,rn(((e,t)=>gt(t)?E:e)),Lr,Tr,rn(((e,t,n)=>{if(!Qe(t))return e;const{connectionId:i,p1:r,p2:o}=t.payload,c=function(e,t,n,i){const r=e.nodesById[t.nodeId],o=e.nodesById[n.nodeId];if(!r||!o)return null;const c=Fn(i,r.nodeType),s=Fn(i,o.nodeType);if(!c||!s)return null;const l=c.pins[t.pinId],a=s.pins[n.pinId];if(!l||!a)return null;if(l.direction===a.direction)return null;return{outputPin:"output"===l.direction?t:n,inputPin:"input"===l.direction?t:n}}(e,r,o,n);if(!c)return e;const{inputPin:s}=c;return hn()(e.connectionsById,(e=>qn(e.inputPin,s)))?e:Object.assign(Object.assign({},e),{connectionsById:Object.assign(Object.assign({},e.connectionsById),{[i]:Object.assign({id:i},c)})})})),rn(((e,t)=>{if(!tt(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.connectionsById).filter((e=>e!==n));return Object.assign(Object.assign({},e),{connectionsById:kt()(e.connectionsById,i)})}))),Jr=Cn(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,position:i=h.Ds}=t.payload;return B(e,"nodePositionsById",n,i)})),Rr=Pr(Br(Lr),Cn(((e,t,n)=>{if(!He(t))return e;const{nodeIds:i}=t.payload;return function(e,t,n){const i=t.reduce(((e,t)=>{const i=qi(n,t),r=Gi(n,t);return e.push(...i,...r),e}),[]),r=gn()(t,(e=>gr(n,e))),o=Ui(n),c=Object.keys(o).filter((e=>{const{inputPin:t,outputPin:n}=o[e];return r.some((e=>qn(e,t)||qn(e,n)))})),s=[...i,...c].reduce(((t,n)=>(t.push(...e.wireJointIdsByConnectionId[n]),t)),[]),l=_t()(Object.keys(e.wireJointIdsByConnectionId),i),a=_t()(Object.keys(e.wireJointPositionsByJointId),s),d=_t()(Object.keys(e.nodePositionsById),t);return Object.assign(Object.assign({},e),{nodePositionsById:kt()(e.nodePositionsById,d),wireJointIdsByConnectionId:kt()(e.wireJointIdsByConnectionId,l),wireJointPositionsByJointId:kt()(e.wireJointPositionsByJointId,a)})}(e,i,n)}))),Wr="@node/move",Ar=(e,t,n={})=>{var i,r;return{type:Wr,payload:{nodeIds:ce(e),position:t,relative:null!==(i=n.relative)&&void 0!==i&&i,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},Ur=Cn(((e,t,n)=>{if(!function(e){return e.type===Wr}(t))return e;const{nodeIds:i,position:r,relative:o,snapMode:c}=t.payload,s=nn()(kt()(e.nodePositionsById,i),(e=>{let t={x:o?e.x+r.x:r.x,y:o?e.y+r.y:r.y};return"node"===c&&(t=Yn(n,t)),t}));return Object.assign(Object.assign({},e),{nodePositionsById:Object.assign(Object.assign({},e.nodePositionsById),s)})})),Zr=Wt(Jr,Cn(((e,t)=>gt(t)?k:e)),Rr,Ur,Cn(((e,t)=>{if(!Qe(t))return e;const{connectionId:n,joints:i}=t.payload;if(i.length>0){const t=i.map((()=>(0,Le.Z)()));e=B(e,"wireJointIdsByConnectionId",n,t),e=B(e,"wireJointPositionsByJointId",(e=>Object.assign(Object.assign({},e),yr()(t,i))))}else e=B(e,"wireJointIdsByConnectionId",n,[]);return e})),Cn(((e,t)=>{if(!tt(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.wireJointIdsByConnectionId).filter((e=>e!=n)),r=_t()(Object.keys(e.wireJointPositionsByJointId),e.wireJointIdsByConnectionId[n]);return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:kt()(e.wireJointIdsByConnectionId,i),wireJointPositionsByJointId:kt()(e.wireJointPositionsByJointId,r)})})),Cn(((e,t)=>{if(!function(e){return e.type===nt}(t))return e;const{connectionId:n,addAfterJointId:i,position:r,jointId:o}=t.payload;let c=e.wireJointIdsByConnectionId[n];const s=i?c.indexOf(i)+1:0;return c=[...c.slice(0,s),o,...c.slice(s)],Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Object.assign(Object.assign({},e.wireJointIdsByConnectionId),{[n]:c}),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),{[o]:r})})})),Cn(((e,t)=>{if(!function(e){return e.type===ot}(t))return e;const{jointId:n}=t.payload,i=Object.keys(e.wireJointPositionsByJointId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:nn()(e.wireJointIdsByConnectionId,(e=>e.filter((e=>e!==n)))),wireJointPositionsByJointId:kt()(e.wireJointPositionsByJointId,i)})})),Cn(((e,t,n)=>{if(!function(e){return e.type===it}(t))return e;const{jointIds:i,position:r,relative:o,snapMode:c}=t.payload,s=nn()(kt()(e.wireJointPositionsByJointId,i),(e=>{let t={x:o?e.x+r.x:r.x,y:o?e.y+r.y:r.y};return"node"===c?t=Yn(n,t):"joint"===c&&(t=Qn(n,t)),t}));return Object.assign(Object.assign({},e),{wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),s)})}))),Fr=Pr(50,((e=we,t)=>{return vt(t)?(n=ir(e),localStorage.setItem("autosave",JSON.stringify(n)),e):e;var n})),Kr=xt("project"),Hr=Ct("project"),qr=Kr(((e,t)=>vt(t)?Object.assign(Object.assign({},e),{projectModified:!0}):e)),Gr=Kr(((e,t)=>gt(t)?(localStorage.removeItem("autosave"),Object.assign(Object.assign({},e),{projectName:"New Project",projectModified:!1})):e)),Vr="@project/rename",$r=Kr(((e,t)=>{if(!function(e){return e.type===Vr}(t))return e;let{projectName:n}=t.payload;return n=n.trim(),""===n?e:Object.assign(Object.assign({},e),{projectName:n})})),_r="@project/save",Xr=()=>({type:_r}),Yr="@project/save:success",Qr=Wt(Fr,(function(e=we,t){if(!function(e){return e.type===ze}(t))return e;const n=function(){const e=localStorage.getItem("autosave");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}();if(!n)return e;try{e=B(e=rr(e,n),"services","project",(e=>Object.assign(Object.assign({},e),{projectName:"Previous Project",projectModified:!0})))}catch(e){}return e}),qr,Gr,(function(e=we,t){if(!function(e){return e.type===It}(t))return e;const{fileName:n,saveData:i}=t.payload;try{e=B(e=rr(e,i),"services","project",(e=>Object.assign(Object.assign({},e),{projectName:n,projectModified:!1})))}catch(e){console.error("Failed to load save",e)}return e}),$r,Kr(((e,t)=>function(e){return e.type===Yr}(t)?Object.assign(Object.assign({},e),{projectModified:!1}):e))),eo=ii(((e,t)=>{if(!He(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:_t()(e.selectedNodeIds,n),selectedConnectionIds:[]})})),to=ii(((e,t)=>gt(t)?N:e));var no=n(5564),io=n.n(no);const ro="@select/all",oo=e=>({type:ro,payload:{circuitId:e}}),co=ii(((e,t,n)=>{if(!function(e){return e.type===ro}(t))return e;const{circuitId:i}=t.payload,r=Nn(n,i);let o=Zi(n);const c=Ui(n);o=o.filter((e=>{const{inputPin:t,outputPin:n}=c[e];return-1!==r.indexOf(t.nodeId)&&-1!==r.indexOf(n.nodeId)}));const s=Yi(n),l=io()(o.map((e=>s[e])));return Object.assign(Object.assign({},e),{selectedNodeIds:r,selectedConnectionIds:o,selectedJointIds:l})})),so="@select/clear",lo=ii(((e,t)=>function(e){return e.type===so}(t)?Object.assign(Object.assign({},e),{selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}):e)),ao=ii(((e,t)=>{if(!function(e){return e.type===ti}(t))return e;const{jointIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:Yt(e.selectedJointIds,n,i)})})),uo=ii(((e,t)=>{if(!function(e){return e.type===gi}(t))return e;const{nodeIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:Yt(e.selectedNodeIds,n,i),selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:"set"===i?[]:e.selectedJointIds})}));var po=n(2525),mo=n.n(po);const yo=(0,en.P1)(wn,Zn,ln,((e,t,n)=>nn()(e,((e,i)=>{const r=n[i];if(!r)return h.rG;const o=t[r];return o?(0,h.gQ)(o.visual.hitRect,e):h.rG})))),fo=ii(((e,t,n)=>{if(!function(e){return e.type===Qt}(t))return e;const{region:i,circuitId:r,mode:o}=t.payload,c=Nn(n,r),s=kt()(yo(n),c),l=[];mo()(s,((e,t)=>{(0,h.kK)(e,i)&&l.push(t)}));const a=tr(n),d=((e,t)=>{const n=Nn(e,t),i=gn()(n,(t=>Vi(e,t))),r=gn()(i,(t=>Qi(e,t)));return Ai()(r)})(n,r).filter((e=>{const t=a[e];return(0,h.PL)(t,i)}));return Object.assign(Object.assign({},e),{selectedNodeIds:Yt(e.selectedNodeIds,l,o),selectedConnectionIds:"set"===o?[]:e.selectedConnectionIds,selectedJointIds:Yt(e.selectedJointIds,d,o)})})),go="@select/wires",Io=ii(((e,t)=>{if(!function(e){return e.type===go}(t))return e;const{connectionIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:Yt(e.selectedConnectionIds,n,i),selectedJointIds:"set"===i?[]:e.selectedJointIds})})),ho="@selection/copy",bo=Wt(to,eo,co,lo,ao,uo,fo,Io,(function(e=we,t){if(!function(e){return e.type===Ge}(t))return e;const{selectedNodeIds:n,selectedJointIds:i}=e.services.selection,r=wn(e);for(const t of n){const n=r[t];if(!n)continue;const i=Yn(e,n);(0,h.kg)(n,i)||(e=wc(e,Ar(t,i)))}const o=tr(e);for(const t of i){const n=o[t];if(!n)continue;const i=Qn(e,n);(0,h.kg)(n,i)||(e=wc(e,rt(t,i)))}return e}),(function(e=we,t){if(!function(e){return e.type===ho}(t))return e;const n=oi(e);return 0===n.length?e:wc(e,(i=n,{type:fr,payload:{nodeIds:Array.isArray(i)?i:[i]}}));var i}),(function(e=we,t){if(!function(e){return e.type===Ve}(t))return e;const{selectedNodeIds:n,selectedConnectionIds:i,selectedJointIds:r}=e.services.selection;return n.length>0&&(e=wc(e,Ke(n))),e=i.reduce(((e,t)=>wc(e,(e=>({type:et,payload:{connectionId:e}}))(t))),e),r.reduce(((e,t)=>wc(e,(e=>({type:ot,payload:{jointId:e}}))(t))),e)}),(function(e=we,t){if(!function(e){return e.type===_e}(t))return e;const{offsetX:n,offsetY:i,snapMode:r}=t.payload,o=oi(e),c=li(e),s={x:n,y:i};let l="none";"node"!==r&&"by-type"!==r||(l="node");let a="none";return a="by-type"===r?"joint":r,e=wc(e,Ar(o,s,{relative:!0,snapMode:l})),wc(e,rt(c,s,{relative:!0,snapMode:a}))}),ii(((e,t)=>{if(!tt(t))return e;const{connectionId:n}=t.payload;return Object.assign(Object.assign({},e),{selectedConnectionIds:e.selectedConnectionIds.filter((e=>e!==n))})}))),vo=xt("simulator"),Eo=Ct("simulator"),ko=vo(((e,t)=>vt(t)?x:e));function Oo(e){return e.default}const No={"input-momentary":Oo(n(3667)),"input-toggle":Oo(n(2318)),"logic-and":Oo(n(7909)),"logic-buffer":Oo(n(274)),"logic-nand":Oo(n(4347)),"logic-nor":Oo(n(8112)),"logic-not":Oo(n(6559)),"logic-or":Oo(n(2649)),"logic-xor":Oo(n(8881)),"output-led":Oo(n(6567)),"output-seg7":Oo(n(4257)),"pin-high":Oo(n(4420))};var xo=n(1235);function Co(e,t){const n=gn()(t,(e=>[e,"subCircuitIds"]));n.pop();const i=w()(e,n);if(!i)return null;const{simulatorNodeId:r}=i;return null!=r?r:null}var jo=n(3857),wo=n.n(jo);const Po=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{},inputElementPinsByCircuitPinId:{},outputElementPinsByCircuitPinId:{}});function Bo(e,t,n=[]){var i;if(-1!==n.indexOf(e))throw new Error(`Circuit graph encountered loop on ${n.join(" => ")} while trying to add circuit ${e}`);n=[...n,e];const r={},o={},c={},s={},l=[],a=[],d={},u={},p=null!==(i=t.nodeIdsByCircuitId[e])&&void 0!==i?i:[];for(const e of p){const i=t.nodeTypesByNodeId[e];if(!i)continue;if("pin-input"===i){l.push(e),c[e]=[];continue}if("pin-output"===i){a.push(e);continue}const s=Mo(e,t,n);wo()(r,s.simulatorNodesById),wo()(o,s.simulatorNodeIdsByCircuitNodeId),d[e]=s.inputElementPinsByCircuitPinId,u[e]=s.outputElementPinsByCircuitPinId}const m=t.connectionsById;for(const e of Object.keys(m)){const{inputPin:t,outputPin:n}=m[e];if(-1===p.indexOf(t.nodeId)||-1===p.indexOf(n.nodeId))continue;const i=w()(u,[n.nodeId,n.pinId]),o=w()(d,[t.nodeId,t.pinId]);if(-1!==l.indexOf(n.nodeId)&&o){c[n.nodeId].push(...o);continue}if(-1!==a.indexOf(t.nodeId)&&i){s[t.nodeId]=i;continue}if(!i||!o)continue;const y=r[i.simulatorNodeId];let f=y.outputsByPin[i.pinId];null==f&&(y.outputsByPin[i.pinId]=f=[]);for(const e of o)f.push({simulatorNodeId:e.simulatorNodeId,pinId:e.pinId}),r[e.simulatorNodeId].inputsByPin[e.pinId]={simulatorNodeId:i.simulatorNodeId,pinId:i.pinId}}return{simulatorNodesById:r,simulatorNodeIdsByCircuitNodeId:o,inputElementPinsByCircuitPinId:c,outputElementPinsByCircuitPinId:s}}function Mo(e,t,n){const i=t.nodeTypesByNodeId[e];if(!i)return Po;const r=t.nodeDefsByType[i];if(!r||!r.elementProduction)return Po;const o="string"==typeof(c=r.elementProduction)?{type:"element",elementType:c}:c;var c;switch(o.type){case"element":return function(e,t,{nodeTypesByNodeId:n,nodeDefsByType:i}){const r=i[n[e]];if(!r)return Po;const o={},c={},s=(0,Le.Z)();o[s]={elementType:t.elementType,inputsByPin:{},outputsByPin:{}},c[e]={simulatorNodeId:s,subCircuitIds:{}};const l={},a={};for(const e of Object.keys(r.pins)){const{direction:t}=r.pins[e];"input"===t?l[e]=[{pinId:e,simulatorNodeId:s}]:"output"===t&&(a[e]={pinId:e,simulatorNodeId:s})}return{simulatorNodesById:o,simulatorNodeIdsByCircuitNodeId:c,inputElementPinsByCircuitPinId:l,outputElementPinsByCircuitPinId:a}}(e,o,t);case"circuit":return function(e,t,n,i){const r=Bo(t.circuitId,n,i);return Object.assign(Object.assign({},r),{simulatorNodeIdsByCircuitNodeId:{[e]:{simulatorNodeId:null,subCircuitIds:r.simulatorNodeIdsByCircuitNodeId}}})}(e,o,t,n);default:throw new Error("Unsupported production type "+o.type)}}const So=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{}}),zo=(0,en.P1)(On,ln,Ui,Zn,((e,t,n,i)=>{try{return Bo(p,{nodeIdsByCircuitId:e,nodeTypesByNodeId:t,connectionsById:n,nodeDefsByType:i})}catch(e){return console.error(e),So}})),Lo=(e,t)=>{const{simulatorNodesById:n}=zo(e),i=n[t];return i?i.elementType:null},To=(e,t)=>{var n;const i=Lo(e,t);return i&&null!==(n=No[i])&&void 0!==n?n:null};var Do=n(7513),Jo=n.n(Do);const Ro=Object.freeze([]),Wo=Object.freeze({});function Ao(e,t){const n=(e=>{const{simulatorNodesById:t}=zo(e);return Object.keys(t)})(t);return e=x,e=n.reduce(((e,n)=>function(e,t,n){const i=To(n,t);if(!i)return e;const r={};return i.outputPins.forEach((e=>{r[e]=!1})),B(e,"nodeOutputValuesByNodeId",t,r)}(e,n,t)),e),e=n.reduce(((e,n)=>Zo(e,n,t)),e),Object.assign({},e,{initialized:!0})}function Uo(e,t,n){if(0===t.transitionIds.length)return e;let i=Object.assign({},e,{tick:t.tick,nodeOutputValuesByNodeId:Object.assign({},e.nodeOutputValuesByNodeId)});const r=new Set;t.transitionIds.forEach((e=>{const{nodeId:t,valuesByOutputPin:o}=i.transitionsById[e];var c,s;(c=i.nodeOutputValuesByNodeId[t],s=o,Object.keys(s).some((e=>c[e]!==s[e])))&&(i.nodeOutputValuesByNodeId[t]=Object.assign({},i.nodeOutputValuesByNodeId[t],o),((e,t)=>{const{simulatorNodesById:n}=zo(e),i=n[t];return i?gn()(Ri()(i.outputsByPin),(e=>e.map((e=>e.simulatorNodeId)))):Ro})(n,t).forEach((e=>r.add(e))))})),i.transitionsById=kt()(i.transitionsById,_t()(Object.keys(i.transitionsById),t.transitionIds));for(const e of r)i=Zo(i,e,n);return i}function Zo(e,t,n){const i=To(n,t);if(!i||!i.evolve)return e;const r=function(e,t,n){const i={},r=((e,t)=>{const{simulatorNodesById:n}=zo(e),i=n[t];return i?i.inputsByPin:Wo})(n,t);return Object.keys(r).forEach((t=>{var n;const o=r[t];if(!o)return void(i[t]=!1);const{simulatorNodeId:c,pinId:s}=o;i[t]=(null===(n=e.nodeOutputValuesByNodeId[c])||void 0===n?void 0:n[s])||!1})),i}(e,t,n);return Fo(e,t,i.evolve(e.nodeStatesByNodeId[t],r,e.tick))}function Fo(e,t,n){const{state:i,transitions:r}=n;return i&&(e=B(e,"nodeStatesByNodeId",t,i)),r&&(e=ce(r).reduce(((e,n,i)=>function(e,t,n,i="replace"){const{tickOffset:r,valuesByPin:o,transitionMerger:c=i}=n,s=e.tick+(r>0?r:1);return"replace"===c&&(e=function(e,t){return Object.keys(e.transitionsById).filter((n=>function(e){return e.nodeId===t}(e.transitionsById[n]))).reduce(((e,t)=>function(e,t){const n=e.transitionsById[t];if(!n)return e;const i=kt()(e.transitionsById,Object.keys(e.transitionsById).filter((e=>e!==t)));let r=e.transitionWindows;const o=Jo()(r,n.tick,((e,t)=>e.tick-t));if(o>=0){const e=r[o],{transitionIds:n}=e,i=e.transitionIds.indexOf(t);-1!==i&&(1===e.transitionIds.length?r=le(r,o):(r=r.slice(),r[o]=Object.assign({},r[o],{transitionIds:le(n,i)})))}return Object.assign({},e,{transitionsById:i,transitionWindows:r})}(e,t)),e)}(e,t)),function(e,t,n,i){const r=(0,Le.Z)(),o={nodeId:t,tick:n,valuesByOutputPin:i},c=e.transitionWindows.slice();let s=Jo()(c,n,((e,t)=>e.tick-t));if(s<0){s=-s-1;const e={tick:n,transitionIds:[]};c.splice(s,0,e)}const l=c[s].transitionIds.slice();l.push(r),c[s]=Object.assign({},c[s],{transitionIds:l});const a=Object.assign({},e.transitionsById,{[r]:o});return Object.assign({},e,{transitionsById:a,transitionWindows:c})}(e,t,s,o)}(e,t,n,0===i?"replace":"append")),e)),e}const Ko=vo(((e,t,n)=>{if(!(0,xo.ke)(t))return e;const{circuitNodeIdPath:i,data:r}=t.payload,o=((e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=zo(e);return Co(n,t)})(n,i);if(!o)return e;const c=Lo(n,o);if(!c)return e;const s=No[c];if(!s||!s.interact)return e;const l=e.nodeStatesByNodeId[o];return Fo(e,o,s.interact(l,r))})),Ho="@sim/start",qo=()=>({type:Ho});function Go(e){return e.type===Ho}const Vo=vo(((e,t,n)=>Go(t)?Ao(e,n):e)),$o="@sim/step",_o=()=>({type:$o});function Xo(e){return e.type===$o}const Yo="@sim/tick",Qo=e=>({type:Yo,payload:{tickCount:e}}),ec="@sim/stop",tc=()=>({type:ec});function nc(e){return e.type===ec}const ic=Wt(ko,Ko,Vo,(function(e=we,t){if(!Xo(t))return e;const{initialized:n}=e.services.simulator;n||(e=B(e,"services","simulator",(t=>Ao(t,e))));const{tick:i,transitionWindows:r}=e.services.simulator;if(0===r.length)return e;const o=r[0].tick;return wc(e,Qo(o-i))}),vo(((e,t)=>nc(t)?x:e)),vo(((e,t,n)=>{if(!function(e){return e.type===Yo}(t))return e;const{tickCount:i}=t.payload,r=performance.now();e=function(e,t,n){const i=e.tick+t;e=Object.assign({},e,{transitionWindows:e.transitionWindows.slice()});let r=t+1;for(;e.transitionWindows.length>0&&e.transitionWindows[0].tick<=i;){if(0==--r)throw new Error("Maximum ticks per sim evolution exceeded.  This is an indication that windows are being generated for past ticks.");const t=e.transitionWindows.shift();e=Uo(e,t,n)}return e.tick!=i&&(e=Object.assign({},e,{tick:i})),e}(e,i,n);const o=performance.now()-r;return Object.assign(Object.assign({},e),{lastTickProcessingTimeMs:o})}))),rc=xt("simulatorControl"),oc=Ct("simulatorControl"),cc=rc(((e,t)=>vt(t)?Object.assign(Object.assign({},e),{mode:"edit"}):e)),sc="@sim/pause",lc=e=>({type:sc,payload:{mode:e}}),ac=oc((e=>"edit"!==e.mode)),dc=oc((e=>"run"===e.mode)),uc=oc((e=>"pause"===e.mode)),pc=oc((e=>e.ticksPerSecond)),mc=Wt(cc,rc(((e,t)=>{if(!function(e){return e.type===sc}(t))return e;const{mode:n}=t.payload;if(!ac.local(e))return e;let i=e.mode;switch(n){case!0:i="pause";break;case!1:i="run";break;case"toggle":i="run"==i?"pause":"run"}return Object.assign(Object.assign({},e),{mode:i})})),rc(((e,t)=>Go(t)?Object.assign(Object.assign({},e),{mode:"run"}):e)),rc(((e,t)=>Xo(t)?Object.assign(Object.assign({},e),{mode:"pause"}):e)),rc(((e,t)=>nc(t)?Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}):e))),yc=xt("uiLayout"),fc=Ct("uiLayout"),gc=yc(((e,t,n)=>{if(!Re(t))return e;if(!e.layout)return e;const{circuitId:i}=t.payload,r=zt(n,i),o=fe(e.layout,(e=>!ve(e)||-1===r.indexOf(e.windowProps.editorId)));return Object.assign(Object.assign({},e),{layout:o})})),Ic="@layout/rearrange",hc=yc(((e,t)=>{if(!function(e){return e.type===Ic}(t))return e;const{layout:n}=t.payload;return Object.assign(Object.assign({},e),{layout:n})})),bc=yc(((e,t,n)=>{if(!Pi(t))return e;const{newWindowId:i}=t.payload;if(!i)return e;const r=be(i),o=Mt(n);let c=e.layout;if(null==c)c=r;else{let e=!1;l=t=>{const n=R(t);return ve(n)&&n.windowProps.editorId===o?(e=!0,{direction:"row",division:50,first:t,second:r}):null},c=null!==(a=function e(t){const n=l(t);if(n)return n;const i=R(t);if(A(i)){const t=e(i.first);if(t)return Object.assign(Object.assign({},i),{first:t});const n=e(i.second);if(n)return Object.assign(Object.assign({},i),{second:n})}return null}(s=c))&&void 0!==a?a:s,e||(c={direction:"row",division:50,first:c,second:r})}var s,l,a;return Object.assign(Object.assign({},e),{layout:c})})),vc="@view/reset",Ec=()=>({type:vc}),kc=Wt(gc,hc,bc,yc(((e,t)=>function(e){return e.type===vc}(t)?ke:e))),Oc="@view/node-names",Nc=e=>({type:Oc,payload:{mode:e}}),xc=xt("uiSettings"),Cc=Ct("uiSettings"),jc=Wt(xc(((e,t)=>{if(!function(e){return e.type===Oc}(t))return e;const{mode:n}=t.payload;return Object.assign(Object.assign({},e),{nodeNameMode:n})}))),wc=function(e){const t=Rt()(e,(e=>e.weight||0));return(e=we,n)=>t.reduce(((e,t)=>t(e,n)),e)}(Wt(Oi,Bi,lr,hr,wr,Dr,Zr,Qr,bo,ic,mc,kc,jc));const Pc=[Ht,ki,Yo];var Bc=n(4970),Mc=n(8764),Sc=n(8424);function*zc(e,t){yield(0,Bc.gz)(((e,t)=>({type:jr,payload:{dialogType:e,data:t}}))(e,t));const n=yield(0,Bc.qn)([br,Nr]);return n.type===br?n.payload.result:null}const Lc="@project/export-link",Tc=()=>({type:Lc});function*Dc(){yield(0,Bc.ib)(Lc,Jc)}function*Jc(){const e=yield(0,Bc.Ys)();try{const t=ir(e),n=JSON.stringify(t),i=(0,Sc.Wt)(n),r=Mc.lW.from(i).toString("base64"),o=encodeURIComponent(r),c=Se+d.createHref({pathname:"/import",search:"data="+o});yield(0,Bc.RE)(zc,"export-project-link",{projectLink:c})}catch(e){console.error("Failed to export project as link",e)}}var Rc=n(4171),Wc=n.n(Rc);const Ac="@project/import-circuits",Uc=()=>({type:Ac});function*Zc(){yield(0,Bc.ib)(Ac,Fc)}function*Fc(){const[e]=yield(0,Bc.RE)(Wc(),{accept:"application/json"}),t=yield(0,Bc.RE)(e.text.bind(e)),n=JSON.parse(t),i=yield(0,Bc.RE)(zc,"import-project-circuits",{circuits:n.circuits.filter((e=>e.circuitId!==p))});if(!Array.isArray(i))return;const r=i,o=[];let c;for(;c=r.pop();){o.push(c);for(const e of n.nodes){const{circuitId:t,nodeType:n}=e;if(c!==t)continue;const i=Mn(n);null!=i&&r.push(i)}}yield(0,Bc.gz)(((e,t)=>({type:Si,payload:{circuitIds:ce(e),saveData:t}}))(o,n))}const Kc="@project/import-link";function*Hc(){yield(0,Bc.ib)(Kc,qc)}function*qc(e){const{data:t}=e.payload;try{const e=decodeURIComponent(t),n=Mc.lW.from(e,"base64"),i=(0,Sc.rr)(n,{to:"string"}),r=JSON.parse(i);yield(0,Bc.gz)(ht("Linked Project",r)),d.replace("/")}catch(e){console.error("Failed to import save from link",e)}}const Gc="@project/load",Vc=()=>({type:Gc});function*$c(){yield(0,Bc.ib)(Gc,_c)}function*_c(){try{const[e]=yield(0,Bc.RE)(Wc(),{accept:"application/json"}),t=yield(0,Bc.RE)(e.text.bind(e)),n=JSON.parse(t);let i=e.name;i=i?i.substr(0,i.lastIndexOf(".json")):"Unnamed Project",yield(0,Bc.gz)(ht(i,n))}catch(e){console.warn("Failed to load project:",e)}}var Xc=n(3162);const Yc=Hr((e=>e.projectName)),Qc=Hr((e=>e.projectModified));function*es(){yield(0,Bc.ib)(_r,ts)}function*ts(){const e=yield(0,Bc.Ys)();try{window.showSaveFilePicker?yield(0,Bc.RE)(ns,e):yield(0,Bc.RE)(is,e),yield(0,Bc.gz)({type:Yr})}catch(e){console.warn("Failed to save project",e)}}function*ns(e){const t=yield(0,Bc.Ys)(Yc),n=yield(0,Bc.RE)(window.showSaveFilePicker,{suggestedName:t,types:[{description:"Discrelog Project Files",accept:{"application/json":[".json"]}}]});if(!n)return;let i=n.name;i||(i=n.getFile().name),i&&(i=i.substr(0,i.lastIndexOf(".json")),yield(0,Bc.gz)((e=>({type:Vr,payload:{projectName:e}}))(i)));const r=ir(e),o=yield(0,Bc.RE)(n.createWritable.bind(n));yield(0,Bc.RE)(o.write.bind(o),JSON.stringify(r,null,2)),yield(0,Bc.RE)(o.close.bind(o))}function*is(e){const t=yield(0,Bc.Ys)(Yc),n=ir(e),i=new Blob([JSON.stringify(n,null,2)],{type:"application/json;charset=utf-8"});(0,Xc.saveAs)(i,t+".json")}function*rs(){yield(0,Bc.rM)(Dc),yield(0,Bc.rM)(Zc),yield(0,Bc.rM)(Hc),yield(0,Bc.rM)($c),yield(0,Bc.rM)(es)}function*os(){yield(0,Bc.A7)([Ho,sc,$o],cs)}function*cs(){for(;yield(0,Bc.Ys)(dc);){try{yield(0,Bc.gz)(Qo(1))}catch(e){return console.error(e),void(yield(0,Bc.gz)(lc(!0)))}const e=yield(0,Bc.Ys)(pc),t=Math.max(Math.ceil(1e3/e),1);yield(0,Bc.gw)(t)}}function*ss(){yield(0,Bc.rM)(os)}const ls=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionSanitizer:function(e){return e},stateSanitizer:function(e){return e},actionsBlacklist:Pc})||Pe.qC,as=(0,Be.ZP)(),ds=[!1,as].filter(z),us=(0,Pe.MT)((function(e=we,t){return e=function(e=we,t){return function(e=we,t){if(!dt(t))return e;const{undoStack:n,redoStack:i}=e.undo,r=Dt()(n);if(!r)return e;const{serviceStates:o,viewCircuitId:c}=r;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:n.slice(0,n.length-1),redoStack:[...i,Lt(e)]})}),c&&(e=wc(e,wi(c))),e}(e=function(e=we,t){if(!mt(t))return e;const{undoStack:n,redoStack:i}=e.undo,r=Dt()(i);if(!r)return e;const{serviceStates:o,viewCircuitId:c}=r;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:[...n,Lt(e)],redoStack:i.slice(0,i.length-1)})}),c&&(e=wc(e,wi(c))),e}(e=function(e=we,t){return!vt(t)||dt(t)||mt(t)?e:B(e,"undo",(t=>Object.assign(Object.assign({},t),{undoStack:[...t.undoStack.slice(0,25),Lt(e)],redoStack:[]})))}(e,t),t),t)}(e,t),wc(e,t)}),ls((0,Pe.md)(...ds)));function ps(e){return(0,c.v9)(e)}function ms(e,t,n,r){i.useEffect((()=>{if(!e.current)return;const i=e.current;return i.addEventListener(t,n,r),()=>{i.removeEventListener(t,n,r)}}),[t,n,e,r])}as.run((function*(){yield(0,Bc.rM)(rs),yield(0,Bc.rM)(ss)})),us.dispatch({type:ze});const ys=fc((e=>e.layout)),fs=({className:e,title:t,children:n})=>i.createElement("div",{className:P("titlebar--3-TCE",e)},i.createElement("span",{className:"titlebar-heading--3RAl1"},"Discrelog"),i.createElement("div",{className:"titlebar-divider--Wl_27"}),t&&i.createElement("div",{className:"titlebar-title--HXGig"},t),n);var gs=n(1935);function Is(){}const hs={registerPopoverChild:Is,unregisterPopoverChild:Is},bs=i.createContext(null),vs=({registerPopoverChild:e,unregisterPopoverChild:t,children:n})=>{const r=i.useContext(bs),o=null==r?void 0:r.registerPopoverChild,c=null==r?void 0:r.unregisterPopoverChild,s=i.useCallback((t=>{o&&o(t),e(t)}),[e,o]),l=i.useCallback((e=>{t(e)}),[t,c]),a=i.useMemo((()=>({registerPopoverChild:s,unregisterPopoverChild:l})),[s,l]);return i.createElement(bs.Provider,{value:a},n)},Es=({isOpen:e,anchorEl:t,placement:n="auto",onRequestClose:o,children:c})=>{const[s,l]=i.useState(null),{attributes:a,styles:d}=(0,gs.D)(e?t:null,s,{placement:n});!function(e){var t;const n=null!==(t=i.useContext(bs))&&void 0!==t?t:hs,r=i.useRef(n);i.useEffect((()=>{r.current=n})),i.useEffect((()=>{if(e)return r.current.registerPopoverChild(e),()=>r.current.unregisterPopoverChild(e)}),[e])}(s);const[u,p,m]=function(e=[]){const[t,n]=i.useState(e),r=i.useCallback((e=>{n([...t,e])}),[t]),o=i.useCallback((e=>{n(_t()(t,[e]))}),[t]);return[t,r,o,n]}();return function(e,t,n=!0){const r=i.useCallback((n=>{const i=ce(e).filter(z);i.length&&i.every((e=>!e.contains(n.target)))&&t()}),[e,t]);i.useEffect((()=>{if(n)return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}}),[r,n])}(i.useMemo((()=>[s,...u]),[u,s]),o),e?(0,r.createPortal)(i.createElement(vs,{registerPopoverChild:p,unregisterPopoverChild:m},i.createElement("div",Object.assign({ref:l,style:d.popper},a.popper),c)),document.body):null},ks=i.createContext((function(){}));function Os(){return i.useContext(ks)}const Ns=ks.Provider,xs=({content:e,placement:t,children:n})=>{const r=i.useRef(null),[o,c]=i.useState(!1),s=i.useCallback((()=>{c(!0)}),[]),l=i.useCallback((()=>{c(!1)}),[]);return i.createElement(Ns,{value:l},i.createElement("div",{ref:r,onClick:s},n),i.createElement(Es,{anchorEl:r.current,isOpen:o,placement:t,onRequestClose:l},o&&e))},Cs={button:"button--Ui3Hp","button--size-small":"button--size-small--289kb","button--size-default":"button--size-default--dnLXK","button--variant-primary":"button--variant-primary--2qpAa","button--variant-default":"button--variant-default---2bie","button--variant-menu":"button--variant-menu--3lEZ1"};const js=e=>{var{variant:t="default",size:n="default"}=e,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["variant","size"]);return i.createElement("button",Object.assign({className:P(Cs.button,Cs["button--variant-"+t],Cs["button--size-"+n]),type:"button"},r),r.children)};function ws(e,...t){const n=(0,c.I0)();return i.useCallback((()=>{const i=e(...t);i&&n(i)}),[n,e,...t])}function Ps(e,...t){const n=(0,c.I0)();return i.useCallback((i=>{if(i.defaultPrevented)return;i.preventDefault();const r=e(...t);r&&n(r)}),[n,e,...t])}const Bs="menu-item--2dcyN",Ms="menu-item--disabled--RJJTK",Ss="menu-item-content--3s1DG",zs="menu-item-text--1F41V",Ls="menu-item-secondary--2PJLF",Ts=({children:e})=>i.createElement("ul",{className:"menu--3E86w"},e),Ds=({disabled:e,onClick:t,secondary:n,children:r})=>{const o=Os(),c=i.useCallback((e=>{t&&t(e),o()}),[o,t]);return i.createElement("li",{className:P(Bs,e&&Ms)},i.createElement("a",{className:Ss,onClick:c},i.createElement("span",{className:zs},r),n&&i.createElement("span",{className:Ls},n)))},Js=()=>i.createElement("div",{className:"menu-divider--1QPGp"}),Rs=()=>{const e=ws(ft),t=ws(Xr),n=ws(Vc),r=ws(Uc),o=ws(Tc);return i.createElement(Ts,null,i.createElement(Ds,{onClick:e},"New"),i.createElement(Js,null),i.createElement(Ds,{onClick:n},"Load"),i.createElement(Ds,{onClick:t},"Save"),i.createElement(Js,null),i.createElement(Ds,{onClick:r},"Import Circuits"),i.createElement(Js,null),i.createElement(Ds,{onClick:o},"Export Link"))};var Ws=n(1795);const As=/(Mac|iOS|OS\ X)/.test((Ws.os||"undefined").toString()),Us=As?"command":"ctrl",Zs=e=>e.undo.undoStack.length>0,Fs=e=>e.undo.redoStack.length>0,Ks=()=>{const e=ps(Zs),t=ws(at),n=ps(Fs),r=ws(pt);return i.createElement(Ts,null,i.createElement(Ds,{disabled:!e,secondary:Us+"+z",onClick:t},"Undo"),i.createElement(Ds,{disabled:!n,secondary:Us+"+shift+z",onClick:r},"Redo"))},Hs=Cc((e=>e.nodeNameMode)),qs=({className:e,value:t,onChange:n,children:r})=>i.createElement("label",{className:e},i.createElement("span",{className:"checkbox-span--1EWGs"},i.createElement("input",{type:"checkbox",checked:t,onChange:n})),r),Gs=({disabled:e,secondary:t,value:n,onChange:r,children:o})=>i.createElement("li",{className:P(Bs,e&&Ms)},i.createElement(qs,{className:Ss,value:n,onChange:r},i.createElement("span",{className:zs},o),t&&i.createElement("span",{className:Ls},t))),Vs=({disabled:e,secondary:t,content:n,children:r})=>i.createElement("li",{className:P(Bs,e&&Ms)},i.createElement(xs,{placement:"right-start",content:n},i.createElement("a",{className:Ss},i.createElement("span",{className:zs},r),t&&i.createElement("span",{className:Ls},t),i.createElement("svg",{className:"menu-item-icon--JTlha",width:12,height:12},i.createElement("path",{d:"M0,0 l6,6 l-6,6 z",fill:"black",strokeWidth:0}))))),$s=()=>{const e=ps(Hs),t=ws(Nc,"all"),n=ws(Nc,"named-only"),r=ws(Nc,"none");return i.createElement(Ts,null,i.createElement(Gs,{value:"all"===e,onChange:t},"Always visible"),i.createElement(Gs,{value:"named-only"===e,onChange:n},"Named Items Only"),i.createElement(Gs,{value:"none"===e,onChange:r},"Hidden"))},_s=()=>{const e=ws(Ec);return i.createElement(Ts,null,i.createElement(Vs,{content:i.createElement($s,null)},"Element Names"),i.createElement(Js,null),i.createElement(Ds,{onClick:e},"Reset View"))},Xs=Eo((e=>e.lastTickProcessingTimeMs)),Ys="icon--3Vly6",Qs=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(Ys,e.className)}),i.createElement("path",{d:"M3,0 L13,8 L3,16 z"})),el=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(Ys,e.className)}),i.createElement("path",{d:"M1,1 L15,1 L15,15 L1,15 z"})),tl=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(Ys,e.className)}),i.createElement("path",{d:"M2.5,1 L6.5,1 L6.5,15 L2.5,15 z M9.5,1 L13.5,1 L13.5,15 L9.5,15 z"})),nl=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(Ys,e.className)}),i.createElement("path",{d:"M3,0 L13,8 L3,16 z M11,1 l2,0 l0,14 l-2,0 z"})),il="button--2N_ol",rl=()=>{const e=ps(ac),t=ps(uc),n=ps(Xs),r=Ps(qo),o=Ps(tc),c=Ps(lc,"toggle"),s=Ps(_o),l=i.useCallback((e=>{e.preventDefault()}),[]);return i.createElement("span",null,e&&i.createElement("span",{className:"simrate--NKBi_"},n.toFixed(2)," ms"),e?i.createElement(el,{id:"simctrl-stop",className:P(il,"button-stop--1dD4-"),onClick:o,onMouseDown:l}):i.createElement(Qs,{id:"simctrl-run",className:P(il,"button-play--1vWfq"),onClick:r,onMouseDown:l}),i.createElement(nl,{id:"simctrl-step",className:P(il,"button-step--3Fat5"),onClick:s,onMouseDown:l}),i.createElement(tl,{id:"simctrl-pause",className:P(il,"button-pause--1UoHJ",!e&&"button--disabled--3caLv",t&&"selected--Ev2q8"),onClick:c,onMouseDown:l}))},ol=({className:e})=>{const t=`${ps(Yc)}${ps(Qc)?"*":""}`;return i.createElement(fs,{className:e,title:t},i.createElement(xs,{content:i.createElement(Rs,null),placement:"bottom-start"},i.createElement(js,{variant:"menu"},"File")),i.createElement(xs,{content:i.createElement(Ks,null),placement:"bottom-start"},i.createElement(js,{variant:"menu"},"Edit")),i.createElement(xs,{content:i.createElement(_s,null),placement:"bottom-start"},i.createElement(js,{variant:"menu"},"View")),i.createElement("div",{className:"project-titlebar-controls--1c1Qn"},i.createElement(rl,null)))};var cl=n(3274);const sl=({circuitId:e,circuitNodeIdPath:t})=>{const n=(0,c.I0)(),r=ps((e=>Tn(e,p))),o=ps((t=>Tn(t,e))),s=i.useCallback((e=>{e.preventDefault(),n(wi(p,[]))}),[n]);return i.createElement(js,{size:"small",onClick:s},0===t.length?o:r)},ll=({circuitNodeIdPath:e})=>{const t=(0,c.I0)(),n=Dt()(e),r=ps((e=>un(e,n))),o=ps((e=>mn(e,n))),s=r?Mn(r):null,l=ps((e=>s?Tn(e,s):null)),a=i.useCallback((n=>{n.preventDefault(),s&&t(wi(s,e))}),[s,e,t]);return i.createElement(js,{size:"small",onClick:a},o," [",l,"]")},al=({circuitId:e,circuitNodeIdPath:t})=>{const n=t.map(((e,n)=>{const r=t.slice(0,n+1);return i.createElement(i.Fragment,{key:e},i.createElement("span",null,">"),i.createElement(ll,{circuitNodeIdPath:r}))}));return i.createElement("div",{className:P("circuit-node-breadcrumb","circuit-node-breadcrumb--3Rx3N")},i.createElement(sl,{circuitId:e,circuitNodeIdPath:t}),n)},dl=Object.freeze({p1:{x:-100,y:-100},p2:{x:100,y:100}}),ul=(0,en.P1)(yo,tr,((e,t)=>[...Ri()(e),...Ri()(t).map((e=>({p1:e,p2:e})))].reduce(h.G0,dl))),pl=({x:e,y:t,open:n,onRequestClose:r,children:o})=>{const c=i.useMemo((()=>({getBoundingClientRect:()=>({left:e,top:t,right:e,bottom:t,width:0,height:0,x:e,y:t})})),[e,t]);return i.createElement(Ns,{value:r},i.createElement(Es,{isOpen:n,onRequestClose:r,anchorEl:c,placement:"bottom-start"},o))};function ml(){const[e,t]=i.useState(null),n=i.useCallback((e=>{t({x:e.pageX,y:e.pageY})}),[]),r=i.useCallback((()=>{t(null)}),[]);return{openContextMenu:n,renderContextMenu:i.useCallback((t=>e?i.createElement(pl,{open:!0,onRequestClose:r,x:e.x,y:e.y},t):null),[e,r])}}const yl=()=>{const e=(0,c.I0)(),t=i.useCallback((()=>{e({type:Ge})}),[e]),n=i.useCallback((()=>{e($e())}),[e]);return i.createElement(i.Fragment,null,i.createElement(Ds,{onClick:t},"Align Selection To Grid"),i.createElement(Js,null),i.createElement(Ds,{onClick:n},"Delete Selected"))},fl=()=>i.createElement(Ts,null,i.createElement(yl,null)),gl="@node/new",Il=e=>({type:gl,payload:{nodeType:e}});function hl(e){return e.type===gl}const bl=i.createContext({zoomFactor:1,zoom:()=>{}});function vl(){return i.useContext(bl)}const El=({children:e})=>{const[t,n]=i.useState(1),r=i.useCallback((e=>{n((t=>e>0?t*e*1.03:t/(1.03*-e)))}),[]),o=i.useMemo((()=>({zoomFactor:t,zoom:r})),[r,t]);return i.createElement(bl.Provider,{value:o},e)},kl={current:null},Ol=i.createContext({svgRef:kl,scalerRef:kl}),Nl=Ol.Provider,xl=({svgRef:e,scalerRef:t,children:n})=>{const r=i.useMemo((()=>({svgRef:e,scalerRef:t})),[e,t]);return i.createElement(Nl,{value:r},n)},Cl=i.createContext({editorId:"~none",circuitId:"~none",circuitNodeIdPath:[]});function jl(){return i.useContext(Cl)}const wl=({editorId:e,children:t})=>{const n=ps((t=>Pt(t,e))),{circuitId:r,circuitNodeIdPath:o}=null!=n?n:{circuitId:"~none",circuitNodeIdPath:[]},c=i.useMemo((()=>({editorId:e,circuitId:r,circuitNodeIdPath:o})),[r,o,e]);return n?i.createElement(Cl.Provider,{value:c},t):null};function Pl(e,t,n){const i=t.getScreenCTM();if(!i)return n;const r=e.createSVGPoint();r.x=n.x,r.y=n.y;const o=r.matrixTransform(i.inverse());return{x:o.x,y:o.y}}function Bl(){const{svgRef:e,scalerRef:t}=i.useContext(Ol);return i.useCallback((n=>e.current&&t.current?Pl(e.current,t.current,n):n),[e,t])}const Ml="text-unselectable--2tvXe",Sl=(e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=zo(e),i=e.services.simulator.nodeOutputValuesByNodeId,r=Co(n,t);if(r)return i[r]},zl="node-interaction-toggle--1eXWD",Ll={"integrated-circuit":({circuitNodeId:e,circuitNodePath:t,circuitId:n,inputPinIds:r,outputPinIds:o})=>{const s=(0,c.I0)(),l=ps((e=>Tn(e,n))),a=ps(pn),d=Sn(r.length,o.length),u=i.useCallback((i=>{e&&(i.defaultPrevented||(i.preventDefault(),s(wi(n,[...t||[],e]))))}),[e,s,n,t]),p=r.map(((e,t)=>{const n=50*t+25;return i.createElement("g",{key:e},i.createElement("line",{className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:4,y1:n,x2:10,y2:n}),i.createElement("text",{className:Ml,x:15,y:n,alignmentBaseline:"middle",fontSize:".7em"},a[e]))})),m=o.map(((e,t)=>{const n=50*t+25;return i.createElement("g",{key:e},i.createElement("line",{key:t,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:90,y1:n,x2:100,y2:n}),i.createElement("text",{className:Ml,x:85,y:n,textAnchor:"end",alignmentBaseline:"middle",fontSize:".7em"},a[e]))}));return i.createElement("g",null,i.createElement("text",{className:P(Ml,"node-select-highlight--fill"),textAnchor:"middle",x:50,y:0},l),i.createElement("path",{className:"node-select-highlight--stroke node-select-highlight--fill",stroke:"black",fill:"transparent",d,onDoubleClick:u}),p,m)},"interaction-momentary":({circuitNodeId:e,circuitNodePath:t})=>{const n=(0,c.I0)(),r=ps(ac),o=i.useMemo((()=>[...t||[],null!=e?e:"~~none"]),[t,e]),s=ps((e=>Sl(e,o))),l=i.useCallback((e=>{r&&(e.defaultPrevented||(e.preventDefault(),n((0,xo.zN)(o,!0))))}),[o,n,r]),a=i.useCallback((()=>{r&&n((0,xo.zN)(o,!1))}),[o,n,r]);let d="darkgreen",u="lightgrey";return s&&s.OUT&&(d="lightgreen",u="black"),i.createElement("g",{onMouseDown:l,onMouseUp:a,onMouseLeave:a,className:zl},i.createElement("rect",{className:"node-select-highlight--stroke node-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),i.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),i.createElement("circle",{cx:25,cy:25,r:17,fill:d}),i.createElement("text",{className:Ml,x:25,y:25,fontSize:".8em",fill:u,textAnchor:"middle",alignmentBaseline:"middle"},"Push"))},"interaction-toggle":({circuitNodeId:e,circuitNodePath:t,elementState:n})=>{const r=(0,c.I0)(),o=i.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),r((0,xo.zN)([...t||[],e]))))}),[e,r,t]);let s="darkgreen",l="lightgrey",a="darkred";if(n){const{toggleState:e}=n;e?(s="lightgreen",l="black"):a="red"}return i.createElement("g",{onClick:o,className:zl},i.createElement("rect",{className:"node-select-highlight--stroke node-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),i.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),i.createElement("rect",{x:10,y:10,width:30,height:15,strokeWidth:0,fill:s}),i.createElement("text",{className:Ml,x:25,y:19,fontSize:".8em",fill:l,textAnchor:"middle",alignmentBaseline:"middle"},"On"),i.createElement("rect",{x:10,y:25,width:30,height:15,strokeWidth:0,fill:a}),i.createElement("text",{className:Ml,x:25,y:34,fontSize:".8em",fill:"lightgrey",textAnchor:"middle",alignmentBaseline:"middle"},"Off"))}},Tl=({componentName:e})=>i.createElement("g",null,i.createElement("rect",{width:50,height:50,fill:"red"}),i.createElement("text",{x:25,y:25,alignmentBaseline:"middle"},e));function Dl(e,t,n,r){const{component:o,componentProps:c}=r,s=Object.assign({circuitNodeId:e,circuitNodePath:t,elementState:n},c);let l;return"string"==typeof o?(l=Ll[o],l||(l=()=>i.createElement(Tl,{componentName:o}))):l=o,i.createElement(l,Object.assign({},s))}const Jl=Object.freeze({}),Rl=i.memo((function({className:e,circuitNodeId:t,x:n=0,y:r=0,nodeType:o}){const c=ps((e=>Fn(e,o)));let s;s=c?Dl(t,[],Jl,c.visual):i.createElement("rect",{x:n,y:r,width:50,height:50,fill:"red"});const l=0!=n||0!=r?`translate(${n}, ${r})`:void 0;return i.createElement("g",{className:P(e,"node-visual"),transform:l},s)})),Wl=i.memo((function(){const e=(0,c.I0)(),{circuitId:t}=jl(),n=ps(_n),r=Bl(),[o,s]=i.useState(null),[l,a]=i.useState(null),d=ps((e=>Jn(e,Mn(o),t))),[,u]=(0,de.L)({accept:gl,collect:e=>{e.isOver()||(a(null),s(null))},hover:(e,t)=>{if(!hl(e))return a(null),void s(null);const n=t.getClientOffset();if(!n)return;const i=r({x:n.x,y:n.y});s(e.payload.nodeType),a(i)},drop:(i,o)=>{if(!hl(i))return;if(d)return;const c=o.getClientOffset();if(!c)return;const s=r({x:c.x,y:c.y});e(Ue(i.payload.nodeType,t,(0,h.R9)(s,n)))}},[t,r,n,d]),p=l&&(0,h.R9)(l,n);return i.createElement("g",{id:"drag-new-node-layer"},!d&&p&&o&&i.createElement("g",{opacity:.5},i.createElement(Rl,{x:p.x,y:p.y,nodeType:o})),d&&i.createElement("g",null,i.createElement("rect",{width:"100%",height:"100%",opacity:.7,fill:"black"}),i.createElement("text",{x:"100",y:"25%",fill:"white"},"The current circuit is already inside the dragged IC.")),i.createElement("rect",{ref:u,width:"100%",height:"100%",fill:"transparent"}))})),Al=Ft((e=>e.dragMode)),Ul=Ft(((e,t)=>null!=e.dragMode&&e.dragStartEditorId===e.dragEndEditorId&&e.dragStartEditorId===t)),Zl=Ft((e=>null!=e.dragMode)),Fl=Ft((e=>e.dragMode?e.dragStart:null)),Kl=Ft((e=>e.dragMode?e.dragEnd:null)),Hl=Ft((0,en.P1)(Al.local,Fl.local,Kl.local,((e,t,n)=>"select"===e&&t&&n?(0,h.Qu)(t,n):null)));let ql=null;const Gl=e=>{const t=e.services.circuitEditorDrag;if("move"!==t.dragMode)return null;let n;n=oi(e).length>0?_n(e):Xn(e);const{dragStart:i,dragEnd:r,dragModifierKeys:o}=t;if(!r)return null;const c=(0,h.sj)(r,i);return o.ctrlMetaKey||(c.x=Math.round(c.x/n)*n,c.y=Math.round(c.y/n)*n),ql&&(0,h.kg)(c,ql)||(ql=c),ql},Vl=Ft((e=>{const t=Xn.local(e);if("new-joint"!==e.dragMode)return null;const{dragEnd:n,dragModifierKeys:i}=e;if(!n||!i)return null;const r=Object.assign({},n);return i.ctrlMetaKey||(r.x=Math.round(r.x/t)*t,r.y=Math.round(r.y/t)*t),r})),$l=e=>{const t=e.services.circuitEditorDrag;if("wire"!==t.dragMode)return null;const{dragEnd:n,dragStartEditorId:i}=t;if(!n)return null;const r=Bt(e,i);return r?$n(e,n,r):null},_l=(0,en.P1)(oi,wn,((e,t)=>kt()(t,e))),Xl=(0,en.P1)(oi,ln,((e,t)=>kt()(t,e))),Yl=i.memo((function(){const{editorId:e}=jl(),t=ps((t=>Ul(t,e))),n=ps(_l),r=ps(Xl),o=ps(Gl);if(!t||!o)return null;let c=null;return o&&(c=Ri()(nn()(n,((e,t)=>i.createElement(Rl,{key:t,nodeType:r[t],x:e.x+o.x,y:e.y+o.y}))))),i.createElement("g",{id:"drag-node-preview-layer",opacity:.3},c)}));const Ql=e=>{var{x:t,y:n,interactable:r=!0,selected:o=!1}=e,c=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["x","y","interactable","selected"]);const[s,l]=i.useState(!1),a=i.useCallback((()=>{r&&l(!0)}),[r]),d=i.useCallback((()=>{l(!1)}),[]);return i.createElement("circle",Object.assign({className:P("wire-joint--3o_SE",o&&"selected--33Nsw"),cx:t,cy:n,r:r&&s||o?4:2,onMouseOver:a,onMouseOut:d},c))},ea=(0,en.P1)(li,tr,((e,t)=>kt()(t,e))),ta=i.memo((function(){const{editorId:e}=jl(),t=ps((t=>Ul(t,e))),n=ps(Gl),r=ps(ea),o=ps(Vl);if(!t||!n&&!o)return null;let c=null;n&&(c=Ri()(r).map(((e,t)=>i.createElement(Ql,{key:t,interactable:!1,x:e.x+n.x,y:e.y+n.y,opacity:.5}))));let s=null;return o&&(s=i.createElement(Ql,{interactable:!1,x:o.x,y:o.y,opacity:.5})),i.createElement("g",{id:"drag-joint-preview-layer",opacity:.3},c,s)}));function na({dragThreshold:e=5,onClick:t,onDragStart:n}){const[r,o]=i.useState(!1),c=i.useRef(null),s=i.useCallback((e=>{e.preventDefault&&(o(!0),c.current={x:e.pageX,y:e.pageY})}),[]),l=i.useCallback((t=>{if(!c.current)return;const i=c.current;(Math.abs(i.x-t.pageX)>=e||Math.abs(i.y-t.pageY)>=e)&&(n&&n(t,c.current),o(!1),c.current=null)}),[e,n]),a=i.useCallback((e=>{c.current&&(t&&t(e),o(!1),c.current=null)}),[t]);return i.useEffect((()=>{if(r)return document.addEventListener("mousemove",l),document.addEventListener("mouseup",a),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)}}),[r,l,a]),{startTracking:s}}function ia(e){const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:r}=e;return{ctrlMetaKey:As?r:t,altKey:n,shiftKey:i}}Object.freeze({});const ra=i.memo((function(){const e=(0,c.I0)(),{editorId:t}=jl(),{zoomFactor:n}=vl(),r=ps((e=>Ul(e,t))),o=ps(Hl);function s(e){return e*(1/n)}const l=Bl(),a=i.useCallback((t=>{if(0!==t.button)return;const n=ia(t);n.ctrlMetaKey||n.shiftKey||e({type:so})}),[e]),d=i.useCallback(((n,i)=>{const r=l(i),o=ia(n);e(((e,t,n)=>({type:hi,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(r,o,t))}),[e,t,l]),{startTracking:u}=na({onClick:a,onDragStart:d});return i.createElement("g",null,i.createElement("rect",{width:100*s(1)+"%",height:100*s(1)+"%",fill:"transparent",onMouseDown:u}),r&&o&&i.createElement("g",{transform:`translate(${o.p1.x}, ${o.p1.y})`},i.createElement("rect",{width:o.p2.x-o.p1.x,height:o.p2.y-o.p1.y,strokeWidth:s(2),strokeDasharray:`${s(5)} ${s(3)}`,stroke:"skyblue",fill:"transparent"})))})),oa=i.memo((function(){const[e]=i.useState("grid-"+(0,Le.Z)()),{zoomFactor:t}=vl(),n=50*t;return i.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},i.createElement("defs",null,i.createElement("pattern",{id:e,width:n,height:n,patternUnits:"userSpaceOnUse"},i.createElement("path",{d:`M ${n} 0 L 0 0 0 ${n}`,fill:"none",stroke:"gray",strokeWidth:.5}))),i.createElement("rect",{width:"100%",height:"100%",fill:`url(#${e})`}))})),ca=i.forwardRef((({className:e,autoFocus:t,defaultValue:n,value:r,onChange:o,onBeginEdit:c,onCommit:s,onCancel:l,onBlur:a,onKeyUp:d},u)=>{const[p,m]=i.useState(null),y=i.useCallback((e=>{null==p&&c&&c(),m(e.target.value),o&&o(e)}),[p,c,o]),f=i.useCallback((e=>{d&&d(e),e.defaultPrevented||null!=p&&("Escape"===e.key?(e.preventDefault(),l&&l()):"Enter"===e.key&&(e.preventDefault(),s&&s(p)))}),[d,p,l,s]),g=i.useCallback((e=>{a&&a(e),null!=p&&s&&s(p)}),[a,p,s]);return i.createElement("input",{ref:u,className:e,autoFocus:t,defaultValue:n,value:r,type:"text",onChange:y,onKeyUp:f,onBlur:g})})),sa=({className:e,textClassname:t,inputClassname:n,label:r,defaultValue:o,isEditing:c,onRequestEdit:s,onCommit:l,onCancel:a})=>{const d=i.useRef(null),u=i.useCallback((e=>{s&&(e.defaultPrevented||(e.preventDefault(),s()))}),[s]),p=i.useCallback((e=>{"Escape"===e.key&&c&&a()}),[c,a]),m=i.useCallback((()=>{c&&a()}),[c,a]);return i.useEffect((()=>{c&&d.current&&d.current.select()}),[c]),c?i.createElement(ca,{ref:d,className:P(e,n),autoFocus:!0,defaultValue:o,onBlur:m,onKeyUp:p,onCommit:l,onCancel:a}):i.createElement("span",{className:P(e,t),onDoubleClick:u},null!=r?r:o)},la=e=>{const{onRequestEdit:t,onCommit:n}=e,r=Os(),o=i.useCallback((()=>{t&&t()}),[t]),c=i.useCallback((e=>{n(e),r()}),[n,r]);return i.createElement("li",{className:Bs,onClick:o},i.createElement(sa,Object.assign({},e,{onCommit:c})))},aa=({nodeId:e})=>{const t=(0,c.I0)(),{circuitNodeIdPath:n}=jl(),r=ps((t=>mn(t,e))),o=ps((t=>un(t,e))),s=o?Mn(o):null,[l,a]=i.useState(!1),d=i.useCallback((()=>{a(!0)}),[]),u=i.useCallback((()=>{a(!1)}),[]),p=i.useCallback((n=>{a(!1),t(((e,t)=>({type:qe,payload:{nodeId:e,nodeName:t}}))(e,n))}),[t,e]),m=i.useCallback((()=>{s&&t(wi(s,[...n,e],{newWindow:!0}))}),[n,t,s,e]);return i.createElement(Ts,null,i.createElement(la,{defaultValue:null!=r?r:"<unknown>",label:i.createElement("span",{style:{fontWeight:"bold"}},r),isEditing:l,onRequestEdit:d,onCommit:p,onCancel:u}),i.createElement(Js,null),s&&i.createElement(i.Fragment,null,i.createElement(Ds,{onClick:m},"Open in New Window"),i.createElement(Js,null)),i.createElement(yl,null))},da=i.memo((function({nodeId:e}){const t=(0,c.I0)(),{editorId:n,circuitNodeIdPath:r}=jl(),o=ps(ac),{openContextMenu:s,renderContextMenu:l}=ml(),a=ps((t=>$i(t,e))),{x:d,y:u}=ps((t=>Pn(t,e))),p=ps((t=>((e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=zo(e),i=e.services.simulator.nodeStatesByNodeId,r=Co(n,t);if(r)return i[r]})(t,[...r,e]))),m=ps((t=>ci(t,e))),y=Bl(),f=i.useCallback((n=>{if(o)return;if(n.defaultPrevented)return;if(0!==n.button)return;n.preventDefault();const i=Xt(ia(n));t(Ii(e,i))}),[t,o,e]),g=i.useCallback((n=>{if(n.defaultPrevented)return;n.preventDefault();const i=Xt(ia(n),"set-if-unselected");t(Ii(e,i)),s(n)}),[t,e,s]),I=i.useCallback(((i,r)=>{const o=y(r),c=ia(i);t(((e,t,n,i)=>({type:fi,payload:Object.assign(Object.assign({},t),{nodeId:e,modifierKeys:n,editorId:i})}))(e,o,c,n))}),[y,t,e,n]),{startTracking:b}=na({onClick:f,onDragStart:I}),v=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),o||0===e.button&&b(e))}),[o,b]);let E,k;if(a){const{hitRect:t}=a.visual;E=Dl(e,r,p,a.visual),k=t}else E=i.createElement("rect",{x:d,y:u,width:50,height:50,fill:m?"goldenrod":"red"}),k={p1:h.Ds,p2:{x:50,y:50}};const O=0!=d||0!=u?`translate(${d}, ${u})`:void 0;return i.createElement("g",{transform:O},i.createElement("g",{className:P("circuit-field-node",m&&"node-selected"),onMouseDown:v,onContextMenu:g},E),i.createElement(ua,{nodeId:e,hitRect:k}),l(i.createElement(aa,{nodeId:e})))})),ua=i.memo((function({nodeId:e,hitRect:t}){const{zoomFactor:n}=vl(),r=ps((t=>((e,t)=>{switch(e.services.uiSettings.nodeNameMode){case"all":default:return mn(e,t);case"named-only":return yn(e,t);case"none":return null}})(t,e))),o=Math.max(.7,n);let c=15;return o>1?c-=2*o:c+=1/o*7,r?i.createElement("text",{fontSize:1.2/o+"em",className:Ml,textAnchor:"middle",x:t.p1.x+(t.p2.x-t.p1.x)/2,y:t.p2.y+c},r):null})),pa=da,ma=i.memo((function(){const{circuitId:e}=jl(),t=ps((t=>Nn(t,e))).map((e=>i.createElement(pa,{key:e,nodeId:e})));return i.createElement("g",null,t)})),ya=(e,t,n)=>{const i=Fi(e,n);if(!i)return!1;const{outputPin:{nodeId:r,pinId:o}}=i,c=un(e,r);if("pin-input"===c){const n=t.slice(0,t.length-1),i={nodeId:t[t.length-1],pinId:r},o=Hi(e,i);return!!o&&ya(e,n,o)}if(null==c?void 0:c.startsWith("ic-")){const n=[...t,r],i=Hi(e,{nodeId:o,pinId:"IN"});return!!i&&ya(e,n,i)}{const n=Sl(e,[...t,r]);return n&&n[o]||!1}},fa=i.memo((function({connectionId:e,startJointId:t,endJointId:n}){const{editorId:r}=jl(),o=(0,c.I0)(),s=Bl(),l=ps(ac),a=ps(Zl),d=ps((n=>null==t?((e,t)=>{const{outputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],r=$i(e,n);if(!r)return h.Ds;const o=Pn(e,n),c=_i[t];if(c&&c.inputNodeDef===r&&c.inputNodePosition.x===o.x&&c.inputNodePosition.y===o.y)return c.outputPosition;let s=h.Ds;r&&r.pins[i]&&(s=r.pins[i]);const l=(0,h.ZO)(o,s);return _i[t]={inputNodeDef:r,inputNodePosition:o,outputPosition:l},l})(n,e):er(n,t))),u=ps((t=>null==n?((e,t)=>{const{inputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],r=$i(e,n);if(!r)return h.Ds;const o=Pn(e,n),c=Xi[t];if(c&&c.inputNodeDef===r&&c.inputNodePosition.x===o.x&&c.inputNodePosition.y===o.y)return c.outputPosition;let s=h.Ds;r&&r.pins[i]&&(s=r.pins[i]);const l=(0,h.ZO)(o,s);return Xi[t]={inputNodeDef:r,inputNodePosition:o,outputPosition:l},l})(t,e):er(t,n))),[p,m]=i.useState(null),y=i.useCallback((e=>{const t=s({x:e.pageX,y:e.pageY});m(t)}),[s]),f=i.useCallback((()=>{m(null)}),[]),g=i.useCallback(((n,i)=>{const c=s(i),l=ia(n);o(((e,t,n,i,r)=>({type:mi,payload:Object.assign(Object.assign({},n),{connectionId:e,addAfterJointId:t,modifierKeys:i,editorId:r})}))(e,t,c,l,r))}),[s,o,e,t,r]),I=i.useCallback((t=>{const n=Xt(ia(t));o(((e,t="set")=>({type:go,payload:{connectionIds:Array.isArray(e)?e:[e],mode:t}}))(e,n))}),[e,o]),{startTracking:b}=na({onClick:I,onDragStart:g}),v=i.useCallback((e=>{e.preventDefault(),l||b(e)}),[l,b]);let E;if(!a&&!l&&p){const e=(0,h.Fv)((0,h.sj)(u,d)),t=(0,h.sj)(p,d),n=(0,h.Ih)(t,e);E=(0,h.ZO)(d,(0,h.bA)(e,n))}return i.createElement("g",{onMouseMove:y,onMouseLeave:f},i.createElement("line",{x1:d.x,y1:d.y,x2:u.x,y2:u.y,strokeWidth:2}),null==n&&i.createElement("circle",{cx:u.x,cy:u.y,r:1.5}),E&&i.createElement("circle",{cx:E.x,cy:E.y,r:3,stroke:"none",fill:"red",onMouseDown:v}))})),ga=i.memo((function({jointId:e}){const{editorId:t}=jl(),n=Bl(),r=(0,c.I0)(),o=ps(ac),s=ps((t=>ai(t,e))),l=ps((t=>er(t,e))),a=i.useCallback(((i,o)=>{const c=n(o),s=ia(i);r(((e,t,n,i)=>({type:ei,payload:Object.assign(Object.assign({},t),{jointId:e,modifierKeys:n,editorId:i})}))(e,c,s,t))}),[r,t,n,e]),d=i.useCallback((t=>{const n=Xt(ia(t));r(ni(e,n))}),[r,e]),{startTracking:u}=na({onClick:d,onDragStart:a}),p=i.useCallback((e=>{o||e.defaultPrevented||(e.preventDefault(),u(e))}),[o,u]);return i.createElement(Ql,{interactable:!o,selected:s,x:l.x,y:l.y,onMouseDown:p})})),Ia=i.memo((function({connectionId:e}){const{circuitNodeIdPath:t}=jl(),n=ps((t=>Qi(t,e))),r=ps((n=>ya(n,t,e))),o=ps((t=>si(t,e))),c=[...n,null].map(((t,r)=>{const o=r>0?n[r-1]:null;return i.createElement(fa,{key:r,connectionId:e,startJointId:o,endJointId:t})})),s=n.map((e=>i.createElement(ga,{key:e,jointId:e})));return i.createElement("g",{className:P("wire--2lJT9",r&&"powered--3tsJ_",o&&"selected--Dkrv_")},c,s)})),ha=i.memo((function(){const{circuitId:e}=jl(),t=ps((t=>ui(t,e))).map((e=>i.createElement(Ia,{key:e,connectionId:e})));return i.createElement("g",null,t)}));var ba=n(784);const va="highlight--30Hqg",Ea="is-drag-target--1kAL8",ka=i.memo((function({nodeId:e,pinId:t}){const{editorId:n}=jl(),r=Bl(),[o,s]=i.useState(!1),l=(0,c.I0)(),a=ps((n=>((e,t,n)=>{var i;const r=Gn(e)[t];return r&&null!==(i=r[n])&&void 0!==i?i:h.Ds})(n,e,t))),d=ps((n=>((e,t,n)=>{const i=$i(e,t);if(!i)return null;const r=i.pins[n];return r?r.direction:null})(n,e,t))),u=ps($l),p=i.useCallback(((i,o)=>{const c=r(o);l(((e,t,n)=>({type:vi,payload:Object.assign(Object.assign({},e),{pin:t,editorId:n})}))(c,{nodeId:e,pinId:t},n))}),[l,n,r,e,t]),{startTracking:m}=na({onDragStart:p}),y=i.useCallback((e=>{0===e.button&&(e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),m(e)))}),[m]),f=i.useCallback((()=>{s(!0)}),[]),g=i.useCallback((()=>{s(!1)}),[]);if(!a)return null;const I=null!=u&&u.nodeId===e&&u.pinId===t,{x:b,y:v}=a;let E;return E="input"===d?i.createElement("path",{d:(0,ba.x)(b,v,4,-45,225),strokeWidth:2,className:P("node-pin-input--3iuKH",I&&Ea,o&&va)}):i.createElement("circle",{className:P("node-pin-output--WumfM",I&&Ea,o&&va),cx:b,cy:v,r:3}),i.createElement("g",{onMouseEnter:f,onMouseLeave:g},E,i.createElement("circle",{stroke:"none",fill:"transparent",cx:b,cy:v,r:5,onMouseDown:y}))})),Oa=i.memo((function({nodeId:e}){var t;const n=ps((t=>$i(t,e))),r=null!==(t=null==n?void 0:n.pins)&&void 0!==t?t:{},o=Object.keys(r).map((t=>i.createElement(ka,{key:t,nodeId:e,pinId:t})));return i.createElement(i.Fragment,null,o)})),Na=i.memo((function(){const{circuitId:e}=jl(),t=ps((t=>Nn(t,e))).map((e=>i.createElement(Oa,{key:e,nodeId:e})));return i.createElement("g",null,t)})),xa=i.memo((function(){const{editorId:e}=jl(),t=ps((t=>Ul(t,e))),n=ps(Al),r=ps(Fl),o=ps(Kl);return t&&"wire"==n&&r&&o?i.createElement("line",{x1:r.x,y1:r.y,x2:o.x,y2:o.y,stroke:"black",strokeWidth:1}):null})),Ca=()=>{const e=(0,c.I0)(),{editorId:t}=jl(),n=ps(Zl),r=function(){const{svgRef:e,scalerRef:t}=i.useContext(Ol);return i.useCallback((n=>{if(!e.current||!t.current)return h.Ds;const i={x:n.pageX,y:n.pageY};return Pl(e.current,t.current,i)}),[e,t])}(),o=i.useCallback((n=>{if(0===n.buttons)return void e(Ut());const i=r(n),o=ia(n);e(((e,t,n)=>({type:Ht,payload:{dragPos:e,modifierKeys:t,editorId:n}}))(i,o,t))}),[e,t,r]),s=i.useCallback((n=>{const i=r(n),o=ia(n);e(((e,t,n)=>({type:st,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(i,o,t))}),[e,t,r]);return n?i.createElement("rect",{width:"100%",height:"100%",fill:"transparent",onMouseMove:o,onMouseUp:s}):null},ja=({width:e,height:t,onContextMenu:n})=>{const r=(0,c.I0)(),{zoomFactor:o}=vl(),s=i.useRef(null),l=i.useRef(null),a=i.useCallback((()=>{var e;null===(e=s.current)||void 0===e||e.focus()}),[]),d=i.useCallback((()=>{r({type:ki})}),[r]),u=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),n(e))}),[n]),[{isDraggingNewNode:p},m]=(0,de.L)({accept:gl,collect:e=>({isDraggingNewNode:e.isOver()})});return i.createElement("svg",{tabIndex:-1,ref:e=>{s.current=e,m(e)},width:e,height:t,onMouseDown:a,onMouseLeave:d,onContextMenu:u,className:"circuit-field-svg--o7YIn"},i.createElement(oa,null),i.createElement("g",{ref:l,"transform-origin":"0 0",transform:`scale(${o})`},i.createElement(xl,{svgRef:s,scalerRef:l},i.createElement(ra,null),i.createElement(ma,null),i.createElement(ha,null),i.createElement(Na,null),i.createElement(xa,null),i.createElement(Yl,null),i.createElement(ta,null),p&&i.createElement(Wl,null),i.createElement(Ca,null))))},wa=({onContextMenu:e})=>{const t=i.useRef(null),{width:n,height:r}=ae(t),{zoomFactor:o,zoom:c}=vl(),s=ps(ul),{width:l,height:a}=(0,h.nF)(s),d=Math.max(n,l*o),u=Math.max(r,a*o);return ms(t,"wheel",i.useCallback((e=>{e.defaultPrevented||e.ctrlKey&&(c(e.deltaY>0?-1:1),e.preventDefault(),e.stopPropagation())}),[c]),{passive:!1}),i.createElement("div",{ref:t,style:{width:"100%",height:"100%"}},i.createElement(ja,{width:d,height:u,onContextMenu:e}))},Pa=({className:e,editorId:t})=>{const n=ps(ac),{openContextMenu:r,renderContextMenu:o}=ml();return i.createElement(wl,{editorId:t},i.createElement("div",{id:"circuit-editor-"+t,className:P("circuit-editor","circuit-editor--2jFUa",n&&"simulator-active",e)},i.createElement("div",{className:"circuit-editor-scrollarea--12k0x"},i.createElement(El,null,i.createElement(wa,{onContextMenu:r}))),o(i.createElement(fl,null))))};var Ba=n(1474);const Ma=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(Ys,e.className)}),i.createElement("path",{d:"M4,4 L12,12 M4,12 L12,4"})),Sa=({title:e,className:t,children:n})=>{const r=X(),{closeWindow:o}=te(),c=i.useCallback((()=>{o(r)}),[o,r]),[,s]=(0,Ba.c)({item:pe(r)});return i.createElement(ye,{className:G["tessel-window"]},i.createElement("div",{ref:s,className:G["tessel-window-titlebar"]},i.createElement("div",{className:G["tessel-window-title"]},e),i.createElement("div",{className:G["tessel-window-controls"]},i.createElement(Ma,{className:G["tessel-window-controls-close"],onClick:c}))),i.createElement("div",{className:P(G["tessel-window-content"],t)},n))},za="keymap:CircuitEditor/SimStep",La="keymap:CircuitEditor/SelectAll",Ta="keymap:CircuitEditor/Copy",Da="keymap:CircuitEditor/Paste",Ja="keymap:CircuitEditor/Delete",Ra="keymap:CircuitEditor/Undo",Wa="keymap:CircuitEditor/Redo",Aa={[za]:"space",[La]:Us+"+a",[Ta]:Us+"+c",[Da]:Us+"+v",[Ja]:["backspace","del"],[Ra]:Us+"+z",[Wa]:[Us+"+y",Us+"+shift+z"]};const Ua=e=>{var{children:t}=e,n=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["children"]);return i.createElement("div",Object.assign({},n,{className:L}),t)},Za=({value:e,label:t,isSelected:n,onItemSelected:r})=>{const o=i.useCallback((t=>{t.defaultPrevented||(t.preventDefault(),r(e))}),[r,e]);return i.createElement("li",{className:P("selection-list-item","selection-list-item--errDr",n&&"selection-list-item--selected--3MkqB"),onClick:o},i.createElement("div",{className:P("selection-list-item-content--321YU",Ml)},t))},Fa=({className:e,items:t,onItemSelected:n})=>i.createElement("ul",{className:P("selection-list","selection-list--3yujH",e)},t.map((e=>i.createElement(Za,Object.assign({key:e.value},e,{onItemSelected:n}))))),Ka=({circuitId:e})=>{const t=(0,c.I0)(),n=ps((t=>Tn(t,e))),[r,o]=i.useState(!1),{openContextMenu:s,renderContextMenu:l}=ml(),a=i.useCallback((()=>{e!==p&&o(!0)}),[e]),d=i.useCallback((()=>{o(!1)}),[]),u=i.useCallback((n=>{t(((e,t)=>({type:We,payload:{circuitId:e,circuitName:t}}))(e,n)),o(!1)}),[e,t]),m=i.useCallback((n=>{n.preventDefault(),t(wi(e,null,{newWindow:!0}))}),[e,t]),y=i.useCallback((n=>{n.preventDefault(),t((e=>({type:Je,payload:{circuitId:e}}))(e))}),[t,e]),f=i.useCallback((e=>{e.preventDefault(),e.stopPropagation(),s(e)}),[s]);return i.createElement("div",{style:{width:"100%"},onContextMenu:f,onDoubleClick:a},i.createElement(sa,{defaultValue:n,isEditing:r,onRequestEdit:a,onCommit:u,onCancel:d}),l(i.createElement(Ts,null,e!==p&&i.createElement(i.Fragment,null,i.createElement(Ds,{onClick:a},"Rename Circuit"),i.createElement(Js,null)),i.createElement(Ds,{onClick:m},"Open in New Window"),e!==p&&i.createElement(i.Fragment,null,i.createElement(Js,null),i.createElement(Ds,{onClick:y},"Delete Circuit")))))},Ha=()=>{const e=(0,c.I0)(),t=i.useCallback((()=>{e(De())}),[e]);return i.createElement(Ts,null,i.createElement(Ds,{onClick:t},"New Circuit"))},qa=({isOpen:e,anchorEl:t,placement:n="auto",children:o})=>{const[c,s]=i.useState(null),[l,a]=i.useState(null),{attributes:d,styles:u}=(0,gs.D)(e?t:null,c,{placement:n,modifiers:[{name:"arrow",options:{element:l}},{name:"offset",options:{offset:[0,8]}}]});return e?(0,r.createPortal)(i.createElement("div",Object.assign({ref:s,className:"tooltip--2yxRI",style:u.popper,role:"tooltip"},d.popper),o,i.createElement("div",Object.assign({ref:a,"data-popper-arrow":!0,className:"tooltip-arrow--2mJMo",style:u.arrow},d.arrow))),document.body):null},Ga={"input-output":"I/O","integrated-circuit":"Integrated Circuits",logic:"Logic"},Va=({category:e})=>{const t=ps(Un).filter((t=>t.category===e)).filter((t=>t.category===e)).map((e=>i.createElement($a,{key:e.type,nodeType:e.type})));return i.createElement(i.Fragment,null,i.createElement("li",{className:"node-tray-category--2EvV3"},Ga[e]),t)},$a=({nodeType:e})=>{const[t,n]=i.useState(null),r=ps((t=>Fn(t,e))),[o,c]=i.useState(!1),s=i.useCallback((e=>{e.preventDefault(),c(!0)}),[]),l=i.useCallback((e=>{e.target===t&&c(!1)}),[t]),[,a]=(0,Ba.c)({item:Il(e)});let d,u=e,p="0 0 50 50";if(r){const{trayComponent:e,hitRect:t}=r.visual;if(e){const t=e;d=i.createElement(t,null)}else d=Dl(void 0,[],void 0,r.visual),p=`${t.p1.x} ${t.p1.y} ${t.p2.x} ${t.p2.y}`;u=r.displayName}else d=i.createElement(_a,null);return i.createElement("li",{ref:e=>{n(e),a(e)},className:"node-tray-item--16YJl",onClick:s,onMouseOut:l},i.createElement(qa,{placement:"top",isOpen:o,anchorEl:t},"Click and drag to create a new circuit element."),i.createElement("span",{className:"node-tray-item-preview--1SRbp"},i.createElement("svg",{width:30,height:30,viewBox:p},d)),i.createElement("span",{className:Ml},u))},_a=()=>i.createElement("rect",{fill:"red",x1:0,y1:0,x2:50,y2:50}),Xa={"node-tray":()=>{const e=ps(Un),t=Ai()(e.map((e=>e.category)));return i.createElement(Sa,{title:"Elements",className:"node-tray--3lZIP"},i.createElement("ul",{className:"node-tray-elements--1GkKn"},t.map((e=>i.createElement(Va,{key:e,category:e})))))},"circuit-field":({editorId:e})=>{var t,n;const r=(0,c.I0)(),{circuitId:o,circuitNodeIdPath:s}=null!==(t=ps((t=>Pt(t,e))))&&void 0!==t?t:{circuitId:null,circuitNodeIdPath:[]},l=null!==(n=ps((e=>Tn(e,o))))&&void 0!==n?n:"<Circuit Missing>",a=i.useMemo((()=>{function e(e){return t=>{if(t){if(t.defaultPrevented)return;t.preventDefault()}r(e)}}var t;return{[za]:e(_o()),[La]:e(oo(o)),[Ta]:e({type:ho}),[Da]:e((t=o,{type:ct,payload:{targetCircuitId:t}})),[Ja]:e($e()),[Ra]:e(at()),[Wa]:e(pt())}}),[r,o]),d=i.useCallback((()=>{r((e=>({type:xi,payload:{editorId:e}}))(e))}),[r,e]);return i.createElement(Sa,{title:l+" [Circuit]"},i.createElement(cl.HotKeys,{keyMap:Aa,handlers:a,component:Ua},i.createElement("div",{onFocus:d,className:P("circuit-field-view",L,T["flex-column"])},i.createElement(al,{circuitId:o,circuitNodeIdPath:s}),i.createElement(Pa,{className:P(L,T["flexitem-shrink"]),editorId:e}))))},"circuits-list":()=>{const e=(0,c.I0)(),t=ps(Ln),{openContextMenu:n,renderContextMenu:r}=ml(),o=i.useCallback((t=>{e(wi(t))}),[e]),s=i.useCallback((e=>{e.preventDefault(),n(e)}),[n]),l=i.useMemo((()=>Object.keys(t).map((e=>({value:e,label:i.createElement(Ka,{circuitId:e})})))),[t]);return i.createElement(Sa,{title:"Circuits",className:P("circuitstree--QeaI9")},i.createElement("div",{className:L,onContextMenu:s},i.createElement(Fa,{className:L,items:l,onItemSelected:o})),r(i.createElement(Ha,null)))}};function Ya(e){const t=Xa[e.windowId];return t?i.createElement(t,Object.assign({},e.windowProps)):null}const Qa=()=>{const e=(0,c.I0)(),t=ps(ys),n=i.useCallback((t=>{e((e=>({type:Ic,payload:{layout:e}}))(t))}),[e]),r=i.useCallback((t=>{let n=t.target;for(;null!=n;){if(n.classList.contains("circuit-editor"))return;n=n.parentElement}e(Ut())}),[e]);return ms({current:document.body},"mouseup",r),i.createElement("div",{className:P(L,T["flex-column"])},i.createElement(ol,{className:T["flexitem-fix"]}),i.createElement("div",{className:P(L,T["flexitem-shrink"])},i.createElement(Ie,{className:P("project-editor",L),rootItem:t,onLayoutChange:n,renderWindow:Ya})))},ed=({location:e})=>{const t=(0,c.I0)(),[n,r]=i.useState(!1);return i.useEffect((()=>{let n;try{n=new URLSearchParams(e.search)}catch(e){return void r(!0)}const i=n.get("data");i?t((e=>({type:Kc,payload:{data:e}}))(i)):r(!0)}),[]),n?i.createElement("div",null,"Failed to import project"):i.createElement("div",null,"Importing Project...")},td=()=>i.createElement(s.rs,null,i.createElement(s.AW,{exact:!0,path:"/",component:Qa}),i.createElement(s.AW,{exact:!0,path:"/import",component:ed})),nd=kr((e=>e.dialogType)),id=kr((e=>e.data));var rd=n(227),od=n(1074);const cd=({className:e,isOpen:t,onRequestClose:n,children:o})=>t?(0,r.createPortal)(i.createElement("div",{className:P("modal","modal--25LBN")},i.createElement(rd.Y,{onClickOutside:n,onEscapeKey:n},i.createElement("div",{className:P("modal-content--1H0T_",e)},i.createElement(od.Z,{className:L},o)))),document.body):null,sd=({isOpen:e,title:t,acceptText:n,cancelText:r,onAccept:o,onCancel:c,footer:s,children:l})=>i.createElement(cd,{className:"dialog--1eQi6",isOpen:e,onRequestClose:c},i.createElement("div",{className:"dialog-title--1DWsL"},t),i.createElement("div",null,l),i.createElement("div",{className:"dialog-footer--2hYdr"},s,c&&i.createElement(js,{onClick:c},null!=r?r:"Cancel"),o&&i.createElement(js,{variant:"primary",onClick:o},null!=n?n:"Accept"))),ld=()=>{const e=ws(vr),t=ps(id),n=null==t?void 0:t.projectLink,r=i.useCallback((()=>{n&&navigator.clipboard.writeText(n).catch((()=>{}))}),[n]);if(!n)return null;const o=i.createElement(js,{onClick:r},"Copy to Clipboard");return i.createElement(sd,{isOpen:!0,title:"Export Project Link",cancelText:"Close",onCancel:e,footer:o},i.createElement("div",{className:"export-link-dialog-link-container--phwUA"},i.createElement("code",{className:"export-link-dialog-link--1dOdK"},n)))},ad=({circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:r})=>{const o=i.useCallback((t=>{t.target.checked&&r(Ai()([...n,e]))}),[e,r,n]);return i.createElement(qs,{onChange:o,value:-1!==n.indexOf(e)},t)},dd=()=>{const e=(0,c.I0)(),t=ps(id),[n,r]=i.useState([]),o=ws(xr),s=i.useCallback((()=>{e(vr(n))}),[e,n]);if(!t)return null;const{circuits:l}=t;return i.createElement(sd,{isOpen:!0,title:"Import Circuits",onAccept:s,onCancel:o,acceptText:"Import Circuits"},i.createElement("div",null,i.createElement("p",null,"Choose the circuits to import."),i.createElement("p",null,"Any chosen circuits that depend on other circuits will import their dependencies automatically."),i.createElement("p",null,"If any circuits already exist in your project, they will not be re-imported.")),i.createElement("ul",{className:"import-project-circuits-list--2ODCz"},l.map((({circuitId:e,circuitName:t})=>i.createElement("li",{key:e},i.createElement(ad,{circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:r}))))))};const ud=()=>{const e=ps(nd);if(!e)return null;const t=function(e){switch(e){case"export-project-link":return ld;case"import-project-circuits":return dd;default:return function(e){throw new Error("Unknown dialog type "+e)}(e)}}(e);return i.createElement(t,null)},pd=document.getElementById("root");r.render(i.createElement(l.W,{backend:a.PD},i.createElement(s.F0,{history:d},i.createElement(c.zt,{store:us},i.createElement((()=>i.createElement(i.Fragment,null,i.createElement(td,null),i.createElement(ud,null))),null)))),pd)},4313:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={type:"interaction-momentary",category:"input-output",displayName:"Momentary Switch",elementProduction:"input-momentary",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-momentary"},pins:{OUT:{direction:"output",x:50,y:25}}}},9175:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={type:"interaction-toggle",category:"input-output",displayName:"Toggle Switch",elementProduction:"input-toggle",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-toggle"},pins:{OUT:{direction:"output",x:50,y:25}}}},4646:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30z",l={type:"logic-and",category:"logic",displayName:"AND",elementProduction:"logic-and",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2140:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z",l={type:"logic-buffer",category:"logic",displayName:"Buffer",elementProduction:"logic-buffer",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M72,25 L 100,25"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 29.043478,25 L 5.0434781,25"}),i.createElement("path",{className:"node-select-highlight--fill",stroke:"none",fill:"black",d:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z M 31.96875,7.40625 L 68.09375,25 L 31.96875,42.59375 L 31.96875,7.40625 z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},6467:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-nand",category:"logic",displayName:"NAND",elementProduction:"logic-nand",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",{transform:"translate(-10,0)"},i.createElement("path",{d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z",stroke:"none",fill:"transparent"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 88,25 H110"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 41,15 L 15,15"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 42,35 L 15,35"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z M 42.857143,7.8571429 C 50.834264,7.8571429 55.918368,7.8571429 58.095238,7.8571429 C 59.285714,7.8571429 59.880952,7.8571429 60.178571,7.8571429 C 60.327381,7.8571429 60.409227,7.8571429 60.446429,7.8571429 C 60.465029,7.8571429 60.471543,7.8571429 60.47619,7.8571429 C 70.236853,7.857143 77.142857,15.497098 77.142857,25 C 77.142857,34.502902 69.760662,42.142857 60,42.142857 L 42.857143,42.142857 L 42.857143,7.8571429 z"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 79,25 A 4,4 0 1 1 71,25 A 4,4 0 1 1 79,25 z",transform:"translate(9,0)"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},8476:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-nor",category:"logic",displayName:"NOR",elementProduction:"logic-nor",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",null,i.createElement("path",{fill:"transparent",stroke:"none",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 h21 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},3980:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-not",category:"logic",displayName:"NOT",elementProduction:"logic-not",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",null,i.createElement("path",{fill:"transparent",stroke:"none",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 H100 M29,25 h-24"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},9696:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",l={type:"logic-or",category:"logic",displayName:"OR",elementProduction:"logic-or",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2201:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375z",l={type:"logic-xor",category:"logic",displayName:"XOR",elementProduction:"logic-xor",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M30,15 H5 M31,35 H5"}),i.createElement("g",{fillRule:"evenodd",className:"node-select-highlight--fill"},i.createElement("path",{d:"M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"}),i.createElement("path",{d:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"})))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},6015:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const i=`M ${25-20}, 25\n    a 20,20 0 1,0 40,0\n    a 20,20 0 1,0 -40,0`;const r={type:"output-led",category:"input-output",displayName:"Indicator Light",elementProduction:"output-led",visual:(0,n(957).J)(i,{path:i,stroke:"black",strokeWidth:3,fill:e=>e.value?"lightgreen":"darkgreen"}),pins:{IN:{direction:"input",x:0,y:25}}}},5058:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(957);const r=[15,0];function o(e,t){const n=t[0];let i=`M${3*n[0]+r[0]},${3*n[1]+r[1]}`;for(const e of t.slice(1)){const[t,n]=e;i+=`L${3*t+r[0]},${3*n+r[1]}`}return i+="z",{path:i,fill:t=>t[e]?"red":"gray",strokeWidth:0}}const c={type:"output-seg7",category:"input-output",displayName:"7-Segment Display",elementProduction:"output-seg7",visual:(0,i.J)("M15,0 V63 H45 V0 z",[o("A",[[1,1],[2,0],[8,0],[9,1],[8,2],[2,2]]),o("B",[[9,1],[10,2],[10,8],[9,9],[8,8],[8,2]]),o("C",[[9,9],[10,10],[10,16],[9,17],[8,16],[8,10]]),o("D",[[9,17],[8,18],[2,18],[1,17],[2,16],[8,16]]),o("E",[[1,17],[0,16],[0,10],[1,9],[2,10],[2,16]]),o("F",[[1,9],[0,8],[0,2],[1,1],[2,2],[2,8]]),o("G",[[1,9],[2,8],[8,8],[9,9],[8,10],[2,10]])]),pins:{A:{direction:"input",x:0,y:5},B:{direction:"input",x:0,y:15},C:{direction:"input",x:0,y:25},D:{direction:"input",x:0,y:35},E:{direction:"input",x:0,y:45},F:{direction:"input",x:0,y:55},G:{direction:"input",x:0,y:65}}}},3158:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-high",category:"input-output",elementProduction:"pin-high",displayName:"High Pin",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M25,20 v10 M20,25 h10",fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},7529:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(7294),r=n(669),o=n.n(r),c=n(8370),s=n(784);const l="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",a={type:"pin-input",category:"input-output",displayName:"Input Pin",visual:(0,n(5471).l)((0,c.NG)(o()(l)),i.createElement("g",null,i.createElement("path",{d:l,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:(0,s.x)(25,25,3,-45,225),fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},4987:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-output",category:"input-output",displayName:"Output Pin",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M15,25 h-15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("circle",{className:"node-select-highlight--fill",cx:25,cy:25,r:3,fill:"black",stroke:"none"}))),pins:{IN:{direction:"input",x:0,y:25}}}},957:(e,t,n)=>{"use strict";n.d(t,{J:()=>u});var i=n(7294),r=n(9242),o=n(669),c=n.n(o),s=n(8370),l=n(1235);const a=({circuitNodeId:e,circuitNodePath:t,shapePath:n,hitPath:o,elementState:c})=>{const s=(0,r.I0)(),a=i.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),s((0,l.zN)([...t||[],e]))))}),[e,s,t]),d=p(n,c).map(((e,t)=>i.createElement("path",{key:t,d:e.path,className:"node-select-highlight--stroke node-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return i.createElement("g",{onClick:a},i.createElement("path",{d:o,fill:"transparent",stroke:"none"}),d)},d=({shapePath:e,hitRect:t})=>{const n=p(e,{}).map(((e,t)=>i.createElement("path",{key:t,d:e.path,className:"node-select-highlight--stroke node-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return i.createElement("svg",{width:50,height:50,viewBox:`${t.p1.x-5} ${t.p1.y-5} ${t.p2.x-t.p1.x+10} ${t.p2.y-t.p1.y+10}`},n)};function u(e,t){const n=(0,s.NG)(c()(e));return{trayComponent:()=>i.createElement(d,{shapePath:t,hitRect:n}),component:n=>i.createElement(a,Object.assign({shapePath:t,hitPath:e},n)),hitRect:n}}function p(e,t){return(Array.isArray(e)?e:[e]).map((e=>{if("string"==typeof e)return{path:e,fill:"black",stroke:"black",strokeWidth:2};const n="function"==typeof e.fill?e.fill(t||{}):e.fill,i="function"==typeof e.stroke?e.stroke(t||{}):e.stroke,r="function"==typeof e.strokeWidth?e.strokeWidth(t||{}):e.strokeWidth;return{path:e.path,fill:n,stroke:i,strokeWidth:r}}))}},5471:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(7294);function r(e,t){return{hitRect:e,trayComponent:()=>i.createElement("svg",{width:50,height:50,viewBox:`${e.p1.x-5} ${e.p1.y-5} ${e.p2.x-e.p1.x+10} ${e.p2.y-e.p1.y+10}`},t),component:()=>t}}},784:(e,t,n)=>{"use strict";function i(e,t,n,i,o){const c=r(e,t,n,o),s=r(e,t,n,i),l=o-i<=180?"0":"1";return["M",c.x,c.y,"A",n,n,0,l,0,s.x,s.y].join(" ")}function r(e,t,n,i){const r=(i-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}}n.d(t,{x:()=>i})}},0,[[7093,1,956,874,90,14,80,744,845,105,699,412]]]);
//# sourceMappingURL=client.02933a7264ded90e9f42.bundle.js.map
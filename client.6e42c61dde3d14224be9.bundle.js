(self.webpackChunkdiscrelog=self.webpackChunkdiscrelog||[]).push([[47],{2954:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.A&&t.B}}})}},5562:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.IN}}})}},2603:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["IN"],outputPins:[],evolve:(e,t,n)=>({state:{value:t.IN}})}},7814:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:!(t.A||t.B)}}})}},50:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:!t.IN}}})}},1652:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.A||t.B}}})}},9684:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["A","B","C","D","E","F","G"],outputPins:[],evolve:(e,t,n)=>({state:Object.assign({},t)})}},9896:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const i={toggleState:!1},o={inputPins:[],outputPins:["OUT"],interact:(e=i)=>Object.assign(Object.assign({},e),{toggleState:!e.toggleState}),evolve:(e=i,t,n)=>({state:e,transitions:{tickOffset:1,valuesByPin:{OUT:e.toggleState}}})}},5978:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t,n)=>({transitions:{tickOffset:4,valuesByPin:{OUT:(t.A||t.B)&&t.A!=t.B}}})}},1990:(e,t,n)=>{"use strict";var i=n(7294),o=n(3935),s=n(9242);const r="root",c={editingCircuitId:r,viewScale:1,dragMode:null,dragStart:null,dragEnd:null,dragNewNodeType:null,dragWireSource:null},a=Object.freeze(c),d={circuitNamesByCircuitId:{[r]:"Root"},nodeIdsByCircuitId:{[r]:[]}},l=Object.freeze(d);var u=n(7516);const p=u.Ry().shape({x:u.Rx().required(),y:u.Rx().required()}),y=Object.freeze({x:0,y:0});function f(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function m(...e){let t,n;if(1===e.length){const i=e[0];t=i.p1,n=i.p2}else t=e[0],n=e[1];return{p1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},p2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}}}function I(e,t){return{x:e.x+t.x,y:e.y+t.y}}function g(e,t){return{x:e.x-t.x,y:e.y-t.y}}function h(e){return{width:(e=m(e)).p2.x-e.p1.x,height:e.p2.y-e.p1.y}}function b(e,t){return e=m(e),t=m(t),{p1:{x:Math.min(e.p1.x,t.p1.x),y:Math.min(e.p1.y,t.p1.y)},p2:{x:Math.max(e.p2.x,t.p2.x),y:Math.max(e.p2.y,t.p2.y)}}}Object.freeze({p1:y,p2:y});const O=Object.freeze({clipboardNodes:[],clipboardPasteOrigin:y}),v=Object.freeze({dialogType:null,data:null}),k=Object.freeze({nodesById:{},connectionsById:{}}),j=Object.freeze({nodePositionsById:{},wireJointIdsByConnectionId:{},wireJointPositionsByJointId:{}}),E=Object.freeze({selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}),C=Object.freeze({mode:"edit",ticksPerSecond:1e3,tick:0,nodeStatesByNodeId:{},nodeOutputValuesByNodeId:{},transitionsById:{},transitionWindows:[],profilerLogicUpdateMsecs:0}),x=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{}}),B={services:{circuitEditorUi:a,nodeGraph:k,nodeLayout:j,circuits:l,clipboard:O,dialog:v,selection:E,simulator:C,simulatorGraph:x}},N=Object.freeze(B);var P=n(4890),w=n(2729),_=n.n(w),M=n(7172);const S="@init",T="@field/drag/continue",J=e=>({type:T,payload:e}),L="@field/mouse/leave",D="@sim/tick",Z=e=>({type:D,payload:{tickCount:e}}),z="@view/zoom";function W(e){return Array.isArray(e)?e:[e]}const A="@wire/joint/move",H=(e,t,n=!1)=>({type:A,payload:{jointIds:W(e),position:t,relative:n}}),R="@wire/joint/end-move",U=()=>({type:R}),V=[T,L,A,D,z];var F=n(4970),G=n(4171),X=n.n(G);const q="@project/load",Y=()=>({type:q}),K="@project/receive";function*$(){yield(0,F.ib)(q,Q)}function*Q(){try{const[e]=yield(0,F.RE)(X(),{accept:"application/json"}),t=yield(0,F.RE)(e.text.bind(e)),n=JSON.parse(t);yield(0,F.gz)((e=>({type:K,payload:{saveData:e}}))(n))}catch(e){console.warn("Failed to load project:",e)}}var ee=n(3162);const te="@project/save",ne=()=>({type:te}),ie="@dialog/show",oe="@dialog/response/accept",se=e=>({type:oe,payload:{result:e}}),re="@dialog/response/cancel",ce=()=>({type:re});function*ae(e,t){yield(0,F.gz)(((e,t)=>({type:ie,payload:{dialogType:e,data:t}}))(e,t));const n=yield(0,F.qn)([oe,re]);return n.type===oe?n.payload.result:null}const de=u.Ry().shape({nodeId:u.Z_().required().min(1),pinId:u.Z_().required().min(1)});function le(e,t){return e.nodeId===t.nodeId&&e.pinId===t.pinId}const ue=u.Ry().shape({circuitId:u.Z_().required().min(1),circuitName:u.Z_().required().min(1)}),pe=u.Ry().shape({nodeId:u.Z_().required().min(1),nodeType:u.Z_().required().min(1),circuitId:u.Z_().required().min(1),x:u.Rx().required(),y:u.Rx().required()}),ye=u.Ry().shape({output:de.required(),input:de.required(),joints:u.IX().of(p)}),fe=u.Ry().shape({circuits:u.IX().of(ue).min(0),nodes:u.IX().of(pe).min(0),wires:u.IX().of(ye).min(0)});var me=n(9734),Ie=n.n(me);function ge(...e){return[].concat(...e)}const he="@circuit/delete";function be(e){return e.type===he}function Oe(...e){return e.filter((e=>Boolean(e)&&""!=e)).join(" ")}function ve(...e){let t=e[0];const n=e.slice(1,e.length-2).map(String),i=e[e.length-2],o=e[e.length-1],s=ke(t);t=s;for(const e of n)t[e]=ke(t[e]),t=t[e];return t[i]="function"==typeof o?o(t[i]):o,s}function ke(e){return Array.isArray(e)?[...e]:Object.assign({},e)}function je(e){return t=>(n=N,i)=>{const o=t(n.services[e],i,n);return n.services[e]!=o?ve(n,"services",e,o):n}}function Ee(e){return t=>{const n=(n,...i)=>t(n.services[e],...i);return n.local=t,n}}const Ce=je("circuitEditorUi"),xe=Ee("circuitEditorUi"),Be=Ce(((e,t)=>{if(!be(t))return e;const{circuitId:n}=t.payload;return e.editingCircuitId!==n?e:Object.assign(Object.assign({},e),{editingCircuitId:"root"})})),Ne="@circuit/edit",Pe=Ce(((e,t)=>function(e){return e.type===Ne}(t)?Object.assign(Object.assign({},e),{editingCircuitId:t.payload.circuitId}):e));var we=n(4586);const _e="@circuit/add",Me=({circuitName:e,circuitId:t,edit:n}={})=>({type:_e,payload:{circuitId:null!=t?t:(0,we.Z)(),circuitName:e,edit:n}});function Se(e){return e.type===_e}const Te=Ce(((e,t)=>{if(!Se(t))return e;const{circuitId:n,edit:i}=t.payload;return i?Object.assign(Object.assign({},e),{editingCircuitId:n}):e})),Je=Ce(((e,t)=>function(e){return e.type===T}(t)?Object.assign(Object.assign({},e),{dragEnd:t.payload}):e)),Le="@field/drag/end",De=(e,t)=>({type:Le,payload:Object.assign(Object.assign({},e),{selectionMode:t})}),Ze="@select/region",ze="@selection/move",We="@node/add",Ae=(e,t)=>({type:We,payload:Object.assign({nodeId:(0,we.Z)(),nodeType:e},t||{})});function He(e){return e.type===We}const Re="@wire/attach",Ue=(e,t,n)=>({type:Re,payload:{connectionId:(0,we.Z)(),p1:e,p2:t,joints:(null==n?void 0:n.joints)||[]}});function Ve(e){return e.type===Re}const Fe=xe((e=>50)),Ge=(e,t)=>{const n=Fe(e);return{x:Math.round(t.x/n)*n,y:Math.round(t.y/n)*n}};var Xe=n(2222),qe=n(6604),Ye=n.n(qe);const Ke=je("nodeGraph"),$e=Ee("nodeGraph"),Qe=$e((e=>e.nodesById)),et=$e((0,Xe.createSelector)(Qe.local,(e=>Object.keys(e)))),tt=$e((0,Xe.createSelector)(Qe.local,(e=>Ye()(e,(e=>e.nodeType))))),nt=$e(((e,t)=>e.nodesById[t]||null)),it=$e(((e,t)=>{const n=[];for(const i of Object.keys(e.nodesById)){const{nodeType:o}=e.nodesById[i];o===t&&n.push(i)}return n})),ot=$e(((e,t)=>{const n=nt.local(e,t);return n?n.nodeType:null}));var st=n(4654),rt=n.n(st),ct=n(3311),at=n.n(ct);const dt=je("circuits"),lt=Ee("circuits"),ut=lt((e=>e.nodeIdsByCircuitId)),pt=lt(((e,t)=>e.nodeIdsByCircuitId[t])),yt=lt(((e,t)=>{for(const n of Object.keys(e.nodeIdsByCircuitId))if(-1!==e.nodeIdsByCircuitId[n].indexOf(t))return n;return null})),ft=je("nodeLayout"),mt=Ee("nodeLayout"),It=mt((e=>e.nodePositionsById)),gt=mt(((e,t)=>e.nodePositionsById[t]));function ht(e){return(0,s.v9)(e)}const bt=lt((e=>Object.keys(e.circuitNamesByCircuitId))),Ot=lt((e=>e.circuitNamesByCircuitId)),vt=lt(((e,t)=>e.circuitNamesByCircuitId[t]));function kt(e,t){return`M10,10 h80 v${50*Math.max(e,t,1)-20} h-80 z`}const jt=({circuitId:e,inputPinCount:t,outputPinCount:n})=>{const o=ht((t=>vt(t,e))),s=kt(t,n),r=[];for(let e=0;e<t;e++){const t=50*e+25;r.push(i.createElement("line",{key:e,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:0,y1:t,x2:10,y2:t}))}const c=[];for(let e=0;e<n;e++){const t=50*e+25;c.push(i.createElement("line",{key:e,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:90,y1:t,x2:100,y2:t}))}return i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",stroke:"black",fill:"none",d:s}),i.createElement("text",{textAnchor:"middle",x:50,y:30},o),r,c)};function Et(e,t,n){return{hitPath:kt(t,n),component:o=>i.createElement(jt,Object.assign({circuitId:e,inputPinCount:t,outputPinCount:n},o))}}function Ct(e,t){return{x:"input"===t?0:100,y:50*e+25}}function xt(e){return"ic-"+e}const Bt=[(0,Xe.createSelector)(ut,tt,It,((e,t,n)=>Object.keys(e).filter((e=>"root"!==e)).map((i=>{var o;let s=(null!==(o=e[i])&&void 0!==o?o:[]).filter((e=>t[e].startsWith("pin-")));s=Ie()(s,(e=>n[e].y),(e=>n[e].x));const r={};let c=0,a=0;for(const e of s){const n=t[e];"pin-input"===n?(r[e]=Object.assign({direction:"input"},Ct(c,"input")),c++):"pin-output"===n&&(r[e]=Object.assign({direction:"output"},Ct(a,"output")),a++)}return{type:xt(i),elementProduction:{type:"circuit",circuitId:i},visual:Et(i,c,a),pins:r}})))),n(1186).Z,n(1894).Z,n(357).Z,n(2074).Z,n(8061).Z,n(6246).Z,n(2334).Z,n(2944).Z,n(1460).Z,n(2554).Z,n(8420).Z];let Nt=[];const Pt=e=>{const t=rt()(Bt,(t=>function(e,t){let n;return n="function"==typeof e?e(t):e,W(n)}(t,e)));return t.every(((e,t)=>e===Nt[t]))?Nt:(Nt=t,t)},wt=(0,Xe.createSelector)(Pt,(e=>{const t={};for(const n of e)t[n.type]=n;return t})),_t=(e,t)=>{var n;const i=Pt(e);return null!==(n=at()(i,(e=>e.type===t)))&&void 0!==n?n:null},Mt=(0,Xe.createSelector)(wt,It,tt,((e,t,n)=>{var i;const o={},s=Object.keys(n);for(const r of s){const s={};o[r]=s;const c=null!==(i=t[r])&&void 0!==i?i:y,a=n[r];if(!a)continue;const d=e[a];if(!d)continue;const l=Object.keys(d.pins);for(const e of l){const t=I(c,d.pins[e]);s[e]=t}}return o})),St=xe((e=>e.dragMode)),Tt=xe((e=>e.dragStart)),Jt=xe((e=>e.dragEnd)),Lt=xe((0,Xe.createSelector)(St.local,Tt.local,Jt.local,((e,t,n)=>"select"===e&&t&&n?m(t,n):null))),Dt=xe((0,Xe.createSelector)(St.local,Tt.local,Jt.local,Fe.local,((e,t,n,i)=>"move"===e&&t&&n?{x:Math.round((n.x-t.x)/i)*i,y:Math.round((n.y-t.y)/i)*i}:null))),Zt=xe((e=>"new-node"===e.dragMode)),zt=xe((e=>"new-node"===e.dragMode?e.dragNewNodeType:null)),Wt=(0,Xe.createSelector)(St,Jt,Mt,((e,t,n)=>{if("wire"!==e||!t)return null;const i=Object.keys(n);for(const e of i){const i=n[e],o=Object.keys(i);for(const n of o)if(f(g(t,i[n]))<=6)return{nodeId:e,pinId:n}}return null})),At="@field/drag/start/new-element",Ht=Ce(((e,t)=>{if(!function(e){return e.type===At}(t))return e;const{nodeType:n}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"new-node",dragNewNodeType:n})})),Rt="@field/drag/start/node",Ut="@select/nodes",Vt=(e,t="set")=>({type:Ut,payload:{nodeIds:Array.isArray(e)?e:[e],mode:t}});var Ft=n(8718),Gt=n.n(Ft),Xt=n(3386),qt=n.n(Xt),Yt=n(1966),Kt=n.n(Yt);const $t=je("selection"),Qt=Ee("selection");function en(e,t,n){switch(n){case"set":return t;case"append":return qt()(e,t);case"remove":return Kt()(e,t);case"toggle":return Kt()(e,t).concat(Kt()(t,e))}return t}const tn=Qt((e=>e.selectedNodeIds)),nn=Qt(((e,t)=>-1!==e.selectedNodeIds.indexOf(t))),on=((0,Xe.createSelector)(Qe,tn,((e,t)=>Gt()(e,t))),Qt((e=>e.selectedConnectionIds)),Qt(((e,t)=>-1!==e.selectedConnectionIds.indexOf(t)))),sn=Qt((e=>e.selectedJointIds)),rn=Qt(((e,t)=>-1!==e.selectedJointIds.indexOf(t))),cn="@field/drag/start/select",an=Ce(((e,t)=>{if(!function(e){return e.type===cn}(t))return e;const{x:n,y:i}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"select",dragStart:{x:n,y:i}})})),dn="@field/drag/start/wire",ln=ge(Be,Pe,Te,Je,(function(e=N,t){if(!function(e){return e.type===Le}(t))return e;const{x:n,y:i,selectionMode:o}=t.payload,{dragMode:s,dragStart:r,dragEnd:c,dragNewNodeType:a,dragWireSource:d}=e.services.circuitEditorUi;switch(s){case"select":if(r){const t=m(r,{x:n,y:i});e=qo(e,((e,t="set")=>({type:Ze,payload:{region:e,mode:t}}))(t,o))}break;case"move":if(r){let t=g({x:n,y:i},r);t=Ge(e,t),e=qo(e,(l=t.x,u=t.y,{type:ze,payload:{offsetX:l,offsetY:u}}))}break;case"new-node":if(c){const t=Ge(e,c);e=qo(e,Ae(a,{position:t}))}break;case"wire":{const t=Wt(e);d&&c&&t&&(e=qo(e,Ue(d,t)));break}}var l,u;return ve(e,"services","circuitEditorUi",(e=>Object.assign(Object.assign({},e),{dragMode:null,dragStart:null,dragEnd:null,dragNewNodeType:null,dragWireSource:null})))}),Ht,(function(e=N,t){if(!function(e){return e.type===Rt}(t))return e;const{nodeId:n,x:i,y:o,selectionMode:s}=t.payload;return e=ve(e,"services","circuitEditorUi",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:i,y:o}}))),nn(e,n)||(e=qo(e,Vt(n,s))),e}),an,Ce(((e,t)=>{if(!function(e){return e.type===dn}(t))return e;const{dragStart:n,pin:i}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"wire",dragStart:n,dragWireSource:i})})),Ce(((e,t)=>function(e){return e.type===L}(t)?null==e.dragMode?e:Object.assign(Object.assign({},e),{dragEnd:null}):e)),Ce(((e,t)=>{if(!function(e){return e.type===z}(t))return e;const{viewScale:n}=e,{delta:i}=t.payload;return Object.assign(Object.assign({},e),{viewScale:i>0?n*i*1.03:n/(1.03*-i)})}))),un=dt(((e,t)=>{if(!Se(t))return e;let{circuitId:n,circuitName:i}=t.payload;return i||(i="Circuit "+(Object.keys(e.circuitNamesByCircuitId).length+1)),Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:i}),nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[n]:[]})})})),pn=dt(((e,t,n)=>{if(!be(t))return e;const{circuitId:i}=t.payload,o=Object.keys(e.circuitNamesByCircuitId).filter((e=>e!==i)),s=it(n,xt(i));let r=Gt()(e.nodeIdsByCircuitId,o);return r=Ye()(r,(e=>Kt()(e,s))),Object.assign(Object.assign({},e),{nodeIdsByCircuitId:r,circuitNamesByCircuitId:Gt()(e.circuitNamesByCircuitId,o)})})),yn="@circuit/rename",fn=dt(((e,t)=>{if(!function(e){return e.type===yn}(t))return e;const{circuitId:n,circuitName:i}=t.payload;let o=i.trim();return""===o?e:Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:o})})})),mn=xe((e=>e.editingCircuitId)),In=dt(((e,t,n)=>{if(!He(t))return e;const{nodeId:i,circuitId:o}=t.payload,s=null!=o?o:mn(n);return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[s]:[...e.nodeIdsByCircuitId[s],i]})})})),gn="@node/delete";function hn(e){return e.type===gn}const bn=dt(((e,t)=>{if(!hn(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:Ye()(e.nodeIdsByCircuitId,(e=>e.filter((e=>-1===n.indexOf(e)))))})})),On="@project/new",vn=()=>({type:On});function kn(e){return e.type===On}const jn=ge(un,pn,fn,In,bn,dt(((e,t)=>kn(t)?Object.assign(Object.assign({},e),{circuitNamesByCircuitId:{[r]:"Root"},nodeIdsByCircuitId:{[r]:[]}}):e)));var En=n(5161),Cn=n.n(En),xn=n(998),Bn=n.n(xn),Nn=n(7287),Pn=n.n(Nn);const wn="@clipboard/copy";var _n=n(2628),Mn=n.n(_n);const Sn=$e((e=>e.connectionsById)),Tn=$e((0,Xe.createSelector)((e=>e.connectionsById),(e=>Object.keys(e)))),Jn=$e(((e,t)=>e.connectionsById[t])),Ln=$e((0,Xe.createSelector)((e=>e.connectionsById),(e=>Mn()(e)))),Dn=$e(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].inputPin.nodeId===t)))),Zn=$e(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].outputPin.nodeId===t)))),zn=(e,t)=>{const n=ot(e,t);return n?_t(e,n):null},Wn=(e,t)=>{const n=ot(e,t);let i;if("pin-input"===n)i="input";else{if("pin-output"!==n)return[];i="output"}const o=yt(e,t);if(!o)return[];const s=xt(o);return it(e,s).map((e=>({nodeId:e,pinId:t})))},An=je("clipboard"),Hn=(Ee("clipboard"),An(((e,t,n)=>{if(!function(e){return e.type===wn}(t))return e;const{nodeIds:i}=t.payload;if(0===i.length)return e;const o=It(n),s=Pn()(i,Cn()(i,(()=>(0,we.Z)()))),r=o[i[0]],c=i.map((e=>{const t=nt(n,e),c=((e,t)=>{const n=Ln(e),i=zn(e,t);if(!i)return{};let o=[];o=Object.keys(i.pins).filter((e=>"output"===i.pins[e].direction));const s=n.filter((e=>e.outputPin.nodeId===t)),r={};for(const e of o)r[e]=[];for(const e of s){const{outputPin:t,inputPin:n}=e;r[t.pinId].push(n)}return r})(n,e);return{id:s[e],nodeType:t.nodeType,offset:g(o[e],r),outputs:Ye()(c,(e=>e.filter((e=>{return t=e.nodeId,-1!==Bn()(i,(e=>e===t));var t})).map((e=>({nodeId:s[e.nodeId],pinId:e.pinId})))))}}));return Object.assign(Object.assign({},e),{clipboardNodes:c,clipboardPasteOrigin:r})}))),Rn="@clipboard/paste",Un={x:10,y:10},Vn=ge(Hn,(function(e=N,t){if(!function(e){return e.type===Rn}(t))return e;const{clipboardNodes:n,clipboardPasteOrigin:i}=e.services.clipboard,o=I(i,Un),s=Pn()(n.map((e=>e.id)),Cn()(n,(()=>(0,we.Z)())));for(let t of n){const{id:n,nodeType:i,offset:r}=t,c=I(o,r);e=qo(e,Ae(i,{position:c,nodeId:s[n]}))}for(let t of n){const{id:n,outputs:i}=t,o=s[n];for(let t of Object.keys(i))for(let n of i[t]){const{nodeId:i,pinId:r}=n,c=s[i];e=qo(e,Ue({nodeId:o,pinId:t},{nodeId:c,pinId:r}))}}return e=ve(e,"services","clipboard","clipboardPasteOrigin",o),qo(e,Vt(Mn()(s)))})),Fn=je("dialog"),Gn=Ee("dialog"),Xn=ge(Fn(((e,t)=>function(e){return e.type===oe}(t)?v:e)),Fn(((e,t)=>function(e){return e.type===re}(t)?v:e)),Fn(((e,t)=>{if(!function(e){return e.type===ie}(t))return e;const{dialogType:n,data:i}=t.payload;return Object.assign(Object.assign({},e),{dialogType:n,data:i})})));function qn(e,t){return t.weight=e,t}function Yn(e){var t;return(null!==(t=e.weight)&&void 0!==t?t:0)-1}var Kn=n(5937),$n=n.n(Kn);function Qn(e,t,n){const i=Kt()(Object.keys(e.nodesById),t),o=rt()(t,(e=>Wn(n,e)));return Object.assign(Object.assign({},e),{nodesById:Gt()(e.nodesById,i),connectionsById:$n()(e.connectionsById,(function({inputPin:e,outputPin:n}){return-1===t.indexOf(e.nodeId)&&-1===t.indexOf(n.nodeId)&&!o.some((t=>le(t,e)||le(t,n)))}))})}const ei=qn(Yn(pn),Ke(((e,t,n)=>{if(!be(t))return e;const{circuitId:i}=t.payload;return Qn(e,[...pt(n,i),...it(n,xt(i))],n)}))),ti=qn(-10,Ke(((e,t)=>{if(!He(t))return e;const{nodeId:n,nodeType:i}=t.payload;return Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:{nodeType:i}})})}))),ni=qn(Yn(bn),Ke(((e,t,n)=>{if(!hn(t))return e;const{nodeIds:i}=t.payload;return Qn(e,i,n)}))),ii=Ke(((e,t)=>kn(t)?k:e)),oi=Ke(((e,t,n)=>{if(!Ve(t))return e;const{connectionId:i,p1:o,p2:s}=t.payload,r=function(e,t,n,i){const o=e.nodesById[t.nodeId],s=e.nodesById[n.nodeId];if(!o||!s)return null;const r=_t(i,o.nodeType),c=_t(i,s.nodeType);if(!r||!c)return null;const a=r.pins[t.pinId],d=c.pins[n.pinId];if(!a||!d)return null;if(a.direction===d.direction)return null;return{outputPin:"output"===a.direction?t:n,inputPin:"input"===a.direction?t:n}}(e,o,s,n);if(!r)return e;const{inputPin:c}=r;return at()(e.connectionsById,(e=>le(e.inputPin,c)))?e:Object.assign(Object.assign({},e),{connectionsById:Object.assign(Object.assign({},e.connectionsById),{[i]:Object.assign({id:i},r)})})})),si="@wire/detatch";function ri(e){return e.type===si}const ci=ge(ei,ti,ii,ni,oi,Ke(((e,t)=>{if(!ri(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.connectionsById).filter((e=>e!==n));return Object.assign(Object.assign({},e),{connectionsById:Gt()(e.connectionsById,i)})})));function ai(e,t,n){const i=rt()(t,(e=>Wn(n,e))),o=t.reduce(((e,t)=>{const i=Dn(n,t);e.push(...i);const o=Zn(n,t);return e.push(...o),e}),[]),s=Sn(n),r=Object.keys(s).filter((e=>{const{inputPin:t,outputPin:n}=s[e];return i.some((e=>le(e,t)||le(e,n)))})),c=[...o,...r].reduce(((t,n)=>(t.push(...e.wireJointIdsByConnectionId[n]),t)),[]),a=Kt()(Object.keys(e.wireJointIdsByConnectionId),o),d=Kt()(Object.keys(e.wireJointPositionsByJointId),c),l=Kt()(Object.keys(e.nodePositionsById),t);return Object.assign(Object.assign({},e),{nodePositionsById:Gt()(e.nodePositionsById,l),wireJointIdsByConnectionId:Gt()(e.wireJointIdsByConnectionId,a),wireJointPositionsByJointId:Gt()(e.wireJointPositionsByJointId,d)})}const di=qn(Yn(ei),ft(((e,t,n)=>{if(!be(t))return e;const{circuitId:i}=t.payload;return e=ai(e,pt(n,i),n),ai(e,it(n,xt(i)),n)}))),li=ft(((e,t)=>{if(!He(t))return e;const{nodeId:n,position:i=y}=t.payload;return ve(e,"nodePositionsById",n,i)})),ui=qn(Yn(ni),ft(((e,t,n)=>{if(!hn(t))return e;const{nodeIds:i}=t.payload;return ai(e,i,n)}))),pi="@node/move",yi=ft(((e,t,n)=>{if(!function(e){return e.type===pi}(t))return e;const{nodeIds:i,position:o,relative:s}=t.payload,r=Ye()(Gt()(e.nodePositionsById,i),(e=>({x:s?e.x+o.x:o.x,y:s?e.y+o.y:o.y})));return Object.assign(Object.assign({},e),{nodePositionsById:Object.assign(Object.assign({},e.nodePositionsById),r)})})),fi=ft(((e,t)=>kn(t)?j:e)),mi=ft(((e,t)=>{if(!Ve(t))return e;const{connectionId:n,joints:i}=t.payload;if(i.length>0){const t=i.map((e=>(0,we.Z)()));e=ve(e,"wireJointIdsByConnectionId",n,t),e=ve(e,"wireJointPositionsByJointId",(e=>Object.assign(Object.assign({},e),Pn()(t,i))))}else e=ve(e,"wireJointIdsByConnectionId",n,[]);return e})),Ii=ft(((e,t)=>{if(!ri(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.wireJointIdsByConnectionId).filter((e=>e!=n)),o=Kt()(Object.keys(e.wireJointPositionsByJointId),e.wireJointIdsByConnectionId[n]);return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Gt()(e.wireJointIdsByConnectionId,i),wireJointPositionsByJointId:Gt()(e.wireJointPositionsByJointId,o)})})),gi="@wire/joint/add",hi=ft(((e,t)=>{if(!function(e){return e.type===gi}(t))return e;const{connectionId:n,addAfterJointId:i,position:o,jointId:s}=t.payload;let r=e.wireJointIdsByConnectionId[n],c=i?r.indexOf(i)+1:0;return r=[...r.slice(0,c),s,...r.slice(c)],Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Object.assign(Object.assign({},e.wireJointIdsByConnectionId),{[n]:r}),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),{[s]:o})})})),bi="@wire/joint/delete",Oi=ge(di,li,fi,ui,yi,mi,Ii,hi,ft(((e,t)=>{if(!function(e){return e.type===bi}(t))return e;const{jointId:n}=t.payload,i=Object.keys(e.wireJointPositionsByJointId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Ye()(e.wireJointIdsByConnectionId,(e=>e.filter((e=>e!==n)))),wireJointsByJointId:Gt()(e.wireJointPositionsByJointId,i)})})),ft(((e,t)=>{if(!function(e){return e.type===A}(t))return e;const{jointIds:n,position:i,relative:o}=t.payload,s=Ye()(Gt()(e.wireJointPositionsByJointId,n),(e=>({x:o?e.x+i.x:i.x,y:o?e.y+i.y:i.y})));return Object.assign(Object.assign({},e),{wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),s)})}))),vi=[We,gn,_e,he,yn,ze,Re,si,gi,R,bi],ki=ge(qn(50,((e=N,t)=>{return-1===vi.indexOf(t.type)||(n=Ko(e),localStorage.setItem("autosave",JSON.stringify(n))),e;var n})),(function(e=N,t){return kn(t)?(localStorage.removeItem("autosave"),e):e}),(function(e=N,t){if(!function(e){return e.type===S}(t))return e;const n=function(){const e=localStorage.getItem("autosave");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}();if(!n)return e;try{return $o(e,n)}catch(t){return e}}),(function(e=N,t){if(!function(e){return e.type===K}(t))return e;try{return $o(e,t.payload.saveData)}catch(t){return e}})),ji=$t(((e,t)=>{if(!hn(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:Kt()(e.selectedNodeIds,n),selectedConnectionIds:[]})})),Ei=$t(((e,t)=>kn(t)?E:e));var Ci=n(5564),xi=n.n(Ci);const Bi="@select/all";var Ni=n(6486);const Pi=(0,Xe.createSelector)(((e,t)=>pt(e,t)),(e=>e.services.nodeGraph.connectionsById),((e,t)=>Object.keys(t).filter((n=>{const{inputPin:i,outputPin:o}=t[n];return!!(0,Ni.includes)(e,i.nodeId)&&!!(0,Ni.includes)(e,o.nodeId)})))),wi=e=>{const t=mn(e);return pt(e,t)},_i=e=>{const t=mn(e);return Pi(e,t)},Mi={},Si={},Ti=(mt((e=>Object.keys(e.wireJointPositionsByJointId))),mt((e=>e.wireJointIdsByConnectionId))),Ji=mt(((e,t)=>e.wireJointIdsByConnectionId[t])),Li=mt(((e,t)=>e.wireJointPositionsByJointId[t])),Di=mt((e=>e.wireJointPositionsByJointId)),Zi=$t(((e,t,n)=>{if(!function(e){return e.type===Bi}(t))return e;const i=wi(n);let o=Tn(n);const s=Sn(n);o=o.filter((e=>{const{inputPin:t,outputPin:n}=s[e];return-1!==i.indexOf(t.nodeId)&&-1!==i.indexOf(n.nodeId)}));const r=Ti(n),c=xi()(o.map((e=>r[e])));return Object.assign(Object.assign({},e),{selectedNodeIds:i,selectedConnectionIds:o,selectedJointIds:c})})),zi="@select/clear",Wi=$t(((e,t)=>function(e){return e.type===zi}(t)?Object.assign(Object.assign({},e),{selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}):e)),Ai="@select/wire-joints",Hi=$t(((e,t)=>{if(!function(e){return e.type===Ai}(t))return e;const{jointIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:en(e.selectedJointIds,n,i)})})),Ri=$t(((e,t)=>{if(!function(e){return e.type===Ut}(t))return e;const{nodeIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:en(e.selectedNodeIds,n,i),selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:"set"===i?[]:e.selectedJointIds})}));var Ui=n(2525),Vi=n.n(Ui),Fi=n(669),Gi=n.n(Fi);const Xi=(0,Xe.createSelector)(wt,tt,((e,t)=>Ye()(t,((t,n)=>{const i=e[t];return i?Gi()(i.visual.hitPath):[0,0,0,0]})))),qi=(0,Xe.createSelector)(It,Xi,((e,t)=>Ye()(e,((e,n)=>{const i=t[n]||[0,0,0,0];return m({x:e.x+i[0],y:e.y+i[1]},{x:e.x+i[2],y:e.y+i[3]})})))),Yi=$t(((e,t,n)=>{if(!function(e){return e.type===Ze}(t))return e;const{region:i,mode:o}=t.payload,s=wi(n),r=Gt()(qi(n),s),c=[];Vi()(r,((e,t)=>{var n,o;o=i,n=m(n=e),o=m(o),n.p1.x>o.p2.x||n.p2.x<o.p1.x||n.p1.y>o.p2.y||n.p2.y<o.p1.y||c.push(t)}));const a=[],d=Di(n);return Vi()(d,((e,t)=>{(function(e,t){return!((t=m(t)).p1.x>e.x||t.p2.x<e.x||t.p1.y>e.y||t.p2.y<e.y)})(e,i)&&a.push(t)})),Object.assign(Object.assign({},e),{selectedNodeIds:en(e.selectedNodeIds,c,o),selectedConnectionIds:"set"===o?[]:e.selectedConnectionIds,selectedJointIds:en(e.selectedJointIds,a,o)})})),Ki="@select/wires",$i=$t(((e,t)=>{if(!function(e){return e.type===Ki}(t))return e;const{connectionIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:en(e.selectedConnectionIds,n,i),selectedJointIds:"set"===i?[]:e.selectedJointIds})})),Qi="@selection/copy",eo="@selection/delete",to=ge(Ei,ji,Zi,Wi,Hi,Ri,Yi,$i,(function(e=N,t){if(!function(e){return e.type===Qi}(t))return e;const n=tn(e);return 0===n.length?e:qo(e,(i=n,{type:wn,payload:{nodeIds:Array.isArray(i)?i:[i]}}));var i}),(function(e=N,t){if(!function(e){return e.type===eo}(t))return e;const{selectedNodeIds:n,selectedConnectionIds:i,selectedJointIds:o}=e.services.selection;return n.length>0&&(e=qo(e,{type:gn,payload:{nodeIds:W(n)}})),e=i.reduce(((e,t)=>qo(e,(e=>({type:si,payload:{connectionId:e}}))(t))),e),o.reduce(((e,t)=>qo(e,(e=>({type:bi,payload:{jointId:e}}))(t))),e)}),(function(e=N,t){if(!function(e){return e.type===ze}(t))return e;const{offsetX:n,offsetY:i}=t.payload,o=tn(e),s=sn(e),r={x:n,y:i};return e=qo(e,((e,t,n=!1)=>({type:pi,payload:{nodeIds:W(e),position:t,relative:n}}))(o,r,!0)),qo(e,H(s,r,!0))}),$t(((e,t)=>{if(!ri(t))return e;const{connectionId:n}=t.payload;return Object.assign(Object.assign({},e),{selectedConnectionIds:e.selectedConnectionIds.filter((e=>e!==n))})}))),no=je("simulator"),io=Ee("simulator"),oo=[On,K,We,gn,Re,si],so=no(((e,t)=>-1!==oo.indexOf(t.type)?Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}):e));n(2603),n(9896);const ro={and:n(2954).Z,or:n(1652).Z,nor:n(7814).Z,not:n(50).Z,buffer:n(5562).Z,led:n(2603).Z,toggle:n(9896).Z,seg7:n(9684).Z,xor:n(5978).Z},co="@node/interact",ao=je("simulatorGraph"),lo=Ee("simulatorGraph"),uo=lo(((e,t)=>e.simulatorNodeIdsByCircuitNodeId[t])),po=lo((e=>Object.keys(e.simulatorNodesById))),yo=lo(((e,t)=>{const n=e.simulatorNodesById[t];return n?n.elementType:null}));var fo=n(7513),mo=n.n(fo);const Io=lo(((e,t)=>{const n=e.simulatorNodesById[t];return n?rt()(Mn()(n.outputsByPin),(e=>e.map((e=>e.simulatorNodeId)))):[]})),go=lo(((e,t)=>{const n=e.simulatorNodesById[t];return n?n.inputsByPin:{}}));function ho(e,t,n){var i;const o=yo(n,t);if(!o)return e;const s=ro[o];if(!s||!s.evolve)return e;const r={},c=go(n,t);for(const t of Object.keys(c)){const n=c[t];if(!n){r[t]=!1;continue}const{simulatorNodeId:o,pinId:s}=n;r[t]=(null===(i=e.nodeOutputValuesByNodeId[o])||void 0===i?void 0:i[s])||!1}const a=s.evolve(e.nodeStatesByNodeId[t],r,e.tick);if(a.state&&(e=ve(e,"nodeStatesByNodeId",t,a.state)),a.transitions){const n=W(a.transitions);for(const i of n){const{tickOffset:n,valuesByPin:o,transitionMerger:s="replace"}=i,r=e.tick+(n>0?n:1);"replace"===s&&(e=Oo(e,t)),e=bo(e,t,r,o)}}return e}function bo(e,t,n,i){const o=(0,we.Z)(),s={transitionId:o,nodeId:t,tick:n,valuesByOutputPin:i};e=Object.assign(Object.assign({},e),{transitionsById:Object.assign(Object.assign({},e.transitionsById),{[o]:s}),transitionWindows:[...e.transitionWindows]});let r=mo()(e.transitionWindows,n,((e,t)=>e.tick-t));if(r<0){r=-r-1;const t={tick:n,transitionIds:[]};e.transitionWindows.splice(r,0,t)}return e.transitionWindows[r]=Object.assign(Object.assign({},e.transitionWindows[r]),{transitionIds:[...e.transitionWindows[r].transitionIds,o]}),e}function Oo(e,t){return Object.keys(e.transitionsById).filter((n=>e.transitionsById[n].nodeId===t)).reduce(((e,t)=>function(e,t){const n=e.transitionsById[t];if(!n)return e;const i=Gt()(e.transitionsById,Object.keys(e.transitionsById).filter((e=>e!==t)));let o=e.transitionWindows;const s=Bn()(o,(e=>e.tick===n.tick));if(-1!==s){const e=o[s],n=e.transitionIds.indexOf(t);if(-1!==n)if(1===e.transitionIds.length)o=[...o.slice(0,s),...o.slice(s+1)];else{o=[...o];const e=o[s].transitionIds;o[s]=Object.assign(Object.assign({},o[s]),{transitionIds:[...e.slice(0,n),...e.slice(n+1)]})}}return Object.assign(Object.assign({},e),{transitionsById:i,transitionWindows:o})}(e,t)),e)}const vo=no(((e,t,n)=>{if(!function(e){return e.type===co}(t))return e;const{nodeId:i}=t.payload,o=uo(n,i),s=yo(n,o);if(!s)return e;const r=ro[s];if(!r||!r.interact)return e;const c=e.nodeStatesByNodeId[o];return ho(e=ve(e,"nodeStatesByNodeId",o,r.interact(c)),o,n)})),ko="@sim/fastforward",jo=no(((e,t,n)=>{if(!function(e){return e.type===D}(t))return e;const i=performance.now(),{tickCount:o}=t.payload,s=e.tick+o;e=Object.assign(Object.assign({},e),{transitionWindows:[...e.transitionWindows]});let r=o+1;for(;e.transitionWindows.length>0&&e.transitionWindows[0].tick<=s;){if(0==--r)throw new Error("Maximum ticks per sim evolution exceeded.  This is an indication that windows are being generated for past ticks.");const t=e.transitionWindows.shift();e=Eo(e,t,n)}e.tick!=s&&(e=Object.assign(Object.assign({},e),{tick:s}));const c=performance.now()-i;return Object.assign(Object.assign({},e),{profilerLogicUpdateMsecs:c})}));function Eo(e,t,n){e=Object.assign(Object.assign({},e),{tick:t.tick,nodeOutputValuesByNodeId:Object.assign({},e.nodeOutputValuesByNodeId)});let i=[];for(const o of t.transitionIds){const{nodeId:t,valuesByOutputPin:s}=e.transitionsById[o];e.nodeOutputValuesByNodeId[t]=Object.assign(Object.assign({},e.nodeOutputValuesByNodeId[t]),s);const r=Io(n,t);for(const e of r)-1===i.indexOf(e)&&i.push(e)}e.transitionsById=Gt()(e.transitionsById,Kt()(Object.keys(e.transitionsById),t.transitionIds));for(const t of i)e=ho(e,t,n);return e}const Co="@sim/pause",xo=e=>({type:Co,payload:{mode:e}}),Bo=io((e=>"edit"!==e.mode)),No=io((e=>"run"===e.mode)),Po=io((e=>"pause"===e.mode)),wo=io((e=>e.ticksPerSecond)),_o=no(((e,t)=>{if(!function(e){return e.type===Co}(t))return e;const{mode:n}=t.payload;if(!Bo.local(e))return e;let i=e.mode;switch(n){case!0:i="pause";break;case!1:i="run";break;case"toggle":i="run"==i?"pause":"run"}return Object.assign(Object.assign({},e),{mode:i})})),Mo="@sim/start",So=()=>({type:Mo});function To(e){return e.type===Mo}const Jo=no(((e,t,n)=>To(t)?(e=function(e,t){const n=po(t);return e=Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}),e=n.reduce(((e,n)=>function(e,t,n){const i=yo(n,t);if(!i)return e;const o=ro[i];if(!o)return e;const s={};for(const e of o.outputPins)s[e]=!1;return ve(e,"nodeOutputValuesByNodeId",t,s)}(e,n,t)),e),n.reduce(((e,n)=>ho(e,n,t)),e)}(e,n),Object.assign(Object.assign({},e),{mode:"run"})):e)),Lo="@sim/stop",Do=()=>({type:Lo});function Zo(e){return e.type===Lo}const zo=ge(so,vo,(function(e=N,t){if(!function(e){return e.type===ko}(t))return e;const{tick:n,transitionWindows:i}=e.services.simulator;if(0===i.length)return e;const o=i[0].tick-n;return jo(e,Z(o))}),_o,Jo,no(((e,t,n)=>Zo(t)?Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}):e)),jo);var Wo=n(3857),Ao=n.n(Wo),Ho=n(7361),Ro=n.n(Ho);const Uo=qn(-10,ao(((e,t,n)=>{if(!To(t))return e;const{simulatorNodesById:i,simulatorNodeIdsByCircuitNodeId:o}=Fo("root",n);return Object.assign(Object.assign({},e),{simulatorNodesById:i,simulatorNodeIdsByCircuitNodeId:o})}))),Vo=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{},inputElementPinsByCircuitPinId:{},outputElementPinsByCircuitPinId:{}});function Fo(e,t,n=!0){const i={},o={},s={},r={},c=[],a=[],d={},l={},u=pt(t,e);for(const e of u){const r=ot(t,e);if(!r)continue;if("pin-input"===r){c.push(e),s[e]=[];continue}if("pin-output"===r){a.push(e);continue}const u=Go(e,t);Ao()(i,u.simulatorNodesById),n&&Ao()(o,u.simulatorNodeIdsByCircuitNodeId),d[e]=u.inputElementPinsByCircuitPinId,l[e]=u.outputElementPinsByCircuitPinId}const p=Sn(t);for(const e of Object.keys(p)){const{inputPin:t,outputPin:n}=p[e];if(-1===u.indexOf(t.nodeId)||-1===u.indexOf(n.nodeId))continue;const o=Ro()(l,[n.nodeId,n.pinId]),y=Ro()(d,[t.nodeId,t.pinId]);if(-1!==c.indexOf(n.nodeId)&&y){s[n.nodeId].push(...y);continue}if(-1!==a.indexOf(t.nodeId)&&o){r[t.nodeId]=o;continue}if(!o||!y)continue;const f=i[o.simulatorNodeId];let m=f.outputsByPin[o.pinId];null==m&&(f.outputsByPin[o.pinId]=m=[]);for(const e of y)m.push({simulatorNodeId:e.simulatorNodeId,pinId:e.pinId}),i[e.simulatorNodeId].inputsByPin[e.pinId]={simulatorNodeId:o.simulatorNodeId,pinId:o.pinId}}return{simulatorNodesById:i,simulatorNodeIdsByCircuitNodeId:o,inputElementPinsByCircuitPinId:s,outputElementPinsByCircuitPinId:r}}function Go(e,t){const n=ot(t,e);if(!n)return Vo;const i=_t(t,n);if(!i||!i.elementProduction)return Vo;const o="string"==typeof(s=i.elementProduction)?{type:"element",elementType:s}:s;var s;switch(o.type){case"element":return function(e,t,n){const i=zn(n,e);if(!i)return Vo;const o={},s={},r=(0,we.Z)();o[r]={elementType:t.elementType,inputsByPin:{},outputsByPin:{}},s[e]=r;const c={},a={};for(const e of Object.keys(i.pins)){const{direction:t}=i.pins[e];"input"===t?c[e]=[{pinId:e,simulatorNodeId:r}]:"output"===t&&(a[e]={pinId:e,simulatorNodeId:r})}return{simulatorNodesById:o,simulatorNodeIdsByCircuitNodeId:s,inputElementPinsByCircuitPinId:c,outputElementPinsByCircuitPinId:a}}(e,o,t);case"circuit":return function(e,t,n){return Fo(t.circuitId,n,!1)}(0,o,t);default:throw new Error("Unsupported production type "+o.type)}}const Xo=ge(Uo,ao(((e,t)=>Zo(t)?Object.assign({},x):e))),qo=function(e){const t=Ie()(e,(e=>e.weight||0));return(e=N,n)=>t.reduce(((e,t)=>t(e,n)),e)}(ge(ln,jn,Vn,Xn,ci,Oi,ki,to,zo,Xo));class Yo extends Error{constructor(e){super(e),this.message=e,this.code="SAVE_FORMAT_ERROR"}}function Ko(e){const t=Di(e);return{circuits:bt(e).map((t=>({circuitId:t,circuitName:vt(e,t)}))),nodes:et(e).map((t=>{const n=nt(e,t),i=gt(e,t),o=yt(e,t);return{nodeId:t,nodeType:n.nodeType,circuitId:null!=o?o:"root",x:i.x,y:i.y}})),wires:Tn(e).map((n=>{const i=Jn(e,n),o=Ji(e,n);return{input:i.inputPin,output:i.outputPin,joints:o.map((e=>t[e]))}}))}}function $o(e,t){var n,i,o;try{fe.validateSync(t)}catch(e){throw new Yo(e.message)}e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),{nodeLayout:j,nodeGraph:k,selection:E,simulator:C})});try{e=(null!==(n=t.circuits)&&void 0!==n?n:[]).reduce(((e,{circuitId:t,circuitName:n})=>qo(e,Me({circuitId:t,circuitName:n}))),e),e=(null!==(i=t.nodes)&&void 0!==i?i:[]).reduce(((e,t)=>qo(e,Ae(t.nodeType,{nodeId:t.nodeId,circuitId:t.circuitId,position:{x:t.x,y:t.y}}))),e),e=(null!==(o=t.wires)&&void 0!==o?o:[]).reduce(((e,t)=>qo(e,Ue(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to rehydrate SaveData:",e),new Yo("Failed to load project.")}return e}function*Qo(){yield(0,F.ib)(te,es)}function*es(){const e=yield(0,F.Ys)(),t=yield(0,F.RE)(ae,"save-project",null);if(t)try{const n=Ko(e),i=new Blob([JSON.stringify(n,null,2)],{type:"application/json;charset=utf-8"});(0,ee.saveAs)(i,t)}catch(e){console.warn("Failed to save project:",e)}}function*ts(){yield(0,F.rM)($),yield(0,F.rM)(Qo)}function*ns(){yield(0,F.A7)([Mo,Co],is)}function*is(){for(;yield(0,F.Ys)(No);){yield(0,F.gz)(Z(1));const e=yield(0,F.Ys)(wo),t=Math.max(Math.ceil(1e3/e),1);yield(0,F.gw)(t)}}function*os(){yield(0,F.rM)(ns)}const ss=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionSanitizer:function(e){return e},stateSanitizer:function(e){return e},actionsBlacklist:V})||P.qC,rs=(0,M.ZP)(),cs=(0,P.MT)(qo,ss((0,P.md)(_(),rs)));rs.run((function*(){yield(0,F.rM)(ts),yield(0,F.rM)(os)})),cs.dispatch({type:S});const as="sizing-module__fill-parent___[fullhash-base64-5]",ds=io((e=>e.profilerLogicUpdateMsecs));var ls=n(7024),us=n(3274);const ps=xe((e=>e.viewScale));var ys=n(1795);const fs=/(Mac|iOS|OS\ X)/.test((ys.os||"undefined").toString()),ms=fs?"command":"ctrl",Is="keymap:CircuitEditor/SimStep",gs="keymap:CircuitEditor/SimFastForward",hs="keymap:CircuitEditor/SelectAll",bs="keymap:CircuitEditor/Copy",Os="keymap:CircuitEditor/Paste",vs="keymap:CircuitEditor/Delete",ks={[Is]:"space",[gs]:"shift+space",[hs]:ms+"+a",[bs]:ms+"+c",[Os]:ms+"+v",[vs]:["backspace","del"]},js=Object.freeze({p1:{x:-100,y:-100},p2:{x:100,y:100}}),Es=(0,Xe.createSelector)(qi,Di,((e,t)=>[...Mn()(e),...Mn()(t).map((e=>({p1:e,p2:e})))].reduce(b,js))),Cs=i.createContext(null),xs=Cs.Provider,Bs=({value:e,children:t})=>{const[n,o]=i.useState(null);return i.useEffect((()=>{o(e.current)}),[e.current]),i.createElement(xs,{value:n},t)};function Ns(){const e=i.useContext(Cs);return i.useCallback((t=>{if(!e)return y;const n={x:t.pageX,y:t.pageY};return function(e,t){const n=e.getScreenCTM();if(!n)return t;const i=e.createSVGPoint();i.x=t.x,i.y=t.y;const o=i.matrixTransform(n.inverse());return{x:o.x,y:o.y}}(e,n)}),[e])}const Ps=({className:e,x:t=0,y:n=0,nodeType:o,nodeState:s,isSelected:r=!1,onClick:c,onMouseDown:a,onMouseOver:d,onMouseUp:l,onMouseLeave:u})=>{const p=ht((e=>_t(e,o)));let y,f;if(p){const{component:e}=p.visual;y=i.createElement(e,{isSelected:r,elementState:s}),f=p.visual.hitPath}else y=i.createElement("rect",{x:t,y:n,width:50,height:50,fill:r?"goldenrod":"red"});const m=0!=t||0!=n?`translate(${t}, ${n})`:void 0;return i.createElement("g",{className:Oe(e,"node-visual",r&&"node-selected"),transform:m,onClick:c,onMouseDown:a,onMouseOver:d,onMouseUp:l,onMouseLeave:u},f&&i.createElement("path",{d:f,fill:"transparent",onClick:c}),y)},ws=()=>{const e=(0,s.I0)(),t=Ns(),n=ht(Es),{width:o,height:r}=h(n),c=ht(Zt),a=ht(Jt),d=ht(zt),l=i.useCallback((n=>{const i=t(n);e(J(i))}),[t]);return c&&d?i.createElement(i.Fragment,null,a&&i.createElement("g",{opacity:.5},i.createElement(Ps,{x:a.x,y:a.y,nodeType:d,nodeState:{}})),i.createElement("rect",{width:o,height:r,fill:"transparent",onMouseMove:l})):null},_s=function(){let e,t,n=null;return i=>{const o=i.services.simulatorGraph.simulatorNodeIdsByCircuitNodeId,s=i.services.simulator.nodeStatesByNodeId;if(e===o&&t===s&&null!=n)return n;const r={};for(const e of Object.keys(o)){const t=o[e];r[e]=s[t]}return e=o,t=s,n=r,r}}(),Ms=(0,Xe.createSelector)(tn,It,((e,t)=>Gt()(t,e))),Ss=(0,Xe.createSelector)(tn,tt,((e,t)=>Gt()(t,e))),Ts=(0,Xe.createSelector)(tn,_s,((e,t)=>Gt()(t,e))),Js=()=>{const e=ht(Ms),t=ht(Ss),n=ht(Ts),o=ht(Dt);let s=null;return o&&(s=Mn()(Ye()(e,((e,s)=>i.createElement(Ps,{key:s,nodeType:t[s],nodeState:n[s],x:e.x+o.x,y:e.y+o.y}))))),i.createElement("g",{id:"drag-preview-layer",opacity:.3},s)};function Ls(e){const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:o}=e;return{ctrlMetaKey:fs?o:t,altKey:n,shiftKey:i}}function Ds(e){return e.shiftKey&&e.ctrlMetaKey?"remove":e.shiftKey?"append":e.ctrlMetaKey?"toggle":"set"}function Zs(e){const{dragThreshold:t=5,onClick:n,onDragStart:o,onDragMove:s,onDragEnd:r}=e,[c,a]=i.useState(!1),d=i.useRef(!1),l=i.useRef(!1),u=i.useRef(y),p=i.useCallback((e=>{d.current||(d.current=!0,a(!0),u.current={x:e.pageX,y:e.pageY})}),[]),f=i.useCallback((()=>{d.current=!1,a(!1),l.current=!1,u.current=y}),[]);return i.useEffect((()=>{if(c)return document.addEventListener("mousemove",e),document.addEventListener("mouseup",i),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",i)};function e(e){if(d.current)if(l.current){if(s){const t=g({x:e.pageX,y:e.pageY},u.current);s(t,e)}}else{const n=u.current;(Math.abs(n.x-e.pageX)>=t||Math.abs(n.y-e.pageY)>=t)&&(l.current=!0,o&&o(e))}}function i(e){if(d.current){if(l.current){if(r){const t=g({x:e.pageX,y:e.pageY},u.current);r(t,e)}}else n&&n(e);f()}}}),[c]),{startTracking:p,cancelTracking:f}}const zs=()=>{const e=(0,s.I0)(),t=(0,s.v9)(Lt),n=Ns(),o=i.useCallback((()=>{e({type:zi})}),[]),r=i.useCallback((t=>{const i=n(t);e((e=>({type:cn,payload:Object.assign({},e)}))(i))}),[n]),c=i.useCallback(((t,i)=>{const o=n(i);e(J(o))}),[n]),a=i.useCallback(((t,i)=>{const o=n(i),s=Ds(Ls(i));e(De(o,s))}),[n]),{startTracking:d}=Zs({onClick:o,onDragStart:r,onDragMove:c,onDragEnd:a}),l=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),d(e))}),[n]);return i.createElement("g",{id:"drag-select-layer"},i.createElement("rect",{width:"100%",height:"100%",fill:"transparent",onMouseDown:l}),t&&i.createElement("g",{transform:`translate(${t.p1.x}, ${t.p1.y})`},i.createElement("rect",{width:t.p2.x-t.p1.x,height:t.p2.y-t.p1.y,strokeWidth:"2",strokeDasharray:"5 3",stroke:"skyblue",fill:"transparent"})))},Ws=()=>{const e=ht(ps);return i.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},i.createElement("defs",null,i.createElement("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse"},i.createElement("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"gray",strokeWidth:1/e*.5}))),i.createElement("rect",{width:"100%",height:"100%",fill:"url(#grid)"}))},As=({nodeId:e})=>{const t=(0,s.I0)(),n=ht(Bo),o=ht((t=>gt(t,e)));o||console.warn(`Rendering node id ${e} that has no position.`);const{x:r,y:c}=null!=o?o:y,a=ht((t=>ot(t,e))),d=ht((t=>((e,t)=>{const n=e.services.simulatorGraph.simulatorNodeIdsByCircuitNodeId,i=e.services.simulator.nodeStatesByNodeId,o=n[t];return o?i[o]:{}})(t,e))),l=ht((t=>nn(t,e))),u=Ns(),p=i.useCallback((i=>{if(n)t((e=>({type:co,payload:{nodeId:e}}))(e));else{const n=Ds(Ls(i));t(Vt(e,n))}}),[n]),f=i.useCallback((n=>{const i=u(n),o=Ds(Ls(n));t(((e,t,n)=>({type:Rt,payload:Object.assign(Object.assign({},t),{nodeId:e,selectionMode:n})}))(e,i,o))}),[e,u]),m=i.useCallback(((e,n)=>{const i=u(n);t(J(i))}),[u]),I=i.useCallback(((e,n)=>{const i=u(n),o=Ds(Ls(n));t(De(i,o))}),[u]),{startTracking:g}=Zs({onClick:p,onDragStart:f,onDragMove:m,onDragEnd:I}),h=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),g(e))}),[u]);return a?i.createElement(Ps,{className:"circuit-field-node",x:r,y:c,nodeType:a,nodeState:d,isSelected:l,onMouseDown:h}):null},Hs=()=>{const e=ht(wi).map((e=>i.createElement(As,{key:e,nodeId:e})));return i.createElement("g",{id:"nodes-layer"},e)};var Rs=n(5879);const Us=n.n(Rs)()(((e,t)=>e.services.nodeGraph.connectionsById[t]),(e=>e.services.simulatorGraph.simulatorNodeIdsByCircuitNodeId),(e=>e.services.simulator.nodeOutputValuesByNodeId),((e,t,n)=>{var i;if(!e)return!1;const{outputPin:{nodeId:o,pinId:s}}=e;return(null===(i=n[t[o]])||void 0===i?void 0:i[s])||!1}))(((e,t)=>t)),Vs=({connectionId:e,startJointId:t,endJointId:n})=>{const o=(0,s.I0)(),r=Ns(),c=ht((n=>null==t?((e,t)=>{const{outputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],o=zn(e,n);if(!o)return y;const s=gt(e,n)||y,r=Mi[t];if(r&&r.inputNodeDef===o&&r.inputNodePosition.x===s.x&&r.inputNodePosition.y===s.y)return r.outputPosition;let c=y;o&&o.pins[i]&&(c=o.pins[i]);const a=I(s,c);return Mi[t]={inputNodeDef:o,inputNodePosition:s,outputPosition:a},a})(n,e):Li(n,t))),a=ht((t=>null==n?((e,t)=>{const{inputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],o=zn(e,n);if(!o)return y;const s=gt(e,n)||y,r=Si[t];if(r&&r.inputNodeDef===o&&r.inputNodePosition.x===s.x&&r.inputNodePosition.y===s.y)return r.outputPosition;let c=y;o&&o.pins[i]&&(c=o.pins[i]);const a=I(s,c);return Si[t]={inputNodeDef:o,inputNodePosition:s,outputPosition:a},a})(t,e):Li(t,n))),[d,l]=i.useState(null),u=i.useRef(null),p=i.useCallback((e=>{const t=r(e);l(t)}),[r]),m=i.useCallback((()=>{l(null)}),[]),h=i.useCallback((n=>{const i=r(n),s=(0,we.Z)();u.current=s,o(((e,t,n,i)=>({type:gi,payload:{connectionId:e,jointId:i||(0,we.Z)(),addAfterJointId:t,position:n}}))(e,t,i,s))}),[e,t,r]),b=i.useCallback(((e,t)=>{const n=u.current;if(!n)return;const i=r(t);o(H(n,i))}),[r]),O=i.useCallback((()=>{o(U())}),[]),v=i.useCallback((t=>{const n=Ds(Ls(t));o(((e,t="set")=>({type:Ki,payload:{connectionIds:Array.isArray(e)?e:[e],mode:t}}))(e,n))}),[e]),{startTracking:k}=Zs({onClick:v,onDragStart:h,onDragMove:b,onDragEnd:O}),j=i.useCallback((e=>{k(e)}),[k]);let E;if(d){let e=function(e){const t=f(e);return{x:e.x/t,y:e.y/t}}(g(a,c));E=I(c,(x=(N=e,(B=g(d,c)).x*N.x+B.y*N.y),{x:(C=e).x*x,y:C.y*x}))}var C,x,B,N;return i.createElement("g",{onMouseMove:p,onMouseLeave:m},i.createElement("line",{x1:c.x,y1:c.y,x2:a.x,y2:a.y,strokeWidth:2}),E&&i.createElement("circle",{cx:E.x,cy:E.y,r:3,stroke:"none",fill:"red",onMouseDown:j}))},Fs=({jointId:e})=>{const t=Ns(),n=(0,s.I0)(),o=ht((t=>rn(t,e))),r=ht((t=>Li(t,e))),[c,a]=i.useState(!1),d=i.useCallback(((i,o)=>{const s=t(o);n(H(e,s))}),[t]),l=i.useCallback((()=>{n(U())}),[]),u=i.useCallback((t=>{const i=Ds(Ls(t));n(((e,t="set")=>({type:Ai,payload:{jointIds:Array.isArray(e)?e:[e],mode:t}}))(e,i))}),[e]),{startTracking:p}=Zs({onClick:u,onDragMove:d,onDragEnd:l}),y=i.useCallback((()=>{a(!0)}),[]),f=i.useCallback((()=>{a(!1)}),[]),m=i.useCallback((e=>{p(e)}),[p]);return i.createElement("circle",{className:Oe("WireJoint-module__wire-joint___[fullhash-base64-5]",o&&"WireJoint-module__selected___[fullhash-base64-5]"),cx:r.x,cy:r.y,r:c||o?4:2,onMouseOver:y,onMouseOut:f,onMouseDown:m})},Gs=({connectionId:e})=>{const t=ht((t=>Ji(t,e))),n=ht((t=>Us(t,e))),o=ht((t=>on(t,e))),s=[...t,null].map(((n,o)=>{const s=o>0?t[o-1]:null;return i.createElement(Vs,{key:o,connectionId:e,startJointId:s,endJointId:n})})),r=t.map((e=>i.createElement(Fs,{key:e,jointId:e})));return i.createElement("g",{className:Oe("Wire-module__wire___[fullhash-base64-5]",n&&"Wire-module__powered___[fullhash-base64-5]",o&&"Wire-module__selected___[fullhash-base64-5]")},s,r)},Xs=()=>{const e=ht(_i).map((e=>i.createElement(Gs,{key:e,connectionId:e})));return i.createElement("g",{id:"wires-layer"},e)},qs="NodePin-module__is-drag-target___[fullhash-base64-5]";function Ys(e,t,n,i,o){var s=Ks(e,t,n,o),r=Ks(e,t,n,i),c=o-i<=180?"0":"1";return["M",s.x,s.y,"A",n,n,0,c,0,r.x,r.y].join(" ")}function Ks(e,t,n,i){var o=(i-90)*Math.PI/180;return{x:e+n*Math.cos(o),y:t+n*Math.sin(o)}}const $s=({nodeId:e,pinId:t})=>{const n=Ns(),o=(0,s.I0)(),r=ht((n=>((e,t,n)=>{var i;const o=Mt(e)[t];return o&&null!==(i=o[n])&&void 0!==i?i:y})(n,e,t))),c=ht((n=>((e,t,n)=>{const i=zn(e,t);if(!i)return null;const o=i.pins[n];return o?o.direction:null})(n,e,t))),a=ht(Wt),d=i.useCallback((i=>{const s=n(i);o({type:dn,payload:{dragStart:s,pin:{nodeId:e,pinId:t}}})}),[n,e,t]),l=i.useCallback(((e,t)=>{const i=n(t);o(J(i))}),[n]),u=i.useCallback(((e,t)=>{const i=n(t),s=Ds(Ls(t));o(De(i,s))}),[n]),{startTracking:p}=Zs({onDragStart:d,onDragMove:l,onDragEnd:u}),f=i.useCallback((e=>{e.preventDefault(),e.stopPropagation(),p(e)}),[]);if(!r)return null;const m=null!=a&&a.nodeId===e&&a.pinId===t,{x:I,y:g}=r;return"input"===c?i.createElement("path",{d:Ys(I,g,3,-45,225),className:Oe("NodePin-module__node-pin-input___[fullhash-base64-5]",m&&qs),onMouseDown:f}):i.createElement("circle",{className:Oe("NodePin-module__node-pin-output___[fullhash-base64-5]",m&&qs),cx:I,cy:g,r:3,onMouseDown:f})},Qs=({nodeId:e})=>{var t;const n=ht((t=>zn(t,e))),o=null!==(t=null==n?void 0:n.pins)&&void 0!==t?t:{},s=Object.keys(o).map((t=>i.createElement($s,{key:t,nodeId:e,pinId:t})));return i.createElement(i.Fragment,null,s)},er=()=>{const e=ht(wi).map((e=>i.createElement(Qs,{key:e,nodeId:e})));return i.createElement("g",{id:"node-pins-layer"},e)},tr=()=>{const e=ht(St),t=ht(Tt),n=ht(Jt);return"wire"==e&&t&&n?i.createElement("line",{x1:t.x,y1:t.y,x2:n.x,y2:n.y,stroke:"black",strokeWidth:1}):null},nr=()=>{const e=(0,s.I0)(),t=ht(Es),{width:n,height:o}=h(t),r=i.useRef(null),c=i.useCallback((()=>{var e;null===(e=r.current)||void 0===e||e.focus()}),[]),a=i.useCallback((()=>{e({type:L})}),[]);return i.createElement("div",{className:Oe("circuit-field","CircuitField-module__circuit-editor___[fullhash-base64-5]"),style:{width:n+"px",height:o+"px"}},i.createElement("svg",{tabIndex:-1,ref:r,width:n,height:o,onMouseDown:c,onMouseLeave:a},i.createElement(Bs,{value:r},i.createElement(Ws,null),i.createElement(zs,null),i.createElement(Hs,null),i.createElement(Xs,null),i.createElement(er,null),i.createElement(tr,null),i.createElement(Js,null),i.createElement(ws,null))))},ir=({className:e})=>{const t=i.useRef(null),n=(0,s.I0)(),o=ht(ps),r=i.useMemo((()=>{function e(e){return t=>{if(t){if(t.defaultPrevented)return;t.preventDefault()}n(e)}}return{[Is]:e(Z(1)),[gs]:e({type:ko}),[hs]:e({type:Bi}),[bs]:e({type:Qi}),[Os]:e({type:Rn}),[vs]:e({type:eo})}}),[]),c=i.useCallback((e=>{var t;e.defaultPrevented||e.ctrlKey&&(n((t=e.deltaY>0?-1:1,{type:z,payload:{delta:t}})),e.preventDefault(),e.stopPropagation())}),[]);var a,d,l,u;return a=t,d="wheel",l=c,u={passive:!1},i.useEffect((()=>{if(!a.current)return;const e=a.current;return e.addEventListener(d,l,u),()=>{e.removeEventListener(d,l,u)}}),[a.current,d,l]),i.createElement("div",{className:Oe("circuit-field-view",e,"CircuitFieldView-module__circuit-field-view___[fullhash-base64-5]"),ref:t},i.createElement("div",{className:"CircuitFieldView-module__circuit-field-content___[fullhash-base64-5]"},i.createElement("div",{className:Oe("zoom-container","CircuitFieldView-module__circuit-field-zoom-container___[fullhash-base64-5]"),style:{transform:`scale(${o})`}},i.createElement(us.HotKeys,{keyMap:ks,handlers:r},i.createElement(nr,null)))))};var or=n(3982);const sr=({circuitId:e})=>{const t=(0,s.I0)(),n=ht((t=>vt(t,e))),[o,r]=i.useState(!1),c=i.useCallback((()=>{r(!0)}),[]),a=i.useCallback((()=>{r(!1)}),[]),d=i.useCallback((n=>{t(((e,t)=>({type:yn,payload:{circuitId:e,circuitName:t}}))(e,n)),r(!1)}),[e]),l=i.useCallback((()=>{t((e=>({type:he,payload:{circuitId:e}}))(e))}),[t,e]),u=i.useCallback((t=>{"root"!==e&&(t.preventDefault(),t.stopPropagation(),or.xV.show(i.createElement(or.v2,null,i.createElement(or.sN,{text:"Rename Circuit",onClick:c}),i.createElement(or.R,null),i.createElement(or.sN,{text:"Delete Circuit",onClick:l})),{left:t.pageX,top:t.pageY}))}),[]);return o?i.createElement(or.sL,{isEditing:!0,defaultValue:n,onConfirm:d,onCancel:a}):i.createElement("div",{style:{width:"100%"},onContextMenu:u,onDoubleClick:c},n)},rr=({dispatch:e})=>{const t=i.useCallback((()=>{e(Me())}),[e]);return i.createElement(or.v2,null,i.createElement(or.sN,{text:"New Circuit",onClick:t}))},cr=({nodeType:e})=>{const t=(0,s.I0)(),n=i.useCallback((n=>{n.defaultPrevented||(n.preventDefault(),t(Ae(e)))}),[e]),o=i.useCallback((()=>{t((e=>({type:At,payload:{nodeType:e}}))(e))}),[e]),r=i.useCallback((()=>{t(De({x:-1,y:-1},"set"))}),[]),{startTracking:c}=Zs({onClick:n,onDragStart:o,onDragEnd:r}),a=i.useCallback((e=>{c(e)}),[]),d=ht((t=>_t(t,e)));let l;return l=d?d.visual.component:()=>i.createElement("rect",{fill:"red",x1:0,y1:0,x2:50,y2:50}),i.createElement("div",{onMouseDown:a},i.createElement("svg",{width:75,height:75},i.createElement(l,{elementState:{}})))};function ar(e){return({id:t,path:n})=>i.createElement(ls.h1,{path:n,title:t},i.createElement(e,null))}const dr={"node-tray":ar((()=>{const e=ht(Pt).map((e=>i.createElement(cr,{key:e.type,nodeType:e.type})));return i.createElement("div",{className:"NodeTray-module__nodetray___[fullhash-base64-5]"},i.createElement("div",{className:"NodeTray-module__nodetray-elements___[fullhash-base64-5]"},e))})),"circuit-field":({path:e,id:t})=>{const n=`Circuit Field (${ht(ds)} ms)`;return i.createElement(ls.h1,{path:e,title:n},i.createElement(ir,null))},"circuit-tree":ar((()=>{const e=(0,s.I0)(),t=ht(mn),n=ht(Ot),o=i.useCallback((t=>{var n;e((n=t.id,{type:Ne,payload:{circuitId:n}}))}),[e]),r=i.useCallback((t=>{t.preventDefault(),t.stopPropagation(),or.xV.show(i.createElement(rr,{dispatch:e}),{left:t.pageX,top:t.pageY})}),[e]),c=i.useMemo((()=>Object.keys(n).map((e=>({id:e,label:i.createElement(sr,{circuitId:e}),isSelected:e===t})))),[n,t]);return i.createElement("div",{className:"CircuitsTree-module__circuitstree___[fullhash-base64-5]",onContextMenu:r},i.createElement(or.mp,{contents:c,onNodeClick:o}))}))},lr=({className:e})=>i.createElement("div",{className:e},i.createElement(ls.Iy,{renderTile:(e,t)=>{const n=dr[e];return i.createElement(n,{id:e,path:t})},initialValue:{direction:"row",first:"node-tray",second:{direction:"row",first:"circuit-field",second:"circuit-tree",splitPercentage:60},splitPercentage:20}}));var ur=n(1229);function pr(e,...t){const n=(0,s.I0)();return i.useCallback(((...i)=>{const o=e(...t,...i);o&&n(o)}),[e,...t])}const yr=e=>i.createElement("svg",Object.assign({width:16,height:16},e),i.createElement("path",{d:"M3,0 L13,8 L3,16 z"})),fr=e=>i.createElement("svg",Object.assign({width:16,height:16},e),i.createElement("path",{d:"M1,1 L15,1 L15,15 L1,15 z"})),mr=e=>i.createElement("svg",Object.assign({width:16,height:16},e),i.createElement("path",{d:"M2.5,1 L6.5,1 L6.5,15 L2.5,15 z M9.5,1 L13.5,1 L13.5,15 L9.5,15 z"})),Ir="SimControls-module__button___[fullhash-base64-5]",gr=()=>{const e=ht(Bo),t=ht(Po),n=pr(So),o=pr(Do),s=pr(xo,"toggle");return i.createElement("span",null,e?i.createElement(fr,{className:Oe(Ir,"SimControls-module__button-stop___[fullhash-base64-5]"),onClick:o}):i.createElement(yr,{className:Oe(Ir,"SimControls-module__button-play___[fullhash-base64-5]"),onClick:n}),i.createElement(mr,{className:Oe(Ir,"SimControls-module__button-pause___[fullhash-base64-5]",!e&&"SimControls-module__button--disabled___[fullhash-base64-5]",t&&"SimControls-module__selected___[fullhash-base64-5]"),onClick:s}))},hr=()=>{const e=pr(vn),t=pr(ne),n=pr(Y);return i.createElement(or.v2,null,i.createElement(or.v2.Item,{onClick:e,icon:"new-object",text:"New"}),i.createElement(or.v2.Divider,null),i.createElement(or.v2.Item,{onClick:n,icon:"document-open",text:"Load"}),i.createElement(or.v2.Item,{onClick:t,icon:"saved",text:"Save"}))},br=()=>i.createElement(or.wp,null,i.createElement(or.wp.Group,{align:ur.v.LEFT},i.createElement(or.wp.Heading,null,"Discrelog"),i.createElement(or.wp.Divider,null),i.createElement(or.J2,{content:i.createElement(hr,null)},i.createElement(or.zx,{minimal:!0,icon:"document",text:"File"}))),i.createElement(or.wp.Group,{align:ur.v.RIGHT},i.createElement(gr,null))),Or=Gn((e=>e.dialogType));Gn((e=>e.data));var vr=n(451),kr=n(2609);const jr=()=>{const e=pr(ce),t=pr(se),[n,o]=i.useState(""),s=i.useCallback((e=>{o(e.target.value)}),[]),r=i.useCallback((()=>{""!==n&&t(n)}),[t,n]);return i.createElement(or.Vq,{isOpen:!0,icon:"saved",onClose:e,title:"Save Project",canEscapeKeyClose:!0,canOutsideClickClose:!0},i.createElement("div",{className:vr.DIALOG_BODY},i.createElement(or.BZ,{placeholder:"Project Name",value:n,onChange:s})),i.createElement("div",{className:vr.DIALOG_FOOTER},i.createElement("div",{className:vr.DIALOG_FOOTER_ACTIONS},i.createElement(or.zx,{onClick:e},"Cancel"),i.createElement(or.zx,{intent:kr.S.PRIMARY,disabled:""===n,onClick:r},"Save"))))},Er=()=>{switch(ht(Or)){case"save-project":return i.createElement(jr,null);default:return null}},Cr=document.getElementById("root");o.render(i.createElement(s.zt,{store:cs},i.createElement((()=>i.createElement("div",{className:Oe(as,"flex-module__flex-column___[fullhash-base64-5]")},i.createElement(Er,null),i.createElement(br,null),i.createElement(lr,{className:Oe(as,"flex-module__flexitem-shrink___[fullhash-base64-5]")}))),null)),Cr)},4944:(e,t,n)=>{"use strict";n.d(t,{D:()=>s});var i=n(7294);const o=({shapePath:e,isSelected:t,elementState:n})=>{var o,s;const r=(o=e,s=n,(Array.isArray(o)?o:[o]).map((e=>{if("string"==typeof e)return{path:e,fill:"black",stroke:"black",strokeWidth:2};const t="function"==typeof e.fill?e.fill(s||{}):e.fill,n="function"==typeof e.stroke?e.stroke(s||{}):e.stroke,i="function"==typeof e.strokeWidth?e.strokeWidth(s||{}):e.strokeWidth;return{path:e.path,fill:t,stroke:n,strokeWidth:i}}))).map(((e,n)=>i.createElement("path",{key:n,d:e.path,fill:t?"goldenrod":e.fill,stroke:t?"goldenrod":e.stroke,strokeWidth:e.strokeWidth})));return i.createElement("g",null,r)};function s(e){return t=>i.createElement(o,Object.assign({shapePath:e},t))}},1186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={type:"interaction-toggle",elementProduction:"toggle",visual:{hitPath:"M5,5 L45,5 L45,45 L5,45 z",component:(0,n(4944).D)([{path:"M5,5 L45,5 L45,45 L5,45 z",fill:"#AFAFAF",stroke:"black"},{path:"M10,10 L40,10 L40,40 L10,40 z",fill:e=>e.toggleState?"lightgreen":"darkgreen",stroke:"black"}])},pins:{OUT:{direction:"output",x:45,y:25}}}},1894:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-and",elementProduction:"and",visual:{hitPath:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M31 15H5M32 35H5"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},357:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-buffer",elementProduction:"buffer",visual:{hitPath:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 72,25 L 95.085706,25"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 29.043478,25 L 5.0434781,25"}),i.createElement("path",{className:"node-select-highlight--fill",stroke:"none",fill:"black",d:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z M 31.96875,7.40625 L 68.09375,25 L 31.96875,42.59375 L 31.96875,7.40625 z"}))},pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},2074:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-nor",elementProduction:"nor",visual:{hitPath:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25h16M31 15H5M32 35H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"3",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},8061:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-not",elementProduction:"not",visual:{hitPath:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79.15691 25H95M29.043478 25h-24"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"3",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))},pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},6246:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-or",elementProduction:"or",visual:{hitPath:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M31 15H5M32 35H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2334:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"logic-xor",elementProduction:"xor",visual:{hitPath:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375z",component:()=>i.createElement("g",null,i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M30.38572 15H5M31.3621 35H5"}),i.createElement("g",{fillRule:"evenodd",className:"node-select-highlight--fill"},i.createElement("path",{d:"M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"}),i.createElement("path",{d:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"})))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2944:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const i=`M ${25-20}, 25\n    a 20,20 0 1,0 40,0\n    a 20,20 0 1,0 -40,0`;const o={type:"output-led",elementProduction:"led",visual:{hitPath:i,component:(0,n(4944).D)({path:i,stroke:"black",strokeWidth:3,fill:e=>e.value?"lightgreen":"darkgreen"})},pins:{IN:{direction:"input",x:0,y:25}}}},1460:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(4944);const o=[15,0];function s(e,t){const n=t[0];let i=`M${3*n[0]+o[0]},${3*n[1]+o[1]}`;for(let e of t.slice(1)){const[t,n]=e;i+=`L${3*t+o[0]},${3*n+o[1]}`}return i+="z",{path:i,fill:t=>t[e]?"red":"gray"}}const r={type:"output-seg7",elementProduction:"seg7",visual:{hitPath:"M0,0 V63 H45 V0 z",component:(0,i.D)([s("A",[[1,1],[2,0],[8,0],[9,1],[8,2],[2,2]]),s("B",[[9,1],[10,2],[10,8],[9,9],[8,8],[8,2]]),s("C",[[9,9],[10,10],[10,16],[9,17],[8,16],[8,10]]),s("D",[[9,17],[8,18],[2,18],[1,17],[2,16],[8,16]]),s("E",[[1,17],[0,16],[0,10],[1,9],[2,10],[2,16]]),s("F",[[1,9],[0,8],[0,2],[1,1],[2,2],[2,8]]),s("G",[[1,9],[2,8],[8,8],[9,9],[8,10],[2,10]])])},pins:{A:{direction:"input",x:0,y:5},B:{direction:"input",x:0,y:15},C:{direction:"input",x:0,y:25},D:{direction:"input",x:0,y:35},E:{direction:"input",x:0,y:45},F:{direction:"input",x:0,y:55},G:{direction:"input",x:0,y:65}}}},2554:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"pin-input",visual:{hitPath:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",component:()=>i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h5",stroke:"black",fill:"none"})},pins:{OUT:{direction:"output",x:40,y:25}}}},8420:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(7294);const o={type:"pin-output",visual:{hitPath:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",component:()=>i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M15,25 h-5",stroke:"black",fill:"none"})},pins:{IN:{direction:"input",x:10,y:25}}}}},0,[[1990,1,956,550,90,792,14,80,744,845,105,606,173]]]);
//# sourceMappingURL=client.6e42c61dde3d14224be9.bundle.js.map
(self.webpackChunkdiscrelog=self.webpackChunkdiscrelog||[]).push([[47],{2846:(e,t,n)=>{"use strict";n.d(t,{Tu:()=>r,Xx:()=>i,Vj:()=>o});const r="@element/interact",i=(e,t)=>({type:r,payload:{elementIdPath:e,data:t}});function o(e){return e.type===r}},6319:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={type:"interaction-momentary",category:"input-output",displayName:"Momentary Switch",elementProduction:"input-momentary",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-momentary"},pins:{OUT:{direction:"output",x:50,y:25}}}},8891:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={type:"interaction-toggle",category:"input-output",displayName:"Toggle Switch",elementProduction:"input-toggle",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-toggle"},pins:{OUT:{direction:"output",x:50,y:25}}}},4409:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30z",l={type:"logic-and",category:"logic",displayName:"AND",elementProduction:"logic-and",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),r.createElement("path",{className:"element-select-highlight--fill",d:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},3013:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z",l={type:"logic-buffer",category:"logic",displayName:"Buffer",elementProduction:"logic-buffer",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M72,25 L 100,25"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 29.043478,25 L 5.0434781,25"}),r.createElement("path",{className:"element-select-highlight--fill",stroke:"none",fill:"black",d:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z M 31.96875,7.40625 L 68.09375,25 L 31.96875,42.59375 L 31.96875,7.40625 z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},2050:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7294);const i={type:"logic-nand",category:"logic",displayName:"NAND",elementProduction:"logic-nand",visual:(0,n(7806).v)({p1:{x:24,y:5},p2:{x:80,y:45}},r.createElement("g",{transform:"translate(-10,0)"},r.createElement("path",{d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z",stroke:"none",fill:"transparent"}),r.createElement("path",{className:"element-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 88,25 H110"}),r.createElement("path",{className:"element-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 41,15 L 15,15"}),r.createElement("path",{className:"element-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 42,35 L 15,35"}),r.createElement("path",{className:"element-select-highlight--fill",d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z M 42.857143,7.8571429 C 50.834264,7.8571429 55.918368,7.8571429 58.095238,7.8571429 C 59.285714,7.8571429 59.880952,7.8571429 60.178571,7.8571429 C 60.327381,7.8571429 60.409227,7.8571429 60.446429,7.8571429 C 60.465029,7.8571429 60.471543,7.8571429 60.47619,7.8571429 C 70.236853,7.857143 77.142857,15.497098 77.142857,25 C 77.142857,34.502902 69.760662,42.142857 60,42.142857 L 42.857143,42.142857 L 42.857143,7.8571429 z"}),r.createElement("path",{className:"element-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 79,25 A 4,4 0 1 1 71,25 A 4,4 0 1 1 79,25 z",transform:"translate(9,0)"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},6583:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7294);const i={type:"logic-nor",category:"logic",displayName:"NOR",elementProduction:"logic-nor",visual:(0,n(7806).v)({p1:{x:24,y:5},p2:{x:80,y:45}},r.createElement("g",null,r.createElement("path",{fill:"transparent",stroke:"none",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 h21 M31,15 H5 M32,35 H5"}),r.createElement("path",{className:"element-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},6524:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7294);const i={type:"logic-not",category:"logic",displayName:"NOT",elementProduction:"logic-not",visual:(0,n(7806).v)({p1:{x:24,y:5},p2:{x:80,y:45}},r.createElement("g",null,r.createElement("path",{fill:"transparent",stroke:"none",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625z"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 H100 M29,25 h-24"}),r.createElement("path",{className:"element-select-highlight--fill",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},3183:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",l={type:"logic-or",category:"logic",displayName:"OR",elementProduction:"logic-or",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),r.createElement("path",{className:"element-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},1454:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375z",l={type:"logic-xor",category:"logic",displayName:"XOR",elementProduction:"logic-xor",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M30,15 H5 M31,35 H5"}),r.createElement("g",{fillRule:"evenodd",className:"element-select-highlight--fill"},r.createElement("path",{d:"M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"}),r.createElement("path",{d:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"})))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},3532:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const r=`M ${25-20}, 25\n    a 20,20 0 1,0 40,0\n    a 20,20 0 1,0 -40,0`;const i={type:"output-led",category:"input-output",displayName:"Indicator Light",elementProduction:"output-led",visual:(0,n(6816).J)(r,{path:r,stroke:"black",strokeWidth:3,fill:e=>e.value?"lightgreen":"darkgreen"}),pins:{IN:{direction:"input",x:0,y:25}}}},8112:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(6816);const i=[15,0];function o(e,t){const n=t[0];let r=`M${3*n[0]+i[0]},${3*n[1]+i[1]}`;for(const e of t.slice(1)){const[t,n]=e;r+=`L${3*t+i[0]},${3*n+i[1]}`}return r+="z",{path:r,fill:t=>t[e]?"red":"gray",strokeWidth:0}}const s={type:"output-seg7",category:"input-output",displayName:"7-Segment Display",elementProduction:"output-seg7",visual:(0,r.J)("M15,0 V63 H45 V0 z",[o("A",[[1,1],[2,0],[8,0],[9,1],[8,2],[2,2]]),o("B",[[9,1],[10,2],[10,8],[9,9],[8,8],[8,2]]),o("C",[[9,9],[10,10],[10,16],[9,17],[8,16],[8,10]]),o("D",[[9,17],[8,18],[2,18],[1,17],[2,16],[8,16]]),o("E",[[1,17],[0,16],[0,10],[1,9],[2,10],[2,16]]),o("F",[[1,9],[0,8],[0,2],[1,1],[2,2],[2,8]]),o("G",[[1,9],[2,8],[8,8],[9,9],[8,10],[2,10]])]),pins:{A:{direction:"input",x:0,y:5},B:{direction:"input",x:0,y:15},C:{direction:"input",x:0,y:25},D:{direction:"input",x:0,y:35},E:{direction:"input",x:0,y:45},F:{direction:"input",x:0,y:55},G:{direction:"input",x:0,y:65}}}},5148:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-high",category:"input-output",elementProduction:"pin-high",displayName:"High Pin",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",d:"M25,20 v10 M20,25 h10",fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},2380:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(7294),i=n(669),o=n.n(i),s=n(8370),c=n(784);const l="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",a={type:"pin-input",category:"input-output",displayName:"Input Pin",visual:(0,n(7806).v)((0,s.NG)(o()(l)),r.createElement("g",null,r.createElement("path",{d:l,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",d:(0,c.x)(25,25,3,-45,225),fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},1615:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7294),i=n(669),o=n.n(i),s=n(8370);const c="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-output",category:"input-output",displayName:"Output Pin",visual:(0,n(7806).v)((0,s.NG)(o()(c)),r.createElement("g",null,r.createElement("path",{d:c,fill:"transparent",stroke:"none"}),r.createElement("path",{className:"element-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M15,25 h-12",stroke:"black",strokeWidth:2,fill:"none"}),r.createElement("circle",{className:"element-select-highlight--fill",cx:25,cy:25,r:3,fill:"black",stroke:"none"}))),pins:{IN:{direction:"input",x:0,y:25}}}},6816:(e,t,n)=>{"use strict";n.d(t,{J:()=>d});var r=n(7294),i=n(9242),o=n(669),s=n.n(o),c=n(8370),l=n(2846);const a=({elementId:e,elementPath:t,shapePath:n,hitPath:o,evolverState:s})=>{const c=(0,i.I0)(),a=r.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),c((0,l.Xx)([...t||[],e]))))}),[e,c,t]),u=m(n,s).map(((e,t)=>r.createElement("path",{key:t,d:e.path,className:"element-select-highlight--stroke element-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return r.createElement("g",{onClick:a},r.createElement("path",{d:o,fill:"transparent",stroke:"none"}),u)},u=({shapePath:e,hitRect:t})=>{const n=m(e,{}).map(((e,t)=>r.createElement("path",{key:t,d:e.path,className:"element-select-highlight--stroke element-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return r.createElement("svg",{width:50,height:50,viewBox:`${t.p1.x-5} ${t.p1.y-5} ${t.p2.x-t.p1.x+10} ${t.p2.y-t.p1.y+10}`},n)};function d(e,t){const n=(0,c.NG)(s()(e));return{trayComponent:()=>r.createElement(u,{shapePath:t,hitRect:n}),component:n=>r.createElement(a,Object.assign({shapePath:t,hitPath:e},n)),hitRect:n}}function m(e,t){return(Array.isArray(e)?e:[e]).map((e=>{if("string"==typeof e)return{path:e,fill:"black",stroke:"black",strokeWidth:2};const n="function"==typeof e.fill?e.fill(t||{}):e.fill,r="function"==typeof e.stroke?e.stroke(t||{}):e.stroke,i="function"==typeof e.strokeWidth?e.strokeWidth(t||{}):e.strokeWidth;return{path:e.path,fill:n,stroke:r,strokeWidth:i}}))}},7806:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(7294);function i(e,t){return{hitRect:e,trayComponent:()=>r.createElement("svg",{width:50,height:50,viewBox:`${e.p1.x-5} ${e.p1.y-5} ${e.p2.x-e.p1.x+10} ${e.p2.y-e.p1.y+10}`},t),component:()=>t}}},6503:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});const r=4},4263:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:[],outputPins:["OUT"],interact:(e,t)=>void 0===t?{transitions:[{tickOffset:1,valuesByPin:{OUT:!0}},{tickOffset:1+Math.round(1.5*r.f),valuesByPin:{OUT:!1}}]}:t?{transitions:{tickOffset:1,valuesByPin:{OUT:!0}}}:{transitions:{tickOffset:1,valuesByPin:{OUT:!1}}}}},9028:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const r={toggleState:!1},i={inputPins:[],outputPins:["OUT"],interact(e=r){const t=!e.toggleState;return{state:Object.assign({},e,{toggleState:t}),transitions:{tickOffset:1,valuesByPin:{OUT:t}}}},evolve:(e=r)=>({state:e,transitions:{tickOffset:1,valuesByPin:{OUT:e.toggleState}}})}},2404:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:t.A&&t.B}}})}},3880:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:t.IN}}})}},5813:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:!(t.A&&t.B)}}})}},2791:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:!(t.A||t.B)}}})}},6139:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:!t.IN}}})}},1868:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:t.A||t.B}}})}},6259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var r=n(6503);const i={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:r.f,valuesByPin:{OUT:(t.A||t.B)&&t.A!=t.B}}})}},9480:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={inputPins:["IN"],outputPins:[],evolve:(e,t)=>({state:{value:t.IN}})}},136:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={inputPins:["A","B","C","D","E","F","G"],outputPins:[],evolve:(e,t)=>({state:Object.assign({},t)})}},4303:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={inputPins:[],outputPins:["OUT"],evolve:()=>({transitions:{tickOffset:1,valuesByPin:{OUT:!0}}})}},8370:(e,t,n)=>{"use strict";n.d(t,{Ds:()=>r,rG:()=>i,NG:()=>o,n$:()=>s,R9:()=>c,VE:()=>l,Fv:()=>a,Ih:()=>u,bA:()=>d,Qu:()=>m,gQ:()=>p,ZO:()=>y,sj:()=>f,kg:()=>g,is:()=>I,nF:()=>h,G0:()=>v,jR:()=>E,Lv:()=>b});const r=Object.freeze({x:0,y:0}),i=Object.freeze({p1:r,p2:r});function o(e){return{p1:{x:e[0],y:e[1]},p2:{x:e[2],y:e[3]}}}function s(e,t){return Math.round(e/t)*t}function c(e,t){return{x:s(e.x,t),y:s(e.y,t)}}function l(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function a(e){const t=l(e);return{x:e.x/t,y:e.y/t}}function u(e,t){return e.x*t.x+e.y*t.y}function d(e,t){return{x:e.x*t,y:e.y*t}}function m(...e){let t,n;if(1===e.length){const r=e[0];t=r.p1,n=r.p2}else t=e[0],n=e[1];return{p1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},p2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}}}function p(e,t){return{p1:y(e.p1,t),p2:y(e.p2,t)}}function y(e,t){return{x:e.x+t.x,y:e.y+t.y}}function f(e,t){return{x:e.x-t.x,y:e.y-t.y}}function g(e,t){return e.x===t.x&&e.y===t.y}function I(e,t){return!((t=m(t)).p1.x>e.x||t.p2.x<e.x||t.p1.y>e.y||t.p2.y<e.y)}function h(e){return{width:(e=m(e)).p2.x-e.p1.x,height:e.p2.y-e.p1.y}}function v(e,t){return e=m(e),t=m(t),{p1:{x:Math.min(e.p1.x,t.p1.x),y:Math.min(e.p1.y,t.p1.y)},p2:{x:Math.max(e.p2.x,t.p2.x),y:Math.max(e.p2.y,t.p2.y)}}}function E(e,t){return e=m(e),t=m(t),!(e.p1.x>t.p2.x||e.p2.x<t.p1.x||e.p1.y>t.p2.y||e.p2.y<t.p1.y)}function b(e,t,n,{threshhold:r=4,axialGridSnap:i=0}){const o=f(t,e),c=l(o),m=a(o);if(Number.isNaN(m.x)||Number.isNaN(m.y))return null;const p=u(f(n,e),m);if(p<0||p>c)return null;const g=y(e,d(m,p));i>0&&(1===Math.abs(m.x)&&(g.x=s(g.x,i)),1===Math.abs(m.y)&&(g.y=s(g.y,i)));const I=l(f(n,g));return I>r?null:{interceptPoint:g,interceptLineLengthDistance:l(f(g,e)),interceptLinePointDistance:I}}},999:(e,t,n)=>{"use strict";var r=n(7294),i=n(3935),o=n(1033),s=n(9242),c=n(6550),l=n(862),a=n(7865);const u=(0,n(9731).q_)(),d=Object.freeze({dragMode:null}),m="root",p="root-editor",y={circucitEditorsById:{[p]:{circuitId:m,elementIdPath:[]}},activeEditorId:null},f=Object.freeze(y),g={elementIdsByCircuitId:{[m]:[]},elementsById:{},wireIdsByCircuitId:{[m]:[]},wiresByWireId:{},wireSegmentsById:{},wireJointPositionsByJointId:{}},I=Object.freeze(g),h=Object.freeze({elementPositionsById:{}}),v={circuitNamesByCircuitId:{[m]:"Root"}},E=Object.freeze(v);var b=n(8370);const w=Object.freeze({clipboardElements:[],clipboardPasteOrigin:b.Ds}),j=Object.freeze({dialogType:null,data:null}),O=Object.freeze({projectLoadState:"no-project",projectName:"New Project",projectModified:!1}),k=Object.freeze({selectedElementIds:[],selectedWireJointIds:[],selectedWireSegmentIds:[]}),x=Object.freeze({initialized:!1,tick:0,lastTickProcessingTimeMs:0,evolverStatesByEvolverId:{},evolverOutputValuesByEvolverId:{},transitionsById:{},transitionWindows:[]}),C=Object.freeze({mode:"edit",ticksPerSecond:1e3}),B=Object.freeze({activeTutorial:null,annotatedElements:[],preTutorialState:null});var P=n(7361),N=n.n(P);function S(...e){return e.filter((e=>Boolean(e)&&""!=e)).join(" ")}function M(...e){return W(e[0],e.slice(1,e.length-1).map(String),e[e.length-1])}function W(e,t,n){if(0===t.length)return"function"==typeof n?n(e):n;const r=t.slice(0,t.length-1).map(String),i=t[t.length-1],o=z(e);let s=o;for(const e of r)s[e]=z(s[e]),s=s[e];return s[i]="function"==typeof n?n(s[i]):n,o}function z(e){return Array.isArray(e)?e.slice():Object.assign({},e)}function L(e){return Boolean(e)}const T="fill-parent--3pw6U",R={"flex-row":"flex-row--sHjOY","flex-column":"flex-column--2LT64","flex-space-around":"flex-space-around--1tYx1","flex-reverse":"flex-reverse--2Vn7L","flexitem-grow":"flexitem-grow--7seUA","flexitem-shrink":"flexitem-shrink--2U9EV","flexitem-fix":"flexitem-fix--1ARxk"};var D=n(8721),A=n.n(D);function J(e){return"string"==typeof e?{windowId:e}:e}function U(e){return A()(e,"windowId")}function Z(e){return A()(e,"first")&&A()(e,"second")&&A()(e,"direction")}function F(e){return"number"==typeof e?{firstPercent:e}:e}function K(e){return A()(e,"firstPercent")}function $(e){return A()(e,"firstSize")||A()(e,"secondSize")}var H=n(3493),G=n.n(H);function Y(e){const t=r.useRef(e);return r.useEffect((()=>{t.current=e})),t}const V={tessel:"tessel--2Q3Xd","tessel-content":"tessel-content--3-kEA","tessel-drop-capture":"tessel-drop-capture--3TbuI","tessel-drop-capture--dragging":"tessel-drop-capture--dragging--Ihwyz","tessel-drop-marker":"tessel-drop-marker--1cqr2","drop-left":"drop-left--wqP1V","drop-right":"drop-right--2MyGz","drop-top":"drop-top--1S0co","drop-bottom":"drop-bottom--2f330","tessel-split":"tessel-split--2gDs5","tessel-split--row":"tessel-split--row--2fC6o","tessel-split--column":"tessel-split--column--1Hl4C","tessel-window":"tessel-window--1qDgp","tessel-window-titlebar":"tessel-window-titlebar--uHBdn","tessel-window-title":"tessel-window-title--2v0hT","tessel-window-controls":"tessel-window-controls--3i3ou","tessel-window-controls-close":"tessel-window-controls-close--2O8Zs","tessel-window-content":"tessel-window-content--sOnG-"},q=Object.freeze({top:0,left:0,bottom:0,right:0,x:0,y:0,height:0,width:0,toJSON:()=>({})}),X=({direction:e,onChangePercentage:t})=>{const n=r.useRef(null),i=r.useRef(null),o=Y(e),s=Y(t),c=r.useMemo((()=>G()((e=>{var t,r;if(null==i.current||null==n.current)return;const c=null!==(r=null===(t=n.current.parentElement)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==r?r:q;let l=0,a=0;"row"===o.current?(a=e.pageX-c.left,l=a/c.width,isNaN(l)?(l=0,a=c.left):l>1&&(l=1,a=c.right)):(a=e.pageY-c.top,l=a/c.height,isNaN(l)?(l=0,a=c.top):l>1&&(l=1,a=c.bottom)),s.current(100*l,a)}),1e3/60,{leading:!0})),[o,s]),l=r.useCallback((e=>{e.persist(),c(e)}),[c]),a=r.useCallback((e=>{!e.defaultPrevented&&n.current&&(i.current||(e.preventDefault(),n.current.setPointerCapture(e.pointerId),i.current=e.pointerId))}),[]),u=r.useCallback((()=>{n.current&&i.current&&(n.current.releasePointerCapture(i.current),i.current=null)}),[]);return r.createElement("div",{ref:n,className:S("tessel-split",V["tessel-split"],V["row"===e?"tessel-split--row":"tessel-split--column"]),onPointerDown:a,onPointerMove:l,onPointerUp:u})},Q=r.createContext([]);function _(){return r.useContext(Q)}const ee=({pathKey:e,children:t})=>{const n=_(),i=r.useMemo((()=>[...n,e]),[n,e]);return r.createElement(Q.Provider,{value:i},t)};function te(){}const ne=r.createContext({moveWindow:te,closeWindow:te});function re(){return r.useContext(ne)}const ie=({moveWindow:e,closeWindow:t,children:n})=>{const i=r.useMemo((()=>({moveWindow:e,closeWindow:t})),[e,t]);return r.createElement(ne.Provider,{value:i},n)};function oe(e,t,n){return K(e)?{firstPercent:t}:$(e)?"number"==typeof e.secondSize?{secondSize:n}:{firstSize:n}:e}const se=({item:e,renderWindow:t,onLayoutChange:n})=>{const{direction:i,first:o,second:s,division:c}=e,l="row"===i?"width":"height",a=r.useCallback(((t,r)=>{const i=F(e.division);n(Object.assign(Object.assign({},e),{division:oe(i,t,r)}))}),[e,n]),u=r.useCallback((t=>{n(Object.assign(Object.assign({},e),{first:t}))}),[e,n]),d=r.useCallback((t=>{n(Object.assign(Object.assign({},e),{second:t}))}),[e,n]),m=F(c);let p="50%",y="50%",f=!1,g=!1;if(K(m)){const{firstPercent:e}=m;p=e+"%",y=100-e+"%"}else if($(m)){const{firstSize:e,secondSize:t}=m;e?(p=e+"px",f=!0,y="100%"):(p="100%",y=t+"px",g=!0)}return r.createElement("div",{className:S(T,R["row"===i?"flex-row":"flex-column"])},r.createElement("div",{className:S(f?R["flexitem-fix"]:R["flexitem-shrink"]),style:{[l]:p}},r.createElement(ee,{pathKey:"first"},r.createElement(ce,{value:o,renderWindow:t,onLayoutChange:u}))),r.createElement(X,{direction:i,onChangePercentage:a}),r.createElement("div",{className:S(g?R["flexitem-fix"]:R["flexitem-shrink"]),style:{[l]:y}},r.createElement(ee,{pathKey:"second"},r.createElement(ce,{value:s,renderWindow:t,onLayoutChange:d}))))},ce=({value:e,renderWindow:t,onLayoutChange:n})=>{const i=J(e);return U(i)?t(i):Z(i)?r.createElement(se,{item:i,renderWindow:t,onLayoutChange:n}):null};function le(e){return Array.isArray(e)?e:[e]}function ae(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>t[n]===e))}const ue=Object.freeze([]);function de(){return ue}function me(e,t){const n=e.slice(0,t);for(let r=t+1;r<e.length;r++)n.push(e[r]);return n}function pe(e){const[t,n]=r.useState({left:0,top:0,right:0,bottom:0,width:0,height:0});return r.useLayoutEffect((()=>{if(!e.current)return;const t=new o.Z((()=>{const t=e.current;if(!t)return;const r=t.getBoundingClientRect();n({top:r.top,left:r.left,right:r.right,bottom:r.bottom,width:r.width,height:r.height})}));return t.observe(e.current),()=>{t.disconnect()}}),[e]),t}var ye=n(9240);const fe="@tessel/window",ge=e=>({type:fe,payload:{path:e}});function Ie(e){return e.type===fe}const he=r.forwardRef((({className:e,id:t,children:n},i)=>{const o=_(),{moveWindow:s}=re(),c=r.useRef(null),{top:l,left:a,right:u,bottom:d}=pe(c),[m,p]=r.useState(null),y=r.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return void p(null);const n=t.getClientOffset();if(null==e||null==n||!Ie(e))return void p(null);if(n.x<a||n.x>u)return void p(null);if(n.y<l||n.y>d)return void p(null);const r=(n.x-a)/(u-a);if(r<=.3)return void p("left");if(r>=.6)return void p("right");const i=(n.y-l)/(d-l);p(i<=.3?"top":i>=.6?"bottom":null)}),[l,a,u,d]),f=r.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return;if(!Ie(e))return;const{path:n}=e.payload;ae(n,o)||null!=m&&s(n,o,m)}),[o,m,s]),[{draggingSelf:g},I]=(0,ye.L)({accept:fe,collect:e=>{e.isOver({shallow:!0})||p(null);const t=e.getItem();return t&&Ie(t)?{draggingSelf:ae(t.payload.path,o)}:{}},hover:y,drop:f},[y,f]);let h=V["tessel-drop-marker"]+" ";if(null!=m&&!g)switch(m){case"bottom":h+=V["drop-bottom"];break;case"top":h+=V["drop-top"];break;case"left":h+=V["drop-left"];break;case"right":h+=V["drop-right"]}return r.createElement("div",{id:t,ref:e=>{c.current=e,I(e),"function"==typeof i?i(e):i&&(i.current=e)},className:S(V["tessel-drop-capture"],g&&V["tessel-drop-capture--dragging"],e)},n,r.createElement("div",{className:h}))}));function ve(e,t){var n;if(!t(e))return null;const r=J(e);if(Z(r)){const i=ve(r.first,t),o=ve(r.second,t);return i&&o?e:null!==(n=null!=i?i:o)&&void 0!==n?n:null}return e}function Ee(e){return"string"==typeof e?e:Z(e)?null==e.first?Ee(e.second):null==e.second?Ee(e.first):Object.assign(Object.assign({},e),{first:Ee(e.first),second:Ee(e.second)}):e}const be=({className:e,rootItem:t,renderWindow:n,onLayoutChange:i})=>{const o=r.useCallback(((e,n,r)=>{if(0===e.length)return;let o=t;const s=N()(o,e);o&&"string"!=typeof o&&s&&(n.length>0&&!N()(o,n)||(o=W(o,e,null),o=W(o,n,(e=>{let t;if("left"===r||"right"===r)t={direction:"row",division:50,first:"left"===r?s:e,second:"right"===r?s:e};else{if("top"!==r&&"bottom"!==r)throw new Error("Unknown tessel position: "+r);t={direction:"column",division:50,first:"top"===r?s:e,second:"bottom"===r?s:e}}return t})),o=Ee(o),i(o)))}),[t,i]),s=r.useCallback((e=>{let n=t;n&&("string"!=typeof n?(n=W(n,e,null),n=Ee(n),i(n)):0===e.length&&i(null))}),[i,t]);return r.createElement("div",{className:S("tessel",V.tessel,e)},r.createElement(ie,{moveWindow:o,closeWindow:s},r.createElement(he,null,r.createElement("div",{className:V["tessel-content"]},t&&r.createElement(ce,{value:t,renderWindow:n,onLayoutChange:i})))))},we="circuit-field",je=e=>({windowId:we,windowProps:{editorId:e}});function Oe(e){return"string"!=typeof e&&!!U(e)&&e.windowId===we}const ke={layout:{direction:"row",division:{firstSize:200},first:{direction:"column",division:30,first:"circuits-list",second:"element-tray"},second:je(p)}},xe=Object.freeze(ke),Ce=Object.freeze({elementNameMode:"named-only"}),Be={circuitEditorDrag:d,circuitEditors:f,circuitGraph:I,circuitLayout:h,circuitProperties:E,clipboard:w,dialog:j,project:O,selection:k,simulator:x,simulatorControl:C,tutorial:B,uiLayout:xe,uiSettings:Ce},Pe=Object.freeze(Be),Ne=["circuitProperties","circuitGraph","circuitLayout"],Se={services:Pe,undo:Object.freeze({undoStack:[],redoStack:[]})},Me=Object.freeze(Se);var We=n(4890),ze=(n(2729),n(7172));const Le=new URL(window.location.origin);Le.pathname=n.p;const Te=Le.toString();var Re=n(4586);const De="@circuit/add",Ae=({circuitName:e,circuitId:t,edit:n}={})=>({type:De,payload:{circuitId:null!=t?t:(0,Re.Z)(),circuitName:e,edit:n}});function Je(e){return e.type===De}const Ue="@circuit/delete";function Ze(e){return e.type===Ue}const Fe="@circuit/rename",Ke="@element/add",$e=(e,t,n,r)=>({type:Ke,payload:Object.assign({elementId:(0,Re.Z)(),elementType:e,circuitId:t,position:n},r||{})});function He(e){return e.type===Ke}const Ge="@element/delete";function Ye(e){return e.type===Ge}const Ve="@element/rename",qe="@selection/align-to-grid",Xe=()=>({type:qe}),Qe="@selection/delete",_e=()=>({type:Qe}),et="@selection/move",tt="@clipboard/paste",nt=(e={})=>({type:tt,payload:Object.assign({},e)}),rt="@circuit-editor/drag/end",it="@undo/undo",ot=()=>({type:it});function st(e){return e.type===it}const ct="@undo/redo",lt=()=>({type:ct});function at(e){return e.type===ct}const ut="@project/new",dt=()=>({type:ut});function mt(e){return e.type===ut}const pt="@project/receive",yt=(e,t)=>({type:pt,payload:{fileName:e,saveData:t}}),ft="@wire/connect",gt=(e,t,n)=>({type:ft,payload:{circuitId:e,from:t,to:n}}),It="@wire/hydrate",ht=e=>({type:It,payload:e}),vt="@wire/joint/move",Et=(e,t,{relative:n=!1,snapMode:r="none"}={})=>({type:vt,payload:{jointIds:le(e),position:t,relative:n,snapMode:r}}),bt="@wire/joint/delete";function wt(e){return e.type===bt}const jt="@wire/segment/insert-joint",Ot="@wire/segment/set-line",kt=(e,t)=>({type:Ot,payload:{wireSegmentId:e,lineId:t}}),xt=[De,Ue,Fe,Ke,Ge,Ve,qe,Qe,et,it,ct,ft,It,vt,bt,jt,Ot,tt,rt];function Ct(e){return-1!==xt.indexOf(e.type)}var Bt=n(8718),Pt=n.n(Bt),Nt=n(8804),St=n.n(Nt);function Mt(e){return t=>(n=Me,r)=>{const i=t(n.services[e],r,n);return n.services[e]!=i?M(n,"services",e,i):n}}function Wt(e){return t=>{const n=(n,...r)=>t(n.services[e],...r);return n.local=t,n}}const zt=Mt("circuitEditors"),Lt=Wt("circuitEditors"),Tt=Lt(((e,t)=>e.circucitEditorsById[t])),Rt=(e,t)=>{const n=Tt(e,t);return n?n.circuitId:null},Dt=Lt((e=>{if(e.activeEditorId)return e.activeEditorId;const t=Object.keys(e.circucitEditorsById);return t.length>0?t[0]:null})),At=Lt((e=>e.activeEditorId?e.circucitEditorsById[e.activeEditorId]:null)),Jt=Lt((e=>{if(!e.activeEditorId)return null;const t=e.circucitEditorsById[e.activeEditorId];return t?t.circuitId:null})),Ut=Lt(((e,t)=>Object.keys(e.circucitEditorsById).filter((n=>e.circucitEditorsById[n].circuitId===t))));function Zt(e){let t=null;const n=At(e);return n&&(t=n.circuitId),{serviceStates:Pt()(e.services,Ne),viewCircuitId:t}}var Ft=n(928),Kt=n.n(Ft),$t=n(9734),Ht=n.n($t);function Gt(...e){return[].concat(...e)}const Yt="@circuit-editor/drag/abort",Vt=()=>({type:Yt}),qt=Mt("circuitEditorDrag"),Xt=Wt("circuitEditorDrag"),Qt=qt(((e,t)=>function(e){return e.type===Yt}(t)?d:e)),_t="@circuit-editor/drag/continue",en=qt(((e,t)=>{if(!function(e){return e.type===_t}(t))return e;const{dragPos:n,modifierKeys:r,editorId:i}=t.payload;return Object.assign(Object.assign({},e),{dragEnd:n,dragEndEditorId:i,dragModifierKeys:r})}));var tn=n(3386),nn=n.n(tn),rn=n(1966),on=n.n(rn);function sn(e,t="set"){return e.shiftKey&&e.ctrlMetaKey?"remove":e.shiftKey?"append":e.ctrlMetaKey?"toggle":t}function cn(e,t,n){switch(n){case"set":return t;case"set-if-unselected":return t.every((t=>-1!==e.indexOf(t)))?e:t;case"append":return nn()(e,t);case"remove":return on()(e,t);case"toggle":return on()(e,t).concat(on()(t,e))}return t}function ln(e,t){switch(t){case"append":case"remove":return e}return[]}const an="@select/region",un=Xt((()=>50)),dn=Xt((()=>5)),mn=(e,t)=>{const n=un(e);return(0,b.R9)(t,n)},pn=(e,t)=>{const n=dn(e);return(0,b.R9)(t,n)};var yn=n(2222),fn=n(6604),gn=n.n(fn);const In=Mt("circuitGraph"),hn=Wt("circuitGraph");function vn(e,t,n){const r=e.wiresByWireId[t],i=new Set;for(const t of r.wireSegmentIds){const r=e.wireSegmentsById[t];switch(r.type){case"input":case"output":r.jointId===n&&i.add(t);break;case"bridge":r.jointAId!==n&&r.jointBId!==n||i.add(t)}}return Array.from(i)}function En(e){switch(e.type){case"bridge":return[e.jointAId,e.jointBId];case"input":case"output":return[e.jointId];default:return[]}}function bn(e,t){const n=e.wiresByWireId[t];if(!n)return[[],[]];const r=new Set,i=new Set;for(const t of n.wireSegmentIds){const n=e.wireSegmentsById[t];"input"===n.type?r.add(n.lineId):"output"===n.type&&i.add(n.lineId)}return[Array.from(r),Array.from(i)]}const wn=hn((e=>e.elementsById)),jn=hn((0,yn.P1)(wn.local,(e=>Object.keys(e)))),On=hn((0,yn.P1)(wn.local,(e=>gn()(e,(e=>e.elementType))))),kn=hn(((e,t)=>e.elementsById[t]||null)),xn=hn(((e,t)=>{const n=[];for(const r of Object.keys(e.elementsById)){const{elementType:i}=e.elementsById[r];i===t&&n.push(r)}return n})),Cn=hn(((e,t)=>{const n=kn.local(e,t);return n?n.elementType:null})),Bn=hn((e=>e.elementIdsByCircuitId)),Pn=Object.freeze([]),Nn=hn(((e,t)=>{var n;return null!==(n=e.elementIdsByCircuitId[t])&&void 0!==n?n:Pn})),Sn=hn(((e,t)=>{for(const n of Object.keys(e.elementIdsByCircuitId))if(-1!==e.elementIdsByCircuitId[n].indexOf(t))return n;return null})),Mn=hn((0,yn.P1)((e=>e.elementsById),(e=>gn()(e,(e=>e.elementName))))),Wn=hn(((e,t)=>{var n;const r=kn.local(e,t);return r?null!==(n=r.elementName)&&void 0!==n?n:t.substr(0,4):null})),zn=hn(((e,t)=>{const n=kn.local(e,t);return n?n.elementName:null}));var Ln=n(4654),Tn=n.n(Ln),Rn=n(3311),Dn=n.n(Rn),An=n(669),Jn=n.n(An);const Un=Mt("circuitLayout"),Zn=Wt("circuitLayout"),Fn=Zn((e=>e.elementPositionsById)),Kn=Zn(((e,t)=>{var n;return null!==(n=e.elementPositionsById[t])&&void 0!==n?n:b.Ds})),$n=Mt("circuitProperties"),Hn=Wt("circuitProperties"),Gn=Hn((e=>Object.keys(e.circuitNamesByCircuitId))),Yn=Hn((e=>e.circuitNamesByCircuitId)),Vn=Hn(((e,t)=>e.circuitNamesByCircuitId[t]));function qn(e){return"ic-"+e}function Xn(e){return e&&e.startsWith("ic-")?e.substr(3):null}function Qn(e,t){return`M10,10 h80 v${50*Math.max(e,t,1)-20} h-80 z`}function _n(e,t){return{x:"input"===t?0:100,y:50*e+25}}const er=[(0,yn.P1)((e=>Bn.local(e.circuitGraph)),(e=>On.local(e.circuitGraph)),(e=>Fn.local(e.circuitLayout)),(e=>Yn.local(e.circuitProperties)),((e,t,n,i)=>Object.keys(e).filter((e=>e!==m)).map((o=>{var s,c;const l=null!==(s=e[o])&&void 0!==s?s:[],a=null!==(c=i[o])&&void 0!==c?c:o.substr(0,5);let u=l.filter((e=>t[e].startsWith("pin-")));u=Ht()(u,(e=>n[e].y),(e=>n[e].x));const d={},m=[],p=[];for(const e of u){const n=t[e];"pin-input"===n?(d[e]=Object.assign({direction:"input"},_n(m.length,"input")),m.push(e)):"pin-output"===n&&(d[e]=Object.assign({direction:"output"},_n(p.length,"output")),p.push(e))}const y={circuitId:o,inputPinIds:m,outputPinIds:p};return{type:qn(o),category:"integrated-circuit",displayName:a,elementProduction:{type:"circuit",circuitId:o},visual:{hitRect:(0,b.NG)(Jn()(Qn(m.length,p.length))),trayComponent:()=>r.createElement("g",{stroke:"black",strokeWidth:1},r.createElement("rect",{x:10,y:10,width:30,height:30,fill:"none"}),r.createElement("line",{x1:10,y1:15,x2:5,y2:15}),r.createElement("line",{x1:40,y1:15,x2:45,y2:15}),r.createElement("line",{x1:10,y1:35,x2:5,y2:35}),r.createElement("line",{x1:40,y1:35,x2:45,y2:35})),component:"integrated-circuit",componentProps:y},pins:d}})))),n(6319).Z,n(8891).Z,n(4409).Z,n(3013).Z,n(2050).Z,n(6583).Z,n(6524).Z,n(3183).Z,n(1454).Z,n(3532).Z,n(8112).Z,n(5148).Z,n(2380).Z,n(1615).Z],tr=(0,yn.P1)((e=>e.services.circuitGraph),(e=>e.services.circuitLayout),(e=>e.services.circuitProperties),((e,t,n)=>({circuitGraph:e,circuitLayout:t,circuitProperties:n}))),nr=(0,yn.P1)(tr,(e=>Tn()(er,(t=>function(e,t){let n;return n="function"==typeof e?e(t):e,le(n)}(t,e))))),rr=(0,yn.P1)(nr,(e=>{const t={};for(const n of e)t[n.type]=n;return t})),ir=(e,t)=>{var n;const r=nr(e);return null!==(n=Dn()(r,(e=>e.type===t)))&&void 0!==n?n:null},or=(0,yn.P1)(rr,Fn,On,((e,t,n)=>{var r;const i={},o=Object.keys(n);for(const s of o){const o={};i[s]=o;const c=null!==(r=t[s])&&void 0!==r?r:b.Ds,l=n[s];if(!l)continue;const a=e[l];if(!a)continue;const u=Object.keys(a.pins);for(const e of u){const t=a.pins[e],n=(0,b.ZO)(c,t);o[e]=n}}return i})),sr=(e,t,n)=>{var r;const i=or(e)[t];return i&&null!==(r=i[n])&&void 0!==r?r:b.Ds};var cr=n(2628),lr=n.n(cr),ar=n(4908),ur=n.n(ar);function dr(e,t){const n=Tn()(t,(e=>[e,"subElementIds"]));n.pop();const r=N()(e,n);if(!r)return null;const{evolverId:i}=r;return null!=i?i:null}function mr(e,t){return e.elementId===t.elementId&&e.pinId===t.pinId}function pr(e){return"output"===e.type}function yr(e){return"input"===e.type}function fr(e){return"input-output"===e.type}function gr(e){return"input"===e.type||"input-output"===e.type}const Ir=hn((0,yn.P1)((e=>e.wiresByWireId),(e=>e.wireSegmentsById),((e,t)=>{const n=[],r=Object.keys(e);for(const i of r){const{wireSegmentIds:r}=e[i],o=r.map((e=>t[e]));for(const e of o)if(fr(e))n.push({inputPin:e.inputPin,outputPin:e.outputPin});else if(pr(e)){const t=o.filter(yr).filter((({lineId:t})=>t===e.lineId));for(const r of t)n.push({outputPin:e.outputPin,inputPin:r.inputPin})}}return n})));var hr=n(3857),vr=n.n(hr);const Er=Object.freeze({evolversById:{},evolverIdsByElementId:{},inputElementPinsByCircuitPinId:{},outputElementPinsByCircuitPinId:{}});function br(e,t,n=[]){var r;if(-1!==n.indexOf(e))throw new Error(`Circuit graph encountered loop on ${n.join(" => ")} while trying to add circuit ${e}`);n=[...n,e];const i={},o={},s={},c={},l=[],a=[],u={},d={},m=null!==(r=t.elementIdsByCircuitId[e])&&void 0!==r?r:[];for(const e of m){const r=t.elementTypesByElementId[e];if(!r)continue;if("pin-input"===r){l.push(e),s[e]=[];continue}if("pin-output"===r){a.push(e);continue}const c=wr(e,t,n);vr()(i,c.evolversById),vr()(o,c.evolverIdsByElementId),u[e]=c.inputElementPinsByCircuitPinId,d[e]=c.outputElementPinsByCircuitPinId}for(const{inputPin:e,outputPin:n}of t.connections){if(-1===m.indexOf(e.elementId)||-1===m.indexOf(n.elementId))continue;const t=N()(d,[n.elementId,n.pinId]),r=N()(u,[e.elementId,e.pinId]);if(-1!==l.indexOf(n.elementId)&&r){s[n.elementId].push(...r);continue}if(-1!==a.indexOf(e.elementId)&&t){c[e.elementId]=t;continue}if(!t||!r)continue;const o=i[t.evolverId];let p=o.outputsByPin[t.pinId];null==p&&(o.outputsByPin[t.pinId]=p=[]);for(const e of r)p.push({evolverId:e.evolverId,pinId:e.pinId}),i[e.evolverId].inputsByPin[e.pinId]={evolverId:t.evolverId,pinId:t.pinId}}return{evolversById:i,evolverIdsByElementId:o,inputElementPinsByCircuitPinId:s,outputElementPinsByCircuitPinId:c}}function wr(e,t,n){const r=t.elementTypesByElementId[e];if(!r)return Er;const i=t.elementDefsByElementType[r];if(!i||!i.elementProduction)return Er;const o="string"==typeof(s=i.elementProduction)?{type:"element",evolverType:s}:s;var s;switch(o.type){case"element":return function(e,t,{elementTypesByElementId:n,elementDefsByElementType:r}){const i=r[n[e]];if(!i)return Er;const o={},s={},c=(0,Re.Z)();o[c]={evolverType:t.evolverType,inputsByPin:{},outputsByPin:{}},s[e]={evolverId:c,subElementIds:{}};const l={},a={};for(const e of Object.keys(i.pins)){const{direction:t}=i.pins[e];"input"===t?l[e]=[{pinId:e,evolverId:c}]:"output"===t&&(a[e]={pinId:e,evolverId:c})}return{evolversById:o,evolverIdsByElementId:s,inputElementPinsByCircuitPinId:l,outputElementPinsByCircuitPinId:a}}(e,o,t);case"circuit":return function(e,t,n,r){const i=br(t.circuitId,n,r);return Object.assign(Object.assign({},i),{evolverIdsByElementId:{[e]:{evolverId:null,subElementIds:i.evolverIdsByElementId}}})}(e,o,t,n);default:throw new Error("Unsupported production type "+o.type)}}const jr=Object.freeze({evolversById:{},evolverIdsByElementId:{}}),Or=(0,yn.P1)(Bn,On,Ir,rr,((e,t,n,r)=>{try{return br(m,{elementIdsByCircuitId:e,elementTypesByElementId:t,connections:n,elementDefsByElementType:r})}catch(e){return console.error(e),jr}})),kr=(e,t)=>{const{evolverIdsByElementId:n}=Or(e),r=e.services.simulator.evolverOutputValuesByEvolverId,i=dr(n,t);if(i)return r[i]},xr=hn((e=>e.wiresByWireId)),Cr=(0,yn.P1)(xr,(e=>Object.keys(e))),Br=hn((e=>e.wireSegmentsById)),Pr=(hn((0,yn.P1)(Br.local,(e=>lr()(e)))),hn(((e,t)=>{const n=e.wiresByWireId[t];return n?n.wireSegmentIds:de()}))),Nr=hn(((e,t)=>{for(const n of Object.keys(e.wiresByWireId)){const{wireSegmentIds:r}=e.wiresByWireId[n];if(-1!==r.indexOf(t))return n}return null})),Sr=hn(((e,t)=>{const n=e.wiresByWireId[t];return n?n.wireJointIds:de()})),Mr=hn(((e,t)=>{const n=Wr.local(e,t);if(!n)return null;for(const t of Object.keys(e.wireIdsByCircuitId))if(-1!==e.wireIdsByCircuitId[t].indexOf(n))return t;return null})),Wr=hn(((e,t)=>{for(const n of Object.keys(e.wiresByWireId)){const{wireJointIds:r}=e.wiresByWireId[n];if(-1!==r.indexOf(t))return n}return null})),zr=hn(((e,t)=>{const n=e.wireSegmentsById[t];return n?n.type:null})),Lr=hn(((e,t)=>{const n=Pr.local(e,t),r=Tn()(n,(t=>En(Tr.local(e,t))));return ur()(r)})),Tr=hn(((e,t)=>{var n;return null!==(n=e.wireSegmentsById[t])&&void 0!==n?n:null})),Rr=hn(((e,t,n)=>{const r=Object.keys(e.wiresByWireId);for(const i of r){const r=e.wiresByWireId[i];for(const i of r.wireSegmentIds){const r=e.wireSegmentsById[i];if(gr(r)&&mr(r.inputPin,{elementId:t,pinId:n}))return i;if(pr(r)&&mr(r.outputPin,{elementId:t,pinId:n}))return i}}return null})),Dr=hn(((e,t,n)=>{const r=Rr.local(e,t,n);return!!r&&gr(e.wireSegmentsById[r])})),Ar=hn(((e,t)=>{var n;return null!==(n=e.wireIdsByCircuitId[t])&&void 0!==n?n:de()})),Jr=hn(((e,t)=>{for(const n of Object.keys(e.wireIdsByCircuitId))if(-1!==e.wireIdsByCircuitId[n].indexOf(t))return n;return null})),Ur=hn(((e,t)=>{const n=e.wireIdsByCircuitId[t];return Tn()(n,(t=>e.wiresByWireId[t].wireJointIds))})),Zr=hn(((e,t)=>{const n=e.wireIdsByCircuitId[t];return Tn()(n,(t=>e.wiresByWireId[t].wireSegmentIds))})),Fr=hn(((e,t)=>{const n=Wr.local(e,t);if(!n)return de();const r=e.wiresByWireId[n],i=[];for(const n of r.wireSegmentIds)-1!==En(e.wireSegmentsById[n]).indexOf(t)&&i.push(n);return i})),Kr=(0,yn.P1)((e=>e.services.circuitGraph),(e=>{const t={};for(const n of Object.keys(e.wiresByWireId))$r(n,t,e);return t}));function $r(e,t,n){const r=n.wiresByWireId[e];if(r)for(const i of r.wireSegmentIds){const r=n.wireSegmentsById[i];fr(r)?Gr(t,i,r.outputPin):pr(r)&&Hr(e,i,null,r,t,n)}}function Hr(e,t,n,r,i,o){const s=o.wireSegmentsById[t];if(yr(s))return s.lineId===r.lineId&&(Gr(i,t,r.outputPin),!0);const c=St()(En(s).filter((e=>e!==n)));if(!c)return!1;const l=vn(o,e,c).filter((e=>e!==t));let a=!1;for(const t of l)Hr(e,t,c,r,i,o)&&(a=!0);return a&&Gr(i,t,r.outputPin),a}function Gr(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}const Yr=(e,t,n)=>{const r=Kr(e)[n];return!!r&&r.some((n=>function(e,t,n){const r=Vr(e,t,n);return!!r&&((e,t,n)=>{var r;const i=kr(e,t);return!!i&&null!==(r=i[n])&&void 0!==r&&r})(e,[...r.elementIdPath,r.elementPin.elementId],r.elementPin.pinId)}(e,t,n)))};function Vr(e,t,n){const r=Cn(e,n.elementId);if("pin-input"===r){const r=t[t.length-1],i=t.slice(0,t.length-1),o=qr(e,{elementId:r,pinId:n.elementId});return o?Vr(e,i,o):null}if(null!=Xn(r)){const r=[...t,n.elementId],i=qr(e,{elementId:n.pinId,pinId:"IN"});return i?Vr(e,r,i):null}return{elementIdPath:t,elementPin:n}}function qr(e,t){const{wiresByWireId:n,wireSegmentsById:r}=e.services.circuitGraph,i=Object.keys(n);for(const e of i){const i=n[e];for(const e of i.wireSegmentIds){const n=r[e];if(gr(n)&&mr(n.inputPin,t)){if("input-output"===n.type)return n.outputPin;{const e=Dn()(i.wireSegmentIds.map((e=>r[e])).filter(pr),(e=>n.lineId===e.lineId));return e?e.outputPin:null}}}}return null}const Xr=hn((e=>e.wireJointPositionsByJointId)),Qr=hn(((e,t)=>{var n;return null!==(n=e.wireJointPositionsByJointId[t])&&void 0!==n?n:b.Ds})),_r=(e,t)=>{const n=Tr(e,t);switch(n.type){case"output":case"input-output":{const{outputPin:t}=n;return sr(e,t.elementId,t.pinId)}case"input":{const{jointId:t}=n;return Qr(e,t)}case"bridge":{const{jointAId:t}=n;return Qr(e,t)}}},ei=(e,t)=>{const n=Tr(e,t);switch(n.type){case"output":{const{jointId:t}=n;return Qr(e,t)}case"input":case"input-output":{const{inputPin:t}=n;return sr(e,t.elementId,t.pinId)}case"bridge":{const{jointBId:t}=n;return Qr(e,t)}}};function ti(e,t){switch(t.type){case"floating":return t.point;case"pin":return sr(e,t.pin.elementId,t.pin.pinId);case"segment":{const{segmentId:n,segmentInsertLength:r}=t,i=_r(e,n),o=ei(e,n),s=(0,b.Fv)((0,b.sj)(o,i));return(0,b.ZO)(i,(0,b.bA)(s,r))}case"joint":return Qr(e,t.jointId)}return null}const ni=(e,t)=>{const n=e.services.circuitEditorDrag;if("wire"!==n.dragMode)return null;const{dragStartEditorId:r,dragModifierKeys:i}=n,o=!i.ctrlMetaKey,s=Rt(e,r);if(!s)return null;const c=function(e,t,n){var r;const i=or(e),o=Nn(e,t);if(!o)return null;for(const e of o){const t=null!==(r=i[e])&&void 0!==r?r:b.Ds,o=Object.keys(t);for(const r of o){const i=t[r],o=(0,b.sj)(n,i);if(!((0,b.VE)(o)>6))return{elementId:e,pinId:r}}}return null}(e,s,t);if(c)return{type:"pin",pin:c};const l=function(e,t,n){const r=Ar(e,t);for(const t of r){const r=Sr(e,t);for(const t of r){const r=Qr(e,t);if(!((0,b.VE)((0,b.sj)(n,r))>4))return{type:"joint",jointId:t}}}return null}(e,s,t);if(l)return l;const a=function(e,t,n,r){const i=dn(e),o=Ar(e,t);for(const t of o){const o=Pr(e,t);for(const t of o){const o=_r(e,t),s=ei(e,t),c=(0,b.Lv)(o,s,n,{axialGridSnap:r?i:void 0});if(c)return{type:"segment",segmentId:t,segmentInsertLength:c.interceptLineLengthDistance}}}return null}(e,s,t,o);if(a)return a;const u=dn(e);if(i.shiftKey)o&&(t=pn(e,t));else{const n=oi(e);if(n){const e=(0,b.Fv)((0,b.sj)(t,n));t=Math.abs(e.x)>=.5?{x:o?(0,b.n$)(t.x,u):t.x,y:n.y}:{x:n.x,y:o?(0,b.n$)(t.y,u):t.y}}}return{type:"floating",point:t}},ri=(0,yn.P1)((e=>e),(e=>{const t=e.services.circuitEditorDrag;if("wire"!==t.dragMode)return null;const{dragEnd:n}=t;return n?ni(e,n):null}));let ii=b.Ds;const oi=e=>{const t=e.services.circuitEditorDrag;if("wire"!==t.dragMode)return null;const n=ti(e,t.dragStartTarget);return n?((0,b.kg)(n,ii)||(ii=n),ii):null};let si=b.Ds;const ci=e=>{const t=ri(e);if(!t)return null;const n=ti(e,t);return n?((0,b.kg)(n,si)||(si=n),si):null},li=e=>{const t=e.services.circuitEditorDrag;if("wire-segment-new-joint"!==t.dragMode)return null;let n=t.dragEnd;return n?(t.dragModifierKeys.ctrlMetaKey||(n=pn(e,n)),n):null},ai=e=>{const t=e.services.circuitEditorDrag;if("wire-segment-new-joint"!==t.dragMode)return de();const{dragWireSegmentId:n}=t,r=li(e);if(!n||!r)return de();const i=_r(e,n),o=ei(e,n);return i&&o?[[i,r],[r,o]]:de()},ui="@field/drag/start/element",di="@select/elements",mi=(e,t="set")=>({type:di,payload:{elementIds:Array.isArray(e)?e:[e],mode:t}}),pi=Mt("selection"),yi=Wt("selection"),fi=yi((e=>e.selectedElementIds)),gi=yi((e=>e.selectedWireJointIds)),Ii=yi(((e,t)=>-1!==e.selectedElementIds.indexOf(t))),hi=yi(((e,t)=>-1!==e.selectedWireJointIds.indexOf(t))),vi=yi(((e,t)=>-1!==e.selectedWireSegmentIds.indexOf(t)));(0,yn.P1)(wn,fi,((e,t)=>Pt()(e,t)));const Ei="@circuit-editor/drag/start/select",bi=qt(((e,t)=>{if(!function(e){return e.type===Ei}(t))return e;const{x:n,y:r,modifierKeys:i,editorId:o}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"select",dragStart:{x:n,y:r},dragStartEditorId:o,dragModifierKeys:i,dragEnd:null,dragEndEditorId:null})})),wi="@circuit-editor/drag/start/wire-joint",ji="@select/wire-joints",Oi=(e,t="set")=>({type:ji,payload:{jointIds:Array.isArray(e)?e:[e],mode:t}}),ki="@circuit-editor/drag/start/wire-segment",xi=qt(((e,t,n)=>{if(!function(e){return e.type===ki}(t))return e;const{x:r,y:i,editorId:o,modifierKeys:s,wireId:c,wireSegmentId:l}=t.payload,a=pn(n,{x:r,y:i});if(s.ctrlMetaKey){const e=_r(n,l),t=ei(n,l),r=(0,b.Fv)((0,b.sj)(t,e)),i=(0,b.sj)(a,e);return{dragMode:"wire",dragStart:a,dragStartEditorId:o,dragModifierKeys:s,dragStartTarget:{type:"segment",segmentId:l,segmentInsertLength:(0,b.Ih)(i,r)},dragEnd:null,dragEndEditorId:null}}return{dragMode:"wire-segment-new-joint",dragStart:a,dragStartEditorId:o,dragModifierKeys:s,dragWireId:c,dragWireSegmentId:l,dragEnd:null,dragEndEditorId:null}})),Ci="@circuit-editor/drag/start/wire",Bi=(e,t,n,r)=>({type:Ci,payload:Object.assign(Object.assign({},e),{target:t,modifierKeys:n,editorId:r})}),Pi=qt(((e,t)=>{if(!function(e){return e.type===Ci}(t))return e;const{x:n,y:r,target:i,editorId:o,modifierKeys:s}=t.payload;return{dragMode:"wire",dragStartEditorId:o,dragStart:{x:n,y:r},dragStartTarget:i,dragModifierKeys:s,dragEndEditorId:null,dragEnd:null}})),Ni="@circuit-editor/mouse/leave",Si=Gt(Qt,en,(function(e=Me,t){return function(e){return e.type===rt}(t)?e=M(e=function(e,t){const{dragMode:n}=e.services.circuitEditorDrag;switch(n){case"select":return function(e,t){const n=e.services.circuitEditorDrag;if("select"!==n.dragMode)return e;const{dragStartEditorId:r,dragEndEditorId:i}=n;if(r!=i)return e;const{dragModifierKeys:o,dragStart:s}=n,{x:c,y:l}=t.payload,a=Rt(e,r);if(!a)return e;const u=sn(o),d=(0,b.Qu)(s,{x:c,y:l});return zc(e,((e,t,n="set")=>({type:an,payload:{region:e,circuitId:t,mode:n}}))(d,a,u))}(e,t);case"move":return function(e,t){const n=e.services.circuitEditorDrag;if("move"!==n.dragMode)return e;const{dragStartEditorId:r,dragEndEditorId:i}=n;if(r!=i)return e;const{dragStart:o,dragModifierKeys:s}=n,{x:c,y:l}=t.payload;let a=(0,b.sj)({x:c,y:l},o);const u=e.services.selection.selectedElementIds.length>0;return s.ctrlMetaKey||(a=u?mn(e,a):pn(e,a)),zc(e,((e,t,n={})=>{var r;return{type:et,payload:{offsetX:e,offsetY:t,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}})(a.x,a.y))}(e,t);case"wire":return function(e,t){const n=e.services.circuitEditorDrag;if("wire"!==n.dragMode)return e;const{dragStartEditorId:r,dragEndEditorId:i}=n;if(r!=i)return e;const o=Rt(e,r);if(!o)return e;const{dragStartTarget:s}=n,{x:c,y:l}=t.payload,a=ni(e,{x:c,y:l});return a?zc(e,gt(o,s,a)):e}(e,t);case"wire-segment-new-joint":return function(e,t){const n=e.services.circuitEditorDrag;if("wire-segment-new-joint"!==n.dragMode)return e;const{dragStartEditorId:r,dragEndEditorId:i}=n;if(r!=i)return e;const{dragWireId:o,dragWireSegmentId:s}=n,{x:c,y:l}=t.payload;return zc(e,{type:jt,payload:{wireId:o,wireSegmentId:s,jointPos:{x:c,y:l}}})}(e,t)}return e}(e,t),"services","circuitEditorDrag",d):e}),(function(e=Me,t){if(!function(e){return e.type===ui}(t))return e;const{elementId:n,x:r,y:i,modifierKeys:o,editorId:s}=t.payload;if(e=M(e,"services","circuitEditorDrag",(()=>({dragMode:"move",dragStart:{x:r,y:i},dragStartEditorId:s,dragModifierKeys:o,dragEnd:null,dragEndEditorId:null}))),!Ii(e,n)){const t=sn(o);e=zc(e,mi(n,t))}return e}),bi,((e=Me,t)=>{if(!function(e){return e.type===wi}(t))return e;const{x:n,y:r,editorId:i,wireId:o,jointId:s,modifierKeys:c}=t.payload;if(c.ctrlMetaKey)e=M(e,"services","circuitEditorDrag",(()=>({dragMode:"wire",dragStart:{x:n,y:r},dragStartEditorId:i,dragStartTarget:{type:"joint",wireId:o,jointId:s},dragModifierKeys:c,dragEnd:null,dragEndEditorId:null})));else if(e=M(e,"services","circuitEditorDrag",(()=>({dragMode:"move",dragStart:{x:n,y:r},dragStartEditorId:i,dragModifierKeys:c,dragEnd:null,dragEndEditorId:null}))),!hi(e,s)){const t=sn(c);e=zc(e,Oi(s,t))}return e}),xi,Pi,qt(((e,t)=>function(e){return e.type===Ni}(t)?null==e.dragMode?e:Object.assign(Object.assign({},e),{dragEnd:null}):e))),Mi=zt(((e,t)=>{if(!Ze(t))return e;const{circuitId:n}=t.payload,r=Object.keys(e.circucitEditorsById).filter((t=>e.circucitEditorsById[t].circuitId!==n));let i=e.activeEditorId;return i&&-1!==r.indexOf(i)||(i=null),Object.assign(Object.assign({},e),{circucitEditorsById:Pt()(e.circucitEditorsById,r),activeEditorId:i})})),Wi="@circuit-editor/receive-focus",zi=zt(((e,t)=>{if(!function(e){return e.type===Wi}(t))return e;const{editorId:n}=t.payload;return-1===Object.keys(e.circucitEditorsById).indexOf(n)?e:Object.assign(Object.assign({},e),{activeEditorId:n})})),Li=zt(((e,t)=>mt(t)?f:e)),Ti="@view/circuit",Ri=(e,t=null,n={})=>({type:Ti,payload:{circuitId:e,elementIdPath:t,newWindowId:n.newWindow?(0,Re.Z)():null}});function Di(e){return e.type===Ti}const Ai=Gt(Mi,zi,Li,zt(((e,t,n)=>{if(!Di(t))return e;const{circuitId:r,elementIdPath:i,newWindowId:o}=t.payload;if(-1===Gn(n).indexOf(r))return e;let s=o;return s||(s=function(e){var t;return e.activeEditorId?e.activeEditorId:null!==(t=St()(Object.keys(e.circucitEditorsById)))&&void 0!==t?t:null}(e)),s?Object.assign(Object.assign({},e),{circucitEditorsById:Object.assign(Object.assign({},e.circucitEditorsById),{[s]:{circuitId:r,elementIdPath:null!=i?i:[]}}),activeEditorId:s}):e})));var Ji=n(5161),Ui=n.n(Ji),Zi=n(998),Fi=n.n(Zi),Ki=n(7287),$i=n.n(Ki);const Hi="@clipboard/copy-elements",Gi=(e,t)=>{var n;const r=null===(n=e.services.circuitGraph.elementsById[t])||void 0===n?void 0:n.elementType;return r?ir(e,r):null},Yi=(e,t,n)=>{const r=Gi(e,t);if(!r)return null;const i=r.pins[n];return i?i.direction:null},Vi=hn(((e,t,n)=>Xn(Cn.local(e,t))?Wn.local(e,n):n)),qi=Mt("clipboard"),Xi=Wt("clipboard"),Qi=Gt(qi(((e,t,n)=>{if(!function(e){return e.type===Hi}(t))return e;const{elementIds:r}=t.payload;if(0===r.length)return e;const i=Fn(n),o=$i()(r,Ui()(r,(()=>(0,Re.Z)()))),s=i[r[0]],c=r.map((e=>{const t=kn(n,e),c=((e,t)=>{const n=Ir(e),r=Gi(e,t);if(!r)return{};let i=[];i=Object.keys(r.pins).filter((e=>"output"===r.pins[e].direction));const o=n.filter((e=>e.outputPin.elementId===t)),s={};for(const e of i)s[e]=[];for(const e of o){const{outputPin:t,inputPin:n}=e;s[t.pinId].push(n)}return s})(n,e);return{id:o[e],elementType:t.elementType,offset:(0,b.sj)(i[e],s),outputs:gn()(c,(e=>e.filter((e=>{return t=e.elementId,-1!==Fi()(r,(e=>e===t));var t})).map((e=>({pin:{elementId:o[e.elementId],pinId:e.pinId}})))))}}));return Object.assign(Object.assign({},e),{clipboardElements:c,clipboardPasteOrigin:s})})),(function(e=Me,t){if(!function(e){return e.type===tt}(t))return e;const n=Jt(e);if(!n)return e;const{clipboardElements:r,clipboardPasteOrigin:i}=e.services.clipboard;if(!r.length)return e;let{pastePosition:o}=t.payload;const s=un(e);o=o?(0,b.R9)(o,s):(0,b.ZO)(i,{x:s,y:s});const c=$i()(r.map((e=>e.id)),Ui()(r,(()=>(0,Re.Z)())));for(const t of r){const{id:r,elementType:i,offset:s}=t,l=(0,b.ZO)(o,s);e=zc(e,$e(i,n,l,{elementId:c[r]}))}for(const t of r){const{id:r,outputs:i}=t,o=c[r];for(const t of Object.keys(i))for(const r of i[t]){const{pin:{elementId:i,pinId:s}}=r,l=c[i];e=zc(e,gt(n,{type:"pin",pin:{elementId:o,pinId:t}},{type:"pin",pin:{elementId:l,pinId:s}}))}}return e=M(e,"services","clipboard","clipboardPasteOrigin",o),zc(e,mi(lr()(c)))})),_i="@dialog/response/accept",eo=e=>({type:_i,payload:{result:e}}),to=Mt("dialog"),no=Wt("dialog"),ro=to(((e,t)=>function(e){return e.type===_i}(t)?j:e)),io="@dialog/response/cancel",oo=()=>({type:io}),so=to(((e,t)=>function(e){return e.type===io}(t)?j:e)),co="@dialog/show",lo=Gt(ro,so,to(((e,t)=>{if(!function(e){return e.type===co}(t))return e;const{dialogType:n,data:r}=t.payload;return Object.assign(Object.assign({},e),{dialogType:n,data:r})}))),ao=In(((e,t)=>{if(!Je(t))return e;const{circuitId:n}=t.payload;return Object.assign(Object.assign({},e),{elementIdsByCircuitId:Object.assign(Object.assign({},e.elementIdsByCircuitId),{[n]:[]}),wireIdsByCircuitId:Object.assign(Object.assign({},e.wireIdsByCircuitId),{[n]:[]})})}));var uo=n(4721),mo=n.n(uo);function po(e,t){const n=e.wiresByWireId[t];if(!n)return e;const{wireSegmentIds:r,wireJointIds:i}=n;return Object.assign(Object.assign({},e),{wireIdsByCircuitId:gn()(e.wireIdsByCircuitId,(e=>e.filter((e=>e!==t)))),wireSegmentsById:Pt()(e.wireSegmentsById,on()(Object.keys(e.wireSegmentsById),r)),wiresByWireId:Pt()(e.wiresByWireId,Object.keys(e.wiresByWireId).filter((e=>e!==t))),wireJointPositionsByJointId:Pt()(e.wireJointPositionsByJointId,on()(Object.keys(e.wireJointPositionsByJointId),i))})}class yo extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,new.target.prototype)}}function fo(e,t,n,r){return Object.assign(Object.assign({},e),{wireIdsByCircuitId:Object.assign(Object.assign({},e.wireIdsByCircuitId),{[t]:[...e.wireIdsByCircuitId[t],n]}),wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[n]:null!=r?r:{wireSegmentIds:[],wireJointIds:[]}})})}function go(e,t){const n=Wr.local(e,t);if(!n)throw new yo("Wire for joint id not found.");const r=e.wiresByWireId[n],i=Object.assign(Object.assign({},e.wiresByWireId),{[n]:Object.assign(Object.assign({},r),{wireJointIds:[...r.wireJointIds.filter((e=>e!==t))]})}),o=Pt()(e.wireJointPositionsByJointId,Object.keys(e.wireJointPositionsByJointId).filter((e=>e!==t)));return Object.assign(Object.assign({},e),{wiresByWireId:i,wireJointPositionsByJointId:o})}function Io(e,t,{deleteWireIfLastSegment:n=!0,removeOrphanJoints:r=!0}={}){const i=Nr.local(e,t);if(!i)throw new yo("Wire for segment not found.");const o=e.wireSegmentsById[t];if(!o)throw new yo("Segment not found");const s=e.wiresByWireId[i].wireSegmentIds.filter((e=>e!==t));if(n&&0===s.length)return po(e,i);if(r){const t=En(o);for(const n of t)s.every((t=>-1===En(e.wireSegmentsById[t]).indexOf(n)))&&(e=go(e,n))}return Object.assign(Object.assign({},e),{wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[i]:Object.assign(Object.assign({},e.wiresByWireId[i]),{wireSegmentIds:s})}),wireSegmentsById:Pt()(e.wireSegmentsById,Object.keys(e.wireSegmentsById).filter((e=>e!==t)))})}function ho(e,t){const n=Nr.local(e,t);if(!n)return e;const r=e.wiresByWireId[n];if(-1===r.wireSegmentIds.indexOf(t))return e;const i=e.wireSegmentsById[t];if(!i)return e;if("input-output"===i.type||1===r.wireSegmentIds.length)return po(e,n);if("bridge"===i.type){const r=(e=Io(e,t,{removeOrphanJoints:!0})).wiresByWireId[n],{jointAId:o,jointBId:s}=i;return r&&-1!==r.wireJointIds.indexOf(o)&&-1!==r.wireJointIds.indexOf(s)&&(e=function(e,t){const n=Wr.local(e,t);if(!n)throw new yo("Wire id for joint not found.");const r=Jr.local(e,n);if(!r)throw new yo("Circuit id for joint not found.");const{jointIds:i,segmentIds:o}=function(e,t,n){const r=new Set,i=new Set;function o(t){if(i.has(t))return;const n=e.wireSegmentsById[t];n&&(i.add(t),En(n).forEach(s))}function s(n){r.has(n)||(r.add(n),vn(e,t,n).forEach(o))}return s(n),{jointIds:Array.from(r),segmentIds:Array.from(i)}}(e,n,t);if(0===i.length||0===o.length)return e;const s=e.wiresByWireId[n],c=on()(s.wireSegmentIds,o),l=on()(s.wireJointIds,i);if(0===l.length||0===c.length)return e;e=Object.assign(Object.assign({},e),{wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[n]:Object.assign(Object.assign({},s),{wireSegmentIds:c,wireJointIds:l})})});const a={};return fo(e=Object.assign(Object.assign({},e),{wireSegmentsById:gn()(e.wireSegmentsById,((e,t)=>{return-1===o.indexOf(t)?e:pr(e)||yr(e)?Object.assign(Object.assign({},e),{lineId:(n=e.lineId,a[n]||(a[n]=(0,Re.Z)()),a[n])}):e;var n}))}),r,(0,Re.Z)(),{wireJointIds:i,wireSegmentIds:o})}(e,i.jointAId)),e}return Io(e,t)}function vo(e,t,n){const r=on()(Object.keys(e.elementsById),t),i=gn()(e.elementIdsByCircuitId,(e=>on()(e,t)));e=Object.assign(Object.assign({},e),{elementsById:Pt()(e.elementsById,r),elementIdsByCircuitId:i});const o=Tn()(t,(e=>((e,t)=>{const n=Cn(e,t);if("pin-input"!==n&&"pin-output"!==n)return[];const r=Sn(e,t);if(!r)return[];const i=qn(r);return xn(e,i).map((e=>({elementId:e,pinId:t})))})(n,e))),s=Object.keys(e.wireSegmentsById).filter((n=>{const r=e.wireSegmentsById[n];return function(e){switch(e.type){case"input-output":return mo()(t,e.inputPin.elementId)||mo()(t,e.outputPin.elementId);case"input":return mo()(t,e.inputPin.elementId);case"output":return mo()(t,e.outputPin.elementId)}return!1}(r)||function(e){switch(e.type){case"input-output":return Boolean(Dn()(o,(t=>mr(t,e.inputPin)))||Dn()(o,(t=>mr(t,e.outputPin))));case"input":return Boolean(Dn()(o,(t=>mr(t,e.inputPin))));case"output":return Boolean(Dn()(o,(t=>mr(t,e.outputPin))))}return!1}(r)}));return e=s.reduce(((e,t)=>ho(e,t)),e)}const Eo=In(((e,t,n)=>{var r;if(!Ze(t))return e;const{circuitId:i}=t.payload,o=Object.keys(e.elementIdsByCircuitId).filter((e=>e!==i)),s=null!==(r=e.elementIdsByCircuitId[i])&&void 0!==r?r:[],c=qn(i),l=[...s,...Object.keys(e.elementsById).filter((t=>e.elementsById[t].elementType===c))];return e=vo(e,l,n),Object.assign(Object.assign({},e),{elementIdsByCircuitId:Pt()(e.elementIdsByCircuitId,o),wireIdsByCircuitId:Pt()(e.wireIdsByCircuitId,o)})}));function bo(e,t){return t.weight=e,t}function wo(e){var t;return(null!==(t=e.weight)&&void 0!==t?t:0)-1}const jo=bo(-10,In(((e,t)=>{if(!He(t))return e;const{elementId:n,elementType:r,elementName:i,circuitId:o}=t.payload;return Object.assign(Object.assign({},e),{elementsById:Object.assign(Object.assign({},e.elementsById),{[n]:{elementType:r,elementName:null!=i?i:null}}),elementIdsByCircuitId:Object.assign(Object.assign({},e.elementIdsByCircuitId),{[o]:[...e.elementIdsByCircuitId[o],n]})})}))),Oo=In(((e,t,n)=>{if(!Ye(t))return e;const{elementIds:r}=t.payload;return vo(e,r,n)})),ko=In(((e,t)=>{if(!function(e){return e.type===Ve}(t))return e;const{elementId:n}=t.payload;if(!e.elementsById[n])return e;let r=t.payload.elementName;return r||""!==r.trim()||(r=null),Object.assign(Object.assign({},e),{elementsById:Object.assign(Object.assign({},e.elementsById),{[n]:Object.assign(Object.assign({},e.elementsById[n]),{elementName:r})})})})),xo=In(((e,t)=>mt(t)?I:e));function Co(e,t,n,r){return Object.assign(Object.assign({},e),{wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[t]:Object.assign(Object.assign({},e.wiresByWireId[t]),{wireSegmentIds:[...e.wiresByWireId[t].wireSegmentIds,n]})}),wireSegmentsById:Object.assign(Object.assign({},e.wireSegmentsById),{[n]:r})})}function Bo(e,t,n,r){return Object.assign(Object.assign({},e),{wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[t]:Object.assign(Object.assign({},e.wiresByWireId[t]),{wireJointIds:[...e.wiresByWireId[t].wireJointIds,n]})}),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),{[n]:r})})}function Po(e,t,n){const r=e.wiresByWireId[t];if(!r)return e;const i=Object.assign({},e.wireSegmentsById);for(const t of r.wireSegmentIds){const r=e.wireSegmentsById[t];"input"!==r.type&&"output"!==r.type||(i[t]=Object.assign(Object.assign({},r),{lineId:n}))}return Object.assign(Object.assign({},e),{wireSegmentsById:i})}const No=In(((e,t,n)=>{if(!function(e){return e.type===ft}(t))return e;const r=e,{circuitId:i,from:o,to:s}=t.payload,{state:c,jointId:l,pin:a,circuitId:u}=So(e,i,o,n);e=c;const{state:d,jointId:m,pin:p,circuitId:y}=So(e,i,s,n);if(e=d,!u||!y||u!==y)return r;if(a&&p){const t=function(e,t,n,r,i){const o=Yi(i,t.elementId,t.pinId),s=Yi(i,n.elementId,n.pinId);if(!o||!s||o===s)return null;const c="input"===o?t:n,l="input"===o?n:t;if(Dr(i,c.elementId,c.pinId))return null;const a=(0,Re.Z)();return Co(e=fo(e,r,a),a,(0,Re.Z)(),{type:"input-output",inputPin:c,outputPin:l})}(e,a,p,u,n);return null!=t?t:r}if(l&&m){const t=function(e,t,n){const r=Wr.local(e,t),i=Wr.local(e,n);if(!r||!i)return null;if(r!==i){const t=function(e,t,n){const r=Jr.local(e,t),i=Jr.local(e,n);if(!r||!i)throw new Error("Unable to determine circuit id for wire.");if(r!==i)throw new Error("Unable to merge wires in different circuits.");const o=e.wiresByWireId[t],s=e.wiresByWireId[n];if(!o||!s)throw new Error("Wire not found.");const[c,l]=bn(e,t),[a,u]=bn(e,n);if(l.length+u.length<=1&&c.length<=1&&a.length<=1){const r=(0,Re.Z)();e=Po(e,t,r),e=Po(e,n,r)}const d=Object.keys(e.wiresByWireId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{wireIdsByCircuitId:Object.assign(Object.assign({},e.wireIdsByCircuitId),{[r]:e.wireIdsByCircuitId[r].filter((e=>e!==n))}),wiresByWireId:Object.assign(Object.assign({},Pt()(e.wiresByWireId,d)),{[t]:Object.assign(Object.assign({},o),{wireSegmentIds:[...o.wireSegmentIds,...s.wireSegmentIds],wireJointIds:[...o.wireJointIds,...s.wireJointIds]})})})}(e,r,i);if(!t)return null;e=t}return Co(e,r,(0,Re.Z)(),{type:"bridge",jointAId:t,jointBId:n})}(e,l,m);return null!=t?t:r}const f=null!=l?l:m,g=null!=a?a:p;if(f&&g){const t=function(e,t,n,r){const i=Wr.local(e,t);if(!i)return null;const o=Yi(r,n.elementId,n.pinId);if(!o)return null;const s=function(e,t,n,r){var i;const o=Yi(r,n.elementId,n.pinId),[s,c]=bn(e,t);return"output"===o&&c.length>0?(0,Re.Z)():1===s.length&&0===c.length||0===s.length&&1===c.length||1===s.length&&1===c.length&&s[0]===c[0]?null!==(i=s[0])&&void 0!==i?i:c[0]:(0,Re.Z)()}(e,i,n,r);let c;if("input"===o){if(Dr(r,n.elementId,n.pinId))return null;c={type:"input",inputPin:n,jointId:t,lineId:s}}else{if("output"!==o)throw new yo("Unknown pin direction");c={type:"output",outputPin:n,jointId:t,lineId:s}}return Co(e,i,(0,Re.Z)(),c)}(e,f,g,n);return null!=t?t:r}return r}));function So(e,t,n,r){switch(n.type){case"pin":return{state:e,jointId:null,pin:n.pin,circuitId:Sn.local(e,n.pin.elementId)};case"joint":return{state:e,jointId:n.jointId,pin:null,circuitId:Mr.local(e,n.jointId)};case"floating":{const r=(0,Re.Z)();e=fo(e,t,r);const i=(0,Re.Z)();return{state:e=Bo(e,r,i,n.point),jointId:i,pin:null,circuitId:t}}case"segment":{const i=(0,Re.Z)();return{state:e=function(e,t,n,r,i){const o=Nr.local(e,t);if(!o)throw new yo("Wire segment parent wire not found.");const s=e.wireSegmentsById[t];if(!s)throw new yo("Wire segment not found.");const c=_r(i,t),l=ei(i,t),a=(0,b.Fv)((0,b.sj)(l,c));e=Bo(e,o,r,(0,b.ZO)(c,(0,b.bA)(a,n)));const u=(0,Re.Z)(),d=(0,Re.Z)();let m,p;switch(s.type){case"bridge":m={type:"bridge",jointAId:s.jointAId,jointBId:r},p={type:"bridge",jointAId:r,jointBId:s.jointBId};break;case"input":case"output":m=Object.assign(Object.assign({},s),{jointId:r}),p={type:"bridge",jointAId:r,jointBId:s.jointId};break;case"input-output":{const e=(0,Re.Z)();m={type:"output",outputPin:s.outputPin,jointId:r,lineId:e},p={type:"input",inputPin:s.inputPin,jointId:r,lineId:e}}break;default:throw new yo("Unknown segment type.")}return e=Co(e=Io(e,t,{deleteWireIfLastSegment:!1,removeOrphanJoints:!1}),o,u,m),Co(e,o,d,p)}(e,n.segmentId,n.segmentInsertLength,i,r),jointId:i,pin:null,circuitId:t}}}throw new yo("Unknown wire connect target")}var Mo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Wo=In(((e,t)=>{if(!function(e){return e.type===It}(t))return e;const{wireId:n,circuitId:r,wireSegments:i,wireJoints:o}=t.payload,s={};for(const e of i){const{wireSegmentId:t}=e,n=Mo(e,["wireSegmentId"]);s[t]=n}const c={};for(const e of o){const{jointId:t}=e,n=Mo(e,["jointId"]);c[t]=n}return Object.assign(Object.assign({},e),{wireIdsByCircuitId:Object.assign(Object.assign({},e.wireIdsByCircuitId),{[r]:[...e.wireIdsByCircuitId[r],n]}),wiresByWireId:Object.assign(Object.assign({},e.wiresByWireId),{[n]:{wireSegmentIds:Object.keys(s),wireJointIds:Object.keys(c)}}),wireSegmentsById:Object.assign(Object.assign({},e.wireSegmentsById),s),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),c)})})),zo=In(((e,t)=>{if(!function(e){return e.type===jt}(t))return e;const{wireId:n,wireSegmentId:r,jointPos:i}=t.payload;if(!e.wiresByWireId[n])return e;const o=e.wireSegmentsById[r];if(!o)return e;const s=(0,Re.Z)();let c,l;switch(o.type){case"bridge":c={type:"bridge",jointAId:o.jointAId,jointBId:s},l={type:"bridge",jointAId:s,jointBId:o.jointBId};break;case"input":case"output":c=Object.assign(Object.assign({},o),{jointId:s}),l={type:"bridge",jointAId:s,jointBId:o.jointId};break;case"input-output":{const e=(0,Re.Z)();c={type:"output",outputPin:o.outputPin,jointId:s,lineId:e},l={type:"input",inputPin:o.inputPin,jointId:s,lineId:e}}break;default:return e}return e=Co(e=Io(e=Bo(e,n,s,i),r,{deleteWireIfLastSegment:!1,removeOrphanJoints:!1}),n,(0,Re.Z)(),c),Co(e,n,(0,Re.Z)(),l)}));const Lo=In(((e,t)=>{if(!wt(t))return e;const{jointIds:n}=t.payload;return n.reduce(((e,t)=>{try{return function(e,t){const n=Wr.local(e,t);if(!n)throw new yo("Wire for joint not found");const r=vn(e,n,t);if(2===r.length)try{return function(e,t,n,r){const i=Nr.local(e,t),o=Nr.local(e,n);if(!i||!o)throw new yo("Wire for segment not found.");if(i!==o)throw new yo("Merging segments from different wires is not supported.");const s=e.wireSegmentsById[t],c=e.wireSegmentsById[n];if(!s||!c)throw new yo("Wire segment not found.");if("input-output"===s.type||"input-output"===c.type)throw new yo("Cannot merge input-output segments.");if(!("input"!==s.type&&"output"!==s.type||"input"!==c.type&&"output"!==c.type)){if(s.type===c.type)throw new yo("Cannot merge two inputs or two outputs.");if(s.jointId!==r||c.jointId!==r)throw new yo("Segments do not share the given joint.");const o="input"===s.type?s:c,l="output"===s.type?s:c;return e=Io(e=go(e,r),t,{deleteWireIfLastSegment:!1,removeOrphanJoints:!1}),Co(e=Io(e,n,{deleteWireIfLastSegment:!1,removeOrphanJoints:!1}),i,(0,Re.Z)(),{type:"input-output",inputPin:o.inputPin,outputPin:l.outputPin})}const l="bridge"===s.type?s:"bridge"===c.type?c:null;if(!l)throw new yo("Cannot merge segment configuration.");const a=s===l?c:s,u=En(l).filter((e=>e!==r)).pop();if(!u)throw new yo("Cannot merge segment configuration.");switch(e=Io(e=go(e,r),t,{removeOrphanJoints:!1,deleteWireIfLastSegment:!1}),e=Io(e,n,{removeOrphanJoints:!1,deleteWireIfLastSegment:!1}),a.type){case"bridge":{const t=a.jointAId===r?a.jointBId:a.jointBId===r?a.jointAId:null;if(!t)throw new yo("Segments do not share the given joint.");return Co(e,i,(0,Re.Z)(),{type:"bridge",jointAId:u,jointBId:t})}case"input":case"output":if(a.jointId!==r)throw new yo("Segments do not share the given joint.");return Co(e,i,(0,Re.Z)(),Object.assign(Object.assign({},a),{jointId:u}))}throw new yo("Cannot merge segment configuration.")}(e,r[0],r[1],t)}catch(e){if(e instanceof yo==0)throw e}return r.reduce(((e,t)=>ho(e,t)),e)}(e,t)}catch(t){if(t instanceof yo==0)throw t;return e}}),e)})),To=In(((e,t,n)=>{if(!function(e){return e.type===vt}(t))return e;const{jointIds:r,position:i,relative:o,snapMode:s}=t.payload,c=gn()(Pt()(e.wireJointPositionsByJointId,r),(e=>{let t={x:o?e.x+i.x:i.x,y:o?e.y+i.y:i.y};switch(s){case"element":t=mn(n,t);break;case"joint":t=pn(n,t)}return t}));return Object.assign(Object.assign({},e),{wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),c)})})),Ro="@wire/segment/delete",Do=Gt(ao,Eo,jo,Oo,ko,xo,No,Wo,zo,Lo,To,In(((e,t)=>{if(!function(e){return e.type===Ro}(t))return e;const{segmentIds:n}=t.payload;return n.reduce(((e,t)=>ho(e,t)),e)})),In(((e,t)=>{if(!function(e){return e.type===Ot}(t))return e;const{wireSegmentId:n,lineId:r}=t.payload,i=e.wireSegmentsById[n];return i&&(yr(i)||pr(i))?Object.assign(Object.assign({},e),{wireSegmentsById:Object.assign(Object.assign({},e.wireSegmentsById),{[n]:Object.assign(Object.assign({},i),{lineId:r})})}):e}))),Ao=Un(((e,t)=>{if(!He(t))return e;const{elementId:n,position:r=b.Ds}=t.payload;return M(e,"elementPositionsById",n,r)})),Jo=bo(wo(Oo),Un(((e,t)=>{if(!Ye(t))return e;const{elementIds:n}=t.payload,r=on()(Object.keys(e.elementPositionsById),n);return Object.assign(Object.assign({},e),{elementPositionsById:Pt()(e.elementPositionsById,r)})}))),Uo="@element/move",Zo=(e,t,n={})=>{var r,i;return{type:Uo,payload:{elementIds:le(e),position:t,relative:null!==(r=n.relative)&&void 0!==r&&r,snapMode:null!==(i=n.snapMode)&&void 0!==i?i:"none"}}},Fo=Gt(Ao,Jo,Un(((e,t,n)=>{if(!function(e){return e.type===Uo}(t))return e;const{elementIds:r,position:i,relative:o,snapMode:s}=t.payload,c=gn()(Pt()(e.elementPositionsById,r),(e=>{let t={x:o?e.x+i.x:i.x,y:o?e.y+i.y:i.y};return"element"===s&&(t=mn(n,t)),t}));return Object.assign(Object.assign({},e),{elementPositionsById:Object.assign(Object.assign({},e.elementPositionsById),c)})})),Un(((e,t)=>mt(t)?h:e))),Ko=Gt($n(((e,t)=>{if(!Je(t))return e;const{circuitId:n}=t.payload;let r=t.payload.circuitName;return r||(r="Circuit "+(Object.keys(e.circuitNamesByCircuitId).length+1)),Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:r})})})),$n(((e,t)=>{if(!Ze(t))return e;const{circuitId:n}=t.payload,r=Object.keys(e.circuitNamesByCircuitId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Pt()(e.circuitNamesByCircuitId,r)})})),$n(((e,t)=>{if(!function(e){return e.type===Fe}(t))return e;const{circuitId:n,circuitName:r}=t.payload,i=r.trim();return""===i?e:Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:i})})})),$n(((e,t)=>mt(t)?Object.assign(Object.assign({},e),{circuitNamesByCircuitId:{[m]:"Root"},elementIdsByCircuitId:{[m]:[]}}):e))),$o="@circuit/import";class Ho extends Error{constructor(e){super(e),this.message=e,this.code="SAVE_FORMAT_ERROR"}}function Go(e){const t=Xr(e);return{circuits:Gn(e).map((t=>({circuitId:t,circuitName:Vn(e,t)}))),elements:jn(e).map((t=>{const n=kn(e,t),r=Kn(e,t),i=Sn(e,t);return{elementId:t,elementType:n.elementType,elementName:n.elementName,circuitId:null!=i?i:m,x:r.x,y:r.y}})),wires:Cr(e).map((n=>{const r=Lr(e,n),i=Jr(e,n);return i?{wireId:n,circuitId:i,wireSegments:Pr(e,n).map((t=>{const n=Tr(e,t);return Object.assign({wireSegmentId:t},n)})),wireJoints:r.map((e=>Object.assign({jointId:e},t[e])))}:null})).filter(L)}}const Yo=Mt("project"),Vo=Wt("project"),qo=Yo(((e,t)=>Ct(t)?Object.assign(Object.assign({},e),{projectModified:!0}):e)),Xo=Yo(((e,t)=>mt(t)?Object.assign(Object.assign({},e),{projectName:"New Project",projectModified:!1}):e)),Qo="@project/rename",_o=Yo(((e,t)=>{if(!function(e){return e.type===Qo}(t))return e;let{projectName:n}=t.payload;return n=n.trim(),""===n?e:Object.assign(Object.assign({},e),{projectName:n})})),es="@project/save",ts=()=>({type:es}),ns="@project/save:success",rs=Gt(qo,Xo,(function(e=Me,t){if(!function(e){return e.type===pt}(t))return e;const{fileName:n,saveData:r}=t.payload;try{e=M(e,"services","project","projectLoadState","loading"),e=M(e=function(e,t){var n,r,i;e=Me;try{e=(null!==(n=t.circuits)&&void 0!==n?n:[]).reduce(((e,{circuitId:t,circuitName:n})=>zc(e,Ae({circuitId:t,circuitName:n}))),e),e=(null!==(r=t.elements)&&void 0!==r?r:[]).reduce(((e,t)=>{var n;return zc(e,$e(t.elementType,t.circuitId,{x:t.x,y:t.y},{elementId:t.elementId,elementName:null!==(n=t.elementName)&&void 0!==n?n:void 0}))}),e),e=(null!==(i=t.wires)&&void 0!==i?i:[]).reduce(((e,t)=>zc(e,ht(t))),e)}catch(e){throw console.error("Failed to rehydrate SaveData:",e),new Ho("Failed to load project.")}return e}(e,r),"services","project",(e=>Object.assign(Object.assign({},e),{projectLoadState:"loaded",projectName:n,projectModified:!1})))}catch(t){console.error("Failed to load save",t),e=M(e,"services","project",(e=>Object.assign(Object.assign({},e),{projectLoadState:"no-project",projectName:"",projectModified:!1})))}return e}),_o,Yo(((e,t)=>function(e){return e.type===ns}(t)?Object.assign(Object.assign({},e),{projectModified:!1}):e))),is=pi(((e,t)=>{if(!Ye(t))return e;const{elementIds:n}=t.payload;return Object.assign(Object.assign({},e),{selectedElementIds:on()(e.selectedElementIds,n),selectedConnectionIds:[]})})),os=pi(((e,t)=>mt(t)?k:e)),ss="@select/all",cs=pi(((e,t,n)=>{if(!function(e){return e.type===ss}(t))return e;const r=Jt(n);if(!r)return e;const i=Nn(n,r),o=Ur(n,r),s=Zr(n,r);return Object.assign(Object.assign({},e),{selectedElementIds:i,selectedWireJointIds:o,selectedWireSegmentIds:s})})),ls="@select/clear",as=pi(((e,t)=>function(e){return e.type===ls}(t)?Object.assign(Object.assign({},e),{selectedElementIds:[],selectedWireJointIds:[],selectedWireSegmentIds:[]}):e)),us=pi(((e,t)=>{if(!function(e){return e.type===di}(t))return e;const{elementIds:n,mode:r}=t.payload;return Object.assign(Object.assign({},e),{selectedElementIds:cn(e.selectedElementIds,n,r),selectedWireJointIds:ln(e.selectedWireJointIds,r),selectedWireSegmentIds:ln(e.selectedWireSegmentIds,r)})}));var ds=n(2525),ms=n.n(ds);const ps=(0,yn.P1)(Fn,rr,On,((e,t,n)=>gn()(e,((e,r)=>{const i=n[r];if(!i)return b.rG;const o=t[i];return o?(0,b.gQ)(o.visual.hitRect,e):b.rG})))),ys=pi(((e,t,n)=>{if(!function(e){return e.type===an}(t))return e;const{region:r,circuitId:i,mode:o}=t.payload,s=Nn(n,i),c=Pt()(ps(n),s),l=[];ms()(c,((e,t)=>{(0,b.jR)(e,r)&&l.push(t)}));const a=Ur(n,i),u=Pt()(Xr(n),a),d=[];return ms()(u,((e,t)=>{(0,b.is)(e,r)&&d.push(t)})),Object.assign(Object.assign({},e),{selectedElementIds:cn(e.selectedElementIds,l,o),selectedWireJointIds:cn(e.selectedWireJointIds,d,o)})})),fs=pi(((e,t)=>{if(!function(e){return e.type===ji}(t))return e;const{jointIds:n,mode:r}=t.payload;return Object.assign(Object.assign({},e),{selectedElementIds:ln(e.selectedElementIds,r),selectedWireJointIds:cn(e.selectedWireJointIds,n,r),selectedWireSegmentIds:ln(e.selectedWireSegmentIds,r)})})),gs="@select/wire-segments",Is=pi(((e,t)=>{if(!function(e){return e.type===gs}(t))return e;const{segmentIds:n,mode:r}=t.payload;return Object.assign(Object.assign({},e),{selectedElementIds:ln(e.selectedElementIds,r),selectedWireJointIds:ln(e.selectedWireJointIds,r),selectedWireSegmentIds:cn(e.selectedWireSegmentIds,n,r)})})),hs="@selection/copy",vs=()=>({type:hs});var Es=n(5325),bs=n.n(Es);const ws=Gt(os,is,cs,as,us,ys,fs,Is,(function(e=Me,t){if(!function(e){return e.type===qe}(t))return e;const{selectedElementIds:n,selectedWireJointIds:r}=e.services.selection,i=Fn(e);for(const t of n){const n=i[t];if(!n)continue;const r=mn(e,n);(0,b.kg)(n,r)||(e=zc(e,Zo(t,r)))}const o=Xr(e);for(const t of r){const n=o[t];if(!n)continue;const r=pn(e,n);(0,b.kg)(n,r)||(e=zc(e,Et(t,r)))}return e}),(function(e=Me,t){if(!function(e){return e.type===hs}(t))return e;const n=fi(e);return 0===n.length?e:zc(e,(r=n,{type:Hi,payload:{elementIds:Array.isArray(r)?r:[r]}}));var r}),(function(e=Me,t){if(!function(e){return e.type===Qe}(t))return e;const{selectedElementIds:n,selectedWireJointIds:r,selectedWireSegmentIds:i}=e.services.selection;return n.length>0&&(e=zc(e,{type:Ge,payload:{elementIds:le(n)}})),r.length>0&&(e=zc(e,{type:bt,payload:{jointIds:le(r)}})),i.length>0&&(e=zc(e,{type:Ro,payload:{segmentIds:le(i)}})),e}),(function(e=Me,t){if(!function(e){return e.type===et}(t))return e;const{offsetX:n,offsetY:r,snapMode:i}=t.payload,o=fi(e),s=gi(e),c={x:n,y:r};let l="none";"element"!==i&&"by-type"!==i||(l="element");let a="none";return a="by-type"===i?"joint":i,e=zc(e,Zo(o,c,{relative:!0,snapMode:l})),zc(e,Et(s,c,{relative:!0,snapMode:a}))}),bo(10,pi(((e,t,n)=>{if(!wt(t))return e;const{wireJointPositionsByJointId:r,wireSegmentsById:i}=n.services.circuitGraph;return Object.assign(Object.assign({},e),{selectedWireJointIds:bs()(e.selectedWireJointIds,Object.keys(r)),selectedWireSegmentIds:bs()(e.selectedWireSegmentIds,Object.keys(i))})})))),js=Mt("simulator"),Os=Wt("simulator"),ks=js(((e,t)=>Ct(t)?x:e));function xs(e){return e.default}const Cs={"input-momentary":xs(n(4263)),"input-toggle":xs(n(9028)),"logic-and":xs(n(2404)),"logic-buffer":xs(n(3880)),"logic-nand":xs(n(5813)),"logic-nor":xs(n(2791)),"logic-not":xs(n(6139)),"logic-or":xs(n(1868)),"logic-xor":xs(n(6259)),"output-led":xs(n(9480)),"output-seg7":xs(n(136)),"pin-high":xs(n(4303))};var Bs=n(2846);const Ps=(e,t)=>{const{evolversById:n}=Or(e),r=n[t];return r?r.evolverType:null},Ns=(e,t)=>{var n;const r=Ps(e,t);return r&&null!==(n=Cs[r])&&void 0!==n?n:null};var Ss=n(7513),Ms=n.n(Ss);const Ws=Object.freeze([]),zs=Object.freeze({});function Ls(e,t){const n=(e=>{const{evolversById:t}=Or(e);return Object.keys(t)})(t);return e=x,e=n.reduce(((e,n)=>function(e,t,n){const r=Ns(n,t);if(!r)return e;const i={};return r.outputPins.forEach((e=>{i[e]=!1})),M(e,"evolverOutputValuesByEvolverId",t,i)}(e,n,t)),e),e=n.reduce(((e,n)=>Rs(e,n,t)),e),Object.assign({},e,{initialized:!0})}function Ts(e,t,n){if(0===t.transitionIds.length)return e;let r=Object.assign({},e,{tick:t.tick,evolverOutputValuesByEvolverId:Object.assign({},e.evolverOutputValuesByEvolverId)});const i=new Set;t.transitionIds.forEach((e=>{const{elementId:t,valuesByOutputPin:o}=r.transitionsById[e];var s,c;(s=r.evolverOutputValuesByEvolverId[t],c=o,Object.keys(c).some((e=>s[e]!==c[e])))&&(r.evolverOutputValuesByEvolverId[t]=Object.assign({},r.evolverOutputValuesByEvolverId[t],o),((e,t)=>{const{evolversById:n}=Or(e),r=n[t];return r?Tn()(lr()(r.outputsByPin),(e=>e.map((e=>e.evolverId)))):Ws})(n,t).forEach((e=>i.add(e))))})),r.transitionsById=Pt()(r.transitionsById,on()(Object.keys(r.transitionsById),t.transitionIds));for(const e of i)r=Rs(r,e,n);return r}function Rs(e,t,n){const r=Ns(n,t);if(!r||!r.evolve)return e;const i=function(e,t,n){const r={},i=((e,t)=>{const{evolversById:n}=Or(e),r=n[t];return r?r.inputsByPin:zs})(n,t);return Object.keys(i).forEach((t=>{var n;const o=i[t];if(!o)return void(r[t]=!1);const{evolverId:s,pinId:c}=o;r[t]=(null===(n=e.evolverOutputValuesByEvolverId[s])||void 0===n?void 0:n[c])||!1})),r}(e,t,n);return Ds(e,t,r.evolve(e.evolverStatesByEvolverId[t],i,e.tick))}function Ds(e,t,n){const{state:r,transitions:i}=n;return r&&(e=M(e,"evolverStatesByEvolverId",t,r)),i&&(e=le(i).reduce(((e,n,r)=>function(e,t,n,r="replace"){const{tickOffset:i,valuesByPin:o,transitionMerger:s=r}=n,c=e.tick+(i>0?i:1);return"replace"===s&&(e=function(e,t){return Object.keys(e.transitionsById).filter((n=>function(e){return e.elementId===t}(e.transitionsById[n]))).reduce(((e,t)=>function(e,t){const n=e.transitionsById[t];if(!n)return e;const r=Pt()(e.transitionsById,Object.keys(e.transitionsById).filter((e=>e!==t)));let i=e.transitionWindows;const o=Ms()(i,n.tick,((e,t)=>e.tick-t));if(o>=0){const e=i[o],{transitionIds:n}=e,r=e.transitionIds.indexOf(t);-1!==r&&(1===e.transitionIds.length?i=me(i,o):(i=i.slice(),i[o]=Object.assign({},i[o],{transitionIds:me(n,r)})))}return Object.assign({},e,{transitionsById:r,transitionWindows:i})}(e,t)),e)}(e,t)),function(e,t,n,r){const i=(0,Re.Z)(),o={elementId:t,tick:n,valuesByOutputPin:r},s=e.transitionWindows.slice();let c=Ms()(s,n,((e,t)=>e.tick-t));if(c<0){c=-c-1;const e={tick:n,transitionIds:[]};s.splice(c,0,e)}const l=s[c].transitionIds.slice();l.push(i),s[c]=Object.assign({},s[c],{transitionIds:l});const a=Object.assign({},e.transitionsById,{[i]:o});return Object.assign({},e,{transitionsById:a,transitionWindows:s})}(e,t,c,o)}(e,t,n,0===r?"replace":"append")),e)),e}const As=js(((e,t,n)=>{if(!(0,Bs.Vj)(t))return e;const{elementIdPath:r,data:i}=t.payload,o=((e,t)=>{const{evolverIdsByElementId:n}=Or(e);return dr(n,t)})(n,r);if(!o)return e;const s=Ps(n,o);if(!s)return e;const c=Cs[s];if(!c||!c.interact)return e;const l=e.evolverStatesByEvolverId[o];return Ds(e,o,c.interact(l,i))})),Js="@sim/start",Us=()=>({type:Js});function Zs(e){return e.type===Js}const Fs=js(((e,t,n)=>Zs(t)?Ls(e,n):e)),Ks="@sim/step",$s=()=>({type:Ks});function Hs(e){return e.type===Ks}const Gs="@sim/tick",Ys=e=>({type:Gs,payload:{tickCount:e}}),Vs="@sim/stop",qs=()=>({type:Vs});function Xs(e){return e.type===Vs}const Qs=Gt(ks,As,Fs,(function(e=Me,t){if(!Hs(t))return e;const{initialized:n}=e.services.simulator;n||(e=M(e,"services","simulator",(t=>Ls(t,e))));const{tick:r,transitionWindows:i}=e.services.simulator;if(0===i.length)return e;const o=i[0].tick;return zc(e,Ys(o-r))}),js(((e,t)=>Xs(t)?x:e)),js(((e,t,n)=>{if(!function(e){return e.type===Gs}(t))return e;const{tickCount:r}=t.payload,i=performance.now();e=function(e,t,n){const r=e.tick+t;e=Object.assign({},e,{transitionWindows:e.transitionWindows.slice()});let i=t+1;for(;e.transitionWindows.length>0&&e.transitionWindows[0].tick<=r;){if(0==--i)throw new Error("Maximum ticks per sim evolution exceeded.  This is an indication that windows are being generated for past ticks.");const t=e.transitionWindows.shift();e=Ts(e,t,n)}return e.tick!=r&&(e=Object.assign({},e,{tick:r})),e}(e,r,n);const o=performance.now()-i;return Object.assign(Object.assign({},e),{lastTickProcessingTimeMs:o})}))),_s=Mt("simulatorControl"),ec=Wt("simulatorControl"),tc=_s(((e,t)=>Ct(t)?Object.assign(Object.assign({},e),{mode:"edit"}):e)),nc="@sim/pause",rc=e=>({type:nc,payload:{mode:e}}),ic=ec((e=>"edit"!==e.mode)),oc=ec((e=>"run"===e.mode)),sc=ec((e=>"pause"===e.mode)),cc=ec((e=>e.ticksPerSecond)),lc=Gt(tc,_s(((e,t)=>{if(!function(e){return e.type===nc}(t))return e;const{mode:n}=t.payload;if(!ic.local(e))return e;let r=e.mode;switch(n){case!0:r="pause";break;case!1:r="run";break;case"toggle":r="run"==r?"pause":"run"}return Object.assign(Object.assign({},e),{mode:r})})),_s(((e,t)=>Zs(t)?Object.assign(Object.assign({},e),{mode:"run"}):e)),_s(((e,t)=>Hs(t)?Object.assign(Object.assign({},e),{mode:"pause"}):e)),_s(((e,t)=>Xs(t)?Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}):e))),ac="@tutorial/annotate",uc=e=>({type:ac,payload:{annotations:e}}),dc=Mt("tutorial"),mc=Wt("tutorial"),pc=dc(((e,t)=>{if(!function(e){return e.type===ac}(t))return e;const{annotations:n}=t.payload;return Object.assign(Object.assign({},e),{annotatedElements:le(n)})})),yc="@tutorial/dismiss",fc=()=>({type:yc}),gc="@tutorial/start",Ic=e=>({type:gc,payload:{tutorial:e}}),hc=Gt(pc,((e=Me,t)=>{var n;return function(e){return e.type===yc}(t)?null!==(n=e.services.tutorial.preTutorialState)&&void 0!==n?n:Me:e}),((e=Me,t)=>{if(!function(e){return e.type===gc}(t))return e;const{tutorial:n}=t.payload;let{preTutorialState:r}=e.services.tutorial;return r||(r=e),e=M(e=Me,"services","project","projectName","Tutorial"),M(e,"services","tutorial",{activeTutorial:n,annotatedElements:[],preTutorialState:r})})),vc=Mt("uiLayout"),Ec=Wt("uiLayout"),bc=bo(wo(Mi),vc(((e,t,n)=>{if(!Ze(t))return e;if(!e.layout)return e;const{circuitId:r}=t.payload,i=Ut(n,r),o=ve(e.layout,(e=>!Oe(e)||-1===i.indexOf(e.windowProps.editorId)));return Object.assign(Object.assign({},e),{layout:o})}))),wc="@layout/rearrange",jc=vc(((e,t)=>{if(!function(e){return e.type===wc}(t))return e;const{layout:n}=t.payload;return Object.assign(Object.assign({},e),{layout:n})})),Oc=vc(((e,t)=>mt(t)?xe:e)),kc=vc(((e,t,n)=>{if(!Di(t))return e;const{newWindowId:r}=t.payload;if(!r)return e;const i=je(r),o=Dt(n);let s=e.layout;if(null==s)s=i;else{let e=!1;l=t=>{const n=J(t);return Oe(n)&&n.windowProps.editorId===o?(e=!0,{direction:"row",division:50,first:t,second:i}):null},s=null!==(a=function e(t){const n=l(t);if(n)return n;const r=J(t);if(Z(r)){const t=e(r.first);if(t)return Object.assign(Object.assign({},r),{first:t});const n=e(r.second);if(n)return Object.assign(Object.assign({},r),{second:n})}return null}(c=s))&&void 0!==a?a:c,e||(s={direction:"row",division:50,first:s,second:i})}var c,l,a;return Object.assign(Object.assign({},e),{layout:s})})),xc="@view/reset",Cc=()=>({type:xc}),Bc=Gt(bc,jc,Oc,kc,vc(((e,t)=>function(e){return e.type===xc}(t)?xe:e))),Pc="@view/element-names",Nc=e=>({type:Pc,payload:{mode:e}}),Sc=Mt("uiSettings"),Mc=Wt("uiSettings"),Wc=Gt(Sc(((e,t)=>{if(!function(e){return e.type===Pc}(t))return e;const{mode:n}=t.payload;return Object.assign(Object.assign({},e),{elementNameMode:n})}))),zc=function(e){const t=Ht()(e,(e=>e.weight||0));return(e=Me,n)=>t.reduce(((e,t)=>t(e,n)),e)}(Gt(Si,Ai,Qi,lo,Do,Fo,Ko,(function(e=Me,t){if(!function(e){return e.type===$o}(t))return e;const{circuitIds:n,saveData:r}=t.payload;return function(e,t,n){var r,i;const o=Object.keys(e.services.circuitProperties.circuitNamesByCircuitId),s=n.circuits.filter((e=>-1!==t.indexOf(e.circuitId)&&-1===o.indexOf(e.circuitId)));if(0===s.length)return e;try{e=s.reduce(((e,{circuitId:t,circuitName:n})=>zc(e,Ae({circuitId:t,circuitName:n}))),e);const t=(null!==(r=n.elements)&&void 0!==r?r:[]).filter((e=>s.some((({circuitId:t})=>t===e.circuitId))));e=t.reduce(((e,t)=>{var n;return zc(e,$e(t.elementType,t.circuitId,{x:t.x,y:t.y},{elementId:t.elementId,elementName:null!==(n=t.elementName)&&void 0!==n?n:void 0}))}),e),e=(null!==(i=n.wires)&&void 0!==i?i:[]).filter((function(e){return e.wireSegments.some((e=>{if(!gr(e))return;const{inputPin:n}=e;return t.some((e=>e.elementId===n.elementId))}))})).reduce(((e,t)=>zc(e,ht(t))),e)}catch(e){throw console.error("Failed to import circuit from SaveData:",e),new Ho("Failed to import circuit.")}return e}(e,n,r)}),rs,ws,Qs,lc,hc,Bc,Wc));var Lc=n(4970),Tc=n(6936);const Rc=mc((e=>null!=e.activeTutorial)),Dc=mc((e=>e.annotatedElements));function*Ac(){yield(0,Tc.ib)(xt,Jc)}function*Jc(){const e=yield(0,Tc.Ys)();if(!Rc(e))try{t=Go(e),localStorage.setItem("autosave",JSON.stringify(t))}catch(e){console.error("Failed to make autosave:",e)}var t}function*Uc(){yield(0,Tc.ib)(ut,Zc)}function*Zc(){localStorage.removeItem("autosave")}function*Fc(){yield(0,Tc.rM)(Ac),yield(0,Tc.rM)(Uc)}const Kc="@page/navigate",$c=e=>({type:Kc,payload:{page:e}}),Hc="@project/restore-previous",Gc=()=>({type:Hc}),Yc=Vo((e=>e.projectName)),Vc=Vo((e=>e.projectModified)),qc=Vo((e=>e.projectLoadState));function*Xc(){yield(0,Tc.ib)(Kc,Qc)}function*Qc(e){const{page:t}=e.payload;"editor"===t&&"no-project"===(yield(0,Tc.Ys)(qc))&&(yield(0,Tc.gz)(Gc()))}var _c=n(8764),el=n(8424);function*tl(e,t){yield(0,Lc.gz)(((e,t)=>({type:co,payload:{dialogType:e,data:t}}))(e,t));const n=yield(0,Lc.qn)([_i,io]);return n.type===_i?n.payload.result:null}const nl="@project/export-link",rl=()=>({type:nl});function*il(){yield(0,Lc.ib)(nl,ol)}function*ol(){const e=yield(0,Lc.Ys)();try{const t=Go(e),n=JSON.stringify(t),r=(0,el.Wt)(n),i=_c.lW.from(r).toString("base64"),o=encodeURIComponent(i),s=Te+u.createHref({pathname:"/import",search:"data="+o});yield(0,Lc.RE)(tl,"export-project-link",{projectLink:s})}catch(e){console.error("Failed to export project as link",e)}}var sl=n(4171),cl=n.n(sl);const ll="@project/import-circuits",al=()=>({type:ll});function*ul(){yield(0,Lc.ib)(ll,dl)}function*dl(){const[e]=yield(0,Lc.RE)(cl(),{accept:"application/json"}),t=yield(0,Lc.RE)(e.text.bind(e)),n=JSON.parse(t),r=yield(0,Lc.RE)(tl,"import-project-circuits",{circuits:n.circuits.filter((e=>e.circuitId!==m))});if(!Array.isArray(r))return;const i=r,o=[];let s;for(;s=i.pop();){o.push(s);for(const e of n.elements){const{circuitId:t,elementType:n}=e;if(s!==t)continue;const r=Xn(n);null!=r&&i.push(r)}}yield(0,Lc.gz)(((e,t)=>({type:$o,payload:{circuitIds:le(e),saveData:t}}))(o,n))}const ml="@project/import-link";function*pl(){yield(0,Lc.ib)(ml,yl)}function*yl(e){const{data:t}=e.payload;try{const e=decodeURIComponent(t),n=_c.lW.from(e,"base64"),r=(0,el.rr)(n,{to:"string"}),i=JSON.parse(r);yield(0,Lc.gz)(yt("Linked Project",i)),u.replace("/")}catch(e){console.error("Failed to import save from link",e)}}const fl="@project/load",gl=()=>({type:fl});function*Il(){yield(0,Lc.ib)(fl,hl)}function*hl(){try{const[e]=yield(0,Lc.RE)(cl(),{accept:"application/json"}),t=yield(0,Lc.RE)(e.text.bind(e)),n=JSON.parse(t);let r=e.name;r=r?r.substr(0,r.lastIndexOf(".json")):"Unnamed Project",yield(0,Lc.gz)(yt(r,n)),u.push("/editor")}catch(e){console.warn("Failed to load project:",e)}}function*vl(){yield(0,Tc.ib)(ut,El)}function*El(){u.push("/editor")}function*bl(){yield(0,Tc.ib)(Hc,wl)}function*wl(){const e=function(){const e=localStorage.getItem("autosave");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}();e&&(yield(0,Tc.gz)(yt("Previous Project",e)),u.push("/editor"))}var jl=n(3162);function*Ol(){yield(0,Lc.ib)(es,kl)}function*kl(){const e=yield(0,Lc.Ys)();try{window.showSaveFilePicker?yield(0,Lc.RE)(xl,e):yield(0,Lc.RE)(Cl,e),yield(0,Lc.gz)({type:ns})}catch(e){console.warn("Failed to save project",e)}}function*xl(e){const t=yield(0,Lc.Ys)(Yc),n=yield(0,Lc.RE)(window.showSaveFilePicker,{suggestedName:t,types:[{description:"Discrelog Project Files",accept:{"application/json":[".json"]}}]});if(!n)return;let r=n.name;r||(r=n.getFile().name),r&&(r=r.substr(0,r.lastIndexOf(".json")),yield(0,Lc.gz)((e=>({type:Qo,payload:{projectName:e}}))(r)));const i=Go(e),o=yield(0,Lc.RE)(n.createWritable.bind(n));yield(0,Lc.RE)(o.write.bind(o),JSON.stringify(i,null,2)),yield(0,Lc.RE)(o.close.bind(o))}function*Cl(e){const t=yield(0,Lc.Ys)(Yc),n=Go(e),r=new Blob([JSON.stringify(n,null,2)],{type:"application/json;charset=utf-8"});(0,jl.saveAs)(r,t+".json")}function*Bl(){yield(0,Lc.rM)(Xc),yield(0,Lc.rM)(il),yield(0,Lc.rM)(ul),yield(0,Lc.rM)(pl),yield(0,Lc.rM)(Il),yield(0,Lc.rM)(vl),yield(0,Lc.rM)(bl),yield(0,Lc.rM)(Ol)}function*Pl(){yield(0,Lc.A7)([Js,nc,Ks],Nl)}function*Nl(){for(;yield(0,Lc.Ys)(oc);){try{yield(0,Lc.gz)(Ys(1))}catch(e){return console.error(e),void(yield(0,Lc.gz)(rc(!0)))}if(!(yield(0,Lc.RE)(Sl)))break}}function*Sl(){const e=yield(0,Lc.Ys)(cc),t=Math.max(Math.ceil(1e3/e),1),n=performance.now()+t;for(;;){const e=yield(0,Lc.qn)(Ml);if(!(yield(0,Lc.Ys)(oc)))return!1;if(n<=e)return!0}}const Ml=(0,ze.GG)((e=>{let t=!0;return function n(){t&&requestAnimationFrame((r=>{t&&(e(r),n())}))}(),()=>{t=!1}}),ze.Ef.sliding(1));function*Wl(){yield(0,Lc.rM)(Pl)}function zl(e){return"circuit-editor-"+e}function Ll(e,t){return`editor-${e}--element-${t}`}function Tl(e,t,n){return`editor-${e}--element-${t}--pin-${n}`}function Rl(e,t){return`editor-${e}--wire-${t}`}function Dl(e,t){return`editor-${e}--wire-joint-${t}`}const Al="@tutorial/next";function*Jl(e,t={}){var n,r;const i=yield(0,Lc.Ys)((t=>ir(t,e)));if(!i)return null;const o=yield(0,Lc.Ys)(Dt);return o?(yield(0,Lc.gz)(uc([{selector:"#element-tray--element-"+e,message:null!==(n=t.trayMessage)&&void 0!==n?n:`This is a ${i.displayName} element`},{selector:"#"+zl(o),message:null!==(r=t.fieldMessage)&&void 0!==r?r:`Drag the ${i.displayName} element onto the circuit field.`,placement:"top"}])),(yield(0,Lc.RE)((()=>Fl(Ke,(({payload:{elementType:t}})=>t===e))))).payload.elementId):null}function*Ul(e,t){for(;;){if(yield(0,Lc.RE)(Zl,e,t))return;yield(0,Lc.qn)(rt)}}function*Zl(e,t){return(yield(0,Lc.Ys)(Ir)).some((({inputPin:n,outputPin:r})=>mr(n,t)&&mr(r,e)))}function*Fl(e,t){let n;for(;(n=yield(0,Lc.qn)(e))&&!t(n););return n}function*Kl(e,t,n={}){var r;yield(0,Lc.gz)(uc([{selector:e,message:t,placement:n.placement,action:{name:"Next",action:{type:Al}}},...(null!==(r=n.additionalSelectors)&&void 0!==r?r:[]).map((e=>({selector:e})))])),yield(0,Lc.qn)(Al)}function*$l(){yield(0,Lc.RE)(Kl,"#element-tray","This is where logic elements are stored.");const e=yield(0,Lc.RE)(Jl,"logic-not");if(!e)return void(yield(0,Lc.gz)(fc()));const t=yield(0,Lc.RE)(Jl,"interaction-momentary");if(!t)return void(yield(0,Lc.gz)(fc()));const n=yield(0,Lc.RE)(Jl,"output-led");if(!n)return void(yield(0,Lc.gz)(fc()));const r=yield(0,Lc.Ys)(Dt);r?(yield(0,Lc.gz)(uc([{selector:"#"+Tl(r,t,"OUT"),message:"This is the switch's output pin.",placement:"top"},{selector:"#"+Tl(r,e,"IN"),message:"This is the logic gate's input pin.",placement:"bottom"},{selector:"#"+zl(r),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:t,pinId:"OUT"},{elementId:e,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(r,e,"OUT"),message:"This is the logic gate's output pin.",placement:"top"},{selector:"#"+Tl(r,n,"IN"),message:"This is the LED's input pin.",placement:"bottom"},{selector:"#"+zl(r),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:e,pinId:"OUT"},{elementId:n,pinId:"IN"}),yield(0,Lc.gz)(uc({selector:"#simctrl-run",message:"Click here to run the simulation."})),yield(0,Lc.qn)(Js),yield(0,Lc.gz)(uc([{selector:"#"+zl(r)},{selector:"#"+Ll(r,t),message:"Click the switch to activate it.  Momentary switches need to be held."}])),yield(0,Lc.RE)((()=>Fl(Bs.Tu,(({payload:{elementIdPath:e,data:n}})=>!0===n&&ae(e,[t]))))),yield(0,Lc.gz)(uc({selector:"#"+zl(r),placement:"top",message:"That's it!",action:{name:"End Tutorial",action:fc()}}))):yield(0,Lc.gz)(fc())}function Hl(e){return"circuit-list--circuit-"+e}function*Gl(){yield(0,Lc.RE)(Kl,"#circuit-list-window","Circuits are collections of elements that can be reused as ICs."),yield(0,Lc.gz)(uc({selector:"#circuit-list",message:"Right click on the circuit list to create a new circuit."}));const e=yield(0,Lc.qn)(De),{circuitId:t}=e.payload;yield(0,Lc.gz)(uc({selector:"#"+Hl(t),message:"Here is your circuit.  Double click it to rename it."})),yield(0,Lc.qn)(Fe),yield(0,Lc.gz)(uc({selector:"#"+Hl(t),message:"Click the circuit to view it in the active editor window."})),yield(0,Lc.RE)((()=>Fl(Ti,(e=>e.payload.circuitId===t))));const n=yield(0,Lc.Ys)(Dt);if(!n)return void(yield(0,Lc.gz)(fc()));const r=yield(0,Lc.RE)(Jl,"pin-input");if(!r)return void(yield(0,Lc.gz)(fc()));yield(0,Lc.RE)(Kl,"#"+Ll(n,r),"Input pins take a signal from outside for use in your circuit.",{additionalSelectors:["#"+zl(n)]}),yield(0,Lc.gz)(uc([{selector:"#"+zl(n)},{selector:"#"+Ll(n,r),message:"Rename the pin by right clicking it and clicking on the bolded text.  Choose any name you like"}])),yield(0,Lc.RE)((()=>Fl(Ve,(e=>e.payload.elementId===r)))),yield(0,Lc.RE)(Kl,"#"+Ll(n,r),"Pin names will appear on the body of the IC when used in other circuits.  Be sure to name your pins!");const i=yield(0,Lc.RE)(Jl,"pin-output");if(!i)return void(yield(0,Lc.gz)(fc()));yield(0,Lc.RE)(Kl,"#"+Ll(n,i),"Output pins take a signal from your circuit and send it to the outside world.");const o=yield(0,Lc.RE)(Jl,"pin-output",{trayMessage:"Let's take another output pin",fieldMessage:"When multiple pins are used, the pins will stack in their vertical orientation on the IC"});if(!o)return void(yield(0,Lc.gz)(fc()));yield(0,Lc.RE)(Kl,"#"+zl(n),"Let's put together a simple circuit.",{placement:"top"});const s=yield(0,Lc.RE)(Jl,"logic-buffer");if(!s)return void(yield(0,Lc.gz)(fc()));const c=yield(0,Lc.RE)(Jl,"logic-not");if(!c)return void(yield(0,Lc.gz)(fc()));yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,r,"OUT"),message:"Connect the input signal pin...",placement:"top"},{selector:"#"+Tl(n,s,"IN"),message:"...to the buffer's input.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:r,pinId:"OUT"},{elementId:s,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,s,"OUT"),message:"Connect the buffer's output pin...",placement:"top"},{selector:"#"+Tl(n,i,"IN"),message:"...to the IC's first output.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:s,pinId:"OUT"},{elementId:i,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,r,"OUT"),message:"Connect the input signal pin...",placement:"top"},{selector:"#"+Tl(n,c,"IN"),message:"...to the NOT's input.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:r,pinId:"OUT"},{elementId:c,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,c,"OUT"),message:"Connect the NOT's output...",placement:"top"},{selector:"#"+Tl(n,o,"IN"),message:"...to the second IC output.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:c,pinId:"OUT"},{elementId:o,pinId:"IN"}),yield(0,Lc.gz)(uc({selector:"#"+Hl(m),message:"We now have a functional IC.  Let's go to the root project and make use of it"})),yield(0,Lc.RE)((()=>Fl(Ti,(e=>e.payload.circuitId===m))));const l=qn(t),a=yield(0,Lc.RE)(Jl,l);if(!a)return void(yield(0,Lc.gz)(fc()));yield(0,Lc.RE)(Kl,"#"+zl(n),"Let's connect it up to see it in action.",{placement:"top"});const u=yield(0,Lc.RE)(Jl,"interaction-momentary");if(!u)return void(yield(0,Lc.gz)(fc()));const d=yield(0,Lc.RE)(Jl,"output-led",{trayMessage:"Make an LED to check the status of the first pin."});if(!d)return void(yield(0,Lc.gz)(fc()));const p=yield(0,Lc.RE)(Jl,"output-led",{trayMessage:"Make an LED to check the status of the second pin."});p?(yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,u,"OUT"),message:"Connect the switch output...",placement:"top"},{selector:"#"+Tl(n,a,r),message:"...to the IC input.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:u,pinId:"OUT"},{elementId:a,pinId:r}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,a,i),message:"Connect the first IC output...",placement:"top"},{selector:"#"+Tl(n,d,"IN"),message:"...to the first LED.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:a,pinId:i},{elementId:d,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,a,i),message:"Connect the first IC output...",placement:"top"},{selector:"#"+Tl(n,d,"IN"),message:"...to the first LED.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:a,pinId:i},{elementId:d,pinId:"IN"}),yield(0,Lc.gz)(uc([{selector:"#"+Tl(n,a,o),message:"Connect the second IC output...",placement:"top"},{selector:"#"+Tl(n,p,"IN"),message:"...to the second LED.",placement:"bottom"},{selector:"#"+zl(n),message:"Click and drag from one pin to another to connect them.",placement:"top"}])),yield(0,Lc.RE)(Ul,{elementId:a,pinId:o},{elementId:p,pinId:"IN"}),yield(0,Lc.gz)(uc({selector:"#simctrl-run",message:"Click here to run the simulation."})),yield(0,Lc.qn)(Js),yield(0,Lc.gz)(uc([{selector:"#"+zl(n)},{selector:"#"+Ll(n,u),message:"Click the switch to activate it.  Momentary switches need to be held."}])),yield(0,Lc.RE)((()=>Fl(Bs.Tu,(({payload:{elementIdPath:e,data:t}})=>!0===t&&ae(e,[u]))))),yield(0,Lc.gz)(uc({selector:"#"+zl(n),placement:"top",message:"You can place as many copies of an IC as you want.  Circuits can also contain other ICs.",action:{name:"End Tutorial",action:fc()}}))):yield(0,Lc.gz)(fc())}function*Yl(){yield(0,Lc.ib)(gc,Vl)}function*Vl(e){const{tutorial:t}=e.payload;switch(t){case"basics":return void(yield(0,Lc.RE)($l));case"circuits":yield(0,Lc.RE)(Gl)}}function*ql(){yield(0,Lc.rM)(Yl)}const Xl=We.qC,Ql=(0,ze.ZP)(),_l=[!1,Ql].filter(L),ea=(0,We.MT)((function(e=Me,t){return e=function(e=Me,t){return function(e=Me,t){if(!st(t))return e;const{undoStack:n,redoStack:r}=e.undo,i=Kt()(n);if(!i)return e;const{serviceStates:o,viewCircuitId:s}=i;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:n.slice(0,n.length-1),redoStack:[...r,Zt(e)]})}),s&&(e=zc(e,Ri(s))),e}(e=function(e=Me,t){if(!at(t))return e;const{undoStack:n,redoStack:r}=e.undo,i=Kt()(r);if(!i)return e;const{serviceStates:o,viewCircuitId:s}=i;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:[...n,Zt(e)],redoStack:r.slice(0,r.length-1)})}),s&&(e=zc(e,Ri(s))),e}(e=function(e=Me,t){return!Ct(t)||st(t)||at(t)?e:M(e,"undo",(t=>{const n=Zt(e);let{undoStack:r}=t;return r=r.length>=25?[...r.slice(1,25),n]:[...r,n],Object.assign(Object.assign({},t),{undoStack:r,redoStack:[]})}))}(e,t),t),t)}(e,t),zc(e,t)}),Xl((0,We.md)(..._l)));function ta(e,...t){const n=(0,s.I0)();return r.useCallback((()=>{const r=e(...t);r&&n(r)}),[n,e,...t])}function na(e,...t){const n=(0,s.I0)();return r.useCallback((r=>{if(r.defaultPrevented)return;r.preventDefault();const i=e(...t);i&&n(i)}),[n,e,...t])}Ql.run((function*(){yield(0,Lc.rM)(Fc),yield(0,Lc.rM)(Bl),yield(0,Lc.rM)(Wl),yield(0,Lc.rM)(ql)})),ea.dispatch({type:"@init"});const ra={button:"button--Ui3Hp",disabled:"disabled--bnSiC","button--size-small":"button--size-small--289kb","button--variant-primary":"button--variant-primary--2qpAa","button--variant-text":"button--variant-text--2oReW","button--variant-menu":"button--variant-menu--3lEZ1"};const ia=e=>{var{variant:t="default",size:n="default",disabled:i}=e,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["variant","size","disabled"]);return r.createElement("button",Object.assign({className:S(ra.button,ra["button--variant-"+t],ra["button--size-"+n],i&&ra.disabled),type:"button"},o),o.children)},oa="panel--uw2LA",sa="button-container--3zi4e",ca=()=>{const e=ta($c,"home"),t=ta(dt),n=ta(gl),i=ta(Gc);r.useEffect((()=>{e()}),[e]);const o=function(){const e=localStorage.getItem("autosave");return Boolean(e)}();return r.createElement("div",{className:"root--2DezE"},r.createElement("div",{className:"content--2cUqW"},r.createElement("div",{className:oa},r.createElement("h1",null,"Discrelog"),r.createElement("h3",null,"Discrelog is a discrete logic simulator for exploring TTL logic systems.")),r.createElement("div",{className:S(R["flex-row"],R["flex-space-around"])},r.createElement("div",{className:S(oa,sa,R["flexitem-grow"])},r.createElement(ia,{onClick:t},"Start a new project")),r.createElement("div",{className:S(oa,sa,R["flexitem-grow"])},r.createElement(ia,{onClick:n},"Load an existing project")),r.createElement("div",{className:S(oa,sa,R["flexitem-grow"])},r.createElement(ia,{disabled:!o,onClick:i},"Restore previous project"))),r.createElement("div",{className:S("footer--lY1Go",oa)},"0.14.0")))};function la(e){return(0,s.v9)(e)}function aa(e,t,n,i){r.useEffect((()=>{if(!e.current)return;const r=e.current;return r.addEventListener(t,n,i),()=>{r.removeEventListener(t,n,i)}}),[t,n,e,i])}const ua=Ec((e=>e.layout)),da=({className:e,title:t,children:n})=>r.createElement("div",{className:S("titlebar--3-TCE",e)},r.createElement("span",{className:"titlebar-heading--3RAl1"},"Discrelog"),r.createElement("div",{className:"titlebar-divider--Wl_27"}),t&&r.createElement("div",{className:"titlebar-title--HXGig"},t),n);var ma=n(1935);function pa(){}const ya={registerPopoverChild:pa,unregisterPopoverChild:pa},fa=r.createContext(null),ga=({registerPopoverChild:e,unregisterPopoverChild:t,children:n})=>{const i=r.useContext(fa),o=null==i?void 0:i.registerPopoverChild,s=null==i?void 0:i.unregisterPopoverChild,c=r.useCallback((t=>{o&&o(t),e(t)}),[e,o]),l=r.useCallback((e=>{t(e)}),[t,s]),a=r.useMemo((()=>({registerPopoverChild:c,unregisterPopoverChild:l})),[c,l]);return r.createElement(fa.Provider,{value:a},n)},Ia=()=>{},ha=({isOpen:e,anchorEl:t,placement:n="auto",onRequestClose:o=Ia,children:s})=>{const[c,l]=r.useState(null),{attributes:a,styles:u}=(0,ma.D)(e?t:null,c,{placement:n});!function(e){var t;const n=null!==(t=r.useContext(fa))&&void 0!==t?t:ya,i=r.useRef(n);r.useEffect((()=>{i.current=n})),r.useEffect((()=>{if(e)return i.current.registerPopoverChild(e),()=>i.current.unregisterPopoverChild(e)}),[e])}(c);const[d,m,p]=function(e=[]){const[t,n]=r.useState(e),i=r.useCallback((e=>{n([...t,e])}),[t]),o=r.useCallback((e=>{n(on()(t,[e]))}),[t]);return[t,i,o,n]}();return function(e,t,n=!0){const i=r.useCallback((n=>{const r=le(e).filter(L);r.length&&r.every((e=>!e.contains(n.target)))&&t()}),[e,t]);r.useEffect((()=>{if(n)return document.addEventListener("mousedown",i),document.addEventListener("touchstart",i),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}}),[i,n])}(r.useMemo((()=>[c,...d]),[d,c]),o),e?(0,i.createPortal)(r.createElement(ga,{registerPopoverChild:m,unregisterPopoverChild:p},r.createElement("div",Object.assign({ref:l,style:Object.assign(Object.assign({},u.popper),{zIndex:10})},a.popper),s)),document.body):null},va=r.createContext((function(){}));function Ea(){return r.useContext(va)}const ba=va.Provider,wa=({content:e,placement:t,children:n})=>{const i=r.useRef(null),[o,s]=r.useState(!1),c=r.useCallback((()=>{s(!0)}),[]),l=r.useCallback((()=>{s(!1)}),[]);return r.createElement(ba,{value:l},r.createElement("div",{ref:i,onClick:c},n),r.createElement(ha,{anchorEl:i.current,isOpen:o,placement:t,onRequestClose:l},o&&e))},ja="menu-item--2dcyN",Oa="menu-item--disabled--RJJTK",ka="menu-item-content--3s1DG",xa="menu-item-text--1F41V",Ca="menu-item-secondary--2PJLF",Ba=({children:e})=>r.createElement("ul",{className:"menu--3E86w"},e),Pa=({disabled:e,onClick:t,secondary:n,children:i})=>{const o=Ea(),s=r.useCallback((e=>{t&&t(e),o()}),[o,t]);return r.createElement("li",{className:S(ja,e&&Oa)},r.createElement("a",{className:ka,onClick:s},r.createElement("span",{className:xa},i),n&&r.createElement("span",{className:Ca},n)))},Na=()=>r.createElement("div",{className:"menu-divider--1QPGp"}),Sa=()=>{const e=ta(dt),t=ta(ts),n=ta(gl),i=ta(al),o=ta(rl);return r.createElement(Ba,null,r.createElement(Pa,{onClick:e},"New"),r.createElement(Na,null),r.createElement(Pa,{onClick:n},"Load"),r.createElement(Pa,{onClick:t},"Save"),r.createElement(Na,null),r.createElement(Pa,{onClick:i},"Import Circuits"),r.createElement(Na,null),r.createElement(Pa,{onClick:o},"Export Link"))};var Ma=n(1795);const Wa=/(Mac|iOS|OS\ X)/.test((Ma.os||"undefined").toString()),za=Wa?"command":"ctrl",La=e=>e.undo.undoStack.length>0,Ta=e=>e.undo.redoStack.length>0,Ra=Xi((e=>e.clipboardElements.length>0)),Da=()=>{const e=la(La),t=ta(ot),n=la(Ta),i=ta(lt),o=la(fi).length>0,s=ta(vs),c=la(Ra),l=ta(nt);return r.createElement(Ba,null,r.createElement(Pa,{disabled:!e,secondary:za+"+z",onClick:t},"Undo"),r.createElement(Pa,{disabled:!n,secondary:za+"+shift+z",onClick:i},"Redo"),r.createElement(Na,null),r.createElement(Pa,{disabled:!o,secondary:za+"+c",onClick:s},"Copy"),r.createElement(Pa,{disabled:!c,secondary:za+"+v",onClick:l},"Paste"))},Aa=Mc((e=>e.elementNameMode)),Ja=({className:e,value:t,onChange:n,children:i})=>r.createElement("label",{className:e},r.createElement("span",{className:"checkbox-span--1EWGs"},r.createElement("input",{type:"checkbox",checked:t,onChange:n})),i),Ua=({disabled:e,secondary:t,value:n,onChange:i,children:o})=>r.createElement("li",{className:S(ja,e&&Oa)},r.createElement(Ja,{className:ka,value:n,onChange:i},r.createElement("span",{className:xa},o),t&&r.createElement("span",{className:Ca},t))),Za=({disabled:e,secondary:t,content:n,children:i})=>r.createElement("li",{className:S(ja,e&&Oa)},r.createElement(wa,{placement:"right-start",content:n},r.createElement("a",{className:ka},r.createElement("span",{className:xa},i),t&&r.createElement("span",{className:Ca},t),r.createElement("svg",{className:"menu-item-icon--JTlha",width:12,height:12},r.createElement("path",{d:"M0,0 l6,6 l-6,6 z",fill:"black",strokeWidth:0}))))),Fa=()=>{const e=la(Aa),t=ta(Nc,"all"),n=ta(Nc,"named-only"),i=ta(Nc,"none");return r.createElement(Ba,null,r.createElement(Ua,{value:"all"===e,onChange:t},"Always visible"),r.createElement(Ua,{value:"named-only"===e,onChange:n},"Named Items Only"),r.createElement(Ua,{value:"none"===e,onChange:i},"Hidden"))},Ka=()=>{const e=ta(Cc);return r.createElement(Ba,null,r.createElement(Za,{content:r.createElement(Fa,null)},"Element Names"),r.createElement(Na,null),r.createElement(Pa,{onClick:e},"Reset View"))},$a=()=>{const e=ta(Ic,"basics"),t=ta(Ic,"circuits");return r.createElement(Ba,null,r.createElement(Pa,{onClick:e},"Basics"),r.createElement(Pa,{onClick:t},"Circuits"))},Ha=()=>r.createElement(Ba,null,r.createElement(Za,{content:r.createElement($a,null)},"Tutorials")),Ga=Os((e=>e.lastTickProcessingTimeMs)),Ya="icon--3Vly6",Va=e=>r.createElement("svg",Object.assign({width:16,height:16},e,{className:S(Ya,e.className)}),r.createElement("path",{d:"M3,0 L13,8 L3,16 z"})),qa=e=>r.createElement("svg",Object.assign({width:16,height:16},e,{className:S(Ya,e.className)}),r.createElement("path",{d:"M1,1 L15,1 L15,15 L1,15 z"})),Xa=e=>r.createElement("svg",Object.assign({width:16,height:16},e,{className:S(Ya,e.className)}),r.createElement("path",{d:"M2.5,1 L6.5,1 L6.5,15 L2.5,15 z M9.5,1 L13.5,1 L13.5,15 L9.5,15 z"})),Qa=e=>r.createElement("svg",Object.assign({width:16,height:16},e,{className:S(Ya,e.className)}),r.createElement("path",{d:"M3,0 L13,8 L3,16 z M11,1 l2,0 l0,14 l-2,0 z"})),_a="button--2N_ol",eu=()=>{const e=la(ic),t=la(sc),n=la(Ga),i=na(Us),o=na(qs),s=na(rc,"toggle"),c=na($s),l=r.useCallback((e=>{e.preventDefault()}),[]);return r.createElement("span",null,e&&r.createElement("span",{className:"simrate--NKBi_"},n.toFixed(2)," ms"),e?r.createElement(qa,{id:"simctrl-stop",className:S(_a,"button-stop--1dD4-"),onClick:o,onMouseDown:l}):r.createElement(Va,{id:"simctrl-run",className:S(_a,"button-play--1vWfq"),onClick:i,onMouseDown:l}),r.createElement(Qa,{id:"simctrl-step",className:S(_a,"button-step--3Fat5"),onClick:c,onMouseDown:l}),r.createElement(Xa,{id:"simctrl-pause",className:S(_a,"button-pause--1UoHJ",!e&&"button--disabled--3caLv",t&&"selected--Ev2q8"),onClick:s,onMouseDown:l}))},tu=({className:e})=>{const t=`${la(Yc)}${la(Vc)?"*":""}`;return r.createElement(da,{className:e,title:t},r.createElement(wa,{content:r.createElement(Sa,null),placement:"bottom-start"},r.createElement(ia,{variant:"menu"},"File")),r.createElement(wa,{content:r.createElement(Da,null),placement:"bottom-start"},r.createElement(ia,{variant:"menu"},"Edit")),r.createElement(wa,{content:r.createElement(Ka,null),placement:"bottom-start"},r.createElement(ia,{variant:"menu"},"View")),r.createElement(wa,{content:r.createElement(Ha,null),placement:"bottom-start"},r.createElement(ia,{variant:"menu"},"Help")),r.createElement("div",{className:"project-titlebar-controls--1c1Qn"},r.createElement(eu,null)))};var nu=n(3274);const ru=({circuitId:e,elementIdPath:t})=>{const n=(0,s.I0)(),i=la((e=>Vn(e,m))),o=la((t=>Vn(t,e))),c=r.useCallback((e=>{e.preventDefault(),n(Ri(m,[]))}),[n]);return r.createElement(ia,{variant:"text",size:"small",onClick:c},0===t.length?o:i)},iu=({elementIdPath:e})=>{const t=(0,s.I0)(),n=Kt()(e),i=la((e=>Cn(e,n))),o=la((e=>Wn(e,n))),c=i?Xn(i):null,l=la((e=>c?Vn(e,c):null)),a=r.useCallback((n=>{n.preventDefault(),c&&t(Ri(c,e))}),[c,e,t]);return r.createElement(ia,{variant:"text",size:"small",onClick:a},o," [",l,"]")},ou=({circuitId:e,elementIdPath:t})=>{const n=t.map(((e,n)=>{const i=t.slice(0,n+1);return r.createElement(r.Fragment,{key:e},r.createElement("span",null,">"),r.createElement(iu,{elementIdPath:i}))}));return r.createElement("div",{className:S("circuit-element-breadcrumb","circuit-element-breadcrumb--1CYNC")},r.createElement(ru,{circuitId:e,elementIdPath:t}),n)},su=Object.freeze({p1:{x:-100,y:-100},p2:{x:100,y:100}}),cu=(0,yn.P1)(ps,Xr,((e,t)=>[...lr()(e),...lr()(t).map((e=>({p1:e,p2:e})))].reduce(b.G0,su))),lu="@element/new",au=e=>({type:lu,payload:{elementType:e}});function uu(e){return e.type===lu}const du=r.createContext({zoomFactor:1,zoom:()=>{}});function mu(){return r.useContext(du)}const pu=({children:e})=>{const[t,n]=r.useState(1),i=r.useCallback((e=>{n((t=>e>0?t*e*1.03:t/(1.03*-e)))}),[]),o=r.useMemo((()=>({zoomFactor:t,zoom:i})),[i,t]);return r.createElement(du.Provider,{value:o},e)},yu={current:null},fu=r.createContext({svgRef:yu,scalerRef:yu}),gu=fu.Provider,Iu=({svgRef:e,scalerRef:t,children:n})=>{const i=r.useMemo((()=>({svgRef:e,scalerRef:t})),[e,t]);return r.createElement(gu,{value:i},n)},hu=hn(((e,t)=>{const{elementIdsByCircuitId:n}=e,r=Object.keys(n);for(const e of r)if(-1!==n[e].indexOf(t))return e;return null})),vu=(e,t,n)=>{if(!t)return!1;if(t===n)return!0;const r=qn(n),{elementsById:i}=e.services.circuitGraph;return Object.keys(i).filter((e=>i[e].elementType===r)).some((n=>{const r=hu(e,n);return!!r&&vu(e,t,r)}))},Eu=r.createContext({editorId:"~none",circuitId:"~none",elementIdPath:[]});function bu(){return r.useContext(Eu)}const wu=({editorId:e,children:t})=>{const n=la((t=>Tt(t,e))),{circuitId:i,elementIdPath:o}=null!=n?n:{circuitId:"~none",elementIdPath:[]},s=r.useMemo((()=>({editorId:e,circuitId:i,elementIdPath:o})),[i,o,e]);return n?r.createElement(Eu.Provider,{value:s},t):null};function ju(e,t,n){const r=t.getScreenCTM();if(!r)return n;const i=e.createSVGPoint();i.x=n.x,i.y=n.y;const o=i.matrixTransform(r.inverse());return{x:o.x,y:o.y}}function Ou(){const{svgRef:e,scalerRef:t}=r.useContext(fu);return r.useCallback((n=>e.current&&t.current?ju(e.current,t.current,n):n),[e,t])}const ku="text-unselectable--2tvXe",xu="element-interaction-toggle--1eeE2",Cu={"integrated-circuit":({elementId:e,elementPath:t,circuitId:n,inputPinIds:i,outputPinIds:o})=>{const c=(0,s.I0)(),l=la((e=>Vn(e,n))),a=la(Mn),u=Qn(i.length,o.length),d=r.useCallback((r=>{e&&(r.defaultPrevented||(r.preventDefault(),c(Ri(n,[...t||[],e]))))}),[e,c,n,t]),m=i.map(((e,t)=>{const n=50*t+25;return r.createElement("g",{key:e},r.createElement("line",{className:"element-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:4,y1:n,x2:10,y2:n}),r.createElement("text",{className:ku,x:15,y:n,dominantBaseline:"middle",fontSize:".7em"},a[e]))})),p=o.map(((e,t)=>{const n=50*t+25;return r.createElement("g",{key:e},r.createElement("line",{key:t,className:"element-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:90,y1:n,x2:100,y2:n}),r.createElement("text",{className:ku,x:85,y:n,textAnchor:"end",dominantBaseline:"middle",fontSize:".7em"},a[e]))}));return r.createElement("g",null,r.createElement("text",{className:S(ku,"element-select-highlight--fill"),textAnchor:"middle",x:50,y:0},l),r.createElement("path",{className:"element-select-highlight--stroke element-select-highlight--fill",stroke:"black",fill:"white",d:u,onDoubleClick:d}),m,p)},"interaction-momentary":({elementId:e,elementPath:t})=>{const n=(0,s.I0)(),i=la(ic),o=r.useMemo((()=>[...t||[],null!=e?e:"~~none"]),[t,e]),c=la((e=>kr(e,o))),l=r.useCallback((e=>{i&&0===e.button&&(e.defaultPrevented||(e.preventDefault(),n((0,Bs.Xx)(o,!0))))}),[o,n,i]),a=r.useCallback((()=>{i&&n((0,Bs.Xx)(o,!1))}),[o,n,i]);let u="darkgreen",d="lightgrey";return c&&c.OUT&&(u="lightgreen",d="black"),r.createElement("g",{onMouseDown:l,onMouseUp:a,onMouseLeave:a,className:xu},r.createElement("rect",{className:"element-select-highlight--stroke element-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),r.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),r.createElement("circle",{cx:25,cy:25,r:17,fill:u}),r.createElement("text",{className:ku,x:25,y:25,fontSize:".8em",fill:d,textAnchor:"middle",dominantBaseline:"middle"},"Push"))},"interaction-toggle":({elementId:e,elementPath:t,evolverState:n})=>{const i=(0,s.I0)(),o=r.useCallback((n=>{e&&0===n.button&&(n.defaultPrevented||(n.preventDefault(),i((0,Bs.Xx)([...t||[],e]))))}),[e,i,t]);let c="darkgreen",l="lightgrey",a="darkred";if(n){const{toggleState:e}=n;e?(c="lightgreen",l="black"):a="red"}return r.createElement("g",{onClick:o,className:xu},r.createElement("rect",{className:"element-select-highlight--stroke element-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),r.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),r.createElement("rect",{x:10,y:10,width:30,height:15,strokeWidth:0,fill:c}),r.createElement("text",{className:ku,x:25,y:19,fontSize:".8em",fill:l,textAnchor:"middle",dominantBaseline:"middle"},"On"),r.createElement("rect",{x:10,y:25,width:30,height:15,strokeWidth:0,fill:a}),r.createElement("text",{className:ku,x:25,y:34,fontSize:".8em",fill:"lightgrey",textAnchor:"middle",dominantBaseline:"middle"},"Off"))}},Bu=({componentName:e})=>r.createElement("g",null,r.createElement("rect",{width:50,height:50,fill:"red"}),r.createElement("text",{x:25,y:25,dominantBaseline:"middle"},e));function Pu(e,t,n,i){const{component:o,componentProps:s}=i,c=Object.assign({elementId:e,elementPath:t,evolverState:n},s);let l;return"string"==typeof o?(l=Cu[o],l||(l=()=>r.createElement(Bu,{componentName:o}))):l=o,r.createElement(l,Object.assign({},c))}const Nu=Object.freeze({}),Su=r.memo((function({className:e,elementId:t,x:n=0,y:i=0,elementType:o}){const s=la((e=>ir(e,o)));let c;c=s?Pu(t,[],Nu,s.visual):r.createElement("rect",{x:n,y:i,width:50,height:50,fill:"red"});const l=0!=n||0!=i?`translate(${n}, ${i})`:void 0;return r.createElement("g",{className:S(e,"element-visual"),transform:l},c)})),Mu=r.memo((function(){const e=(0,s.I0)(),{circuitId:t}=bu(),n=la(un),i=Ou(),{zoomFactor:o}=mu();function c(e){return e*(1/o)}const[l,a]=r.useState(null),[u,d]=r.useState(null),m=la((e=>vu(e,Xn(l),t))),[,p]=(0,ye.L)({accept:lu,collect:e=>{e.isOver()||(d(null),a(null))},hover:(e,t)=>{if(!uu(e))return d(null),void a(null);const n=t.getClientOffset();if(!n)return;const r=i({x:n.x,y:n.y});a(e.payload.elementType),d(r)},drop:(r,o)=>{if(!uu(r))return;if(m)return;const s=o.getClientOffset();if(!s)return;const c=i({x:s.x,y:s.y});e($e(r.payload.elementType,t,(0,b.R9)(c,n)))}},[t,i,n,m]),y=u&&(0,b.R9)(u,n),f=100*c(1)+"%";return r.createElement("g",{id:"drag-new-element-layer"},!m&&y&&l&&r.createElement("g",{opacity:.5},r.createElement(Su,{x:y.x,y:y.y,elementType:l})),m&&r.createElement("g",{transform:`scale(${c(1)})`},r.createElement("rect",{width:"100%",height:"100%",opacity:.7,fill:"black"}),r.createElement("text",{x:"100",y:"25%",fill:"white"},"The current circuit is already inside the dragged IC.")),r.createElement("rect",{ref:p,width:f,height:f,fill:"transparent"}))})),Wu=Xt((e=>e.dragMode)),zu=Xt(((e,t)=>null!=e.dragMode&&e.dragStartEditorId===e.dragEndEditorId&&e.dragStartEditorId===t)),Lu=Xt((e=>null!=e.dragMode)),Tu=Xt((e=>e.dragMode?e.dragStart:null)),Ru=Xt((e=>e.dragMode?e.dragEnd:null));let Du=null;const Au=e=>{const t=e.services.circuitEditorDrag;if("move"!==t.dragMode)return null;let n;n=fi(e).length>0?un(e):dn(e);const{dragStart:r,dragEnd:i,dragModifierKeys:o}=t;if(!i)return null;let s=(0,b.sj)(i,r);if(o.shiftKey){const e=(0,b.Fv)((0,b.sj)(i,r));s=Math.abs(e.x)>=.5?{x:s.x,y:0}:{x:0,y:s.y}}return o.ctrlMetaKey||(s=(0,b.R9)(s,n)),Du&&(0,b.kg)(s,Du)||(Du=s),Du},Ju=e=>{const t=Au(e);if(!t)return null;const n=fi(e),r=Fn(e),i={};for(const e of n)i[e]=(0,b.ZO)(r[e],t);return i},Uu=e=>{const t=Au(e);if(!t)return null;const n=gi(e),r=Xr(e),i={};for(const e of n)i[e]=(0,b.ZO)(r[e],t);return i},Zu=e=>{if("move"!==e.services.circuitEditorDrag.dragMode)return de();const t=gi(e),n=fi(e),r=Au(e);if(!r)return de();function i(t){let i=sr(e,t.elementId,t.pinId);return-1!==n.indexOf(t.elementId)&&(i=(0,b.ZO)(i,r)),i}function o(n){let i=Qr(e,n);return i?(-1!==t.indexOf(n)&&(i=(0,b.ZO)(i,r)),i):b.Ds}function s(e){switch(e.type){case"output":return[i(e.outputPin),o(e.jointId)];case"input":return[o(e.jointId),i(e.inputPin)];case"bridge":return[o(e.jointAId),o(e.jointBId)]}return null}const c=[],l=new Set;for(const n of t){const t=Fr(e,n);for(const n of t){if(l.has(n))continue;l.add(n);const t=s(e.services.circuitGraph.wireSegmentsById[n]);t&&c.push(t)}}return c},Fu=r.memo((function(){const{editorId:e}=bu(),t=la((t=>zu(t,e))),n=la(Ju),i=la(On),o=la(Uu),s=la(Zu);if(!t)return null;const c=lr()(gn()(n,((e,t)=>r.createElement(Su,{key:t,elementType:i[t],x:e.x,y:e.y})))),l=lr()(gn()(o,((e,t)=>r.createElement("circle",{key:t,cx:e.x,cy:e.y,r:2,stroke:"none",fill:"black"})))),a=s.map((([e,t],n)=>r.createElement("line",{key:n,x1:e.x,y1:e.y,x2:t.x,y2:t.y,stroke:"black",strokeWidth:2})));return r.createElement("g",{id:"drag-element-move-preview-layer",opacity:.4},c,l,a)}));function Ku({dragThreshold:e=5,onClick:t,onDragStart:n}){const[i,o]=r.useState(!1),s=r.useRef(null),c=r.useCallback((e=>{e.preventDefault&&(o(!0),s.current={x:e.pageX,y:e.pageY})}),[]),l=r.useCallback((t=>{if(!s.current)return;const r=s.current;(Math.abs(r.x-t.pageX)>=e||Math.abs(r.y-t.pageY)>=e)&&(n&&n(t,s.current),o(!1),s.current=null)}),[e,n]),a=r.useCallback((e=>{s.current&&(t&&t(e),o(!1),s.current=null)}),[t]);return r.useEffect((()=>{if(i)return document.addEventListener("mousemove",l),document.addEventListener("mouseup",a),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)}}),[i,l,a]),{startTracking:c}}function $u(e){const{ctrlKey:t,altKey:n,shiftKey:r,metaKey:i}=e;return{ctrlMetaKey:Wa?i:t,altKey:n,shiftKey:r}}Object.freeze({});const Hu=Xt((0,yn.P1)(Wu.local,Tu.local,Ru.local,((e,t,n)=>"select"===e&&t&&n?(0,b.Qu)(t,n):null))),Gu=({x:e,y:t,open:n,onRequestClose:i,children:o})=>{const s=r.useMemo((()=>({getBoundingClientRect:()=>({left:e,top:t,right:e,bottom:t,width:0,height:0,x:e,y:t})})),[e,t]);return r.createElement(ba,{value:i},r.createElement(ha,{isOpen:n,onRequestClose:i,anchorEl:s,placement:"bottom-start"},o))};function Yu(){const[e,t]=r.useState(null),n=r.useCallback((e=>{t({x:e.pageX,y:e.pageY})}),[]),i=r.useCallback((()=>{t(null)}),[]);return{openContextMenu:n,renderContextMenu:r.useCallback((t=>e?("function"==typeof t&&(t=t({point:e})),r.createElement(Gu,{open:!0,onRequestClose:i,x:e.x,y:e.y},t)):null),[e,i])}}const Vu=({fieldPosition:e})=>{const t=ta(Xe),n=la(fi).length>0,i=ta(vs),o=la(Ra),s=ta(nt,{pastePosition:e}),c=ta(_e);return r.createElement(r.Fragment,null,r.createElement(Pa,{onClick:t},"Align Selection To Grid"),r.createElement(Na,null),r.createElement(Pa,{disabled:!n,secondary:za+"+c",onClick:i},"Copy"),r.createElement(Pa,{disabled:!o,secondary:za+"+v",onClick:s},"Paste"),r.createElement(Na,null),r.createElement(Pa,{onClick:c},"Delete Selected"))},qu=({fieldPosition:e})=>r.createElement(Ba,null,r.createElement(Vu,{fieldPosition:e})),Xu=r.memo((function(){const e=(0,s.I0)(),{editorId:t}=bu(),{zoomFactor:n}=mu(),i=la((e=>zu(e,t))),o=la(Hu);function c(e){return e*(1/n)}const l=Ou(),{openContextMenu:a,renderContextMenu:u}=Yu(),d=r.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),a(e))}),[a]),m=r.useCallback((t=>{if(0!==t.button)return;const n=$u(t);n.ctrlMetaKey||n.shiftKey||e({type:ls})}),[e]),p=r.useCallback(((n,r)=>{const i=l(r),o=$u(n);e(((e,t,n)=>({type:Ei,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(i,o,t))}),[e,t,l]),{startTracking:y}=Ku({onClick:m,onDragStart:p});return r.createElement("g",{className:"circuit-editor-mouse-layer"},r.createElement("rect",{width:100*c(1)+"%",height:100*c(1)+"%",fill:"transparent",onMouseDown:y,onContextMenu:d}),i&&o&&r.createElement("g",{transform:`translate(${o.p1.x}, ${o.p1.y})`},r.createElement("rect",{width:o.p2.x-o.p1.x,height:o.p2.y-o.p1.y,strokeWidth:c(2),strokeDasharray:`${c(5)} ${c(3)}`,stroke:"skyblue",fill:"transparent"})),u((({point:e})=>r.createElement(qu,{fieldPosition:l(e)}))))})),Qu=r.memo((function(){const[e]=r.useState("grid-"+(0,Re.Z)()),{zoomFactor:t}=mu(),n=50*t;return r.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},r.createElement("defs",null,r.createElement("pattern",{id:e,width:n,height:n,patternUnits:"userSpaceOnUse"},r.createElement("path",{d:`M ${n} 0 L 0 0 0 ${n}`,fill:"none",stroke:"gray",strokeWidth:.5}))),r.createElement("rect",{width:"100%",height:"100%",fill:`url(#${e})`}))})),_u=r.forwardRef((({className:e,autoFocus:t,defaultValue:n,value:i,onChange:o,onBeginEdit:s,onCommit:c,onCancel:l,onBlur:a,onKeyUp:u},d)=>{const[m,p]=r.useState(null),y=r.useCallback((e=>{null==m&&s&&s(),p(e.target.value),o&&o(e)}),[m,s,o]),f=r.useCallback((e=>{u&&u(e),e.defaultPrevented||null!=m&&("Escape"===e.key?(e.preventDefault(),l&&l()):"Enter"===e.key&&(e.preventDefault(),c&&c(m)))}),[u,m,l,c]),g=r.useCallback((e=>{a&&a(e),null!=m&&c&&c(m)}),[a,m,c]);return r.createElement("input",{ref:d,className:e,autoFocus:t,defaultValue:n,value:i,type:"text",onChange:y,onKeyUp:f,onBlur:g})})),ed=({className:e,textClassname:t,inputClassname:n,label:i,defaultValue:o,isEditing:s,onRequestEdit:c,onCommit:l,onCancel:a})=>{const u=r.useRef(null),d=r.useCallback((e=>{c&&(e.defaultPrevented||(e.preventDefault(),c()))}),[c]),m=r.useCallback((e=>{"Escape"===e.key&&s&&a()}),[s,a]),p=r.useCallback((()=>{s&&a()}),[s,a]);return r.useEffect((()=>{s&&u.current&&u.current.select()}),[s]),s?r.createElement(_u,{ref:u,className:S(e,n),autoFocus:!0,defaultValue:o,onBlur:p,onKeyUp:m,onCommit:l,onCancel:a}):r.createElement("span",{className:S(e,t),onDoubleClick:d},null!=i?i:o)},td=e=>{const{onRequestEdit:t,onCommit:n}=e,i=Ea(),o=r.useCallback((()=>{t&&t()}),[t]),s=r.useCallback((e=>{n(e),i()}),[n,i]);return r.createElement("li",{className:ja,onClick:o},r.createElement(ed,Object.assign({},e,{onCommit:s})))},nd=({elementId:e,fieldPosition:t})=>{const n=(0,s.I0)(),{elementIdPath:i}=bu(),o=la(ic),c=la((t=>Wn(t,e))),l=la((t=>Cn(t,e))),a=l?Xn(l):null,[u,d]=r.useState(!1),m=r.useCallback((()=>{d(!0)}),[]),p=r.useCallback((()=>{d(!1)}),[]),y=r.useCallback((t=>{d(!1),n(((e,t)=>({type:Ve,payload:{elementId:e,elementName:t}}))(e,t))}),[n,e]),f=r.useCallback((()=>{a&&n(Ri(a,[...i,e],{newWindow:!0}))}),[i,n,a,e]);return o?null:r.createElement(Ba,null,r.createElement(td,{defaultValue:null!=c?c:"<unknown>",label:r.createElement("span",{style:{fontWeight:600}},c),isEditing:u,onRequestEdit:m,onCommit:y,onCancel:p}),r.createElement(Na,null),a&&r.createElement(r.Fragment,null,r.createElement(Pa,{onClick:f},"Open in New Window"),r.createElement(Na,null)),r.createElement(Vu,{fieldPosition:t}))},rd=r.memo((function({elementId:e}){const t=(0,s.I0)(),{editorId:n,elementIdPath:i}=bu(),o=la(ic),{openContextMenu:c,renderContextMenu:l}=Yu(),a=la((t=>Gi(t,e))),{x:u,y:d}=la((t=>Kn(t,e))),m=la((t=>((e,t)=>{const{evolverIdsByElementId:n}=Or(e),r=e.services.simulator.evolverStatesByEvolverId,i=dr(n,t);if(i)return r[i]})(t,[...i,e]))),p=la((t=>Ii(t,e))),y=Ou(),f=r.useCallback((n=>{if(o)return;if(n.defaultPrevented)return;if(0!==n.button)return;n.preventDefault();const r=sn($u(n));t(mi(e,r))}),[t,o,e]),g=r.useCallback((n=>{if(n.defaultPrevented)return;n.preventDefault();const r=sn($u(n),"set-if-unselected");t(mi(e,r)),c(n)}),[t,e,c]),I=r.useCallback(((r,i)=>{const o=y(i),s=$u(r);t(((e,t,n,r)=>({type:ui,payload:Object.assign(Object.assign({},t),{elementId:e,modifierKeys:n,editorId:r})}))(e,o,s,n))}),[y,t,e,n]),{startTracking:h}=Ku({onClick:f,onDragStart:I}),v=r.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),o||0===e.button&&h(e))}),[o,h]);let E,w;if(a){const{hitRect:t}=a.visual;E=Pu(e,i,m,a.visual),w=t}else E=r.createElement("rect",{x:u,y:d,width:50,height:50,fill:p?"goldenrod":"red"}),w={p1:b.Ds,p2:{x:50,y:50}};const j=0!=u||0!=d?`translate(${u}, ${d})`:void 0;return r.createElement("g",{transform:j},r.createElement("g",{id:Ll(n,e),className:S("circuit-field-element",p&&"element-selected"),onMouseDown:v,onContextMenu:g},E),r.createElement(id,{elementId:e,hitRect:w}),l((({point:t})=>r.createElement(nd,{elementId:e,fieldPosition:y(t)}))))})),id=r.memo((function({elementId:e,hitRect:t}){const{zoomFactor:n}=mu(),i=la((t=>((e,t)=>{switch(e.services.uiSettings.elementNameMode){case"all":default:return Wn(e,t);case"named-only":return zn(e,t);case"none":return null}})(t,e))),o=Math.max(.7,n);let s=15;return o>1?s-=2*o:s+=1/o*7,i?r.createElement("text",{fontSize:1.2/o+"em",className:ku,textAnchor:"middle",x:t.p1.x+(t.p2.x-t.p1.x)/2,y:t.p2.y+s},i):null})),od=rd,sd=r.memo((function(){const{circuitId:e}=bu(),t=la((t=>Nn(t,e))).map((e=>r.createElement(od,{key:e,elementId:e})));return r.createElement("g",null,t)}));var cd=n(784),ld=n(2196);const ad=hn(((e,t)=>{const n=e.wireSegmentsById[t];if(!n||fr(n))return[];const r=Nr.local(e,t);if(!r)return[];const[i,o]=bn(e,r);let s=[];return yr(n)?s=o.map((t=>{const r=function(e,t){for(const n of lr()(e.wireSegmentsById))if(pr(n)&&n.lineId===t)return n.outputPin;return null}(e,t);return r?{name:`From [${Wn.local(e,r.elementId)}]:[${Vi.local(e,r.elementId,r.pinId)}]`,lineId:t,selected:t===n.lineId}:null})).filter(L):pr(n)&&(s=i.filter((t=>!function(e,t,n){for(const r of lr()(e.wireSegmentsById))if(n!==r&&pr(r)&&r.lineId===t)return!0;return!1}(e,t,n))).map((t=>{const r=function(e,t){const n=[];for(const r of lr()(e.wireSegmentsById))yr(r)&&r.lineId===t&&n.push(r.inputPin);return n}(e,t);if(0===r.length)return null;let i=`To [${Wn.local(e,r[0].elementId)}]:[${Vi.local(e,r[0].elementId,r[0].pinId)}]`;return r.length>1&&(i+=`(+${r.length-1})`),{name:i,lineId:t,selected:t===n.lineId}})).filter(L)),(0,ld.X)(s,"name","asc")})),ud=({elementId:e,pinId:t})=>{const n=la(ic),i=la((n=>Yi(n,e,t))),o=la((n=>Rr(n,e,t)));return!n&&i&&o?r.createElement(Ba,null,r.createElement(Za,{content:r.createElement(dd,{segmentId:o,direction:i})},"Set ","input"===i?"Input":"Output")):null},dd=({segmentId:e,direction:t})=>{const n=(0,s.I0)(),i=la((t=>ad(t,e)));return r.createElement(Ba,null,r.createElement(Ua,{value:!1,onChange:()=>n(kt(e,(0,Re.Z)()))},"New ","input"===t?"Input":"Output"),i.map((({lineId:t,name:i,selected:o})=>r.createElement(Ua,{key:t,value:o,onChange:()=>n(kt(e,t))},i))))},md="highlight--Q2iLD",pd="is-drag-target--1NYuw",yd=r.memo((function({elementId:e,pinId:t}){const n=(0,s.I0)(),{editorId:i}=bu(),o=Ou(),{openContextMenu:c,renderContextMenu:l}=Yu(),[a,u]=r.useState(!1),d=la((n=>sr(n,e,t))),m=la((n=>Yi(n,e,t))),p=la((n=>((e,t,n)=>{const r=ri(e);return!!r&&"pin"===r.type&&r.pin.elementId===t&&r.pin.pinId===n})(n,e,t))),y=r.useCallback(((r,s)=>{const c=o(s),l=$u(r);n(Bi(c,{type:"pin",pin:{elementId:e,pinId:t}},l,i))}),[n,i,o,e,t]),{startTracking:f}=Ku({onDragStart:y}),g=r.useCallback((e=>{0===e.button&&(e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),f(e)))}),[f]),I=r.useCallback((()=>{u(!0)}),[]),h=r.useCallback((()=>{u(!1)}),[]),v=r.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),c(e))}),[c]);if(!d)return null;const{x:E,y:b}=d;let w;return w="input"===m?r.createElement("path",{d:(0,cd.x)(E,b,4,-45,225),strokeWidth:2,className:S("element-pin-input--1urBY",p&&pd,a&&md)}):r.createElement("circle",{className:S("element-pin-output--1jFy-",p&&pd,a&&md),cx:E,cy:b,r:3}),r.createElement("g",{id:Tl(i,e,t),onMouseEnter:I,onMouseLeave:h,onContextMenu:v},w,r.createElement("circle",{stroke:"none",fill:"transparent",cx:E,cy:b,r:5,onMouseDown:g}),l(r.createElement(ud,{elementId:e,pinId:t})))})),fd=r.memo((function({elementId:e}){var t;const n=la((t=>Gi(t,e))),i=null!==(t=null==n?void 0:n.pins)&&void 0!==t?t:{},o=Object.keys(i).map((t=>r.createElement(yd,{key:t,elementId:e,pinId:t})));return r.createElement(r.Fragment,null,o)})),gd=r.memo((function(){const{circuitId:e}=bu(),t=la((t=>Nn(t,e))).map((e=>r.createElement(fd,{key:e,elementId:e})));return r.createElement("g",null,t)})),Id=()=>{const e=(0,s.I0)(),{editorId:t}=bu(),{zoomFactor:n}=mu(),i=la(Lu);function o(e){return e*(1/n)}const c=function(){const{svgRef:e,scalerRef:t}=r.useContext(fu);return r.useCallback((n=>{if(!e.current||!t.current)return b.Ds;const r={x:n.pageX,y:n.pageY};return ju(e.current,t.current,r)}),[e,t])}(),l=r.useCallback((n=>{if(0===n.buttons)return void e(Vt());const r=c(n),i=$u(n);e(((e,t,n)=>({type:_t,payload:{dragPos:e,modifierKeys:t,editorId:n}}))(r,i,t))}),[e,t,c]),a=r.useCallback((n=>{const r=c(n),i=$u(n);e(((e,t,n)=>({type:rt,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(r,i,t))}),[e,t,c]);return i?r.createElement("rect",{width:100*o(1)+"%",height:100*o(1)+"%",fill:"transparent",onMouseMove:l,onMouseUp:a}):null},hd=({wireId:e,wireSegmentId:t})=>{const n=(0,s.I0)(),{editorId:i,elementIdPath:o}=bu(),c=Ou(),l=r.useRef(!1),[a,u]=r.useState(null),d=la(ic),m=la((e=>vi(e,t))),p=la((e=>Yr(e,o,t))),y=la((e=>((e,t)=>{const n=Kr(e)[t];return n&&n.length>0})(e,t))),f=la((e=>((e,t)=>{const n=ri(e);return n?"segment"!==n.type||n.segmentId!==t?null:n.segmentInsertLength:null})(e,t))),g=la(Lu),I=la(dn),h=la((e=>zr(e,t))),v=la((e=>_r(e,t))),E=la((e=>ei(e,t))),w=(0,b.Fv)((0,b.sj)(E,v)),j=f?(0,b.ZO)(v,(0,b.bA)(w,f)):null,O=r.useCallback((r=>{if(l.current=!1,!a)return;const o=$u(r);n(((e,t,n,r,i)=>({type:ki,payload:Object.assign(Object.assign({},e),{wireId:t,wireSegmentId:n,modifierKeys:r,editorId:i})}))(a,e,t,o,i)),u(null)}),[n,i,a,e,t]),k=r.useCallback((e=>{if(e.defaultPrevented)return;e.preventDefault(),l.current=!1,u(null);const r=sn($u(e));n(((e,t="set")=>({type:gs,payload:{segmentIds:Array.isArray(e)?e:[e],mode:t}}))(t,r))}),[n,t]),{startTracking:x}=Ku({onDragStart:O,onClick:k});return r.createElement("g",{className:S("wire-segment--3ENBk",!y&&"unwired--2GWhN",m&&"selected--1ceWg",p&&"powered--I4EaN"),onMouseMove:e=>{if(g||d||l.current)return;const t=$u(e),n=c({x:e.pageX,y:e.pageY}),r=(0,b.sj)(n,v),i=(0,b.Ih)(r,w),o=(0,b.ZO)(v,(0,b.bA)(w,i));t.ctrlMetaKey||(1===Math.abs(w.x)&&(o.x=(0,b.n$)(o.x,I)),1===Math.abs(w.y)&&(o.y=(0,b.n$)(o.y,I))),u(o)},onMouseLeave:()=>{l.current||u(null)},onMouseDown:e=>{e.defaultPrevented||g||d||(l.current=!0,x(e))}},r.createElement("line",{x1:v.x,x2:E.x,y1:v.y,y2:E.y,stroke:"inherit",strokeWidth:2}),r.createElement("line",{x1:v.x,x2:E.x,y1:v.y,y2:E.y,stroke:"transparent",strokeWidth:4}),("input"===h||"input-output"===h)&&r.createElement("circle",{cx:E.x,cy:E.y,r:2,stroke:"none",fill:"inherit"}),!j&&a&&r.createElement("circle",{cx:a.x,cy:a.y,r:3,fill:"orange",stroke:"none"}),j&&r.createElement("circle",{className:"drag-wire-target--20uzz",cx:j.x,cy:j.y,r:3,stroke:"none"}))},vd=({wireId:e,jointId:t})=>{const n=(0,s.I0)(),{editorId:i}=bu(),o=Ou(),c=la(ic),l=la((e=>Qr(e,t))),a=la((e=>hi(e,t))),u=la((e=>((e,t)=>{const n=ri(e);return!!n&&"joint"===n.type&&n.jointId===t})(e,t))),[d,m]=r.useState(!1),p=r.useCallback((r=>{const s=o({x:r.pageX,y:r.pageY}),c=$u(r);n(((e,t,n,r,i)=>({type:wi,payload:Object.assign(Object.assign({},e),{wireId:t,jointId:n,modifierKeys:r,editorId:i})}))(s,e,t,c,i))}),[n,i,o,t,e]),y=r.useCallback((e=>{if(e.defaultPrevented)return;e.preventDefault();const r=sn($u(e));n(Oi(t,r))}),[n,t]),{startTracking:f}=Ku({onDragStart:p,onClick:y}),g=`${(0,cd.x)(l.x,l.y,8.5,0,180)} ${(0,cd.x)(l.x,l.y,8.5,180,0)} z ${(0,cd.x)(l.x,l.y,5,0,180)} ${(0,cd.x)(l.x,l.y,5,180,0)}`;return l?r.createElement("g",{id:Dl(i,t),onMouseOver:()=>{m(!0)},onMouseLeave:()=>{m(!1)}},r.createElement("circle",{cx:l.x,cy:l.y,r:6,fill:"transparent",stroke:"none"}),r.createElement("circle",{className:S(u&&"is-drag-target--1nP1l"),cx:l.x,cy:l.y,r:3,fill:"black",stroke:"none"}),!c&&!u&&(d||a)&&r.createElement("g",{className:S("wire-joint--interactor--3h5o4",a&&"selected--2L-Hh")},d&&r.createElement("g",{onMouseDown:e=>{const r=o({x:e.pageX,y:e.pageY}),s=$u(e);n(Bi(r,{type:"joint",jointId:t},s,i))}},r.createElement("circle",{cx:l.x,cy:l.y,r:8.5,stroke:"none",fill:"transparent",className:"mouse-detector--23NpN"}),r.createElement("path",{shapeRendering:"geometricPrecision",stroke:"none",fill:"black",fillRule:"evenodd",d:g})),r.createElement("circle",{cx:l.x,cy:l.y,r:3,fill:"black",stroke:"none",onMouseDown:f}))):null},Ed=({wireId:e})=>{const{editorId:t}=bu(),n=la((t=>Pr(t,e))),i=la((t=>Sr(t,e))),o=n.map((t=>r.createElement(hd,{key:t,wireId:e,wireSegmentId:t}))),s=i.map((t=>r.createElement(vd,{key:t,wireId:e,jointId:t})));return r.createElement("g",{id:Rl(t,e)},o,s)},bd=r.memo((function(){const{circuitId:e}=bu(),t=la((t=>Ar(t,e))).map((e=>r.createElement(Ed,{key:e,wireId:e})));return r.createElement("g",{className:"circuit-editor-wires-layer"},t)})),wd=()=>{const e=la(li),t=la(oi),n=la(ci),i=la(ai).map((([e,t],n)=>r.createElement("line",{key:n,x1:e.x,y1:e.y,x2:t.x,y2:t.y,stroke:"black",strokeWidth:2,opacity:.4})));return t||n||e||0!==i.length?r.createElement("g",{className:"circuit-editor-drag-wire-preview"},i,e&&r.createElement("circle",{cx:e.x,cy:e.y,r:2,opacity:.4,stroke:"none",fill:"black"}),t&&n&&r.createElement("line",{x1:t.x,y1:t.y,x2:n.x,y2:n.y,stroke:"black",strokeWidth:2,opacity:.4})):null},jd=({width:e,height:t})=>{const n=(0,s.I0)(),{zoomFactor:i}=mu(),o=r.useRef(null),c=r.useRef(null),l=r.useCallback((()=>{var e;null===(e=o.current)||void 0===e||e.focus()}),[]),a=r.useCallback((()=>{n({type:Ni})}),[n]),[{isDraggingNewElement:u},d]=(0,ye.L)({accept:lu,collect:e=>({isDraggingNewElement:e.isOver()})});return r.createElement("svg",{tabIndex:-1,ref:e=>{o.current=e,d(e)},width:e,height:t,onMouseDown:l,onMouseLeave:a,className:"circuit-field-svg--o7YIn"},r.createElement(Qu,null),r.createElement("g",{ref:c,"transform-origin":"0 0",transform:`scale(${i})`},r.createElement(Iu,{svgRef:o,scalerRef:c},r.createElement(Xu,null),r.createElement(sd,null),r.createElement(bd,null),r.createElement(gd,null),r.createElement(Fu,null),r.createElement(wd,null),u&&r.createElement(Mu,null),r.createElement(Id,null))))},Od=({})=>{const e=r.useRef(null),{width:t,height:n}=pe(e),{zoomFactor:i,zoom:o}=mu(),s=la(cu),{width:c,height:l}=(0,b.nF)(s),a=Math.max(t,c*i),u=Math.max(n,l*i);return aa(e,"wheel",r.useCallback((e=>{e.defaultPrevented||e.ctrlKey&&(o(e.deltaY>0?-1:1),e.preventDefault(),e.stopPropagation())}),[o]),{passive:!1}),r.createElement("div",{ref:e,style:{width:"100%",height:"100%"}},r.createElement(jd,{width:a,height:u}))},kd=({className:e,editorId:t})=>{const n=la(ic);return r.createElement(wu,{editorId:t},r.createElement("div",{id:zl(t),className:S("circuit-editor","circuit-editor--2jFUa",n&&"simulator-active",e)},r.createElement("div",{className:"circuit-editor-scrollarea--12k0x"},r.createElement(pu,null,r.createElement(Od,null)))))};var xd=n(1474);const Cd=e=>r.createElement("svg",Object.assign({width:16,height:16},e,{className:S(Ya,e.className)}),r.createElement("path",{d:"M4,4 L12,12 M4,12 L12,4"})),Bd=({className:e,id:t,title:n,children:i})=>{const o=_(),{closeWindow:s}=re(),c=r.useCallback((()=>{s(o)}),[s,o]),[,l]=(0,xd.c)({item:ge(o)});return r.createElement(he,{id:t,className:V["tessel-window"]},r.createElement("div",{ref:l,className:V["tessel-window-titlebar"]},r.createElement("div",{className:V["tessel-window-title"]},n),r.createElement("div",{className:V["tessel-window-controls"]},r.createElement(Cd,{className:V["tessel-window-controls-close"],onClick:c}))),r.createElement("div",{className:S(V["tessel-window-content"],e)},i))},Pd="keymap:CircuitEditor/SimStep",Nd="keymap:CircuitEditor/SelectAll",Sd="keymap:CircuitEditor/Copy",Md="keymap:CircuitEditor/Paste",Wd="keymap:CircuitEditor/Delete",zd="keymap:CircuitEditor/Undo",Ld="keymap:CircuitEditor/Redo",Td={[Pd]:"space",[Nd]:za+"+a",[Sd]:za+"+c",[Md]:za+"+v",[Wd]:["backspace","del"],[zd]:za+"+z",[Ld]:[za+"+y",za+"+shift+z"]};const Rd=e=>{var{children:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["children"]);return r.createElement("div",Object.assign({},n,{className:T}),t)},Dd=({id:e,value:t,label:n,isSelected:i,onItemSelected:o})=>{const s=r.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),o(t))}),[o,t]);return r.createElement("li",{id:e,className:S("selection-list-item","selection-list-item--errDr",i&&"selection-list-item--selected--3MkqB"),onClick:s},r.createElement("div",{className:S("selection-list-item-content--321YU",ku)},n))},Ad=({className:e,id:t,items:n,onItemSelected:i})=>r.createElement("ul",{id:t,className:S("selection-list","selection-list--3yujH",e)},n.map((e=>r.createElement(Dd,Object.assign({key:e.value},e,{onItemSelected:i}))))),Jd=({circuitId:e})=>{const t=(0,s.I0)(),n=la((t=>Vn(t,e))),[i,o]=r.useState(!1),{openContextMenu:c,renderContextMenu:l}=Yu(),a=r.useCallback((()=>{e!==m&&o(!0)}),[e]),u=r.useCallback((()=>{o(!1)}),[]),d=r.useCallback((n=>{t(((e,t)=>({type:Fe,payload:{circuitId:e,circuitName:t}}))(e,n)),o(!1)}),[e,t]),p=r.useCallback((n=>{n.preventDefault(),t(Ri(e,null,{newWindow:!0}))}),[e,t]),y=r.useCallback((n=>{n.preventDefault(),t((e=>({type:Ue,payload:{circuitId:e}}))(e))}),[t,e]),f=r.useCallback((e=>{e.preventDefault(),e.stopPropagation(),c(e)}),[c]);return r.createElement("div",{className:"circuitstree-item--22dzG",onContextMenu:f,onDoubleClick:a},r.createElement(ed,{defaultValue:n,isEditing:i,onRequestEdit:a,onCommit:d,onCancel:u}),l(r.createElement(Ba,null,e!==m&&r.createElement(r.Fragment,null,r.createElement(Pa,{onClick:a},"Rename Circuit"),r.createElement(Na,null)),r.createElement(Pa,{onClick:p},"Open in New Window"),e!==m&&r.createElement(r.Fragment,null,r.createElement(Na,null),r.createElement(Pa,{onClick:y},"Delete Circuit")))))},Ud=()=>{const e=(0,s.I0)(),t=r.useCallback((()=>{e(Ae())}),[e]);return r.createElement(Ba,null,r.createElement(Pa,{onClick:t},"New Circuit"))},Zd=({className:e,isOpen:t,anchorEl:n,placement:o="auto",children:s})=>{const[c,l]=r.useState(null),[a,u]=r.useState(null),{attributes:d,styles:m}=(0,ma.D)(t?n:null,c,{placement:o,modifiers:[{name:"arrow",options:{element:a}},{name:"offset",options:{offset:[0,8]}}]});return t?(0,i.createPortal)(r.createElement("div",Object.assign({ref:l,className:S("tooltip--2yxRI",e),style:m.popper,role:"tooltip"},d.popper),s,r.createElement("div",Object.assign({ref:u,"data-popper-arrow":!0,className:"tooltip-arrow--2mJMo",style:m.arrow},d.arrow))),document.body):null},Fd={"input-output":"I/O","integrated-circuit":"Integrated Circuits",logic:"Logic"},Kd=({category:e,search:t})=>{const n=la(nr).filter((t=>t.category===e)).filter((function(n){return n.category===e&&(null===t||-1!==n.displayName.toLowerCase().indexOf(t))})).map((e=>r.createElement($d,{key:e.type,elementType:e.type})));return 0===n.length?null:r.createElement(r.Fragment,null,r.createElement("li",{className:"element-tray-category--3K8sv"},Fd[e]),n)},$d=({elementType:e})=>{const[t,n]=r.useState(null),i=la((t=>ir(t,e))),[o,s]=r.useState(!1),c=r.useCallback((e=>{e.preventDefault(),s(!0)}),[]),l=r.useCallback((e=>{e.target===t&&s(!1)}),[t]),[,a]=(0,xd.c)({item:au(e)});let u,d=e,m="0 0 50 50";if(i){const{trayComponent:e,hitRect:t}=i.visual;if(e){const t=e;u=r.createElement(t,null)}else u=Pu(void 0,[],void 0,i.visual),m=`${t.p1.x} ${t.p1.y} ${t.p2.x} ${t.p2.y}`;d=i.displayName}else u=r.createElement(Hd,null);return r.createElement("li",{id:"element-tray--element-"+e,ref:e=>{n(e),a(e)},className:"element-tray-item--32gev",onClick:c,onMouseOut:l},r.createElement(Zd,{placement:"top",isOpen:o,anchorEl:t},"Click and drag to create a new circuit element."),r.createElement("span",{className:"element-tray-item-preview--12k1m"},r.createElement("svg",{width:30,height:30,viewBox:m},u)),r.createElement("span",{className:ku},d))},Hd=()=>r.createElement("rect",{fill:"red",x1:0,y1:0,x2:50,y2:50}),Gd={"element-tray":()=>{const e=la(nr),t=ur()(e.map((e=>e.category))),[n,i]=r.useState(""),o=r.useCallback((e=>{i(e.target.value.toLowerCase())}),[]);return r.createElement(Bd,{id:"element-tray",title:"Elements",className:"element-tray--2OmR6"},r.createElement("div",null,r.createElement("input",{className:"element-tray-search--2PYcp",type:"text",value:n,onChange:o,placeholder:"Search"})),r.createElement("div",{className:"element-tray-element-container--1jqen"},r.createElement("ul",{className:"element-tray-element-list--3RXLA"},t.map((e=>r.createElement(Kd,{key:e,category:e,search:n}))))))},"circuit-field":({editorId:e})=>{var t,n;const i=(0,s.I0)(),{circuitId:o,elementIdPath:c}=null!==(t=la((t=>Tt(t,e))))&&void 0!==t?t:{circuitId:null,elementIdPath:[]},l=null!==(n=la((e=>Vn(e,o))))&&void 0!==n?n:"<Circuit Missing>",a=r.useMemo((()=>{function e(e){return t=>{if(t){if(t.defaultPrevented)return;t.preventDefault()}i(e)}}return{[Pd]:e($s()),[Nd]:e({type:ss}),[Sd]:e(vs()),[Md]:e(nt()),[Wd]:e(_e()),[zd]:e(ot()),[Ld]:e(lt())}}),[i]),u=r.useCallback((()=>{i((e=>({type:Wi,payload:{editorId:e}}))(e))}),[i,e]);return r.createElement(Bd,{title:l+" [Circuit]"},r.createElement(nu.HotKeys,{keyMap:Td,handlers:a,component:Rd},r.createElement("div",{onFocus:u,className:S("circuit-field-view",T,R["flex-column"])},r.createElement(ou,{circuitId:o,elementIdPath:c}),r.createElement(kd,{className:S(T,R["flexitem-shrink"]),editorId:e}))))},"circuits-list":()=>{const e=(0,s.I0)(),t=la(Yn),{openContextMenu:n,renderContextMenu:i}=Yu(),o=r.useCallback((t=>{e(Ri(t))}),[e]),c=r.useCallback((e=>{e.preventDefault(),n(e)}),[n]),l=r.useMemo((()=>Object.keys(t).map((e=>({id:Hl(e),value:e,label:r.createElement(Jd,{circuitId:e})})))),[t]);return r.createElement(Bd,{id:"circuit-list-window",title:"Circuits",className:S("circuitstree--QeaI9")},r.createElement("div",{className:T,onContextMenu:c},r.createElement(Ad,{className:T,id:"circuit-list",items:l,onItemSelected:o})),i(r.createElement(Ud,null)))}};function Yd(e){const t=Gd[e.windowId];return t?r.createElement(t,Object.assign({},e.windowProps)):null}const Vd=()=>{const e=(0,s.I0)();r.useEffect((()=>{e($c("editor"))}),[e]);const t=la(ua),n=r.useCallback((t=>{e((e=>({type:wc,payload:{layout:e}}))(t))}),[e]),i=r.useCallback((t=>{let n=t.target;for(;null!=n;){if(n.classList.contains("circuit-editor"))return;n=n.parentElement}e(Vt())}),[e]);return aa({current:document.body},"mouseup",i),r.createElement("div",{className:S(T,R["flex-column"])},r.createElement(tu,{className:R["flexitem-fix"]}),r.createElement("div",{className:S(T,R["flexitem-shrink"])},r.createElement(be,{className:S("project-editor",T),rootItem:t,onLayoutChange:n,renderWindow:Yd})))},qd=({location:e})=>{const t=(0,s.I0)(),[n,i]=r.useState(!1);return r.useEffect((()=>{let n;try{n=new URLSearchParams(e.search)}catch(e){return void i(!0)}const r=n.get("data");r?t((e=>({type:ml,payload:{data:e}}))(r)):i(!0)}),[]),n?r.createElement("div",null,"Failed to import project"):r.createElement("div",null,"Importing Project...")},Xd=()=>r.createElement(c.rs,null,r.createElement(c.AW,{exact:!0,path:"/",component:ca}),r.createElement(c.AW,{exact:!0,path:"/editor",component:Vd}),r.createElement(c.AW,{exact:!0,path:"/import",component:qd})),Qd=no((e=>e.dialogType)),_d=no((e=>e.data));var em=n(227),tm=n(1074);const nm=({className:e,isOpen:t,onRequestClose:n,children:o})=>t?(0,i.createPortal)(r.createElement("div",{className:S("modal","modal--25LBN")},r.createElement(em.Y,{onClickOutside:n,onEscapeKey:n},r.createElement("div",{className:S("modal-content--1H0T_",e)},r.createElement(tm.Z,{className:T},o)))),document.body):null,rm=({isOpen:e,title:t,acceptText:n,cancelText:i,onAccept:o,onCancel:s,footer:c,children:l})=>r.createElement(nm,{className:"dialog--1eQi6",isOpen:e,onRequestClose:s},r.createElement("div",{className:"dialog-title--1DWsL"},t),r.createElement("div",null,l),r.createElement("div",{className:"dialog-footer--2hYdr"},c,s&&r.createElement(ia,{onClick:s},null!=i?i:"Cancel"),o&&r.createElement(ia,{variant:"primary",onClick:o},null!=n?n:"Accept"))),im=()=>{const e=ta(eo),t=la(_d),n=null==t?void 0:t.projectLink,i=r.useCallback((()=>{n&&navigator.clipboard.writeText(n).catch((()=>{}))}),[n]);if(!n)return null;const o=r.createElement(ia,{variant:"primary",onClick:i},"Copy to Clipboard");return r.createElement(rm,{isOpen:!0,title:"Export Project Link",cancelText:"Close",onCancel:e,footer:o},r.createElement("div",{className:"export-link-dialog-link-container--phwUA"},r.createElement("code",{className:"export-link-dialog-link--1dOdK"},n)))},om=({circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:i})=>{const o=r.useCallback((t=>{t.target.checked&&i(ur()([...n,e]))}),[e,i,n]);return r.createElement(Ja,{onChange:o,value:-1!==n.indexOf(e)},t)},sm=()=>{const e=(0,s.I0)(),t=la(_d),[n,i]=r.useState([]),o=ta(oo),c=r.useCallback((()=>{e(eo(n))}),[e,n]);if(!t)return null;const{circuits:l}=t;return r.createElement(rm,{isOpen:!0,title:"Import Circuits",onAccept:c,onCancel:o,acceptText:"Import Circuits"},r.createElement("div",null,r.createElement("p",null,"Choose the circuits to import."),r.createElement("p",null,"Any chosen circuits that depend on other circuits will import their dependencies automatically."),r.createElement("p",null,"If any circuits already exist in your project, they will not be re-imported.")),r.createElement("ul",{className:"import-project-circuits-list--2ODCz"},l.map((({circuitId:e,circuitName:t})=>r.createElement("li",{key:e},r.createElement(om,{circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:i}))))))};const cm=()=>{const e=la(Qd);if(!e)return null;const t=function(e){switch(e){case"export-project-link":return im;case"import-project-circuits":return sm;default:return function(e){throw new Error("Unknown dialog type "+e)}(e)}}(e);return r.createElement(t,null)},lm=({selector:e,message:t,placement:n,action:i=[]})=>{const o=(0,s.I0)(),c=function(e){const[t,n]=r.useState(null);return r.useEffect((()=>{const t=new MutationObserver((()=>{n(document.querySelector(e))}));return t.observe(document.body,{childList:!0,subtree:!0}),n(document.querySelector(e)),()=>{t.disconnect()}}),[e]),t}(e);r.useEffect((()=>{c&&c.scrollIntoView()}),[c]);const l=le(i);if(!c||!t&&!l.length)return null;const a=l.map((({name:e,action:t})=>r.createElement(ia,{key:e,size:"small",onClick:()=>o(t)},e)));return r.createElement(Zd,{className:"tutorial-tooltip--3gwli",anchorEl:c,placement:n,isOpen:!0},t,a&&r.createElement("div",{className:"tutorial-tooltip-actions--ENkg1"},a))},am=()=>{const e=la(Rc),t=la(Dc);if(!e)return null;const n=t.map((e=>r.createElement(lm,Object.assign({key:e.selector},e)))),o=t.map((({selector:e})=>`\n    ${e} {\n      position: relative;\n      z-index: 10;\n    }\n  `)).join("\n");return(0,i.createPortal)(r.createElement("div",{className:"tutorial--jscuw"},r.createElement("div",{className:"tutorial-backdrop--3I0WR"}),r.createElement("style",null,o),n),document.body)},um=document.getElementById("root");i.render(r.createElement(l.W,{backend:a.PD},r.createElement(c.F0,{history:u},r.createElement(s.zt,{store:ea},r.createElement((()=>r.createElement(r.Fragment,null,r.createElement(Xd,null),r.createElement(cm,null),r.createElement(am,null))),null)))),um)},784:(e,t,n)=>{"use strict";function r(e,t,n,r,o){const s=i(e,t,n,o),c=i(e,t,n,r),l=o-r<=180?"0":"1";return["M",s.x,s.y,"A",n,n,0,l,0,c.x,c.y].join(" ")}function i(e,t,n,r){const i=(r-90)*Math.PI/180;return{x:e+n*Math.cos(i),y:t+n*Math.sin(i)}}n.d(t,{x:()=>r})}},0,[[999,1,956,874,90,898,794,191,80,744,593,617,29,845,105,699,162,416]]]);
//# sourceMappingURL=client.5b0df845ac72968b615a.bundle.js.map
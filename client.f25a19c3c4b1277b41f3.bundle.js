(self.webpackChunkdiscrelog=self.webpackChunkdiscrelog||[]).push([[47],{1235:(e,t,n)=>{"use strict";n.d(t,{zN:()=>r,ke:()=>o});const i="@node/interact",r=(e,t)=>({type:i,payload:{circuitNodeIdPath:e,data:t}});function o(e){return e.type===i}},5766:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i=4},3667:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:[],outputPins:["OUT"],interact:(e,t)=>void 0===t?{transitions:[{tickOffset:1,valuesByPin:{OUT:!0}},{tickOffset:1+Math.round(1.5*i.v),valuesByPin:{OUT:!1}}]}:t?{transitions:{tickOffset:1,valuesByPin:{OUT:!0}}}:{transitions:{tickOffset:1,valuesByPin:{OUT:!1}}}}},2318:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const i={toggleState:!1},r={inputPins:[],outputPins:["OUT"],interact(e=i){const t=!e.toggleState;return{state:Object.assign({},e,{toggleState:t}),transitions:{tickOffset:1,valuesByPin:{OUT:t}}}},evolve:(e=i)=>({state:e,transitions:{tickOffset:1,valuesByPin:{OUT:e.toggleState}}})}},7909:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.A&&t.B}}})}},274:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.IN}}})}},4347:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!(t.A&&t.B)}}})}},8112:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!(t.A||t.B)}}})}},6559:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:!t.IN}}})}},2649:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:t.A||t.B}}})}},8881:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});var i=n(5766);const r={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:i.v,valuesByPin:{OUT:(t.A||t.B)&&t.A!=t.B}}})}},6567:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:["IN"],outputPins:[],evolve:(e,t)=>({state:{value:t.IN}})}},4257:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:["A","B","C","D","E","F","G"],outputPins:[],evolve:(e,t)=>({state:Object.assign({},t)})}},4420:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});const i={inputPins:[],outputPins:["OUT"],evolve:()=>({transitions:{tickOffset:1,valuesByPin:{OUT:!0}}})}},8370:(e,t,n)=>{"use strict";n.d(t,{tQ:()=>r,Ds:()=>o,rG:()=>c,NG:()=>s,R9:()=>l,VE:()=>a,Fv:()=>d,Ih:()=>u,bA:()=>p,Qu:()=>m,gQ:()=>y,ZO:()=>f,sj:()=>g,kg:()=>I,PL:()=>h,nF:()=>b,G0:()=>v,kK:()=>E});var i=n(7516);const r=i.Ry().shape({x:i.Rx().required(),y:i.Rx().required()}),o=Object.freeze({x:0,y:0}),c=Object.freeze({p1:o,p2:o});function s(e){return{p1:{x:e[0],y:e[1]},p2:{x:e[2],y:e[3]}}}function l(e,t){return{x:Math.round(e.x/t)*t,y:Math.round(e.y/t)*t}}function a(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function d(e){const t=a(e);return{x:e.x/t,y:e.y/t}}function u(e,t){return e.x*t.x+e.y*t.y}function p(e,t){return{x:e.x*t,y:e.y*t}}function m(...e){let t,n;if(1===e.length){const i=e[0];t=i.p1,n=i.p2}else t=e[0],n=e[1];return{p1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},p2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}}}function y(e,t){return{p1:f(e.p1,t),p2:f(e.p2,t)}}function f(e,t){return{x:e.x+t.x,y:e.y+t.y}}function g(e,t){return{x:e.x-t.x,y:e.y-t.y}}function I(e,t){return e.x===t.x&&e.y===t.y}function h(e,t){return!((t=m(t)).p1.x>e.x||t.p2.x<e.x||t.p1.y>e.y||t.p2.y<e.y)}function b(e){return{width:(e=m(e)).p2.x-e.p1.x,height:e.p2.y-e.p1.y}}function v(e,t){return e=m(e),t=m(t),{p1:{x:Math.min(e.p1.x,t.p1.x),y:Math.min(e.p1.y,t.p1.y)},p2:{x:Math.max(e.p2.x,t.p2.x),y:Math.max(e.p2.y,t.p2.y)}}}function E(e,t){return e=m(e),t=m(t),!(e.p1.x>t.p2.x||e.p2.x<t.p1.x||e.p1.y>t.p2.y||e.p2.y<t.p1.y)}},4884:(e,t,n)=>{"use strict";var i=n(7294),r=n(3935),o=n(1033),c=n(9242),s=n(5977),l=n(862),a=n(7865);const d=(0,n(7531).q_)(),u=Object.freeze({dragMode:null}),p="root",m="root-editor",y={circucitEditorsById:{[m]:{circuitId:p,circuitNodeIdPath:[]}},activeEditorId:null},f=Object.freeze(y),g={circuitNamesByCircuitId:{[p]:"Root"},nodeIdsByCircuitId:{[p]:[]}},I=Object.freeze(g);var h=n(8370);const b=Object.freeze({clipboardNodes:[],clipboardPasteOrigin:h.Ds}),v=Object.freeze({dialogType:null,data:null}),E=Object.freeze({nodesById:{},connectionsById:{}}),k=Object.freeze({nodePositionsById:{},wireJointIdsByConnectionId:{},wireJointPositionsByJointId:{}}),O=Object.freeze({projectName:"New Project",projectModified:!1}),N=Object.freeze({selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}),x=Object.freeze({initialized:!1,tick:0,lastTickProcessingTimeMs:0,nodeStatesByNodeId:{},nodeOutputValuesByNodeId:{},transitionsById:{},transitionWindows:[]}),C=Object.freeze({mode:"edit",ticksPerSecond:1e3});var j=n(7361),w=n.n(j);function P(...e){return e.filter((e=>Boolean(e)&&""!=e)).join(" ")}function B(...e){return M(e[0],e.slice(1,e.length-1).map(String),e[e.length-1])}function M(e,t,n){if(0===t.length)return"function"==typeof n?n(e):n;const i=t.slice(0,t.length-1).map(String),r=t[t.length-1],o=S(e);let c=o;for(const e of i)c[e]=S(c[e]),c=c[e];return c[r]="function"==typeof n?n(c[r]):n,o}function S(e){return Array.isArray(e)?e.slice():Object.assign({},e)}function L(e){return Boolean(e)}const T="fill-parent--3pw6U",D={"flex-row":"flex-row--sHjOY","flex-column":"flex-column--2LT64","flex-reverse":"flex-reverse--2Vn7L","flexitem-shrink":"flexitem-shrink--2U9EV","flexitem-fix":"flexitem-fix--1ARxk"};var z=n(8721),J=n.n(z);function R(e){return"string"==typeof e?{windowId:e}:e}function W(e){return J()(e,"windowId")}function A(e){return J()(e,"first")&&J()(e,"second")&&J()(e,"direction")}function U(e){return"number"==typeof e?{firstPercent:e}:e}function Z(e){return J()(e,"firstPercent")}function F(e){return J()(e,"firstSize")||J()(e,"secondSize")}var K=n(3493),H=n.n(K);function q(e){const t=i.useRef(e);return i.useEffect((()=>{t.current=e})),t}const G={tessel:"tessel--2Q3Xd","tessel-content":"tessel-content--3-kEA","tessel-drop-capture":"tessel-drop-capture--3TbuI","tessel-drop-capture--dragging":"tessel-drop-capture--dragging--Ihwyz","tessel-drop-marker":"tessel-drop-marker--1cqr2","drop-left":"drop-left--wqP1V","drop-right":"drop-right--2MyGz","drop-top":"drop-top--1S0co","drop-bottom":"drop-bottom--2f330","tessel-split":"tessel-split--2gDs5","tessel-split--row":"tessel-split--row--2fC6o","tessel-split--column":"tessel-split--column--1Hl4C","tessel-window":"tessel-window--1qDgp","tessel-window-titlebar":"tessel-window-titlebar--uHBdn","tessel-window-title":"tessel-window-title--2v0hT","tessel-window-controls":"tessel-window-controls--3i3ou","tessel-window-controls-close":"tessel-window-controls-close--2O8Zs","tessel-window-content":"tessel-window-content--sOnG-"},V=Object.freeze({top:0,left:0,bottom:0,right:0,x:0,y:0,height:0,width:0,toJSON:()=>({})}),$=({direction:e,onChangePercentage:t})=>{const n=i.useRef(null),r=i.useRef(null),o=q(e),c=q(t),s=i.useMemo((()=>H()((e=>{var t,i;if(null==r.current||null==n.current)return;const s=null!==(i=null===(t=n.current.parentElement)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==i?i:V;let l=0,a=0;"row"===o.current?(a=e.pageX-s.left,l=a/s.width,isNaN(l)?(l=0,a=s.left):l>1&&(l=1,a=s.right)):(a=e.pageY-s.top,l=a/s.height,isNaN(l)?(l=0,a=s.top):l>1&&(l=1,a=s.bottom)),c.current(100*l,a)}),1e3/60,{leading:!0})),[o,c]),l=i.useCallback((e=>{e.persist(),s(e)}),[s]),a=i.useCallback((e=>{!e.defaultPrevented&&n.current&&(r.current||(e.preventDefault(),n.current.setPointerCapture(e.pointerId),r.current=e.pointerId))}),[]),d=i.useCallback((()=>{n.current&&r.current&&(n.current.releasePointerCapture(r.current),r.current=null)}),[]);return i.createElement("div",{ref:n,className:P("tessel-split",G["tessel-split"],G["row"===e?"tessel-split--row":"tessel-split--column"]),onPointerDown:a,onPointerMove:l,onPointerUp:d})},_=i.createContext([]);function Y(){return i.useContext(_)}const X=({pathKey:e,children:t})=>{const n=Y(),r=i.useMemo((()=>[...n,e]),[n,e]);return i.createElement(_.Provider,{value:r},t)};function Q(){}const ee=i.createContext({moveWindow:Q,closeWindow:Q});function te(){return i.useContext(ee)}const ne=({moveWindow:e,closeWindow:t,children:n})=>{const r=i.useMemo((()=>({moveWindow:e,closeWindow:t})),[e,t]);return i.createElement(ee.Provider,{value:r},n)};function ie(e,t,n){return Z(e)?{firstPercent:t}:F(e)?"number"==typeof e.secondSize?{secondSize:n}:{firstSize:n}:e}const re=({item:e,renderWindow:t,onLayoutChange:n})=>{const{direction:r,first:o,second:c,division:s}=e,l="row"===r?"width":"height",a=i.useCallback(((t,i)=>{const r=U(e.division);n(Object.assign(Object.assign({},e),{division:ie(r,t,i)}))}),[e,n]),d=i.useCallback((t=>{n(Object.assign(Object.assign({},e),{first:t}))}),[e,n]),u=i.useCallback((t=>{n(Object.assign(Object.assign({},e),{second:t}))}),[e,n]),p=U(s);let m="50%",y="50%",f=!1,g=!1;if(Z(p)){const{firstPercent:e}=p;m=e+"%",y=100-e+"%"}else if(F(p)){const{firstSize:e,secondSize:t}=p;e?(m=e+"px",f=!0,y="100%"):(m="100%",y=t+"px",g=!0)}return i.createElement("div",{className:P(T,D["row"===r?"flex-row":"flex-column"])},i.createElement("div",{className:P(f?D["flexitem-fix"]:D["flexitem-shrink"]),style:{[l]:m}},i.createElement(X,{pathKey:"first"},i.createElement(oe,{value:o,renderWindow:t,onLayoutChange:d}))),i.createElement($,{direction:r,onChangePercentage:a}),i.createElement("div",{className:P(g?D["flexitem-fix"]:D["flexitem-shrink"]),style:{[l]:y}},i.createElement(X,{pathKey:"second"},i.createElement(oe,{value:c,renderWindow:t,onLayoutChange:u}))))},oe=({value:e,renderWindow:t,onLayoutChange:n})=>{const r=R(e);return W(r)?t(r):A(r)?i.createElement(re,{item:r,renderWindow:t,onLayoutChange:n}):null};function ce(e){return Array.isArray(e)?e:[e]}function se(e,t){return e===t||e.length===t.length&&e.every(((e,n)=>t[n]===e))}function le(e,t){const n=e.slice(0,t);for(let i=t+1;i<e.length;i++)n.push(e[i]);return n}function ae(e){const[t,n]=i.useState({left:0,top:0,right:0,bottom:0,width:0,height:0});return i.useLayoutEffect((()=>{if(!e.current)return;const t=new o.Z((()=>{const t=e.current;if(!t)return;const i=t.getBoundingClientRect();n({top:i.top,left:i.left,right:i.right,bottom:i.bottom,width:i.width,height:i.height})}));return t.observe(e.current),()=>{t.disconnect()}}),[e]),t}Object.freeze([]);var de=n(9240);const ue="@tessel/window",pe=e=>({type:ue,payload:{path:e}});function me(e){return e.type===ue}const ye=i.forwardRef((({className:e,children:t},n)=>{const r=Y(),{moveWindow:o}=te(),c=i.useRef(null),{top:s,left:l,right:a,bottom:d}=ae(c),[u,p]=i.useState(null),m=i.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return void p(null);const n=t.getClientOffset();if(null==e||null==n||!me(e))return void p(null);if(n.x<l||n.x>a)return void p(null);if(n.y<s||n.y>d)return void p(null);const i=(n.x-l)/(a-l);if(i<=.3)return void p("left");if(i>=.6)return void p("right");const r=(n.y-s)/(d-s);p(r<=.3?"top":r>=.6?"bottom":null)}),[s,l,a,d]),y=i.useCallback(((e,t)=>{if(!t.isOver({shallow:!0}))return;if(!me(e))return;const{path:n}=e.payload;se(n,r)||null!=u&&o(n,r,u)}),[r,u,o]),[{draggingSelf:f},g]=(0,de.L)({accept:ue,collect:e=>{e.isOver({shallow:!0})||p(null);const t=e.getItem();return t&&me(t)?{draggingSelf:se(t.payload.path,r)}:{}},hover:m,drop:y},[m,y]);let I=G["tessel-drop-marker"]+" ";if(null!=u&&!f)switch(u){case"bottom":I+=G["drop-bottom"];break;case"top":I+=G["drop-top"];break;case"left":I+=G["drop-left"];break;case"right":I+=G["drop-right"]}return i.createElement("div",{ref:e=>{c.current=e,g(e),"function"==typeof n?n(e):n&&(n.current=e)},className:P(G["tessel-drop-capture"],f&&G["tessel-drop-capture--dragging"],e)},t,i.createElement("div",{className:I}))}));function fe(e,t){var n;if(!t(e))return null;const i=R(e);if(A(i)){const r=fe(i.first,t),o=fe(i.second,t);return r&&o?e:null!==(n=null!=r?r:o)&&void 0!==n?n:null}return e}function ge(e){return"string"==typeof e?e:A(e)?null==e.first?ge(e.second):null==e.second?ge(e.first):Object.assign(Object.assign({},e),{first:ge(e.first),second:ge(e.second)}):e}const Ie=({className:e,rootItem:t,renderWindow:n,onLayoutChange:r})=>{const o=i.useCallback(((e,n,i)=>{if(0===e.length)return;let o=t;const c=w()(o,e);o&&"string"!=typeof o&&c&&(n.length>0&&!w()(o,n)||(o=M(o,e,null),o=M(o,n,(e=>{let t;if("left"===i||"right"===i)t={direction:"row",division:50,first:"left"===i?c:e,second:"right"===i?c:e};else{if("top"!==i&&"bottom"!==i)throw new Error("Unknown tessel position: "+i);t={direction:"column",division:50,first:"top"===i?c:e,second:"bottom"===i?c:e}}return t})),o=ge(o),r(o)))}),[t,r]),c=i.useCallback((e=>{let n=t;n&&("string"!=typeof n?(n=M(n,e,null),n=ge(n),r(n)):0===e.length&&r(null))}),[r,t]);return i.createElement("div",{className:P("tessel",G.tessel,e)},i.createElement(ne,{moveWindow:o,closeWindow:c},i.createElement(ye,null,i.createElement("div",{className:G["tessel-content"]},t&&i.createElement(oe,{value:t,renderWindow:n,onLayoutChange:r})))))},he="circuit-field",be=e=>({windowId:he,windowProps:{editorId:e}});function ve(e){return"string"!=typeof e&&!!W(e)&&e.windowId===he}const Ee={layout:{direction:"row",division:{firstSize:200},first:{direction:"column",division:30,first:"circuits-list",second:"node-tray"},second:be(m)}},ke=Object.freeze(Ee),Oe=Object.freeze({nodeNameMode:"named-only"}),Ne={circuitEditorDrag:u,circuitEditors:f,nodeGraph:E,nodeLayout:k,circuits:I,clipboard:b,dialog:v,project:O,selection:N,simulator:x,simulatorControl:C,uiLayout:ke,uiSettings:Oe},xe=Object.freeze(Ne),Ce=["circuits","nodeGraph","nodeLayout"],je={services:xe,undo:Object.freeze({undoStack:[],redoStack:[]})},we=Object.freeze(je);var Pe=n(4890),Be=(n(2729),n(7172));const Me=new URL(window.location.origin);Me.pathname=n.p;const Se=Me.toString(),Le="@init";var Te=n(4586);const De="@circuit/add",ze=({circuitName:e,circuitId:t,edit:n}={})=>({type:De,payload:{circuitId:null!=t?t:(0,Te.Z)(),circuitName:e,edit:n}}),Je="@circuit/delete";function Re(e){return e.type===Je}const We="@circuit/rename",Ae="@node/add",Ue=(e,t,n,i)=>({type:Ae,payload:Object.assign({nodeId:(0,Te.Z)(),nodeType:e,circuitId:t,position:n},i||{})});function Ze(e){return e.type===Ae}const Fe="@node/delete";function Ke(e){return e.type===Fe}const He="@node/rename",qe="@selection/align-to-grid",Ge="@selection/delete",Ve=()=>({type:Ge}),$e="@selection/move",_e="@wire/attach",Ye=(e,t,n)=>({type:_e,payload:{connectionId:(0,Te.Z)(),p1:e,p2:t,joints:(null==n?void 0:n.joints)||[]}});function Xe(e){return e.type===_e}const Qe="@wire/detatch";function et(e){return e.type===Qe}const tt="@wire/joint/add",nt="@wire/joint/move",it=(e,t,n={})=>{var i,r;return{type:nt,payload:{jointIds:ce(e),position:t,relative:null!==(i=n.relative)&&void 0!==i&&i,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},rt="@wire/joint/delete",ot="@clipboard/paste",ct="@circuit-editor/drag/end",st="@undo/undo",lt=()=>({type:st});function at(e){return e.type===st}const dt="@undo/redo",ut=()=>({type:dt});function pt(e){return e.type===dt}const mt="@project/new",yt=()=>({type:mt});function ft(e){return e.type===mt}const gt="@project/receive",It=(e,t)=>({type:gt,payload:{fileName:e,saveData:t}}),ht=[De,Je,We,Ae,Fe,He,qe,Ge,$e,_e,Qe,tt,rt,nt,st,dt,ot,ct];function bt(e){return-1!==ht.indexOf(e.type)}var vt=n(8718),Et=n.n(vt),kt=n(8804),Ot=n.n(kt);function Nt(e){return t=>(n=we,i)=>{const r=t(n.services[e],i,n);return n.services[e]!=r?B(n,"services",e,r):n}}function xt(e){return t=>{const n=(n,...i)=>t(n.services[e],...i);return n.local=t,n}}const Ct=Nt("circuitEditors"),jt=xt("circuitEditors"),wt=jt(((e,t)=>e.circucitEditorsById[t])),Pt=(e,t)=>{const n=wt(e,t);return n?n.circuitId:null},Bt=jt((e=>e.activeEditorId)),Mt=jt((e=>e.activeEditorId?e.circucitEditorsById[e.activeEditorId]:null)),St=jt(((e,t)=>Object.keys(e.circucitEditorsById).filter((n=>e.circucitEditorsById[n].circuitId===t))));function Lt(e){let t=null;const n=Mt(e);return n&&(t=n.circuitId),{serviceStates:Et()(e.services,Ce),viewCircuitId:t}}var Tt=n(928),Dt=n.n(Tt),zt=n(9734),Jt=n.n(zt);function Rt(...e){return[].concat(...e)}const Wt="@circuit-editor/drag/abort",At=()=>({type:Wt}),Ut=Nt("circuitEditorDrag"),Zt=xt("circuitEditorDrag"),Ft=Ut(((e,t)=>function(e){return e.type===Wt}(t)?u:e)),Kt="@circuit-editor/drag/continue",Ht=Ut(((e,t)=>{if(!function(e){return e.type===Kt}(t))return e;const{dragPos:n,modifierKeys:i,editorId:r}=t.payload;return Object.assign(Object.assign({},e),{dragEnd:n,dragEndEditorId:r,dragModifierKeys:i})}));var qt=n(3386),Gt=n.n(qt),Vt=n(1966),$t=n.n(Vt);function _t(e,t="set"){return e.shiftKey&&e.ctrlMetaKey?"remove":e.shiftKey?"append":e.ctrlMetaKey?"toggle":t}function Yt(e,t,n){switch(n){case"set":return t;case"set-if-unselected":return t.every((t=>-1!==e.indexOf(t)))?e:t;case"append":return Gt()(e,t);case"remove":return $t()(e,t);case"toggle":return $t()(e,t).concat($t()(t,e))}return t}const Xt="@select/region";var Qt=n(2222),en=n(6604),tn=n.n(en);const nn=Nt("nodeGraph"),rn=xt("nodeGraph"),on=rn((e=>e.nodesById)),cn=rn((0,Qt.P1)(on.local,(e=>Object.keys(e)))),sn=rn((0,Qt.P1)(on.local,(e=>tn()(e,(e=>e.nodeType))))),ln=rn(((e,t)=>e.nodesById[t]||null)),an=rn(((e,t)=>{const n=[];for(const i of Object.keys(e.nodesById)){const{nodeType:r}=e.nodesById[i];r===t&&n.push(i)}return n})),dn=rn(((e,t)=>{const n=ln.local(e,t);return n?n.nodeType:null})),un=rn((0,Qt.P1)((e=>e.nodesById),(e=>tn()(e,(e=>e.nodeName))))),pn=rn(((e,t)=>{var n;const i=ln.local(e,t);return i?null!==(n=i.nodeName)&&void 0!==n?n:t.substr(0,4):null})),mn=rn(((e,t)=>{const n=ln.local(e,t);return n?n.nodeName:null}));var yn=n(4654),fn=n.n(yn),gn=n(3311),In=n.n(gn),hn=n(669),bn=n.n(hn);const vn=Nt("circuits"),En=xt("circuits"),kn=En((e=>e.nodeIdsByCircuitId)),On=En(((e,t)=>e.nodeIdsByCircuitId[t])),Nn=En(((e,t)=>{for(const n of Object.keys(e.nodeIdsByCircuitId))if(-1!==e.nodeIdsByCircuitId[n].indexOf(t))return n;return null})),xn=Nt("nodeLayout"),Cn=xt("nodeLayout"),jn=Cn((e=>e.nodePositionsById)),wn=Cn(((e,t)=>{var n;return null!==(n=e.nodePositionsById[t])&&void 0!==n?n:h.Ds}));function Pn(e){return"ic-"+e}function Bn(e){return e&&e.startsWith("ic-")?e.substr(3):null}function Mn(e,t){return`M10,10 h80 v${50*Math.max(e,t,1)-20} h-80 z`}const Sn=En((e=>Object.keys(e.circuitNamesByCircuitId))),Ln=En((e=>e.circuitNamesByCircuitId)),Tn=En(((e,t)=>e.circuitNamesByCircuitId[t])),Dn=En(((e,t)=>{const{nodeIdsByCircuitId:n}=e,i=Object.keys(n);for(const e of i)if(-1!==n[e].indexOf(t))return e;return null})),zn=(e,t,n)=>{if(!t)return!1;if(t===n)return!0;const i=Pn(n),{nodesById:r}=e.services.nodeGraph;return Object.keys(r).filter((e=>r[e].nodeType===i)).some((n=>{const i=Dn(e,n);return!!i&&zn(e,t,i)}))};function Jn(e,t){return{x:"input"===t?0:100,y:50*e+25}}const Rn=[(0,Qt.P1)(kn,sn,jn,Ln,((e,t,n,r)=>Object.keys(e).filter((e=>e!==p)).map((o=>{var c,s;const l=null!==(c=e[o])&&void 0!==c?c:[],a=null!==(s=r[o])&&void 0!==s?s:o.substr(0,5);let d=l.filter((e=>t[e].startsWith("pin-")));d=Jt()(d,(e=>n[e].y),(e=>n[e].x));const u={},p=[],m=[];for(const e of d){const n=t[e];"pin-input"===n?(u[e]=Object.assign({direction:"input"},Jn(p.length,"input")),p.push(e)):"pin-output"===n&&(u[e]=Object.assign({direction:"output"},Jn(m.length,"output")),m.push(e))}const y={circuitId:o,inputPinIds:p,outputPinIds:m};return{type:Pn(o),category:"integrated-circuit",displayName:a,elementProduction:{type:"circuit",circuitId:o},visual:{hitRect:(0,h.NG)(bn()(Mn(p.length,m.length))),trayComponent:()=>i.createElement("g",{stroke:"black",strokeWidth:1},i.createElement("rect",{x:10,y:10,width:30,height:30,fill:"none"}),i.createElement("line",{x1:10,y1:15,x2:5,y2:15}),i.createElement("line",{x1:40,y1:15,x2:45,y2:15}),i.createElement("line",{x1:10,y1:35,x2:5,y2:35}),i.createElement("line",{x1:40,y1:35,x2:45,y2:35})),component:"integrated-circuit",componentProps:y},pins:u}})))),n(4313).Z,n(9175).Z,n(4646).Z,n(2140).Z,n(6467).Z,n(8476).Z,n(3980).Z,n(9696).Z,n(2201).Z,n(6015).Z,n(5058).Z,n(3158).Z,n(7529).Z,n(4987).Z];let Wn=[];const An=e=>{const t=fn()(Rn,(t=>function(e,t){let n;return n="function"==typeof e?e(t):e,ce(n)}(t,e)));return t.every(((e,t)=>e===Wn[t]))?Wn:(Wn=t,t)},Un=(0,Qt.P1)(An,(e=>{const t={};for(const n of e)t[n.type]=n;return t})),Zn=(e,t)=>{var n;const i=An(e);return null!==(n=In()(i,(e=>e.type===t)))&&void 0!==n?n:null};var Fn=n(7516);const Kn=Fn.Ry().shape({nodeId:Fn.Z_().required().min(1),pinId:Fn.Z_().required().min(1)});function Hn(e,t){return e.nodeId===t.nodeId&&e.pinId===t.pinId}const qn=(0,Qt.P1)(Un,jn,sn,((e,t,n)=>{var i;const r={},o=Object.keys(n);for(const c of o){const o={};r[c]=o;const s=null!==(i=t[c])&&void 0!==i?i:h.Ds,l=n[c];if(!l)continue;const a=e[l];if(!a)continue;const d=Object.keys(a.pins);for(const e of d){const t=a.pins[e],n=(0,h.ZO)(s,t);o[e]=n}}return r}));let Gn=null;const Vn=(e,t,n)=>{var i;const r=qn(e),o=On(e,n);if(!o)return null;for(const e of o){const n=null!==(i=r[e])&&void 0!==i?i:h.Ds,o=Object.keys(n);for(const i of o){const r=n[i],o=(0,h.sj)(t,r);if((0,h.VE)(o)>6)continue;const c={nodeId:e,pinId:i};return Gn&&Hn(c,Gn)||(Gn=c),Gn}}return null},$n=Zt((()=>50)),_n=Zt((()=>5)),Yn=(e,t)=>{const n=$n(e);return(0,h.R9)(t,n)},Xn=(e,t)=>{const n=_n(e);return(0,h.R9)(t,n)},Qn="@circuit-editor/drag/start/joint",ei="@select/wire-joints",ti=(e,t="set")=>({type:ei,payload:{jointIds:Array.isArray(e)?e:[e],mode:t}}),ni=Nt("selection"),ii=xt("selection"),ri=ii((e=>e.selectedNodeIds)),oi=ii(((e,t)=>-1!==e.selectedNodeIds.indexOf(t))),ci=((0,Qt.P1)(on,ri,((e,t)=>Et()(e,t))),ii((e=>e.selectedConnectionIds)),ii(((e,t)=>-1!==e.selectedConnectionIds.indexOf(t)))),si=ii((e=>e.selectedJointIds)),li=ii(((e,t)=>-1!==e.selectedJointIds.indexOf(t)));var ai=n(6486);const di=(0,Qt.P1)(((e,t)=>On(e,t)),(e=>e.services.nodeGraph.connectionsById),((e,t)=>Object.keys(t).filter((n=>{const{inputPin:i,outputPin:r}=t[n];return!!(0,ai.includes)(e,i.nodeId)&&!!(0,ai.includes)(e,r.nodeId)})))),ui=(e,t)=>{const{connectionsById:n}=e.services.nodeGraph,i=n[t];if(!i)return null;const{nodeId:r}=i.inputPin||i.outputPin;return Nn(e,r)},pi="@circuit-editor/drag/start/new-joint",mi=Ut(((e,t,n)=>{if(!function(e){return e.type===pi}(t))return e;const{connectionId:i,addAfterJointId:r,modifierKeys:o,x:c,y:s,editorId:l}=t.payload;return ui(n,i)?Object.assign(Object.assign({},e),{dragMode:"new-joint",dragStart:{x:c,y:s},dragStartEditorId:l,dragEnd:null,dragEndEditorId:null,dragNewJointConnectionId:i,dragNewJointAfterJointId:r,dragModifierKeys:o}):e})),yi="@field/drag/start/node",fi="@select/nodes",gi=(e,t="set")=>({type:fi,payload:{nodeIds:Array.isArray(e)?e:[e],mode:t}}),Ii="@circuit-editor/drag/start/select",hi=Ut(((e,t)=>{if(!function(e){return e.type===Ii}(t))return e;const{x:n,y:i,modifierKeys:r,editorId:o}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"select",dragStart:{x:n,y:i},dragStartEditorId:o,dragModifierKeys:r,dragEnd:null,dragEndEditorId:null})})),bi="@circuit-editor/drag/start/wire",vi=Ut(((e,t,n)=>{if(!function(e){return e.type===bi}(t))return e;const{x:i,y:r,pin:o,editorId:c}=t.payload;return function(e,t){const n=kn(t);for(const t of Object.keys(n))if(-1!==n[t].indexOf(e))return t;return null}(o.nodeId,n)?Object.assign(Object.assign({},e),{dragMode:"wire",dragStart:{x:i,y:r},dragStartEditorId:c,dragWireSource:o,dragEnd:null,dragEndEditorId:null}):e})),Ei="@circuit-editor/mouse/leave",ki=Rt(Ft,Ht,(function(e=we,t){if(!function(e){return e.type===ct}(t))return e;const n=e.services.circuitEditorDrag;if(null===n.dragMode)return e;const{x:i,y:r}=t.payload,{dragStart:o,dragStartEditorId:c,dragEndEditorId:s}=n;if(c!=s)return B(e,"services","circuitEditorDrag",u);switch(n.dragMode){case"select":{const t=Pt(e,c);if(t){const{dragModifierKeys:c}=n,s=_t(c),l=(0,h.Qu)(o,{x:i,y:r});e=Dc(e,((e,t,n="set")=>({type:Xt,payload:{region:e,circuitId:t,mode:n}}))(l,t,s))}break}case"move":{const{dragModifierKeys:t}=n;let c=(0,h.sj)({x:i,y:r},o);const s=e.services.selection.selectedNodeIds.length>0;t.ctrlMetaKey||(c=s?Yn(e,c):Xn(e,c)),e=Dc(e,((e,t,n={})=>{var i;return{type:$e,payload:{offsetX:e,offsetY:t,snapMode:null!==(i=n.snapMode)&&void 0!==i?i:"none"}}})(c.x,c.y));break}case"new-joint":{const{dragNewJointConnectionId:t,dragNewJointAfterJointId:o}=n,c=Xn(e,{x:i,y:r});e=Dc(e,((e,t,n,i)=>({type:tt,payload:{connectionId:e,jointId:(0,Te.Z)(),addAfterJointId:t,position:n}}))(t,o,c));break}case"wire":{const t=Pt(e,c);if(t){const{dragWireSource:o}=n,c=Vn(e,{x:i,y:r},t);o&&c&&(e=Dc(e,Ye(o,c)))}break}}return B(e,"services","circuitEditorDrag",u)}),(function(e=we,t){if(!function(e){return e.type===Qn}(t))return e;const{jointId:n,x:i,y:r,modifierKeys:o,editorId:c}=t.payload;if(!((e,t)=>{const{wireJointIdsByConnectionId:n}=e.services.nodeLayout,i=Object.keys(n).find((e=>-1!==n[e].indexOf(t)));return i?ui(e,i):null})(e,n))return e;if(e=B(e,"services","circuitEditorDrag",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:i,y:r},dragStartEditorId:c,dragModifierKeys:o,dragEnd:null,dragEndEditorId:null}))),!li(e,n)){const t=_t(o);e=Dc(e,ti(n,t))}return e}),mi,(function(e=we,t){if(!function(e){return e.type===yi}(t))return e;const{nodeId:n,x:i,y:r,modifierKeys:o,editorId:c}=t.payload;if(!Nn(e,n))return e;if(e=B(e,"services","circuitEditorDrag",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:i,y:r},dragStartEditorId:c,dragModifierKeys:o,dragEnd:null,dragEndEditorId:null}))),!oi(e,n)){const t=_t(o);e=Dc(e,gi(n,t))}return e}),hi,vi,Ut(((e,t)=>function(e){return e.type===Ei}(t)?null==e.dragMode?e:Object.assign(Object.assign({},e),{dragEnd:null}):e))),Oi=Ct(((e,t)=>{if(!Re(t))return e;const{circuitId:n}=t.payload,i=Object.keys(e.circucitEditorsById).filter((t=>e.circucitEditorsById[t].circuitId===n));let r=e.activeEditorId;return r&&-1!==i.indexOf(r)||(r=null),Object.assign(Object.assign({},e),{circucitEditorsById:Et()(e.circucitEditorsById,i),activeEditorId:r})})),Ni="@circuit-editor/receive-focus",xi=Ct(((e,t)=>{if(!function(e){return e.type===Ni}(t))return e;const{editorId:n}=t.payload;return-1===Object.keys(e.circucitEditorsById).indexOf(n)?e:Object.assign(Object.assign({},e),{activeEditorId:n})})),Ci="@view/circuit",ji=(e,t=null,n={})=>({type:Ci,payload:{circuitId:e,circuitNodeIdPath:t,newWindowId:n.newWindow?(0,Te.Z)():null}});function wi(e){return e.type===Ci}const Pi=Rt(Oi,xi,Ct(((e,t,n)=>{if(!wi(t))return e;const{circuitId:i,circuitNodeIdPath:r,newWindowId:o}=t.payload;if(-1===Sn(n).indexOf(i))return e;let c=o;return c||(c=function(e){var t;return e.activeEditorId?e.activeEditorId:null!==(t=Ot()(Object.keys(e.circucitEditorsById)))&&void 0!==t?t:null}(e)),c?Object.assign(Object.assign({},e),{circucitEditorsById:Object.assign(Object.assign({},e.circucitEditorsById),{[c]:{circuitId:i,circuitNodeIdPath:null!=r?r:[]}}),activeEditorId:c}):e}))),Bi=vn(((e,t)=>{if(!function(e){return e.type===De}(t))return e;const n=t.payload.circuitId;let i=t.payload.circuitName;return i||(i="Circuit "+(Object.keys(e.circuitNamesByCircuitId).length+1)),Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:i}),nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[n]:[]})})})),Mi=vn(((e,t,n)=>{if(!Re(t))return e;const{circuitId:i}=t.payload,r=Object.keys(e.circuitNamesByCircuitId).filter((e=>e!==i)),o=an(n,Pn(i));let c=Et()(e.nodeIdsByCircuitId,r);return c=tn()(c,(e=>$t()(e,o))),Object.assign(Object.assign({},e),{nodeIdsByCircuitId:c,circuitNamesByCircuitId:Et()(e.circuitNamesByCircuitId,r)})})),Si="@circuit/import",Li=Fn.Ry().shape({circuitId:Fn.Z_().required().min(1),circuitName:Fn.Z_().required().min(1)}),Ti=Fn.Ry().shape({nodeId:Fn.Z_().required().min(1),nodeType:Fn.Z_().required().min(1),nodeName:Fn.Z_().nullable().min(1),circuitId:Fn.Z_().required().min(1),x:Fn.Rx().required(),y:Fn.Rx().required()}),Di=Fn.Ry().shape({output:Kn.required(),input:Kn.required(),joints:Fn.IX().of(h.tQ)}),zi=Fn.Ry().shape({circuits:Fn.IX().of(Li).min(0),nodes:Fn.IX().of(Ti).min(0),wires:Fn.IX().of(Di).min(0)});var Ji=n(2628),Ri=n.n(Ji),Wi=n(4908),Ai=n.n(Wi);const Ui=rn((e=>e.connectionsById)),Zi=rn((0,Qt.P1)((e=>e.connectionsById),(e=>Object.keys(e)))),Fi=rn(((e,t)=>e.connectionsById[t])),Ki=rn((0,Qt.P1)((e=>e.connectionsById),(e=>Ri()(e)))),Hi=rn(((e,t)=>{const{connectionsById:n}=e,i=Object.keys(n);for(const e of i)if(Hn(n[e].inputPin,t))return e;return null})),qi=rn(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].inputPin.nodeId===t)))),Gi=rn(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].outputPin.nodeId===t)))),Vi=rn(((e,t)=>{const n=qi.local(e,t),i=Gi.local(e,t);return Ai()([...n,...i])})),$i=(e,t)=>{const n=dn(e,t);return n?Zn(e,n):null},_i={},Yi={},Xi=(Cn((e=>Object.keys(e.wireJointPositionsByJointId))),Cn((e=>e.wireJointIdsByConnectionId))),Qi=Cn(((e,t)=>e.wireJointIdsByConnectionId[t])),er=Cn(((e,t)=>e.wireJointPositionsByJointId[t])),tr=Cn((e=>e.wireJointPositionsByJointId));class nr extends Error{constructor(e){super(e),this.message=e,this.code="SAVE_FORMAT_ERROR"}}function ir(e){const t=tr(e);return{circuits:Sn(e).map((t=>({circuitId:t,circuitName:Tn(e,t)}))),nodes:cn(e).map((t=>{const n=ln(e,t),i=wn(e,t),r=Nn(e,t);return{nodeId:t,nodeType:n.nodeType,nodeName:n.nodeName,circuitId:null!=r?r:p,x:i.x,y:i.y}})),wires:Zi(e).map((n=>{const i=Fi(e,n),r=Qi(e,n);return{input:i.inputPin,output:i.outputPin,joints:r.map((e=>t[e]))}}))}}function rr(e,t){var n,i,r;try{zi.validateSync(t)}catch(e){throw new nr(e.message)}e=we;try{e=(null!==(n=t.circuits)&&void 0!==n?n:[]).reduce(((e,{circuitId:t,circuitName:n})=>Dc(e,ze({circuitId:t,circuitName:n}))),e),e=(null!==(i=t.nodes)&&void 0!==i?i:[]).reduce(((e,t)=>{var n;return Dc(e,Ue(t.nodeType,t.circuitId,{x:t.x,y:t.y},{nodeId:t.nodeId,nodeName:null!==(n=t.nodeName)&&void 0!==n?n:void 0}))}),e),e=(null!==(r=t.wires)&&void 0!==r?r:[]).reduce(((e,t)=>Dc(e,Ye(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to rehydrate SaveData:",e),new nr("Failed to load project.")}return e}const or=vn(((e,t)=>{if(!function(e){return e.type===We}(t))return e;const{circuitId:n,circuitName:i}=t.payload,r=i.trim();return""===r?e:Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:r})})})),cr=vn(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,circuitId:i}=t.payload,r=i;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[r]:[...e.nodeIdsByCircuitId[r],n]})})})),sr=vn(((e,t)=>{if(!Ke(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:tn()(e.nodeIdsByCircuitId,(e=>e.filter((e=>-1===n.indexOf(e)))))})})),lr=Rt(Bi,Mi,(function(e=we,t){if(!function(e){return e.type===Si}(t))return e;const{circuitIds:n,saveData:i}=t.payload;return function(e,t,n){var i,r;try{zi.validateSync(n)}catch(e){throw new nr(e.message)}const o=Object.keys(e.services.circuits.circuitNamesByCircuitId),c=n.circuits.filter((e=>-1!==t.indexOf(e.circuitId)&&-1===o.indexOf(e.circuitId)));if(0===c.length)return e;try{e=c.reduce(((e,{circuitId:t,circuitName:n})=>Dc(e,ze({circuitId:t,circuitName:n}))),e);const t=(null!==(i=n.nodes)&&void 0!==i?i:[]).filter((e=>c.some((({circuitId:t})=>t===e.circuitId))));e=t.reduce(((e,t)=>{var n;return Dc(e,Ue(t.nodeType,t.circuitId,{x:t.x,y:t.y},{nodeId:t.nodeId,nodeName:null!==(n=t.nodeName)&&void 0!==n?n:void 0}))}),e),e=(null!==(r=n.wires)&&void 0!==r?r:[]).filter((function(e){return t.some((({nodeId:t})=>e.input.nodeId===t||e.output.nodeId===t))})).reduce(((e,t)=>Dc(e,Ye(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to import circuit from SaveData:",e),new nr("Failed to import circuit.")}return e}(e,n,i)}),or,cr,sr,vn(((e,t)=>ft(t)?Object.assign(Object.assign({},e),{circuitNamesByCircuitId:{[p]:"Root"},nodeIdsByCircuitId:{[p]:[]}}):e)));var ar=n(5161),dr=n.n(ar),ur=n(998),pr=n.n(ur),mr=n(7287),yr=n.n(mr);const fr="@clipboard/copy",gr=(e,t)=>{const n=dn(e,t);if("pin-input"!==n&&"pin-output"!==n)return[];const i=Nn(e,t);if(!i)return[];const r=Pn(i);return an(e,r).map((e=>({nodeId:e,pinId:t})))},Ir=Nt("clipboard");xt("clipboard");const hr=Rt(Ir(((e,t,n)=>{if(!function(e){return e.type===fr}(t))return e;const{nodeIds:i}=t.payload;if(0===i.length)return e;const r=jn(n),o=yr()(i,dr()(i,(()=>(0,Te.Z)()))),c=r[i[0]],s=i.map((e=>{const t=ln(n,e),s=((e,t)=>{const n=Ki(e),i=$i(e,t);if(!i)return{};let r=[];r=Object.keys(i.pins).filter((e=>"output"===i.pins[e].direction));const o=n.filter((e=>e.outputPin.nodeId===t)),c={};for(const e of r)c[e]=[];for(const e of o){const{outputPin:t,inputPin:n}=e;c[t.pinId].push(n)}return c})(n,e);return{id:o[e],nodeType:t.nodeType,offset:(0,h.sj)(r[e],c),outputs:tn()(s,(e=>e.filter((e=>{return t=e.nodeId,-1!==pr()(i,(e=>e===t));var t})).map((e=>({nodeId:o[e.nodeId],pinId:e.pinId})))))}}));return Object.assign(Object.assign({},e),{clipboardNodes:s,clipboardPasteOrigin:c})})),(function(e=we,t){if(!function(e){return e.type===ot}(t))return e;const{targetCircuitId:n}=t.payload,{clipboardNodes:i,clipboardPasteOrigin:r}=e.services.clipboard,o=$n(e),c=(0,h.ZO)(r,{x:o,y:o}),s=yr()(i.map((e=>e.id)),dr()(i,(()=>(0,Te.Z)())));for(const t of i){const{id:i,nodeType:r,offset:o}=t,l=(0,h.ZO)(c,o);e=Dc(e,Ue(r,n,l,{nodeId:s[i]}))}for(const t of i){const{id:n,outputs:i}=t,r=s[n];for(const t of Object.keys(i))for(const n of i[t]){const{nodeId:i,pinId:o}=n,c=s[i];e=Dc(e,Ye({nodeId:r,pinId:t},{nodeId:c,pinId:o}))}}return e=B(e,"services","clipboard","clipboardPasteOrigin",c),Dc(e,gi(Ri()(s)))})),br="@dialog/response/accept",vr=e=>({type:br,payload:{result:e}}),Er=Nt("dialog"),kr=xt("dialog"),Or=Er(((e,t)=>function(e){return e.type===br}(t)?v:e)),Nr="@dialog/response/cancel",xr=()=>({type:Nr}),Cr=Er(((e,t)=>function(e){return e.type===Nr}(t)?v:e)),jr="@dialog/show",wr=Rt(Or,Cr,Er(((e,t)=>{if(!function(e){return e.type===jr}(t))return e;const{dialogType:n,data:i}=t.payload;return Object.assign(Object.assign({},e),{dialogType:n,data:i})})));function Pr(e,t){return t.weight=e,t}function Br(e){var t;return(null!==(t=e.weight)&&void 0!==t?t:0)-1}var Mr=n(5937),Sr=n.n(Mr);function Lr(e,t,n){const i=$t()(Object.keys(e.nodesById),t),r=fn()(t,(e=>gr(n,e)));return Object.assign(Object.assign({},e),{nodesById:Et()(e.nodesById,i),connectionsById:Sr()(e.connectionsById,(function({inputPin:e,outputPin:n}){return-1===t.indexOf(e.nodeId)&&-1===t.indexOf(n.nodeId)&&!r.some((t=>Hn(t,e)||Hn(t,n)))}))})}const Tr=Pr(Br(Mi),nn(((e,t,n)=>{if(!Re(t))return e;const{circuitId:i}=t.payload;return Lr(e,[...On(n,i),...an(n,Pn(i))],n)}))),Dr=Pr(-10,nn(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,nodeType:i,nodeName:r}=t.payload;return Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:{nodeType:i,nodeName:null!=r?r:null}})})}))),zr=Pr(Br(sr),nn(((e,t,n)=>{if(!Ke(t))return e;const{nodeIds:i}=t.payload;return Lr(e,i,n)}))),Jr=nn(((e,t)=>{if(!function(e){return e.type===He}(t))return e;const{nodeId:n}=t.payload;if(!e.nodesById[n])return e;let i=t.payload.nodeName;return i||""!==i.trim()||(i=null),Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:Object.assign(Object.assign({},e.nodesById[n]),{nodeName:i})})})})),Rr=Rt(Tr,Dr,nn(((e,t)=>ft(t)?E:e)),zr,Jr,nn(((e,t,n)=>{if(!Xe(t))return e;const{connectionId:i,p1:r,p2:o}=t.payload,c=function(e,t,n,i){const r=e.nodesById[t.nodeId],o=e.nodesById[n.nodeId];if(!r||!o)return null;const c=Zn(i,r.nodeType),s=Zn(i,o.nodeType);if(!c||!s)return null;const l=c.pins[t.pinId],a=s.pins[n.pinId];if(!l||!a)return null;if(l.direction===a.direction)return null;return{outputPin:"output"===l.direction?t:n,inputPin:"input"===l.direction?t:n}}(e,r,o,n);if(!c)return e;const{inputPin:s}=c;return In()(e.connectionsById,(e=>Hn(e.inputPin,s)))?e:Object.assign(Object.assign({},e),{connectionsById:Object.assign(Object.assign({},e.connectionsById),{[i]:Object.assign({id:i},c)})})})),nn(((e,t)=>{if(!et(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.connectionsById).filter((e=>e!==n));return Object.assign(Object.assign({},e),{connectionsById:Et()(e.connectionsById,i)})})));function Wr(e,t,n){const i=t.reduce(((e,t)=>{const i=qi(n,t),r=Gi(n,t);return e.push(...i,...r),e}),[]),r=fn()(t,(e=>gr(n,e))),o=Ui(n),c=Object.keys(o).filter((e=>{const{inputPin:t,outputPin:n}=o[e];return r.some((e=>Hn(e,t)||Hn(e,n)))})),s=[...i,...c].reduce(((t,n)=>(t.push(...e.wireJointIdsByConnectionId[n]),t)),[]),l=$t()(Object.keys(e.wireJointIdsByConnectionId),i),a=$t()(Object.keys(e.wireJointPositionsByJointId),s),d=$t()(Object.keys(e.nodePositionsById),t);return Object.assign(Object.assign({},e),{nodePositionsById:Et()(e.nodePositionsById,d),wireJointIdsByConnectionId:Et()(e.wireJointIdsByConnectionId,l),wireJointPositionsByJointId:Et()(e.wireJointPositionsByJointId,a)})}const Ar=Pr(Br(Tr),xn(((e,t,n)=>{if(!Re(t))return e;const{circuitId:i}=t.payload;return e=Wr(e,On(n,i),n),Wr(e,an(n,Pn(i)),n)}))),Ur=xn(((e,t)=>{if(!Ze(t))return e;const{nodeId:n,position:i=h.Ds}=t.payload;return B(e,"nodePositionsById",n,i)})),Zr=Pr(Br(zr),xn(((e,t,n)=>{if(!Ke(t))return e;const{nodeIds:i}=t.payload;return Wr(e,i,n)}))),Fr="@node/move",Kr=(e,t,n={})=>{var i,r;return{type:Fr,payload:{nodeIds:ce(e),position:t,relative:null!==(i=n.relative)&&void 0!==i&&i,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},Hr=xn(((e,t,n)=>{if(!function(e){return e.type===Fr}(t))return e;const{nodeIds:i,position:r,relative:o,snapMode:c}=t.payload,s=tn()(Et()(e.nodePositionsById,i),(e=>{let t={x:o?e.x+r.x:r.x,y:o?e.y+r.y:r.y};return"node"===c&&(t=Yn(n,t)),t}));return Object.assign(Object.assign({},e),{nodePositionsById:Object.assign(Object.assign({},e.nodePositionsById),s)})})),qr=Rt(Ar,Ur,xn(((e,t)=>ft(t)?k:e)),Zr,Hr,xn(((e,t)=>{if(!Xe(t))return e;const{connectionId:n,joints:i}=t.payload;if(i.length>0){const t=i.map((()=>(0,Te.Z)()));e=B(e,"wireJointIdsByConnectionId",n,t),e=B(e,"wireJointPositionsByJointId",(e=>Object.assign(Object.assign({},e),yr()(t,i))))}else e=B(e,"wireJointIdsByConnectionId",n,[]);return e})),xn(((e,t)=>{if(!et(t))return e;const{connectionId:n}=t.payload,i=Object.keys(e.wireJointIdsByConnectionId).filter((e=>e!=n)),r=$t()(Object.keys(e.wireJointPositionsByJointId),e.wireJointIdsByConnectionId[n]);return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Et()(e.wireJointIdsByConnectionId,i),wireJointPositionsByJointId:Et()(e.wireJointPositionsByJointId,r)})})),xn(((e,t)=>{if(!function(e){return e.type===tt}(t))return e;const{connectionId:n,addAfterJointId:i,position:r,jointId:o}=t.payload;let c=e.wireJointIdsByConnectionId[n];const s=i?c.indexOf(i)+1:0;return c=[...c.slice(0,s),o,...c.slice(s)],Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Object.assign(Object.assign({},e.wireJointIdsByConnectionId),{[n]:c}),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),{[o]:r})})})),xn(((e,t)=>{if(!function(e){return e.type===rt}(t))return e;const{jointId:n}=t.payload,i=Object.keys(e.wireJointPositionsByJointId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:tn()(e.wireJointIdsByConnectionId,(e=>e.filter((e=>e!==n)))),wireJointPositionsByJointId:Et()(e.wireJointPositionsByJointId,i)})})),xn(((e,t,n)=>{if(!function(e){return e.type===nt}(t))return e;const{jointIds:i,position:r,relative:o,snapMode:c}=t.payload,s=tn()(Et()(e.wireJointPositionsByJointId,i),(e=>{let t={x:o?e.x+r.x:r.x,y:o?e.y+r.y:r.y};return"node"===c?t=Yn(n,t):"joint"===c&&(t=Xn(n,t)),t}));return Object.assign(Object.assign({},e),{wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),s)})}))),Gr=Pr(50,((e=we,t)=>{return bt(t)?(n=ir(e),localStorage.setItem("autosave",JSON.stringify(n)),e):e;var n})),Vr=Nt("project"),$r=xt("project"),_r=Vr(((e,t)=>bt(t)?Object.assign(Object.assign({},e),{projectModified:!0}):e)),Yr=Vr(((e,t)=>ft(t)?(localStorage.removeItem("autosave"),Object.assign(Object.assign({},e),{projectName:"New Project",projectModified:!1})):e)),Xr="@project/rename",Qr=Vr(((e,t)=>{if(!function(e){return e.type===Xr}(t))return e;let{projectName:n}=t.payload;return n=n.trim(),""===n?e:Object.assign(Object.assign({},e),{projectName:n})})),eo="@project/save",to=()=>({type:eo}),no="@project/save:success",io=Rt(Gr,(function(e=we,t){if(!function(e){return e.type===Le}(t))return e;const n=function(){const e=localStorage.getItem("autosave");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}();if(!n)return e;try{e=B(e=rr(e,n),"services","project",(e=>Object.assign(Object.assign({},e),{projectName:"Previous Project",projectModified:!0})))}catch(e){}return e}),_r,Yr,(function(e=we,t){if(!function(e){return e.type===gt}(t))return e;const{fileName:n,saveData:i}=t.payload;try{e=B(e=rr(e,i),"services","project",(e=>Object.assign(Object.assign({},e),{projectName:n,projectModified:!1})))}catch(e){console.error("Failed to load save",e)}return e}),Qr,Vr(((e,t)=>function(e){return e.type===no}(t)?Object.assign(Object.assign({},e),{projectModified:!1}):e))),ro=ni(((e,t)=>{if(!Ke(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:$t()(e.selectedNodeIds,n),selectedConnectionIds:[]})})),oo=ni(((e,t)=>ft(t)?N:e));var co=n(5564),so=n.n(co);const lo="@select/all",ao=e=>({type:lo,payload:{circuitId:e}}),uo=ni(((e,t,n)=>{if(!function(e){return e.type===lo}(t))return e;const{circuitId:i}=t.payload,r=On(n,i);let o=Zi(n);const c=Ui(n);o=o.filter((e=>{const{inputPin:t,outputPin:n}=c[e];return-1!==r.indexOf(t.nodeId)&&-1!==r.indexOf(n.nodeId)}));const s=Xi(n),l=so()(o.map((e=>s[e])));return Object.assign(Object.assign({},e),{selectedNodeIds:r,selectedConnectionIds:o,selectedJointIds:l})})),po="@select/clear",mo=ni(((e,t)=>function(e){return e.type===po}(t)?Object.assign(Object.assign({},e),{selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}):e)),yo=ni(((e,t)=>{if(!function(e){return e.type===ei}(t))return e;const{jointIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:Yt(e.selectedJointIds,n,i)})})),fo=ni(((e,t)=>{if(!function(e){return e.type===fi}(t))return e;const{nodeIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:Yt(e.selectedNodeIds,n,i),selectedConnectionIds:"set"===i?[]:e.selectedConnectionIds,selectedJointIds:"set"===i?[]:e.selectedJointIds})}));var go=n(2525),Io=n.n(go);const ho=(0,Qt.P1)(jn,Un,sn,((e,t,n)=>tn()(e,((e,i)=>{const r=n[i];if(!r)return h.rG;const o=t[r];return o?(0,h.gQ)(o.visual.hitRect,e):h.rG})))),bo=ni(((e,t,n)=>{if(!function(e){return e.type===Xt}(t))return e;const{region:i,circuitId:r,mode:o}=t.payload,c=On(n,r),s=Et()(ho(n),c),l=[];Io()(s,((e,t)=>{(0,h.kK)(e,i)&&l.push(t)}));const a=tr(n),d=((e,t)=>{const n=On(e,t),i=fn()(n,(t=>Vi(e,t))),r=fn()(i,(t=>Qi(e,t)));return Ai()(r)})(n,r).filter((e=>{const t=a[e];return(0,h.PL)(t,i)}));return Object.assign(Object.assign({},e),{selectedNodeIds:Yt(e.selectedNodeIds,l,o),selectedConnectionIds:"set"===o?[]:e.selectedConnectionIds,selectedJointIds:Yt(e.selectedJointIds,d,o)})})),vo="@select/wires",Eo=ni(((e,t)=>{if(!function(e){return e.type===vo}(t))return e;const{connectionIds:n,mode:i}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===i?[]:e.selectedNodeIds,selectedConnectionIds:Yt(e.selectedConnectionIds,n,i),selectedJointIds:"set"===i?[]:e.selectedJointIds})})),ko="@selection/copy",Oo=Rt(oo,ro,uo,mo,yo,fo,bo,Eo,(function(e=we,t){if(!function(e){return e.type===qe}(t))return e;const{selectedNodeIds:n,selectedJointIds:i}=e.services.selection,r=jn(e);for(const t of n){const n=r[t];if(!n)continue;const i=Yn(e,n);(0,h.kg)(n,i)||(e=Dc(e,Kr(t,i)))}const o=tr(e);for(const t of i){const n=o[t];if(!n)continue;const i=Xn(e,n);(0,h.kg)(n,i)||(e=Dc(e,it(t,i)))}return e}),(function(e=we,t){if(!function(e){return e.type===ko}(t))return e;const n=ri(e);return 0===n.length?e:Dc(e,(i=n,{type:fr,payload:{nodeIds:Array.isArray(i)?i:[i]}}));var i}),(function(e=we,t){if(!function(e){return e.type===Ge}(t))return e;const{selectedNodeIds:n,selectedConnectionIds:i,selectedJointIds:r}=e.services.selection;return n.length>0&&(e=Dc(e,{type:Fe,payload:{nodeIds:ce(n)}})),e=i.reduce(((e,t)=>Dc(e,(e=>({type:Qe,payload:{connectionId:e}}))(t))),e),r.reduce(((e,t)=>Dc(e,(e=>({type:rt,payload:{jointId:e}}))(t))),e)}),(function(e=we,t){if(!function(e){return e.type===$e}(t))return e;const{offsetX:n,offsetY:i,snapMode:r}=t.payload,o=ri(e),c=si(e),s={x:n,y:i};let l="none";"node"!==r&&"by-type"!==r||(l="node");let a="none";return a="by-type"===r?"joint":r,e=Dc(e,Kr(o,s,{relative:!0,snapMode:l})),Dc(e,it(c,s,{relative:!0,snapMode:a}))}),ni(((e,t)=>{if(!et(t))return e;const{connectionId:n}=t.payload;return Object.assign(Object.assign({},e),{selectedConnectionIds:e.selectedConnectionIds.filter((e=>e!==n))})}))),No=Nt("simulator"),xo=xt("simulator"),Co=No(((e,t)=>bt(t)?x:e));function jo(e){return e.default}const wo={"input-momentary":jo(n(3667)),"input-toggle":jo(n(2318)),"logic-and":jo(n(7909)),"logic-buffer":jo(n(274)),"logic-nand":jo(n(4347)),"logic-nor":jo(n(8112)),"logic-not":jo(n(6559)),"logic-or":jo(n(2649)),"logic-xor":jo(n(8881)),"output-led":jo(n(6567)),"output-seg7":jo(n(4257)),"pin-high":jo(n(4420))};var Po=n(1235);function Bo(e,t){const n=fn()(t,(e=>[e,"subCircuitIds"]));n.pop();const i=w()(e,n);if(!i)return null;const{simulatorNodeId:r}=i;return null!=r?r:null}var Mo=n(3857),So=n.n(Mo);const Lo=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{},inputElementPinsByCircuitPinId:{},outputElementPinsByCircuitPinId:{}});function To(e,t,n=[]){var i;if(-1!==n.indexOf(e))throw new Error(`Circuit graph encountered loop on ${n.join(" => ")} while trying to add circuit ${e}`);n=[...n,e];const r={},o={},c={},s={},l=[],a=[],d={},u={},p=null!==(i=t.nodeIdsByCircuitId[e])&&void 0!==i?i:[];for(const e of p){const i=t.nodeTypesByNodeId[e];if(!i)continue;if("pin-input"===i){l.push(e),c[e]=[];continue}if("pin-output"===i){a.push(e);continue}const s=Do(e,t,n);So()(r,s.simulatorNodesById),So()(o,s.simulatorNodeIdsByCircuitNodeId),d[e]=s.inputElementPinsByCircuitPinId,u[e]=s.outputElementPinsByCircuitPinId}const m=t.connectionsById;for(const e of Object.keys(m)){const{inputPin:t,outputPin:n}=m[e];if(-1===p.indexOf(t.nodeId)||-1===p.indexOf(n.nodeId))continue;const i=w()(u,[n.nodeId,n.pinId]),o=w()(d,[t.nodeId,t.pinId]);if(-1!==l.indexOf(n.nodeId)&&o){c[n.nodeId].push(...o);continue}if(-1!==a.indexOf(t.nodeId)&&i){s[t.nodeId]=i;continue}if(!i||!o)continue;const y=r[i.simulatorNodeId];let f=y.outputsByPin[i.pinId];null==f&&(y.outputsByPin[i.pinId]=f=[]);for(const e of o)f.push({simulatorNodeId:e.simulatorNodeId,pinId:e.pinId}),r[e.simulatorNodeId].inputsByPin[e.pinId]={simulatorNodeId:i.simulatorNodeId,pinId:i.pinId}}return{simulatorNodesById:r,simulatorNodeIdsByCircuitNodeId:o,inputElementPinsByCircuitPinId:c,outputElementPinsByCircuitPinId:s}}function Do(e,t,n){const i=t.nodeTypesByNodeId[e];if(!i)return Lo;const r=t.nodeDefsByType[i];if(!r||!r.elementProduction)return Lo;const o="string"==typeof(c=r.elementProduction)?{type:"element",elementType:c}:c;var c;switch(o.type){case"element":return function(e,t,{nodeTypesByNodeId:n,nodeDefsByType:i}){const r=i[n[e]];if(!r)return Lo;const o={},c={},s=(0,Te.Z)();o[s]={elementType:t.elementType,inputsByPin:{},outputsByPin:{}},c[e]={simulatorNodeId:s,subCircuitIds:{}};const l={},a={};for(const e of Object.keys(r.pins)){const{direction:t}=r.pins[e];"input"===t?l[e]=[{pinId:e,simulatorNodeId:s}]:"output"===t&&(a[e]={pinId:e,simulatorNodeId:s})}return{simulatorNodesById:o,simulatorNodeIdsByCircuitNodeId:c,inputElementPinsByCircuitPinId:l,outputElementPinsByCircuitPinId:a}}(e,o,t);case"circuit":return function(e,t,n,i){const r=To(t.circuitId,n,i);return Object.assign(Object.assign({},r),{simulatorNodeIdsByCircuitNodeId:{[e]:{simulatorNodeId:null,subCircuitIds:r.simulatorNodeIdsByCircuitNodeId}}})}(e,o,t,n);default:throw new Error("Unsupported production type "+o.type)}}const zo=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{}}),Jo=(0,Qt.P1)(kn,sn,Ui,Un,((e,t,n,i)=>{try{return To(p,{nodeIdsByCircuitId:e,nodeTypesByNodeId:t,connectionsById:n,nodeDefsByType:i})}catch(e){return console.error(e),zo}})),Ro=(e,t)=>{const{simulatorNodesById:n}=Jo(e),i=n[t];return i?i.elementType:null},Wo=(e,t)=>{var n;const i=Ro(e,t);return i&&null!==(n=wo[i])&&void 0!==n?n:null};var Ao=n(7513),Uo=n.n(Ao);const Zo=Object.freeze([]),Fo=Object.freeze({});function Ko(e,t){const n=(e=>{const{simulatorNodesById:t}=Jo(e);return Object.keys(t)})(t);return e=x,e=n.reduce(((e,n)=>function(e,t,n){const i=Wo(n,t);if(!i)return e;const r={};return i.outputPins.forEach((e=>{r[e]=!1})),B(e,"nodeOutputValuesByNodeId",t,r)}(e,n,t)),e),e=n.reduce(((e,n)=>Go(e,n,t)),e),Object.assign({},e,{initialized:!0})}function Ho(e,t,n){const i=e.tick+t;e=Object.assign({},e,{transitionWindows:e.transitionWindows.slice()});let r=t+1;for(;e.transitionWindows.length>0&&e.transitionWindows[0].tick<=i;){if(0==--r)throw new Error("Maximum ticks per sim evolution exceeded.  This is an indication that windows are being generated for past ticks.");const t=e.transitionWindows.shift();e=qo(e,t,n)}return e.tick!=i&&(e=Object.assign({},e,{tick:i})),e}function qo(e,t,n){if(0===t.transitionIds.length)return e;let i=Object.assign({},e,{tick:t.tick,nodeOutputValuesByNodeId:Object.assign({},e.nodeOutputValuesByNodeId)});const r=new Set;t.transitionIds.forEach((e=>{const{nodeId:t,valuesByOutputPin:o}=i.transitionsById[e];var c,s;(c=i.nodeOutputValuesByNodeId[t],s=o,Object.keys(s).some((e=>c[e]!==s[e])))&&(i.nodeOutputValuesByNodeId[t]=Object.assign({},i.nodeOutputValuesByNodeId[t],o),((e,t)=>{const{simulatorNodesById:n}=Jo(e),i=n[t];return i?fn()(Ri()(i.outputsByPin),(e=>e.map((e=>e.simulatorNodeId)))):Zo})(n,t).forEach((e=>r.add(e))))})),i.transitionsById=Et()(i.transitionsById,$t()(Object.keys(i.transitionsById),t.transitionIds));for(const e of r)i=Go(i,e,n);return i}function Go(e,t,n){const i=Wo(n,t);if(!i||!i.evolve)return e;const r=function(e,t,n){const i={},r=((e,t)=>{const{simulatorNodesById:n}=Jo(e),i=n[t];return i?i.inputsByPin:Fo})(n,t);return Object.keys(r).forEach((t=>{var n;const o=r[t];if(!o)return void(i[t]=!1);const{simulatorNodeId:c,pinId:s}=o;i[t]=(null===(n=e.nodeOutputValuesByNodeId[c])||void 0===n?void 0:n[s])||!1})),i}(e,t,n);return Vo(e,t,i.evolve(e.nodeStatesByNodeId[t],r,e.tick))}function Vo(e,t,n){const{state:i,transitions:r}=n;return i&&(e=B(e,"nodeStatesByNodeId",t,i)),r&&(e=ce(r).reduce(((e,n,i)=>function(e,t,n,i="replace"){const{tickOffset:r,valuesByPin:o,transitionMerger:c=i}=n,s=e.tick+(r>0?r:1);return"replace"===c&&(e=function(e,t){return Object.keys(e.transitionsById).filter((n=>function(e){return e.nodeId===t}(e.transitionsById[n]))).reduce(((e,t)=>function(e,t){const n=e.transitionsById[t];if(!n)return e;const i=Et()(e.transitionsById,Object.keys(e.transitionsById).filter((e=>e!==t)));let r=e.transitionWindows;const o=Uo()(r,n.tick,((e,t)=>e.tick-t));if(o>=0){const e=r[o],{transitionIds:n}=e,i=e.transitionIds.indexOf(t);-1!==i&&(1===e.transitionIds.length?r=le(r,o):(r=r.slice(),r[o]=Object.assign({},r[o],{transitionIds:le(n,i)})))}return Object.assign({},e,{transitionsById:i,transitionWindows:r})}(e,t)),e)}(e,t)),function(e,t,n,i){const r=(0,Te.Z)(),o={nodeId:t,tick:n,valuesByOutputPin:i},c=e.transitionWindows.slice();let s=Uo()(c,n,((e,t)=>e.tick-t));if(s<0){s=-s-1;const e={tick:n,transitionIds:[]};c.splice(s,0,e)}const l=c[s].transitionIds.slice();l.push(r),c[s]=Object.assign({},c[s],{transitionIds:l});const a=Object.assign({},e.transitionsById,{[r]:o});return Object.assign({},e,{transitionsById:a,transitionWindows:c})}(e,t,s,o)}(e,t,n,0===i?"replace":"append")),e)),e}const $o=No(((e,t,n)=>{if(!(0,Po.ke)(t))return e;const{circuitNodeIdPath:i,data:r}=t.payload,o=((e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=Jo(e);return Bo(n,t)})(n,i);if(!o)return e;const c=Ro(n,o);if(!c)return e;const s=wo[c];if(!s||!s.interact)return e;const l=e.nodeStatesByNodeId[o];return Vo(e,o,s.interact(l,r))})),_o="@sim/fastforward",Yo=No(((e,t,n)=>{if(!function(e){return e.type===_o}(t))return e;const{tick:i,transitionWindows:r}=e;return 0===r.length?e:Ho(e,r[0].tick-i,n)})),Xo="@sim/start",Qo=()=>({type:Xo});function ec(e){return e.type===Xo}const tc=No(((e,t,n)=>ec(t)?Ko(e,n):e)),nc="@sim/step",ic=()=>({type:nc});function rc(e){return e.type===nc}const oc="@sim/tick",cc=e=>({type:oc,payload:{tickCount:e}}),sc="@sim/stop",lc=()=>({type:sc});function ac(e){return e.type===sc}const dc=Rt(Co,$o,Yo,tc,(function(e=we,t){if(!rc(t))return e;const{initialized:n}=e.services.simulator;n||(e=B(e,"services","simulator",(t=>Ko(t,e))));const{tick:i,transitionWindows:r}=e.services.simulator;if(0===r.length)return e;const o=r[0].tick;return Dc(e,cc(o-i))}),No(((e,t)=>ac(t)?x:e)),No(((e,t,n)=>{if(!function(e){return e.type===oc}(t))return e;const{tickCount:i}=t.payload,r=performance.now();e=Ho(e,i,n);const o=performance.now()-r;return Object.assign(Object.assign({},e),{lastTickProcessingTimeMs:o})}))),uc=Nt("simulatorControl"),pc=xt("simulatorControl"),mc=uc(((e,t)=>bt(t)?Object.assign(Object.assign({},e),{mode:"edit"}):e)),yc="@sim/pause",fc=e=>({type:yc,payload:{mode:e}}),gc=pc((e=>"edit"!==e.mode)),Ic=pc((e=>"run"===e.mode)),hc=pc((e=>"pause"===e.mode)),bc=pc((e=>e.ticksPerSecond)),vc=Rt(mc,uc(((e,t)=>{if(!function(e){return e.type===yc}(t))return e;const{mode:n}=t.payload;if(!gc.local(e))return e;let i=e.mode;switch(n){case!0:i="pause";break;case!1:i="run";break;case"toggle":i="run"==i?"pause":"run"}return Object.assign(Object.assign({},e),{mode:i})})),uc(((e,t)=>ec(t)?Object.assign(Object.assign({},e),{mode:"run"}):e)),uc(((e,t)=>rc(t)?Object.assign(Object.assign({},e),{mode:"pause"}):e)),uc(((e,t)=>ac(t)?Object.assign(Object.assign({},C),{ticksPerSecond:e.ticksPerSecond}):e))),Ec=Nt("uiLayout"),kc=xt("uiLayout"),Oc=Ec(((e,t,n)=>{if(!Re(t))return e;if(!e.layout)return e;const{circuitId:i}=t.payload,r=St(n,i),o=fe(e.layout,(e=>!ve(e)||-1===r.indexOf(e.windowProps.editorId)));return Object.assign(Object.assign({},e),{layout:o})})),Nc="@layout/rearrange",xc=Ec(((e,t)=>{if(!function(e){return e.type===Nc}(t))return e;const{layout:n}=t.payload;return Object.assign(Object.assign({},e),{layout:n})})),Cc=Ec(((e,t,n)=>{if(!wi(t))return e;const{newWindowId:i}=t.payload;if(!i)return e;const r=be(i),o=Bt(n);let c=e.layout;if(null==c)c=r;else{let e=!1;l=t=>{const n=R(t);return ve(n)&&n.windowProps.editorId===o?(e=!0,{direction:"row",division:50,first:t,second:r}):null},c=null!==(a=function e(t){const n=l(t);if(n)return n;const i=R(t);if(A(i)){const t=e(i.first);if(t)return Object.assign(Object.assign({},i),{first:t});const n=e(i.second);if(n)return Object.assign(Object.assign({},i),{second:n})}return null}(s=c))&&void 0!==a?a:s,e||(c={direction:"row",division:50,first:c,second:r})}var s,l,a;return Object.assign(Object.assign({},e),{layout:c})})),jc="@view/reset",wc=()=>({type:jc}),Pc=Rt(Oc,xc,Cc,Ec(((e,t)=>function(e){return e.type===jc}(t)?ke:e))),Bc="@view/node-names",Mc=e=>({type:Bc,payload:{mode:e}}),Sc=Nt("uiSettings"),Lc=xt("uiSettings"),Tc=Rt(Sc(((e,t)=>{if(!function(e){return e.type===Bc}(t))return e;const{mode:n}=t.payload;return Object.assign(Object.assign({},e),{nodeNameMode:n})}))),Dc=function(e){const t=Jt()(e,(e=>e.weight||0));return(e=we,n)=>t.reduce(((e,t)=>t(e,n)),e)}(Rt(ki,Pi,lr,hr,wr,Rr,qr,io,Oo,dc,vc,Pc,Tc));const zc=[Kt,Ei,oc];var Jc=n(4970),Rc=n(8764),Wc=n(8424);function*Ac(e,t){yield(0,Jc.gz)(((e,t)=>({type:jr,payload:{dialogType:e,data:t}}))(e,t));const n=yield(0,Jc.qn)([br,Nr]);return n.type===br?n.payload.result:null}const Uc="@project/export-link",Zc=()=>({type:Uc});function*Fc(){yield(0,Jc.ib)(Uc,Kc)}function*Kc(){const e=yield(0,Jc.Ys)();try{const t=ir(e),n=JSON.stringify(t),i=(0,Wc.Wt)(n),r=Rc.lW.from(i).toString("base64"),o=encodeURIComponent(r),c=Se+d.createHref({pathname:"/import",search:"data="+o});yield(0,Jc.RE)(Ac,"export-project-link",{projectLink:c})}catch(e){console.error("Failed to export project as link",e)}}var Hc=n(4171),qc=n.n(Hc);const Gc="@project/import-circuits",Vc=()=>({type:Gc});function*$c(){yield(0,Jc.ib)(Gc,_c)}function*_c(){const[e]=yield(0,Jc.RE)(qc(),{accept:"application/json"}),t=yield(0,Jc.RE)(e.text.bind(e)),n=JSON.parse(t),i={circuits:n.circuits.filter((e=>e.circuitId!==p))},r=yield(0,Jc.RE)(Ac,"import-project-circuits",i);if(!Array.isArray(r))return;const o=r,c=[];let s;for(;s=o.pop();){c.push(s);for(const e of n.nodes){const{circuitId:t,nodeType:n}=e;if(s!==t)continue;const i=Bn(n);null!=i&&o.push(i)}}yield(0,Jc.gz)(((e,t)=>({type:Si,payload:{circuitIds:ce(e),saveData:t}}))(c,n))}const Yc="@project/import-link";function*Xc(){yield(0,Jc.ib)(Yc,Qc)}function*Qc(e){const{data:t}=e.payload;try{const e=decodeURIComponent(t),n=Rc.lW.from(e,"base64"),i=(0,Wc.rr)(n,{to:"string"}),r=JSON.parse(i);yield(0,Jc.gz)(It("Linked Project",r)),d.replace("/")}catch(e){console.error("Failed to import save from link",e)}}const es="@project/load",ts=()=>({type:es});function*ns(){yield(0,Jc.ib)(es,is)}function*is(){try{const[e]=yield(0,Jc.RE)(qc(),{accept:"application/json"}),t=yield(0,Jc.RE)(e.text.bind(e)),n=JSON.parse(t);let i=e.name;i=i?i.substr(0,i.lastIndexOf(".json")):"Unnamed Project",yield(0,Jc.gz)(It(i,n))}catch(e){console.warn("Failed to load project:",e)}}var rs=n(3162);const os=$r((e=>e.projectName)),cs=$r((e=>e.projectModified));function*ss(){yield(0,Jc.ib)(eo,ls)}function*ls(){const e=yield(0,Jc.Ys)();try{window.showSaveFilePicker?yield(0,Jc.RE)(as,e):yield(0,Jc.RE)(ds,e),yield(0,Jc.gz)({type:no})}catch(e){console.warn("Failed to save project",e)}}function*as(e){const t=yield(0,Jc.Ys)(os),n=yield(0,Jc.RE)(window.showSaveFilePicker,{suggestedName:t,types:[{description:"Discrelog Project Files",accept:{"application/json":[".json"]}}]});if(!n)return;let i=n.name;i||(i=n.getFile().name),i&&(i=i.substr(0,i.lastIndexOf(".json")),yield(0,Jc.gz)((e=>({type:Xr,payload:{projectName:e}}))(i)));const r=ir(e),o=yield(0,Jc.RE)(n.createWritable.bind(n));yield(0,Jc.RE)(o.write.bind(o),JSON.stringify(r,null,2)),yield(0,Jc.RE)(o.close.bind(o))}function*ds(e){const t=yield(0,Jc.Ys)(os),n=ir(e),i=new Blob([JSON.stringify(n,null,2)],{type:"application/json;charset=utf-8"});(0,rs.saveAs)(i,t+".json")}function*us(){yield(0,Jc.rM)(Fc),yield(0,Jc.rM)($c),yield(0,Jc.rM)(Xc),yield(0,Jc.rM)(ns),yield(0,Jc.rM)(ss)}function*ps(){yield(0,Jc.A7)([Xo,yc,nc],ms)}function*ms(){for(;yield(0,Jc.Ys)(Ic);){try{yield(0,Jc.gz)(cc(1))}catch(e){return console.error(e),void(yield(0,Jc.gz)(fc(!0)))}const e=yield(0,Jc.Ys)(bc),t=Math.max(Math.ceil(1e3/e),1);yield(0,Jc.gw)(t)}}function*ys(){yield(0,Jc.rM)(ps)}const fs=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionSanitizer:function(e){return e},stateSanitizer:function(e){return e},actionsBlacklist:zc})||Pe.qC,gs=(0,Be.ZP)(),Is=[!1,gs].filter(L),hs=(0,Pe.MT)((function(e=we,t){return e=function(e=we,t){return function(e=we,t){if(!at(t))return e;const{undoStack:n,redoStack:i}=e.undo,r=Dt()(n);if(!r)return e;const{serviceStates:o,viewCircuitId:c}=r;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:n.slice(0,n.length-1),redoStack:[...i,Lt(e)]})}),c&&(e=Dc(e,ji(c))),e}(e=function(e=we,t){if(!pt(t))return e;const{undoStack:n,redoStack:i}=e.undo,r=Dt()(i);if(!r)return e;const{serviceStates:o,viewCircuitId:c}=r;return e=Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),o),undo:Object.assign(Object.assign({},e.undo),{undoStack:[...n,Lt(e)],redoStack:i.slice(0,i.length-1)})}),c&&(e=Dc(e,ji(c))),e}(e=function(e=we,t){return!bt(t)||at(t)||pt(t)?e:B(e,"undo",(t=>Object.assign(Object.assign({},t),{undoStack:[...t.undoStack.slice(0,25),Lt(e)],redoStack:[]})))}(e,t),t),t)}(e,t),Dc(e,t)}),fs((0,Pe.md)(...Is)));function bs(e){return(0,c.v9)(e)}function vs(e,t,n,r){i.useEffect((()=>{if(!e.current)return;const i=e.current;return i.addEventListener(t,n,r),()=>{i.removeEventListener(t,n,r)}}),[t,n,e,r])}gs.run((function*(){yield(0,Jc.rM)(us),yield(0,Jc.rM)(ys)})),hs.dispatch({type:Le});const Es=kc((e=>e.layout)),ks=({className:e,children:t})=>i.createElement("div",{className:P("titlebar--3-TCE",e)},i.createElement("span",{className:"titlebar-heading--3RAl1"},"Discrelog"),i.createElement("div",{className:"titlebar-divider--Wl_27"}),t);var Os=n(1935);function Ns(){}const xs={registerPopoverChild:Ns,unregisterPopoverChild:Ns},Cs=i.createContext(null),js=({registerPopoverChild:e,unregisterPopoverChild:t,children:n})=>{const r=i.useContext(Cs),o=null==r?void 0:r.registerPopoverChild,c=null==r?void 0:r.unregisterPopoverChild,s=i.useCallback((t=>{o&&o(t),e(t)}),[e,o]),l=i.useCallback((e=>{t(e)}),[t,c]),a=i.useMemo((()=>({registerPopoverChild:s,unregisterPopoverChild:l})),[s,l]);return i.createElement(Cs.Provider,{value:a},n)},ws=({isOpen:e,anchorEl:t,placement:n="auto",onRequestClose:o,children:c})=>{const[s,l]=i.useState(null),{attributes:a,styles:d}=(0,Os.D)(e?t:null,s,{placement:n});!function(e){var t;const n=null!==(t=i.useContext(Cs))&&void 0!==t?t:xs,r=i.useRef(n);i.useEffect((()=>{r.current=n})),i.useEffect((()=>{if(e)return r.current.registerPopoverChild(e),()=>r.current.unregisterPopoverChild(e)}),[e])}(s);const[u,p,m]=function(e=[]){const[t,n]=i.useState(e),r=i.useCallback((e=>{n([...t,e])}),[t]),o=i.useCallback((e=>{n($t()(t,[e]))}),[t]);return[t,r,o,n]}();return function(e,t,n=!0){const r=i.useCallback((n=>{const i=ce(e).filter(L);i.length&&i.every((e=>!e.contains(n.target)))&&t()}),[e,t]);i.useEffect((()=>{if(n)return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}}),[r,n])}(i.useMemo((()=>[s,...u]),[u,s]),o),e?(0,r.createPortal)(i.createElement(js,{registerPopoverChild:p,unregisterPopoverChild:m},i.createElement("div",Object.assign({ref:l,style:d.popper},a.popper),c)),document.body):null},Ps=i.createContext((function(){}));function Bs(){return i.useContext(Ps)}const Ms=Ps.Provider,Ss=({content:e,placement:t,children:n})=>{const r=i.useRef(null),[o,c]=i.useState(!1),s=i.useCallback((()=>{c(!0)}),[]),l=i.useCallback((()=>{c(!1)}),[]);return i.createElement(Ms,{value:l},i.createElement("div",{ref:r,onClick:s},n),i.createElement(ws,{anchorEl:r.current,isOpen:o,placement:t,onRequestClose:l},o&&e))},Ls=e=>i.createElement("button",Object.assign({className:"button--Ui3Hp",type:"button"},e),e.children);function Ts(e,...t){const n=(0,c.I0)();return i.useCallback(((...i)=>{const r=e(...t,...i);r&&n(r)}),[n,e,...t])}function Ds(e,...t){const n=(0,c.I0)();return i.useCallback((i=>{if(i.defaultPrevented)return;i.preventDefault();const r=e(...t);r&&n(r)}),[n,e,...t])}const zs="menu-item--2dcyN",Js="menu-item--disabled--RJJTK",Rs="menu-item-content--3s1DG",Ws="menu-item-text--1F41V",As="menu-item-secondary--2PJLF",Us=({children:e})=>i.createElement("ul",{className:"menu--3E86w"},e),Zs=({disabled:e,onClick:t,secondary:n,children:r})=>{const o=Bs(),c=i.useCallback((e=>{t&&t(e),o()}),[o,t]);return i.createElement("li",{className:P(zs,e&&Js)},i.createElement("a",{className:Rs,onClick:c},i.createElement("span",{className:Ws},r),n&&i.createElement("span",{className:As},n)))},Fs=()=>i.createElement("div",{className:"menu-divider--1QPGp"}),Ks=()=>{const e=Ts(yt),t=Ts(to),n=Ts(ts),r=Ts(Vc),o=Ts(Zc);return i.createElement(Us,null,i.createElement(Zs,{onClick:e},"New"),i.createElement(Fs,null),i.createElement(Zs,{onClick:n},"Load"),i.createElement(Zs,{onClick:t},"Save"),i.createElement(Fs,null),i.createElement(Zs,{onClick:r},"Import Circuits"),i.createElement(Fs,null),i.createElement(Zs,{onClick:o},"Export Link"))};var Hs=n(1795);const qs=/(Mac|iOS|OS\ X)/.test((Hs.os||"undefined").toString()),Gs=qs?"command":"ctrl",Vs=e=>e.undo.undoStack.length>0,$s=e=>e.undo.redoStack.length>0,_s=()=>{const e=bs(Vs),t=Ts(lt),n=bs($s),r=Ts(ut);return i.createElement(Us,null,i.createElement(Zs,{disabled:!e,secondary:Gs+"+z",onClick:t},"Undo"),i.createElement(Zs,{disabled:!n,secondary:Gs+"+shift+z",onClick:r},"Redo"))},Ys=Lc((e=>e.nodeNameMode)),Xs=({className:e,value:t,onChange:n,children:r})=>i.createElement("label",{className:e},i.createElement("span",{className:"checkbox-span--1EWGs"},i.createElement("input",{type:"checkbox",checked:t,onChange:n})),r),Qs=({disabled:e,secondary:t,value:n,onChange:r,children:o})=>i.createElement("li",{className:P(zs,e&&Js)},i.createElement(Xs,{className:Rs,value:n,onChange:r},i.createElement("span",{className:Ws},o),t&&i.createElement("span",{className:As},t))),el=({disabled:e,secondary:t,content:n,children:r})=>i.createElement("li",{className:P(zs,e&&Js)},i.createElement(Ss,{placement:"right-start",content:n},i.createElement("a",{className:Rs},i.createElement("span",{className:Ws},r),t&&i.createElement("span",{className:As},t),i.createElement("svg",{className:"menu-item-icon--JTlha",width:12,height:12},i.createElement("path",{d:"M0,0 l6,6 l-6,6 z",fill:"black",strokeWidth:0}))))),tl=()=>{const e=bs(Ys),t=Ts(Mc,"all"),n=Ts(Mc,"named-only"),r=Ts(Mc,"none");return i.createElement(Us,null,i.createElement(Qs,{value:"all"===e,onChange:t},"Always visible"),i.createElement(Qs,{value:"named-only"===e,onChange:n},"Named Items Only"),i.createElement(Qs,{value:"none"===e,onChange:r},"Hidden"))},nl=()=>{const e=Ts(wc);return i.createElement(Us,null,i.createElement(el,{content:i.createElement(tl,null)},"Element Names"),i.createElement(Fs,null),i.createElement(Zs,{onClick:e},"Reset View"))},il=xo((e=>e.lastTickProcessingTimeMs)),rl="icon--3Vly6",ol=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(rl,e.className)}),i.createElement("path",{d:"M3,0 L13,8 L3,16 z"})),cl=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(rl,e.className)}),i.createElement("path",{d:"M1,1 L15,1 L15,15 L1,15 z"})),sl=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(rl,e.className)}),i.createElement("path",{d:"M2.5,1 L6.5,1 L6.5,15 L2.5,15 z M9.5,1 L13.5,1 L13.5,15 L9.5,15 z"})),ll=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(rl,e.className)}),i.createElement("path",{d:"M3,0 L13,8 L3,16 z M11,1 l2,0 l0,14 l-2,0 z"})),al="button--2N_ol",dl=()=>{const e=bs(gc),t=bs(hc),n=bs(il),r=Ds(Qo),o=Ds(lc),c=Ds(fc,"toggle"),s=Ds(ic),l=i.useCallback((e=>{e.preventDefault()}),[]);return i.createElement("span",null,e&&i.createElement("span",{className:"simrate--NKBi_"},n.toFixed(2)," ms"),e?i.createElement(cl,{id:"simctrl-stop",className:P(al,"button-stop--1dD4-"),onClick:o,onMouseDown:l}):i.createElement(ol,{id:"simctrl-run",className:P(al,"button-play--1vWfq"),onClick:r,onMouseDown:l}),i.createElement(ll,{id:"simctrl-step",className:P(al,"button-step--3Fat5"),onClick:s,onMouseDown:l}),i.createElement(sl,{id:"simctrl-pause",className:P(al,"button-pause--1UoHJ",!e&&"button--disabled--3caLv",t&&"selected--Ev2q8"),onClick:c,onMouseDown:l}))},ul=({className:e})=>{const t=bs(os),n=bs(cs);return i.createElement(ks,{className:e},i.createElement(Ss,{content:i.createElement(Ks,null),placement:"bottom-start"},i.createElement(Ls,null,"File")),i.createElement(Ss,{content:i.createElement(_s,null),placement:"bottom-start"},i.createElement(Ls,null,"Edit")),i.createElement(Ss,{content:i.createElement(nl,null),placement:"bottom-start"},i.createElement(Ls,null,"View")),i.createElement("div",{className:"project-titlebar-projectname--20U9D"},t,n&&"*"),i.createElement("div",{className:"project-titlebar-controls--1c1Qn"},i.createElement(dl,null)))};var pl=n(3274);const ml=({circuitId:e,circuitNodeIdPath:t})=>{const n=(0,c.I0)(),r=bs((e=>Tn(e,p))),o=bs((t=>Tn(t,e))),s=i.useCallback((e=>{e.preventDefault(),n(ji(p,[]))}),[n]);return i.createElement(Ls,{onClick:s},0===t.length?o:r)},yl=({circuitNodeIdPath:e})=>{const t=(0,c.I0)(),n=Dt()(e),r=bs((e=>dn(e,n))),o=bs((e=>pn(e,n))),s=r?Bn(r):null,l=bs((e=>s?Tn(e,s):null)),a=i.useCallback((n=>{n.preventDefault(),s&&t(ji(s,e))}),[s,e,t]);return i.createElement(Ls,{onClick:a},o," [",l,"]")},fl=({circuitId:e,circuitNodeIdPath:t})=>{const n=t.map(((e,n)=>{const r=t.slice(0,n+1);return i.createElement(i.Fragment,{key:e},i.createElement("span",null,">"),i.createElement(yl,{circuitNodeIdPath:r}))}));return i.createElement("div",{className:P("circuit-node-breadcrumb","circuit-node-breadcrumb--3Rx3N")},i.createElement(ml,{circuitId:e,circuitNodeIdPath:t}),n)},gl=Object.freeze({p1:{x:-100,y:-100},p2:{x:100,y:100}}),Il=(0,Qt.P1)(ho,tr,((e,t)=>[...Ri()(e),...Ri()(t).map((e=>({p1:e,p2:e})))].reduce(h.G0,gl))),hl=({x:e,y:t,open:n,onRequestClose:r,children:o})=>{const c=i.useMemo((()=>({getBoundingClientRect:()=>({left:e,top:t,right:e,bottom:t,width:0,height:0,x:e,y:t})})),[e,t]);return i.createElement(Ms,{value:r},i.createElement(ws,{isOpen:n,onRequestClose:r,anchorEl:c,placement:"bottom-start"},o))};function bl(){const[e,t]=i.useState(null),n=i.useCallback((e=>{t({x:e.pageX,y:e.pageY})}),[]),r=i.useCallback((()=>{t(null)}),[]);return{openContextMenu:n,renderContextMenu:i.useCallback((t=>e?i.createElement(hl,{open:!0,onRequestClose:r,x:e.x,y:e.y},t):null),[e,r])}}const vl=()=>{const e=(0,c.I0)(),t=i.useCallback((()=>{e({type:qe})}),[e]),n=i.useCallback((()=>{e(Ve())}),[e]);return i.createElement(i.Fragment,null,i.createElement(Zs,{onClick:t},"Align Selection To Grid"),i.createElement(Fs,null),i.createElement(Zs,{onClick:n},"Delete Selected"))},El=()=>i.createElement(Us,null,i.createElement(vl,null)),kl="@node/new",Ol=e=>({type:kl,payload:{nodeType:e}});function Nl(e){return e.type===kl}const xl=i.createContext({zoomFactor:1,zoom:()=>{}});function Cl(){return i.useContext(xl)}const jl=({children:e})=>{const[t,n]=i.useState(1),r=i.useCallback((e=>{n((t=>e>0?t*e*1.03:t/(1.03*-e)))}),[]),o=i.useMemo((()=>({zoomFactor:t,zoom:r})),[r,t]);return i.createElement(xl.Provider,{value:o},e)},wl={current:null},Pl=i.createContext({svgRef:wl,scalerRef:wl}),Bl=Pl.Provider,Ml=({svgRef:e,scalerRef:t,children:n})=>{const r=i.useMemo((()=>({svgRef:e,scalerRef:t})),[e,t]);return i.createElement(Bl,{value:r},n)},Sl=i.createContext({editorId:"~none",circuitId:p,circuitNodeIdPath:[]});function Ll(){return i.useContext(Sl)}const Tl=({editorId:e,children:t})=>{const{circuitId:n,circuitNodeIdPath:r}=bs((t=>wt(t,e))),o=i.useMemo((()=>({editorId:e,circuitId:n,circuitNodeIdPath:r})),[n,r,e]);return i.createElement(Sl.Provider,{value:o},t)};function Dl(e,t,n){const i=t.getScreenCTM();if(!i)return n;const r=e.createSVGPoint();r.x=n.x,r.y=n.y;const o=r.matrixTransform(i.inverse());return{x:o.x,y:o.y}}function zl(){const{svgRef:e,scalerRef:t}=i.useContext(Pl);return i.useCallback((n=>e.current&&t.current?Dl(e.current,t.current,n):n),[e,t])}const Jl="text-unselectable--2tvXe",Rl=(e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=Jo(e),i=e.services.simulator.nodeOutputValuesByNodeId,r=Bo(n,t);if(r)return i[r]},Wl="node-interaction-toggle--1eXWD",Al={"integrated-circuit":({circuitNodeId:e,circuitNodePath:t,circuitId:n,inputPinIds:r,outputPinIds:o})=>{const s=(0,c.I0)(),l=bs((e=>Tn(e,n))),a=bs(un),d=Mn(r.length,o.length),u=i.useCallback((i=>{e&&(i.defaultPrevented||(i.preventDefault(),s(ji(n,[...t||[],e]))))}),[e,s,n,t]),p=r.map(((e,t)=>{const n=50*t+25;return i.createElement("g",{key:e},i.createElement("line",{className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:4,y1:n,x2:10,y2:n}),i.createElement("text",{className:Jl,x:15,y:n,alignmentBaseline:"middle",fontSize:".7em"},a[e]))})),m=o.map(((e,t)=>{const n=50*t+25;return i.createElement("g",{key:e},i.createElement("line",{key:t,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:90,y1:n,x2:100,y2:n}),i.createElement("text",{className:Jl,x:85,y:n,textAnchor:"end",alignmentBaseline:"middle",fontSize:".7em"},a[e]))}));return i.createElement("g",null,i.createElement("text",{className:P(Jl,"node-select-highlight--fill"),textAnchor:"middle",x:50,y:0},l),i.createElement("path",{className:"node-select-highlight--stroke node-select-highlight--fill",stroke:"black",fill:"transparent",d,onDoubleClick:u}),p,m)},"interaction-momentary":({circuitNodeId:e,circuitNodePath:t})=>{const n=(0,c.I0)(),r=bs(gc),o=i.useMemo((()=>[...t||[],null!=e?e:"~~none"]),[t,e]),s=bs((e=>Rl(e,o))),l=i.useCallback((e=>{r&&(e.defaultPrevented||(e.preventDefault(),n((0,Po.zN)(o,!0))))}),[o,n,r]),a=i.useCallback((()=>{r&&n((0,Po.zN)(o,!1))}),[o,n,r]);let d="darkgreen",u="lightgrey";return s&&s.OUT&&(d="lightgreen",u="black"),i.createElement("g",{onMouseDown:l,onMouseUp:a,onMouseLeave:a,className:Wl},i.createElement("rect",{className:"node-select-highlight--stroke node-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),i.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),i.createElement("circle",{cx:25,cy:25,r:17,fill:d}),i.createElement("text",{className:Jl,x:25,y:25,fontSize:".8em",fill:u,textAnchor:"middle",alignmentBaseline:"middle"},"Push"))},"interaction-toggle":({circuitNodeId:e,circuitNodePath:t,elementState:n})=>{const r=(0,c.I0)(),o=i.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),r((0,Po.zN)([...t||[],e]))))}),[e,r,t]);let s="darkgreen",l="lightgrey",a="darkred";if(n){const{toggleState:e}=n;e?(s="lightgreen",l="black"):a="red"}return i.createElement("g",{onClick:o,className:Wl},i.createElement("rect",{className:"node-select-highlight--stroke node-select-highlight--fill",x:5,y:5,width:40,height:40,stroke:"black",fill:"#AFAFAF",strokeWidth:1}),i.createElement("line",{x1:45,y1:25,x2:50,y2:25,stroke:"black",strokeWidth:2}),i.createElement("rect",{x:10,y:10,width:30,height:15,strokeWidth:0,fill:s}),i.createElement("text",{className:Jl,x:25,y:19,fontSize:".8em",fill:l,textAnchor:"middle",alignmentBaseline:"middle"},"On"),i.createElement("rect",{x:10,y:25,width:30,height:15,strokeWidth:0,fill:a}),i.createElement("text",{className:Jl,x:25,y:34,fontSize:".8em",fill:"lightgrey",textAnchor:"middle",alignmentBaseline:"middle"},"Off"))}},Ul=({componentName:e})=>i.createElement("g",null,i.createElement("rect",{width:50,height:50,fill:"red"}),i.createElement("text",{x:25,y:25,alignmentBaseline:"middle"},e));function Zl(e,t,n,r){const{component:o,componentProps:c}=r,s=Object.assign({circuitNodeId:e,circuitNodePath:t,elementState:n},c);let l;return"string"==typeof o?(l=Al[o],l||(l=()=>i.createElement(Ul,{componentName:o}))):l=o,i.createElement(l,Object.assign({},s))}const Fl=Object.freeze({}),Kl=i.memo((function({className:e,circuitNodeId:t,x:n=0,y:r=0,nodeType:o}){const c=bs((e=>Zn(e,o)));let s;s=c?Zl(t,[],Fl,c.visual):i.createElement("rect",{x:n,y:r,width:50,height:50,fill:"red"});const l=0!=n||0!=r?`translate(${n}, ${r})`:void 0;return i.createElement("g",{className:P(e,"node-visual"),transform:l},s)})),Hl=i.memo((function(){const e=(0,c.I0)(),{circuitId:t}=Ll(),n=bs($n),r=zl(),[o,s]=i.useState(null),[l,a]=i.useState(null),d=bs((e=>zn(e,Bn(o),t))),[,u]=(0,de.L)({accept:kl,collect:e=>{e.isOver()||(a(null),s(null))},hover:(e,t)=>{if(!Nl(e))return a(null),void s(null);const n=t.getClientOffset();if(!n)return;const i=r({x:n.x,y:n.y});s(e.payload.nodeType),a(i)},drop:(i,o)=>{if(!Nl(i))return;if(d)return;const c=o.getClientOffset();if(!c)return;const s=r({x:c.x,y:c.y});e(Ue(i.payload.nodeType,t,(0,h.R9)(s,n)))}},[t,r,n,d]),p=l&&(0,h.R9)(l,n);return i.createElement("g",{id:"drag-new-node-layer"},!d&&p&&o&&i.createElement("g",{opacity:.5},i.createElement(Kl,{x:p.x,y:p.y,nodeType:o})),d&&i.createElement("g",null,i.createElement("rect",{width:"100%",height:"100%",opacity:.7,fill:"black"}),i.createElement("text",{x:"100",y:"25%",fill:"white"},"The current circuit is already inside the dragged IC.")),i.createElement("rect",{ref:u,width:"100%",height:"100%",fill:"transparent"}))})),ql=Zt((e=>e.dragMode)),Gl=Zt(((e,t)=>null!=e.dragMode&&e.dragStartEditorId===e.dragEndEditorId&&e.dragStartEditorId===t)),Vl=Zt((e=>null!=e.dragMode)),$l=Zt((e=>e.dragMode?e.dragStart:null)),_l=Zt((e=>e.dragMode?e.dragEnd:null)),Yl=Zt((0,Qt.P1)(ql.local,$l.local,_l.local,((e,t,n)=>"select"===e&&t&&n?(0,h.Qu)(t,n):null)));let Xl=null;const Ql=e=>{const t=e.services.circuitEditorDrag;if("move"!==t.dragMode)return null;let n;n=ri(e).length>0?$n(e):_n(e);const{dragStart:i,dragEnd:r,dragModifierKeys:o}=t;if(!r)return null;const c=(0,h.sj)(r,i);return o.ctrlMetaKey||(c.x=Math.round(c.x/n)*n,c.y=Math.round(c.y/n)*n),Xl&&(0,h.kg)(c,Xl)||(Xl=c),Xl},ea=Zt((e=>{const t=_n.local(e);if("new-joint"!==e.dragMode)return null;const{dragEnd:n,dragModifierKeys:i}=e;if(!n||!i)return null;const r=Object.assign({},n);return i.ctrlMetaKey||(r.x=Math.round(r.x/t)*t,r.y=Math.round(r.y/t)*t),r})),ta=e=>{const t=e.services.circuitEditorDrag;if("wire"!==t.dragMode)return null;const{dragEnd:n,dragStartEditorId:i}=t;if(!n)return null;const r=Pt(e,i);return r?Vn(e,n,r):null},na=(0,Qt.P1)(ri,jn,((e,t)=>Et()(t,e))),ia=(0,Qt.P1)(ri,sn,((e,t)=>Et()(t,e))),ra=i.memo((function(){const{editorId:e}=Ll(),t=bs((t=>Gl(t,e))),n=bs(na),r=bs(ia),o=bs(Ql);if(!t||!o)return null;let c=null;return o&&(c=Ri()(tn()(n,((e,t)=>i.createElement(Kl,{key:t,nodeType:r[t],x:e.x+o.x,y:e.y+o.y}))))),i.createElement("g",{id:"drag-node-preview-layer",opacity:.3},c)}));const oa=e=>{var{x:t,y:n,interactable:r=!0,selected:o=!1}=e,c=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["x","y","interactable","selected"]);const[s,l]=i.useState(!1),a=i.useCallback((()=>{r&&l(!0)}),[r]),d=i.useCallback((()=>{l(!1)}),[]);return i.createElement("circle",Object.assign({className:P("wire-joint--3o_SE",o&&"selected--33Nsw"),cx:t,cy:n,r:r&&s||o?4:2,onMouseOver:a,onMouseOut:d},c))},ca=(0,Qt.P1)(si,tr,((e,t)=>Et()(t,e))),sa=i.memo((function(){const{editorId:e}=Ll(),t=bs((t=>Gl(t,e))),n=bs(Ql),r=bs(ca),o=bs(ea);if(!t||!n&&!o)return null;let c=null;n&&(c=Ri()(r).map(((e,t)=>i.createElement(oa,{key:t,interactable:!1,x:e.x+n.x,y:e.y+n.y,opacity:.5}))));let s=null;return o&&(s=i.createElement(oa,{interactable:!1,x:o.x,y:o.y,opacity:.5})),i.createElement("g",{id:"drag-joint-preview-layer",opacity:.3},c,s)}));function la({dragThreshold:e=5,onClick:t,onDragStart:n}){const[r,o]=i.useState(!1),c=i.useRef(null),s=i.useCallback((e=>{e.preventDefault&&(o(!0),c.current={x:e.pageX,y:e.pageY})}),[]),l=i.useCallback((t=>{if(!c.current)return;const i=c.current;(Math.abs(i.x-t.pageX)>=e||Math.abs(i.y-t.pageY)>=e)&&(n&&n(t,c.current),o(!1),c.current=null)}),[e,n]),a=i.useCallback((e=>{c.current&&(t&&t(e),o(!1),c.current=null)}),[t]);return i.useEffect((()=>{if(r)return document.addEventListener("mousemove",l),document.addEventListener("mouseup",a),()=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",a)}}),[r,l,a]),{startTracking:s}}function aa(e){const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:r}=e;return{ctrlMetaKey:qs?r:t,altKey:n,shiftKey:i}}Object.freeze({});const da=i.memo((function(){const e=(0,c.I0)(),{editorId:t}=Ll(),{zoomFactor:n}=Cl(),r=bs((e=>Gl(e,t))),o=bs(Yl);function s(e){return e*(1/n)}const l=zl(),a=i.useCallback((t=>{if(0!==t.button)return;const n=aa(t);n.ctrlMetaKey||n.shiftKey||e({type:po})}),[e]),d=i.useCallback(((n,i)=>{const r=l(i),o=aa(n);e(((e,t,n)=>({type:Ii,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(r,o,t))}),[e,t,l]),{startTracking:u}=la({onClick:a,onDragStart:d});return i.createElement("g",null,i.createElement("rect",{width:100*s(1)+"%",height:100*s(1)+"%",fill:"transparent",onMouseDown:u}),r&&o&&i.createElement("g",{transform:`translate(${o.p1.x}, ${o.p1.y})`},i.createElement("rect",{width:o.p2.x-o.p1.x,height:o.p2.y-o.p1.y,strokeWidth:s(2),strokeDasharray:`${s(5)} ${s(3)}`,stroke:"skyblue",fill:"transparent"})))})),ua=i.memo((function(){const[e]=i.useState("grid-"+(0,Te.Z)()),{zoomFactor:t}=Cl(),n=50*t;return i.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},i.createElement("defs",null,i.createElement("pattern",{id:e,width:n,height:n,patternUnits:"userSpaceOnUse"},i.createElement("path",{d:`M ${n} 0 L 0 0 0 ${n}`,fill:"none",stroke:"gray",strokeWidth:.5}))),i.createElement("rect",{width:"100%",height:"100%",fill:`url(#${e})`}))})),pa=i.forwardRef((({className:e,autoFocus:t,defaultValue:n,value:r,onChange:o,onBeginEdit:c,onCommit:s,onCancel:l,onBlur:a,onKeyUp:d},u)=>{const[p,m]=i.useState(null),y=i.useCallback((e=>{null==p&&c&&c(),m(e.target.value),o&&o(e)}),[p,c,o]),f=i.useCallback((e=>{d&&d(e),e.defaultPrevented||null!=p&&("Escape"===e.key?(e.preventDefault(),l&&l()):"Enter"===e.key&&(e.preventDefault(),s&&s(p)))}),[d,p,l,s]),g=i.useCallback((e=>{a&&a(e),null!=p&&s&&s(p)}),[a,p,s]);return i.createElement("input",{ref:u,className:e,autoFocus:t,defaultValue:n,value:r,type:"text",onChange:y,onKeyUp:f,onBlur:g})})),ma=({className:e,textClassname:t,inputClassname:n,label:r,defaultValue:o,isEditing:c,onRequestEdit:s,onCommit:l,onCancel:a})=>{const d=i.useRef(null),u=i.useCallback((e=>{s&&(e.defaultPrevented||(e.preventDefault(),s()))}),[s]),p=i.useCallback((e=>{"Escape"===e.key&&c&&a()}),[c,a]),m=i.useCallback((()=>{c&&a()}),[c,a]);return i.useEffect((()=>{c&&d.current&&d.current.select()}),[c]),c?i.createElement(pa,{ref:d,className:P(e,n),autoFocus:!0,defaultValue:o,onBlur:m,onKeyUp:p,onCommit:l,onCancel:a}):i.createElement("span",{className:P(e,t),onDoubleClick:u},null!=r?r:o)},ya=e=>{const{onRequestEdit:t,onCommit:n}=e,r=Bs(),o=i.useCallback((()=>{t&&t()}),[t]),c=i.useCallback((e=>{n(e),r()}),[n,r]);return i.createElement("li",{className:zs,onClick:o},i.createElement(ma,Object.assign({},e,{onCommit:c})))},fa=({nodeId:e})=>{const t=(0,c.I0)(),{circuitNodeIdPath:n}=Ll(),r=bs((t=>pn(t,e))),o=bs((t=>dn(t,e))),s=o?Bn(o):null,[l,a]=i.useState(!1),d=i.useCallback((()=>{a(!0)}),[]),u=i.useCallback((()=>{a(!1)}),[]),p=i.useCallback((n=>{a(!1),t(((e,t)=>({type:He,payload:{nodeId:e,nodeName:t}}))(e,n))}),[t,e]),m=i.useCallback((()=>{s&&t(ji(s,[...n,e],{newWindow:!0}))}),[n,t,s,e]);return i.createElement(Us,null,i.createElement(ya,{defaultValue:null!=r?r:"<unknown>",label:i.createElement("span",{style:{fontWeight:"bold"}},r),isEditing:l,onRequestEdit:d,onCommit:p,onCancel:u}),i.createElement(Fs,null),s&&i.createElement(i.Fragment,null,i.createElement(Zs,{onClick:m},"Open in New Window"),i.createElement(Fs,null)),i.createElement(vl,null))},ga=i.memo((function({nodeId:e}){const t=(0,c.I0)(),{editorId:n,circuitNodeIdPath:r}=Ll(),o=bs(gc),{openContextMenu:s,renderContextMenu:l}=bl(),a=bs((t=>$i(t,e))),{x:d,y:u}=bs((t=>wn(t,e))),p=bs((t=>((e,t)=>{const{simulatorNodeIdsByCircuitNodeId:n}=Jo(e),i=e.services.simulator.nodeStatesByNodeId,r=Bo(n,t);if(r)return i[r]})(t,[...r,e]))),m=bs((t=>oi(t,e))),y=zl(),f=i.useCallback((n=>{if(o)return;if(n.defaultPrevented)return;if(0!==n.button)return;n.preventDefault();const i=_t(aa(n));t(gi(e,i))}),[t,o,e]),g=i.useCallback((n=>{if(n.defaultPrevented)return;n.preventDefault();const i=_t(aa(n),"set-if-unselected");t(gi(e,i)),s(n)}),[t,e,s]),I=i.useCallback(((i,r)=>{const o=y(r),c=aa(i);t(((e,t,n,i)=>({type:yi,payload:Object.assign(Object.assign({},t),{nodeId:e,modifierKeys:n,editorId:i})}))(e,o,c,n))}),[y,t,e,n]),{startTracking:b}=la({onClick:f,onDragStart:I}),v=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),o||0===e.button&&b(e))}),[o,b]);let E,k;if(a){const{hitRect:t}=a.visual;E=Zl(e,r,p,a.visual),k=t}else E=i.createElement("rect",{x:d,y:u,width:50,height:50,fill:m?"goldenrod":"red"}),k={p1:h.Ds,p2:{x:50,y:50}};const O=0!=d||0!=u?`translate(${d}, ${u})`:void 0;return i.createElement("g",{transform:O},i.createElement("g",{className:P("circuit-field-node",m&&"node-selected"),onMouseDown:v,onContextMenu:g},E),i.createElement(Ia,{nodeId:e,hitRect:k}),l(i.createElement(fa,{nodeId:e})))})),Ia=i.memo((function({nodeId:e,hitRect:t}){const{zoomFactor:n}=Cl(),r=bs((t=>((e,t)=>{switch(e.services.uiSettings.nodeNameMode){case"all":default:return pn(e,t);case"named-only":return mn(e,t);case"none":return null}})(t,e))),o=Math.max(.7,n);let c=15;return o>1?c-=2*o:c+=1/o*7,r?i.createElement("text",{fontSize:1.2/o+"em",className:Jl,textAnchor:"middle",x:t.p1.x+(t.p2.x-t.p1.x)/2,y:t.p2.y+c},r):null})),ha=ga,ba=i.memo((function(){const{circuitId:e}=Ll(),t=bs((t=>On(t,e))).map((e=>i.createElement(ha,{key:e,nodeId:e})));return i.createElement("g",null,t)})),va=(e,t,n)=>{const i=Fi(e,n);if(!i)return!1;const{outputPin:{nodeId:r,pinId:o}}=i,c=dn(e,r);if("pin-input"===c){const n=t.slice(0,t.length-1),i={nodeId:t[t.length-1],pinId:r},o=Hi(e,i);return!!o&&va(e,n,o)}if(null==c?void 0:c.startsWith("ic-")){const n=[...t,r],i=Hi(e,{nodeId:o,pinId:"IN"});return!!i&&va(e,n,i)}{const n=Rl(e,[...t,r]);return n&&n[o]||!1}},Ea=i.memo((function({connectionId:e,startJointId:t,endJointId:n}){const{editorId:r}=Ll(),o=(0,c.I0)(),s=zl(),l=bs(gc),a=bs(Vl),d=bs((n=>null==t?((e,t)=>{const{outputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],r=$i(e,n);if(!r)return h.Ds;const o=wn(e,n),c=_i[t];if(c&&c.inputNodeDef===r&&c.inputNodePosition.x===o.x&&c.inputNodePosition.y===o.y)return c.outputPosition;let s=h.Ds;r&&r.pins[i]&&(s=r.pins[i]);const l=(0,h.ZO)(o,s);return _i[t]={inputNodeDef:r,inputNodePosition:o,outputPosition:l},l})(n,e):er(n,t))),u=bs((t=>null==n?((e,t)=>{const{inputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],r=$i(e,n);if(!r)return h.Ds;const o=wn(e,n),c=Yi[t];if(c&&c.inputNodeDef===r&&c.inputNodePosition.x===o.x&&c.inputNodePosition.y===o.y)return c.outputPosition;let s=h.Ds;r&&r.pins[i]&&(s=r.pins[i]);const l=(0,h.ZO)(o,s);return Yi[t]={inputNodeDef:r,inputNodePosition:o,outputPosition:l},l})(t,e):er(t,n))),[p,m]=i.useState(null),y=i.useCallback((e=>{const t=s({x:e.pageX,y:e.pageY});m(t)}),[s]),f=i.useCallback((()=>{m(null)}),[]),g=i.useCallback(((n,i)=>{const c=s(i),l=aa(n);o(((e,t,n,i,r)=>({type:pi,payload:Object.assign(Object.assign({},n),{connectionId:e,addAfterJointId:t,modifierKeys:i,editorId:r})}))(e,t,c,l,r))}),[s,o,e,t,r]),I=i.useCallback((t=>{const n=_t(aa(t));o(((e,t="set")=>({type:vo,payload:{connectionIds:Array.isArray(e)?e:[e],mode:t}}))(e,n))}),[e,o]),{startTracking:b}=la({onClick:I,onDragStart:g}),v=i.useCallback((e=>{e.preventDefault(),l||b(e)}),[l,b]);let E;if(!a&&!l&&p){const e=(0,h.Fv)((0,h.sj)(u,d)),t=(0,h.sj)(p,d),n=(0,h.Ih)(t,e);E=(0,h.ZO)(d,(0,h.bA)(e,n))}return i.createElement("g",{onMouseMove:y,onMouseLeave:f},i.createElement("line",{x1:d.x,y1:d.y,x2:u.x,y2:u.y,strokeWidth:2}),null==n&&i.createElement("circle",{cx:u.x,cy:u.y,r:1.5}),E&&i.createElement("circle",{cx:E.x,cy:E.y,r:3,stroke:"none",fill:"red",onMouseDown:v}))})),ka=i.memo((function({jointId:e}){const{editorId:t}=Ll(),n=zl(),r=(0,c.I0)(),o=bs(gc),s=bs((t=>li(t,e))),l=bs((t=>er(t,e))),a=i.useCallback(((i,o)=>{const c=n(o),s=aa(i);r(((e,t,n,i)=>({type:Qn,payload:Object.assign(Object.assign({},t),{jointId:e,modifierKeys:n,editorId:i})}))(e,c,s,t))}),[r,t,n,e]),d=i.useCallback((t=>{const n=_t(aa(t));r(ti(e,n))}),[r,e]),{startTracking:u}=la({onClick:d,onDragStart:a}),p=i.useCallback((e=>{o||e.defaultPrevented||(e.preventDefault(),u(e))}),[o,u]);return i.createElement(oa,{interactable:!o,selected:s,x:l.x,y:l.y,onMouseDown:p})})),Oa=i.memo((function({connectionId:e}){const{circuitNodeIdPath:t}=Ll(),n=bs((t=>Qi(t,e))),r=bs((n=>va(n,t,e))),o=bs((t=>ci(t,e))),c=[...n,null].map(((t,r)=>{const o=r>0?n[r-1]:null;return i.createElement(Ea,{key:r,connectionId:e,startJointId:o,endJointId:t})})),s=n.map((e=>i.createElement(ka,{key:e,jointId:e})));return i.createElement("g",{className:P("wire--2lJT9",r&&"powered--3tsJ_",o&&"selected--Dkrv_")},c,s)})),Na=i.memo((function(){const{circuitId:e}=Ll(),t=bs((t=>di(t,e))).map((e=>i.createElement(Oa,{key:e,connectionId:e})));return i.createElement("g",null,t)}));var xa=n(784);const Ca="highlight--30Hqg",ja="is-drag-target--1kAL8",wa=i.memo((function({nodeId:e,pinId:t}){const{editorId:n}=Ll(),r=zl(),[o,s]=i.useState(!1),l=(0,c.I0)(),a=bs((n=>((e,t,n)=>{var i;const r=qn(e)[t];return r&&null!==(i=r[n])&&void 0!==i?i:h.Ds})(n,e,t))),d=bs((n=>((e,t,n)=>{const i=$i(e,t);if(!i)return null;const r=i.pins[n];return r?r.direction:null})(n,e,t))),u=bs(ta),p=i.useCallback(((i,o)=>{const c=r(o);l(((e,t,n)=>({type:bi,payload:Object.assign(Object.assign({},e),{pin:t,editorId:n})}))(c,{nodeId:e,pinId:t},n))}),[l,n,r,e,t]),{startTracking:m}=la({onDragStart:p}),y=i.useCallback((e=>{0===e.button&&(e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),m(e)))}),[m]),f=i.useCallback((()=>{s(!0)}),[]),g=i.useCallback((()=>{s(!1)}),[]);if(!a)return null;const I=null!=u&&u.nodeId===e&&u.pinId===t,{x:b,y:v}=a;let E;return E="input"===d?i.createElement("path",{d:(0,xa.x)(b,v,4,-45,225),strokeWidth:2,className:P("node-pin-input--3iuKH",I&&ja,o&&Ca)}):i.createElement("circle",{className:P("node-pin-output--WumfM",I&&ja,o&&Ca),cx:b,cy:v,r:3}),i.createElement("g",{onMouseEnter:f,onMouseLeave:g},E,i.createElement("circle",{stroke:"none",fill:"transparent",cx:b,cy:v,r:5,onMouseDown:y}))})),Pa=i.memo((function({nodeId:e}){var t;const n=bs((t=>$i(t,e))),r=null!==(t=null==n?void 0:n.pins)&&void 0!==t?t:{},o=Object.keys(r).map((t=>i.createElement(wa,{key:t,nodeId:e,pinId:t})));return i.createElement(i.Fragment,null,o)})),Ba=i.memo((function(){const{circuitId:e}=Ll(),t=bs((t=>On(t,e))).map((e=>i.createElement(Pa,{key:e,nodeId:e})));return i.createElement("g",null,t)})),Ma=i.memo((function(){const{editorId:e}=Ll(),t=bs((t=>Gl(t,e))),n=bs(ql),r=bs($l),o=bs(_l);return t&&"wire"==n&&r&&o?i.createElement("line",{x1:r.x,y1:r.y,x2:o.x,y2:o.y,stroke:"black",strokeWidth:1}):null})),Sa=()=>{const e=(0,c.I0)(),{editorId:t}=Ll(),n=bs(Vl),r=function(){const{svgRef:e,scalerRef:t}=i.useContext(Pl);return i.useCallback((n=>{if(!e.current||!t.current)return h.Ds;const i={x:n.pageX,y:n.pageY};return Dl(e.current,t.current,i)}),[e,t])}(),o=i.useCallback((n=>{if(0===n.buttons)return void e(At());const i=r(n),o=aa(n);e(((e,t,n)=>({type:Kt,payload:{dragPos:e,modifierKeys:t,editorId:n}}))(i,o,t))}),[e,t,r]),s=i.useCallback((n=>{const i=r(n),o=aa(n);e(((e,t,n)=>({type:ct,payload:Object.assign(Object.assign({},e),{modifierKeys:t,editorId:n})}))(i,o,t))}),[e,t,r]);return n?i.createElement("rect",{width:"100%",height:"100%",fill:"transparent",onMouseMove:o,onMouseUp:s}):null},La=({width:e,height:t,onContextMenu:n})=>{const r=(0,c.I0)(),{zoomFactor:o}=Cl(),s=i.useRef(null),l=i.useRef(null),a=i.useCallback((()=>{var e;null===(e=s.current)||void 0===e||e.focus()}),[]),d=i.useCallback((()=>{r({type:Ei})}),[r]),u=i.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),n(e))}),[n]),[{isDraggingNewNode:p},m]=(0,de.L)({accept:kl,collect:e=>({isDraggingNewNode:e.isOver()})});return i.createElement("svg",{tabIndex:-1,ref:e=>{s.current=e,m(e)},width:e,height:t,onMouseDown:a,onMouseLeave:d,onContextMenu:u,className:"circuit-field-svg--o7YIn"},i.createElement(ua,null),i.createElement("g",{ref:l,"transform-origin":"0 0",transform:`scale(${o})`},i.createElement(Ml,{svgRef:s,scalerRef:l},i.createElement(da,null),i.createElement(ba,null),i.createElement(Na,null),i.createElement(Ba,null),i.createElement(Ma,null),i.createElement(ra,null),i.createElement(sa,null),p&&i.createElement(Hl,null),i.createElement(Sa,null))))},Ta=({onContextMenu:e})=>{const t=i.useRef(null),{width:n,height:r}=ae(t),{zoomFactor:o,zoom:c}=Cl(),s=bs(Il),{width:l,height:a}=(0,h.nF)(s),d=Math.max(n,l*o),u=Math.max(r,a*o);return vs(t,"wheel",i.useCallback((e=>{e.defaultPrevented||e.ctrlKey&&(c(e.deltaY>0?-1:1),e.preventDefault(),e.stopPropagation())}),[c]),{passive:!1}),i.createElement("div",{ref:t,style:{width:"100%",height:"100%"}},i.createElement(La,{width:d,height:u,onContextMenu:e}))},Da=({className:e,editorId:t})=>{const n=bs(gc),{openContextMenu:r,renderContextMenu:o}=bl();return i.createElement(Tl,{editorId:t},i.createElement("div",{id:"circuit-editor-"+t,className:P("circuit-editor","circuit-editor--2jFUa",n&&"simulator-active",e)},i.createElement("div",{className:"circuit-editor-scrollarea--12k0x"},i.createElement(jl,null,i.createElement(Ta,{onContextMenu:r}))),o(i.createElement(El,null))))};var za=n(1474);const Ja=e=>i.createElement("svg",Object.assign({width:16,height:16},e,{className:P(rl,e.className)}),i.createElement("path",{d:"M4,4 L12,12 M4,12 L12,4"})),Ra=({title:e,className:t,children:n})=>{const r=Y(),{closeWindow:o}=te(),c=i.useCallback((()=>{o(r)}),[o,r]),[,s]=(0,za.c)({item:pe(r)});return i.createElement(ye,{className:G["tessel-window"]},i.createElement("div",{ref:s,className:G["tessel-window-titlebar"]},i.createElement("div",{className:G["tessel-window-title"]},e),i.createElement("div",{className:G["tessel-window-controls"]},i.createElement(Ja,{className:G["tessel-window-controls-close"],onClick:c}))),i.createElement("div",{className:P(G["tessel-window-content"],t)},n))},Wa="keymap:CircuitEditor/SimStep",Aa="keymap:CircuitEditor/SimFastForward",Ua="keymap:CircuitEditor/SelectAll",Za="keymap:CircuitEditor/Copy",Fa="keymap:CircuitEditor/Paste",Ka="keymap:CircuitEditor/Delete",Ha="keymap:CircuitEditor/Undo",qa="keymap:CircuitEditor/Redo",Ga={[Wa]:"space",[Aa]:"shift+space",[Ua]:Gs+"+a",[Za]:Gs+"+c",[Fa]:Gs+"+v",[Ka]:["backspace","del"],[Ha]:Gs+"+z",[qa]:[Gs+"+y",Gs+"+shift+z"]};const Va=e=>{var{children:t}=e,n=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["children"]);return i.createElement("div",Object.assign({},n,{className:T}),t)},$a=({value:e,label:t,isSelected:n,onItemSelected:r})=>{const o=i.useCallback((t=>{t.defaultPrevented||(t.preventDefault(),r(e))}),[r,e]);return i.createElement("li",{className:P("selection-list-item","selection-list-item--errDr",n&&"selection-list-item--selected--3MkqB"),onClick:o},i.createElement("div",{className:P("selection-list-item-content--321YU",Jl)},t))},_a=({className:e,items:t,onItemSelected:n})=>i.createElement("ul",{className:P("selection-list","selection-list--3yujH",e)},t.map((e=>i.createElement($a,Object.assign({key:e.value},e,{onItemSelected:n}))))),Ya=({circuitId:e})=>{const t=(0,c.I0)(),n=bs((t=>Tn(t,e))),[r,o]=i.useState(!1),{openContextMenu:s,renderContextMenu:l}=bl(),a=i.useCallback((()=>{e!==p&&o(!0)}),[e]),d=i.useCallback((()=>{o(!1)}),[]),u=i.useCallback((n=>{t(((e,t)=>({type:We,payload:{circuitId:e,circuitName:t}}))(e,n)),o(!1)}),[e,t]),m=i.useCallback((n=>{n.preventDefault(),t(ji(e,null,{newWindow:!0}))}),[e,t]),y=i.useCallback((n=>{n.preventDefault(),t((e=>({type:Je,payload:{circuitId:e}}))(e))}),[t,e]),f=i.useCallback((e=>{e.preventDefault(),e.stopPropagation(),s(e)}),[s]);return i.createElement("div",{style:{width:"100%"},onContextMenu:f,onDoubleClick:a},i.createElement(ma,{defaultValue:n,isEditing:r,onRequestEdit:a,onCommit:u,onCancel:d}),l(i.createElement(Us,null,e!==p&&i.createElement(i.Fragment,null,i.createElement(Zs,{onClick:a},"Rename Circuit"),i.createElement(Fs,null)),i.createElement(Zs,{onClick:m},"Open in New Window"),e!==p&&i.createElement(i.Fragment,null,i.createElement(Fs,null),i.createElement(Zs,{onClick:y},"Delete Circuit")))))},Xa=()=>{const e=(0,c.I0)(),t=i.useCallback((()=>{e(ze())}),[e]);return i.createElement(Us,null,i.createElement(Zs,{onClick:t},"New Circuit"))},Qa=({isOpen:e,anchorEl:t,placement:n="auto",children:o})=>{const[c,s]=i.useState(null),[l,a]=i.useState(null),{attributes:d,styles:u}=(0,Os.D)(e?t:null,c,{placement:n,modifiers:[{name:"arrow",options:{element:l}},{name:"offset",options:{offset:[0,8]}}]});return e?(0,r.createPortal)(i.createElement("div",Object.assign({ref:s,className:"tooltip--2yxRI",style:u.popper,role:"tooltip"},d.popper),o,i.createElement("div",Object.assign({ref:a,"data-popper-arrow":!0,className:"tooltip-arrow--2mJMo",style:u.arrow},d.arrow))),document.body):null},ed={"input-output":"I/O","integrated-circuit":"Integrated Circuits",logic:"Logic"},td=({category:e})=>{const t=bs(An).filter((t=>t.category===e)).filter((t=>t.category===e)).map((e=>i.createElement(nd,{key:e.type,nodeType:e.type})));return i.createElement(i.Fragment,null,i.createElement("li",{className:"node-tray-category--2EvV3"},ed[e]),t)},nd=({nodeType:e})=>{const[t,n]=i.useState(null),r=bs((t=>Zn(t,e))),[o,c]=i.useState(!1),s=i.useCallback((e=>{e.preventDefault(),c(!0)}),[]),l=i.useCallback((e=>{e.target===t&&c(!1)}),[t]),[,a]=(0,za.c)({item:Ol(e)});let d,u=e,p="0 0 50 50";if(r){const{trayComponent:e,hitRect:t}=r.visual;if(e){const t=e;d=i.createElement(t,null)}else d=Zl(void 0,[],void 0,r.visual),p=`${t.p1.x} ${t.p1.y} ${t.p2.x} ${t.p2.y}`;u=r.displayName}else d=i.createElement(id,null);return i.createElement("li",{ref:e=>{n(e),a(e)},className:"node-tray-item--16YJl",onClick:s,onMouseOut:l},i.createElement(Qa,{placement:"top",isOpen:o,anchorEl:t},"Click and drag to create a new circuit element."),i.createElement("span",{className:"node-tray-item-preview--1SRbp"},i.createElement("svg",{width:30,height:30,viewBox:p},d)),i.createElement("span",{className:Jl},u))},id=()=>i.createElement("rect",{fill:"red",x1:0,y1:0,x2:50,y2:50}),rd={"node-tray":()=>{const e=bs(An),t=Ai()(e.map((e=>e.category)));return i.createElement(Ra,{title:"Elements",className:"node-tray--3lZIP"},i.createElement("ul",{className:"node-tray-elements--1GkKn"},t.map((e=>i.createElement(td,{key:e,category:e})))))},"circuit-field":({editorId:e})=>{var t,n;const r=(0,c.I0)(),{circuitId:o,circuitNodeIdPath:s}=null!==(t=bs((t=>wt(t,e))))&&void 0!==t?t:{circuitId:null,circuitNodeIdPath:[]},l=null!==(n=bs((e=>Tn(e,o))))&&void 0!==n?n:"<Circuit Missing>",a=i.useMemo((()=>{function e(e){return t=>{if(t){if(t.defaultPrevented)return;t.preventDefault()}r(e)}}var t;return{[Wa]:e(ic()),[Aa]:e({type:_o}),[Ua]:e(ao(o)),[Za]:e({type:ko}),[Fa]:e((t=o,{type:ot,payload:{targetCircuitId:t}})),[Ka]:e(Ve()),[Ha]:e(lt()),[qa]:e(ut())}}),[r,o]),d=i.useCallback((()=>{r((e=>({type:Ni,payload:{editorId:e}}))(e))}),[r,e]);return i.createElement(Ra,{title:l+" [Circuit]"},i.createElement(pl.HotKeys,{keyMap:Ga,handlers:a,component:Va},i.createElement("div",{onFocus:d,className:P("circuit-field-view",T,D["flex-column"])},i.createElement(fl,{circuitId:o,circuitNodeIdPath:s}),i.createElement(Da,{className:P(T,D["flexitem-shrink"]),editorId:e}))))},"circuits-list":()=>{const e=(0,c.I0)(),t=bs(Ln),{openContextMenu:n,renderContextMenu:r}=bl(),o=i.useCallback((t=>{e(ji(t))}),[e]),s=i.useCallback((e=>{e.preventDefault(),n(e)}),[n]),l=i.useMemo((()=>Object.keys(t).map((e=>({value:e,label:i.createElement(Ya,{circuitId:e})})))),[t]);return i.createElement(Ra,{title:"Circuits",className:P("circuitstree--QeaI9")},i.createElement("div",{className:T,onContextMenu:s},i.createElement(_a,{className:T,items:l,onItemSelected:o})),r(i.createElement(Xa,null)))}};function od(e){const t=rd[e.windowId];return t?i.createElement(t,Object.assign({},e.windowProps)):null}const cd=()=>{const e=(0,c.I0)(),t=bs(Es),n=i.useCallback((t=>{e((e=>({type:Nc,payload:{layout:e}}))(t))}),[e]),r=i.useCallback((t=>{let n=t.target;for(;null!=n;){if(n.classList.contains("circuit-editor"))return;n=n.parentElement}e(At())}),[e]);return vs({current:document.body},"mouseup",r),i.createElement("div",{className:P(T,D["flex-column"])},i.createElement(ul,{className:D["flexitem-fix"]}),i.createElement("div",{className:P(T,D["flexitem-shrink"])},i.createElement(Ie,{className:P("project-editor",T),rootItem:t,onLayoutChange:n,renderWindow:od})))},sd=({location:e})=>{const t=(0,c.I0)(),[n,r]=i.useState(!1);return i.useEffect((()=>{let n;try{n=new URLSearchParams(e.search)}catch(e){return void r(!0)}const i=n.get("data");i?t((e=>({type:Yc,payload:{data:e}}))(i)):r(!0)}),[]),n?i.createElement("div",null,"Failed to import project"):i.createElement("div",null,"Importing Project...")},ld=()=>i.createElement(s.rs,null,i.createElement(s.AW,{exact:!0,path:"/",component:cd}),i.createElement(s.AW,{exact:!0,path:"/import",component:sd})),ad=kr((e=>e.dialogType)),dd=kr((e=>e.data));var ud=n(227),pd=n(1074);const md=({className:e,isOpen:t,onRequestClose:n,children:o})=>t?(0,r.createPortal)(i.createElement("div",{className:P("modal","modal--25LBN")},i.createElement(ud.Y,{onClickOutside:n,onEscapeKey:n},i.createElement("div",{className:P("modal-content--1H0T_",e)},i.createElement(pd.Z,{className:T},o)))),document.body):null,yd=({isOpen:e,acceptText:t,cancelText:n,onAccept:r,onCancel:o,footer:c,children:s})=>i.createElement(md,{className:"dialog--1eQi6",isOpen:e,onRequestClose:o},i.createElement("div",null,s),i.createElement("div",{className:"dialog-footer--2hYdr"},c,o&&i.createElement(Ls,{onClick:o},null!=n?n:"Cancel"),r&&i.createElement(Ls,{onClick:r},null!=t?t:"Accept"))),fd=()=>{const e=Ts(vr),t=bs(dd),n=null==t?void 0:t.projectLink,r=i.useCallback((()=>{n&&navigator.clipboard.writeText(n).catch((()=>{}))}),[n]);if(!n)return null;const o=i.createElement(Ls,{onClick:r},"Copy to Clipboard");return i.createElement(yd,{isOpen:!0,cancelText:"Close",onCancel:e,footer:o},i.createElement("div",{className:"export-link-dialog-link-container--3uQpv"},i.createElement("code",{className:"export-link-dialog-link--1o62F"},n)))},gd=({circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:r})=>{const o=i.useCallback((t=>{t.target.checked&&r(Ai()([...n,e]))}),[e,r,n]);return i.createElement(Xs,{onChange:o,value:-1!==n.indexOf(e)},t)},Id=()=>{const e=(0,c.I0)(),t=bs(dd),[n,r]=i.useState([]),o=Ts(xr),s=i.useCallback((()=>{e(vr(n))}),[e,n]);if(!t)return null;const{circuits:l}=t;return i.createElement(yd,{isOpen:!0,onAccept:s,onCancel:o,acceptText:"Import Circuits"},i.createElement("ul",{className:"import-project-circuits-list--1Ykhs"},l.map((({circuitId:e,circuitName:t})=>i.createElement("li",{key:e},i.createElement(gd,{circuitId:e,circuitName:t,selectedIds:n,onSetSelectedIds:r}))))))},hd=()=>{switch(bs(ad)){default:return null;case"export-project-link":return i.createElement(fd,null);case"import-project-circuits":return i.createElement(Id,null)}},bd=document.getElementById("root");r.render(i.createElement(l.W,{backend:a.PD},i.createElement(s.F0,{history:d},i.createElement(c.zt,{store:hs},i.createElement((()=>i.createElement(i.Fragment,null,i.createElement(ld,null),i.createElement(hd,null))),null)))),bd)},4313:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={type:"interaction-momentary",category:"input-output",displayName:"Momentary Switch",elementProduction:"input-momentary",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-momentary"},pins:{OUT:{direction:"output",x:50,y:25}}}},9175:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={type:"interaction-toggle",category:"input-output",displayName:"Toggle Switch",elementProduction:"input-toggle",visual:{hitRect:{p1:{x:5,y:5},p2:{x:45,y:45}},component:"interaction-toggle"},pins:{OUT:{direction:"output",x:50,y:25}}}},4646:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30z",l={type:"logic-and",category:"logic",displayName:"AND",elementProduction:"logic-and",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2140:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z",l={type:"logic-buffer",category:"logic",displayName:"Buffer",elementProduction:"logic-buffer",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M72,25 L 100,25"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 29.043478,25 L 5.0434781,25"}),i.createElement("path",{className:"node-select-highlight--fill",stroke:"none",fill:"black",d:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z M 31.96875,7.40625 L 68.09375,25 L 31.96875,42.59375 L 31.96875,7.40625 z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},6467:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-nand",category:"logic",displayName:"NAND",elementProduction:"logic-nand",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",{transform:"translate(-10,0)"},i.createElement("path",{d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z",stroke:"none",fill:"transparent"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 88,25 H110"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 41,15 L 15,15"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 42,35 L 15,35"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M 40,5 L 40,6.4285714 L 40,43.571429 L 40,45 L 41.428571,45 L 60.47619,45 C 71.744098,45 80.47619,35.999955 80.47619,25 C 80.47619,14.000045 71.744099,5.0000002 60.47619,5 C 60.47619,5 60.47619,5 41.428571,5 L 40,5 z M 42.857143,7.8571429 C 50.834264,7.8571429 55.918368,7.8571429 58.095238,7.8571429 C 59.285714,7.8571429 59.880952,7.8571429 60.178571,7.8571429 C 60.327381,7.8571429 60.409227,7.8571429 60.446429,7.8571429 C 60.465029,7.8571429 60.471543,7.8571429 60.47619,7.8571429 C 70.236853,7.857143 77.142857,15.497098 77.142857,25 C 77.142857,34.502902 69.760662,42.142857 60,42.142857 L 42.857143,42.142857 L 42.857143,7.8571429 z"}),i.createElement("path",{className:"node-select-highlight--stroke",strokeWidth:"2",stroke:"black",fill:"none",d:"M 79,25 A 4,4 0 1 1 71,25 A 4,4 0 1 1 79,25 z",transform:"translate(9,0)"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},8476:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-nor",category:"logic",displayName:"NOR",elementProduction:"logic-nor",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",null,i.createElement("path",{fill:"transparent",stroke:"none",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 h21 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},3980:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7294);const r={type:"logic-not",category:"logic",displayName:"NOT",elementProduction:"logic-not",visual:(0,n(5471).l)({p1:{x:24,y:5},p2:{x:80,y:45}},i.createElement("g",null,i.createElement("path",{fill:"transparent",stroke:"none",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79,25 H100 M29,25 h-24"}),i.createElement("path",{className:"node-select-highlight--fill",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))),pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},9696:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",l={type:"logic-or",category:"logic",displayName:"OR",elementProduction:"logic-or",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M31,15 H5 M32,35 H5"}),i.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2201:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375z",l={type:"logic-xor",category:"logic",displayName:"XOR",elementProduction:"logic-xor",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70,25 h30 M30,15 H5 M31,35 H5"}),i.createElement("g",{fillRule:"evenodd",className:"node-select-highlight--fill"},i.createElement("path",{d:"M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"}),i.createElement("path",{d:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"})))),pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},6015:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const i=`M ${25-20}, 25\n    a 20,20 0 1,0 40,0\n    a 20,20 0 1,0 -40,0`;const r={type:"output-led",category:"input-output",displayName:"Indicator Light",elementProduction:"output-led",visual:(0,n(957).J)(i,{path:i,stroke:"black",strokeWidth:3,fill:e=>e.value?"lightgreen":"darkgreen"}),pins:{IN:{direction:"input",x:0,y:25}}}},5058:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(957);const r=[15,0];function o(e,t){const n=t[0];let i=`M${3*n[0]+r[0]},${3*n[1]+r[1]}`;for(const e of t.slice(1)){const[t,n]=e;i+=`L${3*t+r[0]},${3*n+r[1]}`}return i+="z",{path:i,fill:t=>t[e]?"red":"gray",strokeWidth:0}}const c={type:"output-seg7",category:"input-output",displayName:"7-Segment Display",elementProduction:"output-seg7",visual:(0,i.J)("M15,0 V63 H45 V0 z",[o("A",[[1,1],[2,0],[8,0],[9,1],[8,2],[2,2]]),o("B",[[9,1],[10,2],[10,8],[9,9],[8,8],[8,2]]),o("C",[[9,9],[10,10],[10,16],[9,17],[8,16],[8,10]]),o("D",[[9,17],[8,18],[2,18],[1,17],[2,16],[8,16]]),o("E",[[1,17],[0,16],[0,10],[1,9],[2,10],[2,16]]),o("F",[[1,9],[0,8],[0,2],[1,1],[2,2],[2,8]]),o("G",[[1,9],[2,8],[8,8],[9,9],[8,10],[2,10]])]),pins:{A:{direction:"input",x:0,y:5},B:{direction:"input",x:0,y:15},C:{direction:"input",x:0,y:25},D:{direction:"input",x:0,y:35},E:{direction:"input",x:0,y:45},F:{direction:"input",x:0,y:55},G:{direction:"input",x:0,y:65}}}},3158:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-high",category:"input-output",elementProduction:"pin-high",displayName:"High Pin",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M25,20 v10 M20,25 h10",fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},7529:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(7294),r=n(669),o=n.n(r),c=n(8370),s=n(784);const l="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",a={type:"pin-input",category:"input-output",displayName:"Input Pin",visual:(0,n(5471).l)((0,c.NG)(o()(l)),i.createElement("g",null,i.createElement("path",{d:l,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:(0,s.x)(25,25,3,-45,225),fill:"none",stroke:"black",strokeWidth:2}))),pins:{OUT:{direction:"output",x:50,y:25}}}},4987:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(7294),r=n(669),o=n.n(r),c=n(8370);const s="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",l={type:"pin-output",category:"input-output",displayName:"Output Pin",visual:(0,n(5471).l)((0,c.NG)(o()(s)),i.createElement("g",null,i.createElement("path",{d:s,fill:"transparent",stroke:"none"}),i.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M15,25 h-15",stroke:"black",strokeWidth:2,fill:"none"}),i.createElement("circle",{className:"node-select-highlight--fill",cx:25,cy:25,r:3,fill:"black",stroke:"none"}))),pins:{IN:{direction:"input",x:0,y:25}}}},957:(e,t,n)=>{"use strict";n.d(t,{J:()=>u});var i=n(7294),r=n(9242),o=n(669),c=n.n(o),s=n(8370),l=n(1235);const a=({circuitNodeId:e,circuitNodePath:t,shapePath:n,hitPath:o,elementState:c})=>{const s=(0,r.I0)(),a=i.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),s((0,l.zN)([...t||[],e]))))}),[e,s,t]),d=p(n,c).map(((e,t)=>i.createElement("path",{key:t,d:e.path,className:"node-select-highlight--stroke node-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return i.createElement("g",{onClick:a},i.createElement("path",{d:o,fill:"transparent",stroke:"none"}),d)},d=({shapePath:e,hitRect:t})=>{const n=p(e,{}).map(((e,t)=>i.createElement("path",{key:t,d:e.path,className:"node-select-highlight--stroke node-select-highlight--fill",fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth})));return i.createElement("svg",{width:50,height:50,viewBox:`${t.p1.x-5} ${t.p1.y-5} ${t.p2.x-t.p1.x+10} ${t.p2.y-t.p1.y+10}`},n)};function u(e,t){const n=(0,s.NG)(c()(e));return{trayComponent:()=>i.createElement(d,{shapePath:t,hitRect:n}),component:n=>i.createElement(a,Object.assign({shapePath:t,hitPath:e},n)),hitRect:n}}function p(e,t){return(Array.isArray(e)?e:[e]).map((e=>{if("string"==typeof e)return{path:e,fill:"black",stroke:"black",strokeWidth:2};const n="function"==typeof e.fill?e.fill(t||{}):e.fill,i="function"==typeof e.stroke?e.stroke(t||{}):e.stroke,r="function"==typeof e.strokeWidth?e.strokeWidth(t||{}):e.strokeWidth;return{path:e.path,fill:n,stroke:i,strokeWidth:r}}))}},5471:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(7294);function r(e,t){return{hitRect:e,trayComponent:()=>i.createElement("svg",{width:50,height:50,viewBox:`${e.p1.x-5} ${e.p1.y-5} ${e.p2.x-e.p1.x+10} ${e.p2.y-e.p1.y+10}`},t),component:()=>t}}},784:(e,t,n)=>{"use strict";function i(e,t,n,i,o){const c=r(e,t,n,o),s=r(e,t,n,i),l=o-i<=180?"0":"1";return["M",c.x,c.y,"A",n,n,0,l,0,s.x,s.y].join(" ")}function r(e,t,n,i){const r=(i-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}}n.d(t,{x:()=>i})}},0,[[4884,1,956,874,90,14,80,744,845,105,699,412]]]);
//# sourceMappingURL=client.f25a19c3c4b1277b41f3.bundle.js.map
(self.webpackChunkdiscrelog=self.webpackChunkdiscrelog||[]).push([[47],{2334:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={"text-unselectable":"text-unselectable--2tvXe"}},7252:(e,t,n)=>{"use strict";n.d(t,{q6:()=>r,_Y:()=>i,U_:()=>s});var o=n(4586);const r="@circuit/add",i=({circuitName:e,circuitId:t,edit:n}={})=>({type:r,payload:{circuitId:null!=t?t:(0,o.Z)(),circuitName:e,edit:n}});function s(e){return e.type===r}},5984:(e,t,n)=>{"use strict";n.d(t,{JP:()=>o,Zj:()=>r,Q$:()=>i});const o="@circuit/delete",r=e=>({type:o,payload:{circuitId:e}});function i(e){return e.type===o}},1314:(e,t,n)=>{"use strict";n.d(t,{QM:()=>o,U3:()=>r,lp:()=>i});const o="@circuit/rename",r=(e,t)=>({type:o,payload:{circuitId:e,circuitName:t}});function i(e){return e.type===o}},7930:(e,t,n)=>{"use strict";n.d(t,{_A:()=>r,k5:()=>i});const o="@circuit/view",r=(e,t=null)=>({type:o,payload:{circuitId:e,circuitNodeIdPath:t}});function i(e){return e.type===o}},5621:(e,t,n)=>{"use strict";n.d(t,{Fb:()=>o,v:()=>r,Ff:()=>i});const o="@clipboard/paste",r=()=>({type:o});function i(e){return e.type===o}},5222:(e,t,n)=>{"use strict";n.d(t,{pR:()=>o,GA:()=>r,W2:()=>i});const o="@dialog/response/accept",r=e=>({type:o,payload:{result:e}});function i(e){return e.type===o}},8177:(e,t,n)=>{"use strict";n.d(t,{NQ:()=>o,ey:()=>r,Xm:()=>i});const o="@field/drag/continue",r=(e,t)=>({type:o,payload:{dragPos:e,modifierKeys:t}});function i(e){return e.type===o}},4:(e,t,n)=>{"use strict";n.d(t,{cN:()=>o,k4:()=>r,$V:()=>i});const o="@field/drag/end",r=(e,t)=>({type:o,payload:Object.assign(Object.assign({},e),{modifierKeys:t})});function i(e){return e.type===o}},713:(e,t,n)=>{"use strict";n.d(t,{R4:()=>r,Vl:()=>i});const o="@field/drag/start/joint",r=(e,t,n)=>({type:o,payload:Object.assign(Object.assign({},t),{jointId:e,modifierKeys:n})});function i(e){return e.type===o}},1883:(e,t,n)=>{"use strict";n.d(t,{gM:()=>r,xl:()=>i});const o="@field/drag/start/new-joint",r=(e,t,n,r)=>({type:o,payload:Object.assign(Object.assign({},n),{connectionId:e,addAfterJointId:t,modifierKeys:r})});function i(e){return e.type===o}},8554:(e,t,n)=>{"use strict";n.d(t,{Yf:()=>r,Q6:()=>i});const o="@field/drag/start/new-element",r=e=>({type:o,payload:{nodeType:e}});function i(e){return e.type===o}},8198:(e,t,n)=>{"use strict";n.d(t,{hZ:()=>r,KH:()=>i});const o="@field/drag/start/node",r=(e,t,n)=>({type:o,payload:Object.assign(Object.assign({},t),{nodeId:e,modifierKeys:n})});function i(e){return e.type===o}},853:(e,t,n)=>{"use strict";n.d(t,{wZ:()=>r,dx:()=>i});const o="@field/drag/start/select",r=e=>({type:o,payload:Object.assign({},e)});function i(e){return e.type===o}},4206:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,Zr:()=>i});const o="@field/drag/start/wire",r=(e,t)=>({type:o,payload:{dragStart:e,pin:t}});function i(e){return e.type===o}},1387:(e,t,n)=>{"use strict";n.d(t,{Cq:()=>o,xr:()=>r,hG:()=>i});const o="@field/mouse/leave",r=()=>({type:o});function i(e){return e.type===o}},5273:(e,t,n)=>{"use strict";n.d(t,{dd:()=>r,gz:()=>i,g0:()=>s});var o=n(4586);const r="@node/add",i=(e,t)=>({type:r,payload:Object.assign({nodeId:(0,o.Z)(),nodeType:e},t||{})});function s(e){return e.type===r}},1235:(e,t,n)=>{"use strict";n.d(t,{zN:()=>r,ke:()=>i});const o="@node/interact",r=e=>({type:o,payload:{circuitNodeIdPath:e}});function i(e){return e.type===o}},4443:(e,t,n)=>{"use strict";n.d(t,{XT:()=>o,w:()=>r,HH:()=>i});const o="@node/rename",r=(e,t)=>({type:o,payload:{nodeId:e,nodeName:t}});function i(e){return e.type===o}},4505:(e,t,n)=>{"use strict";n.d(t,{WG:()=>o,C9:()=>r});const o="@project/export-link",r=()=>({type:o})},7198:(e,t,n)=>{"use strict";n.d(t,{Yk:()=>o,vP:()=>r});const o="@project/import-link",r=e=>({type:o,payload:{data:e}})},6577:(e,t,n)=>{"use strict";n.d(t,{Wx:()=>o,Cb:()=>r});const o="@project/load",r=()=>({type:o})},38:(e,t,n)=>{"use strict";n.d(t,{Ny:()=>o,o9:()=>r,Tp:()=>i});const o="@project/new",r=()=>({type:o});function i(e){return e.type===o}},3069:(e,t,n)=>{"use strict";n.d(t,{hq:()=>o,UI:()=>r});const o="@project/save",r=()=>({type:o})},5758:(e,t,n)=>{"use strict";n.d(t,{Nz:()=>o,KX:()=>r,rA:()=>i});const o="@undo/redo",r=()=>({type:o});function i(e){return e.type===o}},7243:(e,t,n)=>{"use strict";n.d(t,{td:()=>r,ov:()=>i});const o="@select/all",r=()=>({type:o});function i(e){return e.type===o}},1578:(e,t,n)=>{"use strict";n.d(t,{MO:()=>r,CH:()=>i});const o="@select/clear",r=()=>({type:o});function i(e){return e.type===o}},4662:(e,t,n)=>{"use strict";n.d(t,{lF:()=>r,xW:()=>i});const o="@select/nodes",r=(e,t="set")=>({type:o,payload:{nodeIds:Array.isArray(e)?e:[e],mode:t}});function i(e){return e.type===o}},2571:(e,t,n)=>{"use strict";n.d(t,{a2:()=>r,p6:()=>i});const o="@select/wire-joints",r=(e,t="set")=>({type:o,payload:{jointIds:Array.isArray(e)?e:[e],mode:t}});function i(e){return e.type===o}},4691:(e,t,n)=>{"use strict";n.d(t,{Rp:()=>r,GT:()=>i});const o="@select/wires",r=(e,t="set")=>({type:o,payload:{connectionIds:Array.isArray(e)?e:[e],mode:t}});function i(e){return e.type===o}},5409:(e,t,n)=>{"use strict";n.d(t,{R9:()=>o,Fs:()=>r,wr:()=>i});const o="@selection/align-to-grid",r=()=>({type:o});function i(e){return e.type===o}},4484:(e,t,n)=>{"use strict";n.d(t,{qn:()=>r,ww:()=>i});const o="@selection/copy",r=()=>({type:o});function i(e){return e.type===o}},2165:(e,t,n)=>{"use strict";n.d(t,{XE:()=>o,NE:()=>r,SB:()=>i});const o="@selection/delete",r=()=>({type:o});function i(e){return e.type===o}},7366:(e,t,n)=>{"use strict";n.d(t,{C2:()=>r,RC:()=>i});const o="@sim/fastforward",r=()=>({type:o});function i(e){return e.type===o}},8261:(e,t,n)=>{"use strict";n.d(t,{l2:()=>o,ri:()=>r,Ie:()=>i});const o="@sim/pause",r=e=>({type:o,payload:{mode:e}});function i(e){return e.type===o}},8910:(e,t,n)=>{"use strict";n.d(t,{pu:()=>o,Fr:()=>r,NL:()=>i});const o="@sim/start",r=()=>({type:o});function i(e){return e.type===o}},737:(e,t,n)=>{"use strict";n.d(t,{Sk:()=>r,qf:()=>i});const o="@sim/stop",r=()=>({type:o});function i(e){return e.type===o}},152:(e,t,n)=>{"use strict";n.d(t,{rZ:()=>o,jf:()=>r,FD:()=>i});const o="@sim/tick",r=e=>({type:o,payload:{tickCount:e}});function i(e){return e.type===o}},3634:(e,t,n)=>{"use strict";n.d(t,{Um:()=>o,Yw:()=>r,Qy:()=>i});const o="@undo/undo",r=()=>({type:o});function i(e){return e.type===o}},4882:(e,t,n)=>{"use strict";n.d(t,{Sh:()=>o,iM:()=>r,UO:()=>i});const o="@view/zoom",r=e=>({type:o,payload:{delta:e}});function i(e){return e.type===o}},5054:(e,t,n)=>{"use strict";function o(e){return Array.isArray(e)?e:[e]}n.d(t,{_:()=>o})},2954:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.A&&t.B}}})}},5562:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.IN}}})}},2603:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["IN"],outputPins:[],evolve:(e,t)=>({state:{value:t.IN}})}},7814:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:!(t.A||t.B)}}})}},50:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["IN"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:!t.IN}}})}},1652:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:t.A||t.B}}})}},9684:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["A","B","C","D","E","F","G"],outputPins:[],evolve:(e,t)=>({state:Object.assign({},t)})}},9896:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const o={toggleState:!1},r={inputPins:[],outputPins:["OUT"],interact:(e=o)=>Object.assign(Object.assign({},e),{toggleState:!e.toggleState}),evolve:(e=o)=>({state:e,transitions:{tickOffset:1,valuesByPin:{OUT:e.toggleState}}})}},5978:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={inputPins:["A","B"],outputPins:["OUT"],evolve:(e,t)=>({transitions:{tickOffset:4,valuesByPin:{OUT:(t.A||t.B)&&t.A!=t.B}}})}},8370:(e,t,n)=>{"use strict";n.d(t,{tQ:()=>r,Ds:()=>i,VE:()=>s,Fv:()=>c,Ih:()=>a,bA:()=>l,Qu:()=>d,ZO:()=>u,sj:()=>p,kg:()=>y,PL:()=>m,nF:()=>f,G0:()=>g,kK:()=>I});var o=n(7516);const r=o.Ry().shape({x:o.Rx().required(),y:o.Rx().required()}),i=Object.freeze({x:0,y:0});function s(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function c(e){const t=s(e);return{x:e.x/t,y:e.y/t}}function a(e,t){return e.x*t.x+e.y*t.y}function l(e,t){return{x:e.x*t,y:e.y*t}}function d(...e){let t,n;if(1===e.length){const o=e[0];t=o.p1,n=o.p2}else t=e[0],n=e[1];return{p1:{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},p2:{x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)}}}function u(e,t){return{x:e.x+t.x,y:e.y+t.y}}function p(e,t){return{x:e.x-t.x,y:e.y-t.y}}function y(e,t){return e.x===t.x&&e.y===t.y}function m(e,t){return!((t=d(t)).p1.x>e.x||t.p2.x<e.x||t.p1.y>e.y||t.p2.y<e.y)}function f(e){return{width:(e=d(e)).p2.x-e.p1.x,height:e.p2.y-e.p1.y}}function g(e,t){return e=d(e),t=d(t),{p1:{x:Math.min(e.p1.x,t.p1.x),y:Math.min(e.p1.y,t.p1.y)},p2:{x:Math.max(e.p2.x,t.p2.x),y:Math.max(e.p2.y,t.p2.y)}}}function I(e,t){return e=d(e),t=d(t),!(e.p1.x>t.p2.x||e.p2.x<t.p1.x||e.p1.y>t.p2.y||e.p2.y<t.p1.y)}Object.freeze({p1:i,p2:i})},4875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o=(0,n(7531).q_)()},7165:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(9242);function r(e){return(0,o.v9)(e)}},9193:(e,t,n)=>{"use strict";var o=n(7294),r=n(3935),i=(n(1033),n(9242)),s=n(5977),c=n(4875),a=n(9188),l=n(6600);const d={"flex-row":"flex-row--sHjOY","flex-column":"flex-column--2LT64","flex-reverse":"flex-reverse--2Vn7L","flexitem-shrink":"flexitem-shrink--2U9EV","flexitem-fix":"flexitem-fix--1ARxk"},u="fill-parent--3pw6U";var p=n(8721),y=n.n(p);function m(e){return"number"==typeof e?{firstPercent:e}:e}function f(e){return y()(e,"firstPercent")}function g(e){return y()(e,"firstSize")||y()(e,"secondSize")}var I=n(3493),v=n.n(I);function b(e){const t=o.useRef(e);return o.useEffect((()=>{t.current=e})),t}const h={tessel:"tessel--2Q3Xd","tessel-split":"tessel-split--2gDs5","tessel-split--row":"tessel-split--row--2fC6o","tessel-split--column":"tessel-split--column--1Hl4C"},k=Object.freeze({top:0,left:0,bottom:0,right:0,x:0,y:0,height:0,width:0,toJSON:()=>({})}),O=({direction:e,onChangePercentage:t})=>{const n=o.useRef(null),r=o.useRef(null),i=b(e),s=b(t),c=o.useMemo((()=>v()((e=>{var t,o;if(null==r.current||null==n.current)return;const c=null!==(o=null===(t=n.current.parentElement)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==o?o:k;let a=0,l=0;"row"===i.current?(l=e.pageX-c.left,a=l/c.width,isNaN(a)?(a=0,l=c.left):a>1&&(a=1,l=c.right)):(l=e.pageY-c.top,a=l/c.height,isNaN(a)?(a=0,l=c.top):a>1&&(a=1,l=c.bottom)),s.current(100*a,l)}),1e3/60,{leading:!0})),[i,s]),a=o.useCallback((e=>{e.persist(),c(e)}),[c]),d=o.useCallback((e=>{!e.defaultPrevented&&n.current&&(r.current||(e.preventDefault(),n.current.setPointerCapture(e.pointerId),r.current=e.pointerId))}),[]),u=o.useCallback((()=>{n.current&&r.current&&(n.current.releasePointerCapture(r.current),r.current=null)}),[]);return o.createElement("div",{ref:n,className:(0,l.yI)("tessel-split",h["tessel-split"],h["row"===e?"tessel-split--row":"tessel-split--column"]),onPointerDown:d,onPointerMove:a,onPointerUp:u})};function E(e,t,n){return f(e)?{firstPercent:t}:g(e)?"number"==typeof e.secondSize?{secondSize:n}:{firstSize:n}:e}const C=({item:e,renderWindow:t,onLayoutChange:n})=>{const{direction:r,first:i,second:s,division:c}=e,a="row"===r?"width":"height",p=o.useCallback(((t,o)=>{const r=m(e.division);n(Object.assign(Object.assign({},e),{division:E(r,t,o)}))}),[e,n]),y=o.useCallback((t=>{n(Object.assign(Object.assign({},e),{first:t}))}),[e,n]),I=o.useCallback((t=>{n(Object.assign(Object.assign({},e),{second:t}))}),[e,n]),v=m(c);let b="50%",h="50%",k=!1,C=!1;if(f(v)){const{firstPercent:e}=v;b=e+"%",h=100-e+"%"}else if(g(v)){const{firstSize:e,secondSize:t}=v;e?(b=e+"px",k=!0,h="100%"):(b="100%",h=t+"px",C=!0)}return o.createElement("div",{className:(0,l.yI)(u,d["row"===r?"flex-row":"flex-column"])},o.createElement("div",{className:(0,l.yI)(k?d["flexitem-fix"]:d["flexitem-shrink"]),style:{[a]:b}},o.createElement(j,{value:i,renderWindow:t,onLayoutChange:y})),o.createElement(O,{direction:r,onChangePercentage:p}),o.createElement("div",{className:(0,l.yI)(C?d["flexitem-fix"]:d["flexitem-shrink"]),style:{[a]:h}},o.createElement(j,{value:s,renderWindow:t,onLayoutChange:I})))},j=({value:e,renderWindow:t,onLayoutChange:n})=>{const r=function(e){return"string"==typeof e?{windowId:e}:e}(e);return function(e){return y()(e,"windowId")}(r)?t(r):function(e){return y()(e,"first")&&y()(e,"second")&&y()(e,"direction")}(r)?o.createElement(C,{item:r,renderWindow:t,onLayoutChange:n}):null},x=({className:e,rootItem:t,renderWindow:n,onLayoutChange:r})=>o.createElement("div",{className:(0,l.yI)("tessel",h.tessel,e)},o.createElement(j,{value:t,renderWindow:n,onLayoutChange:r}));var N=n(3274),w=n(152),P=n(7366),B=n(5621),M=n(4484),S=n(2165),Z=n(7243),J=n(3634),D=n(5758),R=n(928),T=n.n(R),L=n(7165),A=n(7930),z=n(4405),W=n(5213),U=n(1089);var F=n(6222);const K=e=>o.createElement("button",Object.assign({className:"button--Ui3Hp",type:"button"},e),e.children);var H=n(9977);const V=()=>{const e=(0,i.I0)(),t=(0,L.Z)(z.se),n=(0,L.Z)((e=>(0,H.w)(e,F.u))),r=(0,L.Z)(z.WU),s=o.useCallback((t=>{t.preventDefault(),e((0,A._A)(F.u,[]))}),[e]);return o.createElement(K,{onClick:s},0===t.length?r:n)},q=({circuitNodeIdPath:e})=>{const t=(0,i.I0)(),n=T()(e),r=(0,L.Z)((e=>(0,W.og)(e,n))),s=(0,L.Z)((e=>(0,W.p2)(e,n))),c=r?(0,U.X)(r):null,a=(0,L.Z)((e=>c?(0,H.w)(e,c):null)),l=o.useCallback((n=>{n.preventDefault(),c&&t((0,A._A)(c,e))}),[c,e,t]);return o.createElement(K,{onClick:l},s," [",a,"]")},X=()=>{const e=(0,L.Z)(z.se),t=e.map(((t,n)=>{const r=e.slice(0,n+1);return o.createElement(o.Fragment,{key:t},o.createElement("span",null,">"),o.createElement(q,{circuitNodeIdPath:r}))}));return o.createElement("div",{className:(0,l.yI)("circuit-node-breadcrumb","circuit-node-breadcrumb--3Rx3N")},o.createElement(V,null),t)};var _=n(3092),G=n.n(_),Q=n(8370),Y=n(2222),$=n(2628),ee=n.n($),te=n(4150),ne=n(5393);const oe=Object.freeze({p1:{x:-100,y:-100},p2:{x:100,y:100}}),re=(0,Y.createSelector)(te.g,ne.v5,((e,t)=>[...ee()(e),...ee()(t).map((e=>({p1:e,p2:e})))].reduce(Q.G0,oe))),ie=(0,n(5191).V)((e=>e.viewScale));var se=n(1387),ce=n(4882);const ae=o.createContext((function(){}));function le(){return o.useContext(ae)}const de=ae.Provider;var ue=n(1935);const pe=({isOpen:e,anchorEl:t,placement:n="auto",onRequestClose:i,children:s})=>{const[c,a]=o.useState(null),{attributes:l,styles:d}=(0,ue.D)(e?t:null,c,{placement:n});return function(e,t){const n=o.useCallback((n=>{e&&(e.contains(n.target)||t())}),[e,t]);o.useEffect((()=>(document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)})),[n])}(c,i),e?(0,r.createPortal)(o.createElement("div",Object.assign({ref:a,style:d.popper},l.popper),s),document.body):null},ye=({x:e,y:t,open:n,onRequestClose:r,children:i})=>{const s=o.useMemo((()=>({getBoundingClientRect:()=>({left:e,top:t,right:e,bottom:t,width:0,height:0,x:e,y:t})})),[e,t]);return o.createElement(de,{value:r},o.createElement(pe,{isOpen:n,onRequestClose:r,anchorEl:s,placement:"bottom-start"},i))};function me(){const[e,t]=o.useState(null),n=o.useCallback((e=>{t({x:e.pageX,y:e.pageY})}),[]),r=o.useCallback((()=>{t(null)}),[]);return{openContextMenu:n,renderContextMenu:o.useCallback((t=>e?o.createElement(ye,{open:!0,onRequestClose:r,x:e.x,y:e.y},t):null),[e,r])}}const fe={current:null},ge=o.createContext({svgRef:fe,scalerRef:fe}),Ie=ge.Provider,ve=({svgRef:e,scalerRef:t,children:n})=>{const r=o.useMemo((()=>({svgRef:e,scalerRef:t})),[e,t]);return o.createElement(Ie,{value:r},n)};var be=n(2550),he=n(1585),ke=n(8177);function Oe(){const{svgRef:e,scalerRef:t}=o.useContext(ge);return o.useCallback((n=>{if(!e.current||!t.current)return Q.Ds;const o={x:n.pageX,y:n.pageY};return function(e,t,n){const o=t.getScreenCTM();if(!o)return n;const r=e.createSVGPoint();r.x=n.x,r.y=n.y;const i=r.matrixTransform(o.inverse());return{x:i.x,y:i.y}}(e.current,t.current,o)}),[e,t])}var Ee=n(3304);const Ce=o.memo((function({className:e,circuitNodeId:t,x:n=0,y:r=0,nodeType:i,nodeState:s,isSelected:c=!1,onClick:a,onMouseDown:d,onMouseOver:u,onMouseUp:p,onMouseLeave:y,onContextMenu:m}){const f=(0,L.Z)((e=>(0,Ee.yP)(e,i)));let g;if(f){const{component:e}=f.visual;g=o.createElement(e,{circuitNodeId:t,isSelected:c,elementState:s})}else g=o.createElement("rect",{x:n,y:r,width:50,height:50,fill:c?"goldenrod":"red"});const I=0!=n||0!=r?`translate(${n}, ${r})`:void 0;return o.createElement("g",{className:(0,l.yI)(e,"node-visual",c&&"node-selected"),transform:I,onClick:a,onMouseDown:d,onMouseOver:u,onMouseUp:p,onMouseLeave:y,onContextMenu:m},g)})),je=o.memo((function(){const e=(0,i.I0)(),t=Oe(),n=(0,L.Z)(he.y_),r=(0,L.Z)(he.Ll),s=(0,L.Z)(he.Ny),c=o.useCallback((n=>{const o=t(n),r=(0,be.h)(n);e((0,ke.ey)(o,r))}),[t,e]);return n&&s?o.createElement(o.Fragment,null,r&&o.createElement("g",{opacity:.5},o.createElement(Ce,{x:r.x,y:r.y,nodeType:s,nodeState:{}})),o.createElement("rect",{width:"100%",height:"100%",fill:"transparent",onMouseMove:c})):null}));var xe=n(8718),Ne=n.n(xe),we=n(6604),Pe=n.n(we),Be=n(1486),Me=n(7836);const Se=(0,Y.createSelector)(Me.d4,Be.T,((e,t)=>Ne()(t,e))),Ze=(0,Y.createSelector)(Me.d4,W.KO,((e,t)=>Ne()(t,e))),Je=o.memo((function(){const e=(0,L.Z)(Se),t=(0,L.Z)(Ze),n=(0,L.Z)(he.KQ);let r=null;return n&&(r=ee()(Pe()(e,((e,r)=>o.createElement(Ce,{key:r,nodeType:t[r],nodeState:{},x:e.x+n.x,y:e.y+n.y}))))),o.createElement("g",{id:"drag-node-preview-layer",opacity:.3},r)}));const De=e=>{var{x:t,y:n,interactable:r=!0,selected:i=!1}=e,s=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["x","y","interactable","selected"]);const[c,a]=o.useState(!1),d=o.useCallback((()=>{r&&a(!0)}),[r]),u=o.useCallback((()=>{a(!1)}),[]);return o.createElement("circle",Object.assign({className:(0,l.yI)("wire-joint--DrAWT",i&&"selected--1I6Un"),cx:t,cy:n,r:r&&c||i?4:2,onMouseOver:d,onMouseOut:u},s))},Re=(0,Y.createSelector)(Me.O5,ne.v5,((e,t)=>Ne()(t,e))),Te=o.memo((function(){const e=(0,L.Z)(he.KQ),t=(0,L.Z)(Re),n=(0,L.Z)(he.pc);let r=null;e&&(r=ee()(t).map(((t,n)=>o.createElement(De,{key:n,interactable:!1,x:t.x+e.x,y:t.y+e.y,opacity:.5}))));let i=null;return n&&(i=o.createElement(De,{interactable:!1,x:n.x,y:n.y,opacity:.5})),o.createElement("g",{id:"drag-joint-preview-layer",opacity:.3},r,i)}));function Le(e){const{dragThreshold:t=5,onClick:n,onDragStart:r,onDragMove:i,onDragEnd:s}=e,[c,a]=o.useState(!1),l=o.useRef(!1),d=o.useRef(!1),u=o.useRef(Q.Ds),p=o.useCallback((e=>{l.current||(l.current=!0,a(!0),u.current={x:e.pageX,y:e.pageY})}),[]),y=o.useCallback((()=>{l.current=!1,a(!1),d.current=!1,u.current=Q.Ds}),[]),m=o.useCallback((e=>{if(l.current)if(d.current){if(i){const t=(0,Q.sj)({x:e.pageX,y:e.pageY},u.current);i(t,e)}}else{const n=u.current;(Math.abs(n.x-e.pageX)>=t||Math.abs(n.y-e.pageY)>=t)&&(d.current=!0,r&&r(e))}}),[t,i,r]),f=o.useCallback((e=>{if(l.current){if(d.current){if(s){const t=(0,Q.sj)({x:e.pageX,y:e.pageY},u.current);s(t,e)}}else n&&n(e);y()}}),[y,n,s]);return o.useEffect((()=>{if(c)return document.addEventListener("mousemove",m),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}}),[c,m,f]),{startTracking:p,cancelTracking:y}}var Ae=n(1578),ze=n(853),We=n(4);const Ue=o.memo((function(){const e=(0,i.I0)(),t=(0,i.v9)(he.xn),n=(0,i.v9)(ie);function r(e){return e*(1/n)}const s=Oe(),c=o.useCallback((t=>{if(0!==t.button)return;const n=(0,be.h)(t);n.ctrlMetaKey||n.shiftKey||e((0,Ae.MO)())}),[e]),a=o.useCallback((t=>{const n=s(t);e((0,ze.wZ)(n))}),[e,s]),l=o.useCallback(((t,n)=>{const o=s(n),r=(0,be.h)(n);e((0,ke.ey)(o,r))}),[e,s]),d=o.useCallback(((t,n)=>{const o=s(n),r=(0,be.h)(n);e((0,We.k4)(o,r))}),[e,s]),{startTracking:u}=Le({onClick:c,onDragStart:a,onDragMove:l,onDragEnd:d}),p=o.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),u(e))}),[u]);return o.createElement("g",{id:"drag-select-layer"},o.createElement("rect",{width:100*r(1)+"%",height:100*r(1)+"%",fill:"transparent",onMouseDown:p}),t&&o.createElement("g",{transform:`translate(${t.p1.x}, ${t.p1.y})`},o.createElement("rect",{width:t.p2.x-t.p1.x,height:t.p2.y-t.p1.y,strokeWidth:r(2),strokeDasharray:`${r(5)} ${r(3)}`,stroke:"skyblue",fill:"transparent"})))})),Fe=o.memo((function(){const e=50*(0,L.Z)(ie);return o.createElement("svg",{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},o.createElement("defs",null,o.createElement("pattern",{id:"grid",width:e,height:e,patternUnits:"userSpaceOnUse"},o.createElement("path",{d:`M ${e} 0 L 0 0 0 ${e}`,fill:"none",stroke:"gray",strokeWidth:.5}))),o.createElement("rect",{width:"100%",height:"100%",fill:"url(#grid)"}))}));var Ke=n(7547),He=n(669),Ve=n.n(He),qe=n(3871),Xe=n(2334),_e=n(1755),Ge=n(2619),Qe=n(4368),Ye=n(8198),$e=n(4662),et=n(5409);const tt="menu-item--2dcyN",nt=({children:e})=>o.createElement("ul",{className:"menu--3E86w"},e),ot=({disabled:e,onClick:t,secondary:n,children:r})=>{const i=le(),s=o.useCallback((e=>{t&&t(e),i()}),[i,t]);return o.createElement("li",{className:(0,l.yI)(tt,e&&"menu-item--disabled--RJJTK")},o.createElement("a",{className:"menu-item-content--3s1DG",onClick:s},o.createElement("span",{className:"menu-item-text--1F41V"},r),n&&o.createElement("span",{className:"menu-item-secondary--2PJLF"},n)))},rt=()=>o.createElement("div",{className:"menu-divider--1QPGp"}),it=o.forwardRef((({className:e,autoFocus:t,defaultValue:n,value:r,onChange:i,onBeginEdit:s,onCommit:c,onCancel:a,onBlur:l,onKeyUp:d},u)=>{const[p,y]=o.useState(null),m=o.useCallback((e=>{null==p&&s&&s(),y(e.target.value),i&&i(e)}),[p,s,i]),f=o.useCallback((e=>{d&&d(e),e.defaultPrevented||null!=p&&("Escape"===e.key?(e.preventDefault(),a&&a()):"Enter"===e.key&&(e.preventDefault(),c&&c(p)))}),[d,p,a,c]),g=o.useCallback((e=>{l&&l(e),null!=p&&c&&c(p)}),[l,p,c]);return o.createElement("input",{ref:u,className:e,autoFocus:t,defaultValue:n,value:r,type:"text",onChange:m,onKeyUp:f,onBlur:g})})),st=({className:e,textClassname:t,inputClassname:n,label:r,defaultValue:i,isEditing:s,onRequestEdit:c,onCommit:a,onCancel:d})=>{const u=o.useRef(null),p=o.useCallback((e=>{c&&(e.defaultPrevented||(e.preventDefault(),c()))}),[c]),y=o.useCallback((e=>{"Escape"===e.key&&s&&d()}),[s,d]),m=o.useCallback((()=>{s&&d()}),[s,d]);return o.useEffect((()=>{s&&u.current&&u.current.select()}),[s]),s?o.createElement(it,{ref:u,className:(0,l.yI)(e,n),autoFocus:!0,defaultValue:i,onBlur:m,onKeyUp:y,onCommit:a,onCancel:d}):o.createElement("span",{className:(0,l.yI)(e,t),onDoubleClick:p},null!=r?r:i)},ct=e=>{const{onRequestEdit:t,onCommit:n}=e,r=le(),i=o.useCallback((()=>{t&&t()}),[t]),s=o.useCallback((e=>{n(e),r()}),[n,r]);return o.createElement("li",{className:tt,onClick:i},o.createElement(st,Object.assign({},e,{onCommit:s})))};var at=n(4443);const lt=({nodeId:e})=>{const t=(0,i.I0)(),n=(0,L.Z)((t=>(0,W.p2)(t,e))),[r,s]=o.useState(!1),c=o.useCallback((()=>{s(!0)}),[]),a=o.useCallback((()=>{s(!1)}),[]),l=o.useCallback((n=>{s(!1),t((0,at.w)(e,n))}),[t,e]),d=o.useCallback((()=>{t((0,et.Fs)())}),[t]),u=o.useCallback((()=>{t((0,S.NE)())}),[t]);return o.createElement(nt,null,o.createElement(ct,{defaultValue:null!=n?n:"<unknown>",label:o.createElement("span",{style:{fontWeight:"bold"}},n),isEditing:r,onRequestEdit:c,onCommit:l,onCancel:a}),o.createElement(rt,null),o.createElement(ot,{onClick:d},"Align Selection To Grid"),o.createElement(rt,null),o.createElement(ot,{onClick:u},"Delete Selected"))},dt=o.memo((function({nodeId:e}){const t=(0,i.I0)(),n=(0,L.Z)(Ge.D7),r=(0,L.Z)(z.se),{openContextMenu:s,renderContextMenu:c}=me(),a=(0,L.Z)((t=>(0,Qe.m)(t,e))),{x:d,y:u}=(0,L.Z)((t=>(0,Be.e)(t,e))),p=(0,L.Z)((t=>((e,t)=>{const n=e.services.simulatorGraph.simulatorNodeIdsByCircuitNodeId,o=e.services.simulator.nodeStatesByNodeId,r=(0,_e.F9)(n,t);return r?o[r]:{}})(t,[...r,e]))),y=(0,L.Z)((t=>(0,Me.CP)(t,e))),m=Oe(),f=o.useCallback((o=>{if(n)return;if(o.defaultPrevented)return;if(0!==o.button)return;o.preventDefault();const r=(0,be.h)(o),i=(0,qe.t)(r);t((0,$e.lF)(e,i))}),[t,n,e]),g=o.useCallback((n=>{if(n.defaultPrevented)return;n.preventDefault();const o=(0,be.h)(n),r=(0,qe.t)(o,"set-if-unselected");t((0,$e.lF)(e,r)),s(n)}),[t,e,s]),I=o.useCallback((n=>{const o=m(n),r=(0,be.h)(n);t((0,Ye.hZ)(e,o,r))}),[m,t,e]),v=o.useCallback(((e,n)=>{const o=m(n),r=(0,be.h)(n);t((0,ke.ey)(o,r))}),[t,m]),b=o.useCallback(((e,n)=>{const o=m(n),r=(0,be.h)(n);t((0,We.k4)(o,r))}),[t,m]),{startTracking:h}=Le({onClick:f,onDragStart:I,onDragMove:v,onDragEnd:b}),k=o.useCallback((e=>{0===e.button&&(e.defaultPrevented||(e.preventDefault(),h(e)))}),[h]);if(!a)return null;let O,E;if(a){const{component:t,hitPath:n}=a.visual;O=o.createElement(t,{circuitNodeId:e,isSelected:y,elementState:p}),E=Ve()(n)}else O=o.createElement("rect",{x:d,y:u,width:50,height:50,fill:y?"goldenrod":"red"}),E=[0,0,50,50];const C=0!=d||0!=u?`translate(${d}, ${u})`:void 0;return o.createElement("g",{transform:C},o.createElement("g",{className:(0,l.yI)("circuit-field-node",y&&"node-selected"),onMouseDown:k,onContextMenu:g},O),o.createElement(ut,{nodeId:e,bounds:E}),c(o.createElement(lt,{nodeId:e})))})),ut=o.memo((function({nodeId:e,bounds:t}){const n=(0,L.Z)(ie),r=(0,L.Z)((t=>(0,W.p2)(t,e))),i=Math.max(.7,n);let s=15;return i>1?s-=2*i:s+=1/i*7,r?o.createElement("text",{fontSize:1.2/i+"em",className:Xe.Z["text-unselectable"],textAnchor:"middle",x:t[0]+(t[2]-t[0])/2,y:t[3]+s},r):null})),pt=dt,yt=o.memo((function(){const e=(0,L.Z)(Ke.f).map((e=>o.createElement(pt,{key:e,nodeId:e})));return o.createElement("g",{id:"nodes-layer"},e)}));var mt=n(5879);const ft=n.n(mt)()(((e,t,n)=>e.services.nodeGraph.connectionsById[n]),((e,t)=>t),(e=>e.services.simulatorGraph.simulatorNodeIdsByCircuitNodeId),(e=>e.services.simulator.nodeOutputValuesByNodeId),((e,t,n,o)=>{var r;if(!e)return!1;const{outputPin:{nodeId:i,pinId:s}}=e,c=(0,_e.F9)(n,[...t,i]);return c&&(null===(r=o[c])||void 0===r?void 0:r[s])||!1}))(((e,t,n)=>t.join(".")+"::"+n));var gt=n(1883),It=n(4691);const vt=o.memo((function({connectionId:e,startJointId:t,endJointId:n}){const r=(0,i.I0)(),s=Oe(),c=(0,L.Z)((n=>null==t?(0,ne.qX)(n,e):(0,ne.oW)(n,t))),a=(0,L.Z)((t=>null==n?(0,ne.wR)(t,e):(0,ne.oW)(t,n))),[l,d]=o.useState(null),u=o.useCallback((e=>{const t=s(e);d(t)}),[s]),p=o.useCallback((()=>{d(null)}),[]),y=o.useCallback((n=>{const o=s(n),i=(0,be.h)(n);r((0,gt.gM)(e,t,o,i))}),[s,r,e,t]),m=o.useCallback(((e,t)=>{const n=s(t),o=(0,be.h)(t);r((0,ke.ey)(n,o))}),[r,s]),f=o.useCallback((e=>{const t=s(e),n=(0,be.h)(e);r((0,We.k4)(t,n))}),[r,s]),g=o.useCallback((t=>{const n=(0,be.h)(t),o=(0,qe.t)(n);r((0,It.Rp)(e,o))}),[e,r]),{startTracking:I}=Le({onClick:g,onDragStart:y,onDragMove:m,onDragEnd:f}),v=o.useCallback((e=>{e.preventDefault(),I(e)}),[I]);let b;if(l){const e=(0,Q.Fv)((0,Q.sj)(a,c)),t=(0,Q.sj)(l,c),n=(0,Q.Ih)(t,e);b=(0,Q.ZO)(c,(0,Q.bA)(e,n))}return o.createElement("g",{onMouseMove:u,onMouseLeave:p},o.createElement("line",{x1:c.x,y1:c.y,x2:a.x,y2:a.y,strokeWidth:2}),b&&o.createElement("circle",{cx:b.x,cy:b.y,r:3,stroke:"none",fill:"red",onMouseDown:v}))}));var bt=n(2571),ht=n(713);const kt=o.memo((function({jointId:e}){const t=Oe(),n=(0,i.I0)(),r=(0,L.Z)((t=>(0,Me.g7)(t,e))),s=(0,L.Z)((t=>(0,ne.oW)(t,e))),c=o.useCallback((o=>{const r=t(o),i=(0,be.h)(o);n((0,ht.R4)(e,r,i))}),[n,t,e]),a=o.useCallback(((e,o)=>{const r=t(o),i=(0,be.h)(o);n((0,ke.ey)(r,i))}),[n,t]),l=o.useCallback(((e,o)=>{const r=t(o),i=(0,be.h)(o);n((0,We.k4)(r,i))}),[n,t]),d=o.useCallback((t=>{const o=(0,be.h)(t),r=(0,qe.t)(o);n((0,bt.a2)(e,r))}),[n,e]),{startTracking:u}=Le({onClick:d,onDragStart:c,onDragMove:a,onDragEnd:l}),p=o.useCallback((e=>{e.preventDefault(),u(e)}),[u]);return o.createElement(De,{selected:r,x:s.x,y:s.y,onMouseDown:p})})),Ot=o.memo((function({connectionId:e}){const t=(0,L.Z)(z.se),n=(0,L.Z)((t=>(0,ne.qq)(t,e))),r=(0,L.Z)((n=>ft(n,t,e))),i=(0,L.Z)((t=>(0,Me.nG)(t,e))),s=[...n,null].map(((t,r)=>{const i=r>0?n[r-1]:null;return o.createElement(vt,{key:r,connectionId:e,startJointId:i,endJointId:t})})),c=n.map((e=>o.createElement(kt,{key:e,jointId:e})));return o.createElement("g",{className:(0,l.yI)("wire--3TtqK",r&&"powered--3lHhu",i&&"selected--3qbV0")},s,c)})),Et=o.memo((function(){const e=(0,L.Z)(Ke.G).map((e=>o.createElement(Ot,{key:e,connectionId:e})));return o.createElement("g",{id:"wires-layer"},e)}));var Ct=n(9203),jt=n(3065),xt=n(4206);const Nt="is-drag-target--1_8nq";function wt(e,t,n,o,r){const i=Pt(e,t,n,r),s=Pt(e,t,n,o),c=r-o<=180?"0":"1";return["M",i.x,i.y,"A",n,n,0,c,0,s.x,s.y].join(" ")}function Pt(e,t,n,o){const r=(o-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}}const Bt=o.memo((function({nodeId:e,pinId:t}){const n=Oe(),r=(0,i.I0)(),s=(0,L.Z)((n=>(0,Ct.G)(n,e,t))),c=(0,L.Z)((n=>(0,jt.k_)(n,e,t))),a=(0,L.Z)(he.qO),d=o.useCallback((o=>{const i=n(o);r((0,xt.V)(i,{nodeId:e,pinId:t}))}),[r,n,e,t]),u=o.useCallback(((e,t)=>{const o=n(t),i=(0,be.h)(t);r((0,ke.ey)(o,i))}),[r,n]),p=o.useCallback(((e,t)=>{const o=n(t),i=(0,be.h)(t);r((0,We.k4)(o,i))}),[r,n]),{startTracking:y}=Le({onDragStart:d,onDragMove:u,onDragEnd:p}),m=o.useCallback((e=>{0===e.button&&(e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),y(e)))}),[y]);if(!s)return null;const f=null!=a&&a.nodeId===e&&a.pinId===t,{x:g,y:I}=s;let v;return v="input"===c?o.createElement("path",{d:wt(g,I,3,-45,225),className:(0,l.yI)("node-pin-input--2bnnb",f&&Nt)}):o.createElement("circle",{className:(0,l.yI)("node-pin-output--Okd03",f&&Nt),cx:g,cy:I,r:3}),o.createElement("g",null,v,o.createElement("circle",{stroke:"none",fill:"transparent",cx:g,cy:I,r:3,onMouseDown:m}))})),Mt=o.memo((function({nodeId:e}){var t;const n=(0,L.Z)((t=>(0,Qe.m)(t,e))),r=null!==(t=null==n?void 0:n.pins)&&void 0!==t?t:{},i=Object.keys(r).map((t=>o.createElement(Bt,{key:t,nodeId:e,pinId:t})));return o.createElement(o.Fragment,null,i)})),St=o.memo((function(){const e=(0,L.Z)(Ke.f).map((e=>o.createElement(Mt,{key:e,nodeId:e})));return o.createElement("g",{id:"node-pins-layer"},e)})),Zt=o.memo((function(){const e=(0,L.Z)(he.rC),t=(0,L.Z)(he.zL),n=(0,L.Z)(he.Ll);return"wire"==e&&t&&n?o.createElement("line",{x1:t.x,y1:t.y,x2:n.x,y2:n.y,stroke:"black",strokeWidth:1}):null})),Jt=()=>{const e=(0,i.I0)(),t=o.useCallback((()=>{e((0,et.Fs)())}),[e]),n=o.useCallback((()=>{e((0,S.NE)())}),[e]);return o.createElement(nt,null,o.createElement(ot,{onClick:t},"Align Selection To Grid"),o.createElement(rt,null),o.createElement(ot,{onClick:n},"Delete Selected"))},Dt=({className:e})=>{const t=(0,i.I0)(),n=o.useRef(null),r=o.useRef(null),s=o.useRef(null),{openContextMenu:c,renderContextMenu:a}=me(),{width:d,height:u}=G()(n),p=(0,L.Z)(re),{width:y,height:m}=(0,Q.nF)(p),f=(0,L.Z)(ie),g=Math.max(d,y*f),I=Math.max(u,m*f),v=o.useCallback((()=>{var e;null===(e=r.current)||void 0===e||e.focus()}),[]),b=o.useCallback((()=>{t((0,se.xr)())}),[t]),h=o.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),c(e))}),[c]),k=o.useCallback((e=>{e.defaultPrevented||e.ctrlKey&&(t((0,ce.iM)(e.deltaY>0?-1:1)),e.preventDefault(),e.stopPropagation())}),[t]);var O,E,C,j;return O=n,E="wheel",C=k,j={passive:!1},o.useEffect((()=>{if(!O.current)return;const e=O.current;return e.addEventListener(E,C,j),()=>{e.removeEventListener(E,C,j)}}),[E,C,O,j]),o.createElement("div",{className:(0,l.yI)("circuit-field","circuit-field--3PQBN",e)},o.createElement("div",{className:"circuit-field-scrollarea--vyu82"},o.createElement("div",{ref:n,style:{width:"100%",height:"100%"}},o.createElement("svg",{tabIndex:-1,ref:r,width:g,height:I,onMouseDown:v,onMouseLeave:b,onContextMenu:h},o.createElement(Fe,null),o.createElement("g",{ref:s,"transform-origin":"0 0",transform:`scale(${f})`},o.createElement(ve,{svgRef:r,scalerRef:s},o.createElement(Ue,null),o.createElement(yt,null),o.createElement(Et,null),o.createElement(St,null),o.createElement(Zt,null),o.createElement(Je,null),o.createElement(Te,null),o.createElement(je,null)))))),a(o.createElement(Jt,null)))};var Rt=n(5667);const Tt="keymap:CircuitEditor/SimStep",Lt="keymap:CircuitEditor/SimFastForward",At="keymap:CircuitEditor/SelectAll",zt="keymap:CircuitEditor/Copy",Wt="keymap:CircuitEditor/Paste",Ut="keymap:CircuitEditor/Delete",Ft="keymap:CircuitEditor/Undo",Kt="keymap:CircuitEditor/Redo",Ht={[Tt]:"space",[Lt]:"shift+space",[At]:Rt.ty+"+a",[zt]:Rt.ty+"+c",[Wt]:Rt.ty+"+v",[Ut]:["backspace","del"],[Ft]:Rt.ty+"+z",[Kt]:[Rt.ty+"+y",Rt.ty+"+shift+z"]};const Vt=e=>{var{children:t}=e,n=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["children"]);return o.createElement("div",Object.assign({},n,{className:u}),t)};var qt=n(5984),Xt=n(7252),_t=n(1314);const Gt=({value:e,label:t,isSelected:n,onItemSelected:r})=>{const i=o.useCallback((t=>{t.defaultPrevented||(t.preventDefault(),r(e))}),[r,e]);return o.createElement("li",{className:(0,l.yI)("selection-list-item","selection-list-item--errDr",n&&"selection-list-item--selected--3MkqB"),onClick:i},o.createElement("div",{className:(0,l.yI)("selection-list-item-content--321YU",Xe.Z["text-unselectable"])},t))},Qt=({className:e,items:t,onItemSelected:n})=>o.createElement("ul",{className:(0,l.yI)("selection-list","selection-list--3yujH",e)},t.map((e=>o.createElement(Gt,Object.assign({key:e.value},e,{onItemSelected:n}))))),Yt=({circuitId:e})=>{const t=(0,i.I0)(),n=(0,L.Z)((t=>(0,H.w)(t,e))),[r,s]=o.useState(!1),{openContextMenu:c,renderContextMenu:a}=me(),l=o.useCallback((()=>{e!==F.u&&s(!0)}),[e]),d=o.useCallback((()=>{s(!1)}),[]),u=o.useCallback((n=>{t((0,_t.U3)(e,n)),s(!1)}),[e,t]),p=o.useCallback((n=>{n.preventDefault(),t((0,qt.Zj)(e))}),[t,e]),y=o.useCallback((t=>{e!==F.u&&(t.preventDefault(),t.stopPropagation(),c(t))}),[e,c]);return o.createElement("div",{style:{width:"100%"},onContextMenu:y,onDoubleClick:l},o.createElement(st,{defaultValue:n,isEditing:r,onRequestEdit:l,onCommit:u,onCancel:d}),a(o.createElement(nt,null,o.createElement(ot,{onClick:l},"Rename Circuit"),o.createElement(rt,null),o.createElement(ot,{onClick:p},"Delete Circuit"))))},$t=()=>{const e=(0,i.I0)(),t=o.useCallback((()=>{e((0,Xt._Y)())}),[e]);return o.createElement(nt,null,o.createElement(ot,{onClick:t},"New Circuit"))},en=({className:e})=>{const t=(0,i.I0)(),n=(0,L.Z)(z.Gl),r=(0,L.Z)(H.nR),{openContextMenu:s,renderContextMenu:c}=me(),a=o.useCallback((e=>{t((0,A._A)(e))}),[t]),d=o.useCallback((e=>{e.preventDefault(),s(e)}),[s]),p=o.useMemo((()=>Object.keys(r).map((e=>({value:e,label:o.createElement(Yt,{circuitId:e}),isSelected:e===n})))),[r,n]);return o.createElement("div",{className:(0,l.yI)("circuitstree--1eZ0Q",e),onContextMenu:d},o.createElement(Qt,{className:u,items:p,onItemSelected:a}),c(o.createElement($t,null)))};var tn=n(5273),nn=n(8554);const on=({nodeType:e})=>{const t=(0,i.I0)(),n=o.useCallback((n=>{n.defaultPrevented||(n.preventDefault(),t((0,tn.gz)(e)))}),[t,e]),r=o.useCallback((()=>{t((0,nn.Yf)(e))}),[t,e]),s=o.useCallback((()=>{t((0,We.k4)({x:-1,y:-1},be.J))}),[t]),{startTracking:c}=Le({onClick:n,onDragStart:r,onDragEnd:s}),a=o.useCallback((e=>{e.defaultPrevented||(e.preventDefault(),c(e))}),[c]),l=(0,L.Z)((t=>(0,Ee.yP)(t,e)));let d,u=e,p="0 0 50 50";if(l){const{trayComponent:e,component:t,hitPath:n}=l.visual;e?d=e:(d=()=>{const e=t;return o.createElement(e,{elementState:{}})},p=Ve()(n).join(" ")),u=l.displayName}else d=()=>o.createElement("rect",{fill:"red",x1:0,y1:0,x2:50,y2:50});return o.createElement("li",{className:"node-tray-item--2_AyH",onMouseDown:a},o.createElement("span",{className:"node-tray-item-preview--2QFhF"},o.createElement("svg",{width:30,height:30,viewBox:p},o.createElement(d,null))),o.createElement("span",{className:Xe.Z["text-unselectable"]},u))},rn={"node-tray":({className:e})=>{const t=(0,L.Z)(Ee.NJ).map((e=>o.createElement(on,{key:e.type,nodeType:e.type})));return o.createElement("div",{className:(0,l.yI)("node-tray--1uIvj",e)},o.createElement("ul",{className:"node-tray-elements--KiJGM"},t))},"circuit-field":({className:e})=>{const t=(0,i.I0)(),n=o.useMemo((()=>{function e(e){return n=>{if(n){if(n.defaultPrevented)return;n.preventDefault()}t(e)}}return{[Tt]:e((0,w.jf)(1)),[Lt]:e((0,P.C2)()),[At]:e((0,Z.td)()),[zt]:e((0,M.qn)()),[Wt]:e((0,B.v)()),[Ut]:e((0,S.NE)()),[Ft]:e((0,J.Yw)()),[Kt]:e((0,D.KX)())}}),[t]);return o.createElement(N.HotKeys,{keyMap:Ht,handlers:n,component:Vt},o.createElement("div",{className:(0,l.yI)("circuit-field-view",u,d["flex-column"],e)},o.createElement(X,null),o.createElement(Dt,{className:(0,l.yI)(u,d["flexitem-shrink"])})))},"circuits-list":en};function sn(e){const t=rn[e.windowId];return t?o.createElement(t,Object.assign({},e.windowProps)):null}const cn=()=>{const[e,t]=o.useState({direction:"row",division:{firstSize:200},first:{direction:"column",division:30,first:"circuits-list",second:"node-tray"},second:"circuit-field"});return o.createElement(x,{className:(0,l.yI)("circuit-editor",u),rootItem:e,onLayoutChange:t,renderWindow:sn})};var an=n(7198);const ln=({location:e})=>{const t=(0,i.I0)(),[n,r]=o.useState(!1);return o.useEffect((()=>{let n;try{n=new URLSearchParams(e.search)}catch(e){return void r(!0)}const o=n.get("data");o?t((0,an.vP)(o)):r(!0)}),[]),n?o.createElement("div",null,"Failed to import project"):o.createElement("div",null,"Importing Project...")},dn=()=>o.createElement(s.rs,null,o.createElement(s.AW,{exact:!0,path:"/",component:cn}),o.createElement(s.AW,{exact:!0,path:"/import",component:ln})),un=({content:e,placement:t,children:n})=>{const r=o.useRef(null),[i,s]=o.useState(!1),c=o.useCallback((()=>{s(!0)}),[]),a=o.useCallback((()=>{s(!1)}),[]);return o.createElement(de,{value:a},o.createElement("div",{ref:r,onClick:c},n),o.createElement(pe,{anchorEl:r.current,isOpen:i,placement:t,onRequestClose:a},i&&e))};function pn(e,...t){const n=(0,i.I0)();return o.useCallback(((...o)=>{const r=e(...t,...o);r&&n(r)}),[n,e,...t])}var yn=n(38),mn=n(3069),fn=n(6577),gn=n(4505);const In=()=>{const e=pn(yn.o9),t=pn(mn.UI),n=pn(fn.Cb),r=pn(gn.C9);return o.createElement(nt,null,o.createElement(ot,{onClick:e},"New"),o.createElement(rt,null),o.createElement(ot,{onClick:n},"Load"),o.createElement(ot,{onClick:t},"Save"),o.createElement(rt,null),o.createElement(ot,{onClick:r},"Export Link"))},vn=e=>e.undo.undoStack.length>0,bn=e=>e.undo.redoStack.length>0,hn=()=>{const e=(0,L.Z)(vn),t=pn(J.Yw),n=(0,L.Z)(bn),r=pn(D.KX);return o.createElement(nt,null,o.createElement(ot,{disabled:!e,secondary:Rt.ty+"+z",onClick:t},"Undo"),o.createElement(ot,{disabled:!n,secondary:Rt.ty+"+shift+z",onClick:r},"Redo"))};var kn=n(8910),On=n(737),En=n(8261);const Cn=(0,n(6036).g)((e=>e.lastTickProcessingTimeMs)),jn=e=>o.createElement("svg",Object.assign({width:16,height:16},e),o.createElement("path",{d:"M3,0 L13,8 L3,16 z"})),xn=e=>o.createElement("svg",Object.assign({width:16,height:16},e),o.createElement("path",{d:"M1,1 L15,1 L15,15 L1,15 z"})),Nn=e=>o.createElement("svg",Object.assign({width:16,height:16},e),o.createElement("path",{d:"M2.5,1 L6.5,1 L6.5,15 L2.5,15 z M9.5,1 L13.5,1 L13.5,15 L9.5,15 z"})),wn="button--1Syge",Pn=()=>{const e=(0,L.Z)(Ge.D7),t=(0,L.Z)(Ge.Ro),n=(0,L.Z)(Cn),r=pn(kn.Fr),i=pn(On.Sk),s=pn(En.ri,"toggle");return o.createElement("span",null,e&&o.createElement("span",{className:"simrate--1LNMp"},n.toFixed(2)," ms"),e?o.createElement(xn,{className:(0,l.yI)(wn,"button-stop--264bH"),onClick:i}):o.createElement(jn,{className:(0,l.yI)(wn,"button-play--3gVDD"),onClick:r}),o.createElement(Nn,{className:(0,l.yI)(wn,"button-pause--YWEL8",!e&&"button--disabled--2BVJb",t&&"selected--QetqX"),onClick:s}))},Bn=({className:e})=>o.createElement("div",{className:(0,l.yI)("titlebar--3-TCE",e)},o.createElement("span",{className:"titlebar-heading--3RAl1"},"Discrelog"),o.createElement("div",{className:"titlebar-divider--Wl_27"}),o.createElement(un,{content:o.createElement(In,null),placement:"bottom-start"},o.createElement(K,null,"File")),o.createElement(un,{content:o.createElement(hn,null),placement:"bottom-start"},o.createElement(K,null,"Edit")),o.createElement("div",{className:"titlebar-controls--1R_l6"},o.createElement(Pn,null)));var Mn=n(2047);const Sn=(0,Mn.m)((e=>e.dialogType)),Zn=(0,Mn.m)((e=>e.data));var Jn=n(5222),Dn=n(227),Rn=n(1074);const Tn=({className:e,isOpen:t,onRequestClose:n,children:i})=>t?(0,r.createPortal)(o.createElement("div",{className:(0,l.yI)("modal","modal--25LBN")},o.createElement(Dn.Y,{onClickOutside:n,onEscapeKey:n},o.createElement("div",{className:(0,l.yI)("modal-content--1H0T_",e)},o.createElement(Rn.Z,{className:u},i)))),document.body):null,Ln=({isOpen:e,acceptText:t,cancelText:n,onAccept:r,onCancel:i,footer:s,children:c})=>o.createElement(Tn,{className:"dialog--1eQi6",isOpen:e,onRequestClose:i},o.createElement("div",null,c),o.createElement("div",{className:"dialog-footer--2hYdr"},s,i&&o.createElement(K,{onClick:i},null!=n?n:"Cancel"),r&&o.createElement(K,{onClick:r},null!=t?t:"Accept"))),An=()=>{const e=pn(Jn.GA),t=(0,L.Z)(Zn),n=null==t?void 0:t.projectLink,r=o.useCallback((()=>{n&&navigator.clipboard.writeText(n).catch((()=>{}))}),[n]);if(!n)return null;const i=o.createElement(K,{onClick:r},"Copy to Clipboard");return o.createElement(Ln,{isOpen:!0,cancelText:"Close",onCancel:e,footer:i},o.createElement("div",{className:"export-link-dialog-link-container--Zas2L"},o.createElement("code",{className:"export-link-dialog-link--7r7uE"},n)))},zn=()=>{switch((0,L.Z)(Sn)){default:return null;case"export-project-link":return o.createElement(An,null)}},Wn=document.getElementById("root");r.render(o.createElement(s.F0,{history:c.Z},o.createElement(i.zt,{store:a.h},o.createElement((()=>o.createElement("div",{className:(0,l.yI)(u,d["flex-column"])},o.createElement(Bn,{className:d["flexitem-fix"]}),o.createElement("div",{className:(0,l.yI)(u,d["flexitem-shrink"])},o.createElement(dn,null)),o.createElement(zn,null))),null))),Wn)},2550:(e,t,n)=>{"use strict";n.d(t,{J:()=>r,h:()=>i});var o=n(5667);const r=Object.freeze({});function i(e){const{ctrlKey:t,altKey:n,shiftKey:r,metaKey:i}=e;return{ctrlMetaKey:o.fD?i:t,altKey:n,shiftKey:r}}},5667:(e,t,n)=>{"use strict";n.d(t,{fD:()=>r,ty:()=>i,Wd:()=>c});var o=n(1795);const r=/(Mac|iOS|OS\ X)/.test((o.os||"undefined").toString()),i=r?"command":"ctrl",s=new URL(window.location.origin);s.pathname=n.p;const c=s.toString()},3871:(e,t,n)=>{"use strict";n.d(t,{t:()=>c,a:()=>a});var o=n(3386),r=n.n(o),i=n(1966),s=n.n(i);function c(e,t="set"){return e.shiftKey&&e.ctrlMetaKey?"remove":e.shiftKey?"append":e.ctrlMetaKey?"toggle":t}function a(e,t,n){switch(n){case"set":return t;case"set-if-unselected":return t.every((t=>-1!==e.indexOf(t)))?e:t;case"append":return r()(e,t);case"remove":return s()(e,t);case"toggle":return s()(e,t).concat(s()(t,e))}return t}},1585:(e,t,n)=>{"use strict";n.d(t,{rC:()=>u,zL:()=>p,Ll:()=>y,xn:()=>f,KQ:()=>g,pc:()=>I,y_:()=>v,Ny:()=>b,qO:()=>h});var o=n(2222),r=n(8370),i=n(2550),s=n(9203),c=n(7836),a=n(7547),l=n(4418),d=n(6320);const u=(0,l.v)((e=>e.dragMode)),p=(0,l.v)((e=>e.dragStart)),y=(0,l.v)((e=>e.dragEnd)),m=(0,l.v)((e=>{var t;return null!==(t=e.dragModifierKeys)&&void 0!==t?t:i.J})),f=(0,l.v)((0,o.createSelector)(u.local,p.local,y.local,((e,t,n)=>"select"===e&&t&&n?(0,r.Qu)(t,n):null))),g=(0,o.createSelector)(u,c.d4,m,p,y,d.pf,d.Fv,((e,t,n,o,i,s,c)=>{if("move"!==e||!o||!i)return null;let a=c;t.length>0&&(a=s);const l=(0,r.sj)(i,o);return n.ctrlMetaKey||(l.x=Math.round(l.x/a)*a,l.y=Math.round(l.y/a)*a),l})),I=(0,l.v)((e=>{const t=d.Fv.local(e),{dragMode:n,dragEnd:o,dragModifierKeys:r}=e;if("new-joint"!==n||!o||!r)return null;const i=Object.assign({},o);return r.ctrlMetaKey||(i.x=Math.round(i.x/t)*t,i.y=Math.round(i.y/t)*t),i})),v=(0,l.v)((e=>"new-node"===e.dragMode)),b=(0,l.v)((e=>"new-node"===e.dragMode?e.dragNewNodeType:null)),h=(0,o.createSelector)(u,y,a.f,s.x,((e,t,n,o)=>{var i;if("wire"!==e||!t)return null;for(const e of n){const n=null!==(i=o[e])&&void 0!==i?i:r.Ds,s=Object.keys(n);for(const o of s){const i=n[o],s=(0,r.sj)(t,i);if((0,r.VE)(s)<=6)return{nodeId:e,pinId:o}}}return null}))},6320:(e,t,n)=>{"use strict";n.d(t,{pf:()=>r,Fv:()=>i,ph:()=>s,aj:()=>c});var o=n(4418);const r=(0,o.v)((()=>50)),i=(0,o.v)((()=>5)),s=(e,t)=>{const n=r(e);return{x:Math.round(t.x/n)*n,y:Math.round(t.y/n)*n}},c=(e,t)=>{const n=i(e);return{x:Math.round(t.x/n)*n,y:Math.round(t.y/n)*n}}},4418:(e,t,n)=>{"use strict";n.d(t,{X:()=>r,v:()=>i});var o=n(9963);const r=(0,o.R)("circuitEditorUi"),i=(0,o.e)("circuitEditorUi")},4405:(e,t,n)=>{"use strict";n.d(t,{Gl:()=>i,se:()=>s,WU:()=>c});var o=n(9977),r=n(5191);const i=(0,r.V)((e=>e.editingCircuitId)),s=(0,r.V)((e=>{var t;return null!==(t=e.editingCircuitNodeIdPath)&&void 0!==t?t:[]})),c=e=>(0,o.w)(e,i(e))},7547:(e,t,n)=>{"use strict";n.d(t,{G:()=>l,f:()=>a});var o=n(8133),r=n(2222),i=n(6486);const s=(0,r.createSelector)(((e,t)=>(0,o.U4)(e,t)),(e=>e.services.nodeGraph.connectionsById),((e,t)=>Object.keys(t).filter((n=>{const{inputPin:o,outputPin:r}=t[n];return!!(0,i.includes)(e,o.nodeId)&&!!(0,i.includes)(e,r.nodeId)}))));var c=n(4405);const a=e=>{const t=(0,c.Gl)(e);return(0,o.U4)(e,t)},l=e=>{const t=(0,c.Gl)(e);return s(e,t)}},5191:(e,t,n)=>{"use strict";n.d(t,{a:()=>r,V:()=>i});var o=n(9963);const r=(0,o.R)("circuitEditorView"),i=(0,o.e)("circuitEditorView")},6222:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});const o="root"},9977:(e,t,n)=>{"use strict";n.d(t,{Nd:()=>r,nR:()=>i,w:()=>s});var o=n(8628);const r=(0,o.b)((e=>Object.keys(e.circuitNamesByCircuitId))),i=(0,o.b)((e=>e.circuitNamesByCircuitId)),s=(0,o.b)(((e,t)=>e.circuitNamesByCircuitId[t]))},8133:(e,t,n)=>{"use strict";n.d(t,{oh:()=>r,U4:()=>i,RW:()=>s});var o=n(8628);const r=(0,o.b)((e=>e.nodeIdsByCircuitId)),i=(0,o.b)(((e,t)=>e.nodeIdsByCircuitId[t])),s=(0,o.b)(((e,t)=>{for(const n of Object.keys(e.nodeIdsByCircuitId))if(-1!==e.nodeIdsByCircuitId[n].indexOf(t))return n;return null}))},8628:(e,t,n)=>{"use strict";n.d(t,{v:()=>r,b:()=>i});var o=n(9963);const r=(0,o.R)("circuits"),i=(0,o.e)("circuits")},2047:(e,t,n)=>{"use strict";n.d(t,{L:()=>r,m:()=>i});var o=n(9963);const r=(0,o.R)("dialog"),i=(0,o.e)("dialog")},5637:(e,t,n)=>{"use strict";n.d(t,{DH:()=>c,PB:()=>a,rl:()=>l,ij:()=>d,Me:()=>u,lZ:()=>p});var o=n(2628),r=n.n(o),i=n(2222),s=n(3562);const c=(0,s.Z)((e=>e.connectionsById)),a=(0,s.Z)((0,i.createSelector)((e=>e.connectionsById),(e=>Object.keys(e)))),l=(0,s.Z)(((e,t)=>e.connectionsById[t])),d=(0,s.Z)((0,i.createSelector)((e=>e.connectionsById),(e=>r()(e)))),u=(0,s.Z)(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].inputPin.nodeId===t)))),p=(0,s.Z)(((e,t)=>Object.keys(e.connectionsById).filter((n=>e.connectionsById[n].outputPin.nodeId===t))))},4368:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var o=n(3304),r=n(5213);const i=(e,t)=>{const n=(0,r.og)(e,t);return n?(0,o.yP)(e,n):null}},5213:(e,t,n)=>{"use strict";n.d(t,{Xi:()=>c,Fm:()=>a,KO:()=>l,yX:()=>d,M6:()=>u,og:()=>p,p2:()=>y});var o=n(2222),r=n(6604),i=n.n(r),s=n(3562);const c=(0,s.Z)((e=>e.nodesById)),a=(0,s.Z)((0,o.createSelector)(c.local,(e=>Object.keys(e)))),l=(0,s.Z)((0,o.createSelector)(c.local,(e=>i()(e,(e=>e.nodeType))))),d=(0,s.Z)(((e,t)=>e.nodesById[t]||null)),u=(0,s.Z)(((e,t)=>{const n=[];for(const o of Object.keys(e.nodesById)){const{nodeType:r}=e.nodesById[o];r===t&&n.push(o)}return n})),p=(0,s.Z)(((e,t)=>{const n=d.local(e,t);return n?n.nodeType:null})),y=(0,s.Z)(((e,t)=>{var n;const o=d.local(e,t);return o?null!==(n=o.nodeName)&&void 0!==n?n:t.substr(0,4):null}))},3065:(e,t,n)=>{"use strict";n.d(t,{k_:()=>a,LK:()=>l,Su:()=>d});var o=n(8133),r=n(1089),i=n(5637),s=n(4368),c=n(5213);const a=(e,t,n)=>{const o=(0,s.m)(e,t);if(!o)return null;const r=o.pins[n];return r?r.direction:null},l=(e,t)=>{const n=(0,i.ij)(e),o=(0,s.m)(e,t);if(!o)return{};let r=[];r=Object.keys(o.pins).filter((e=>"output"===o.pins[e].direction));const c=n.filter((e=>e.outputPin.nodeId===t)),a={};for(const e of r)a[e]=[];for(const e of c){const{outputPin:t,inputPin:n}=e;a[t.pinId].push(n)}return a},d=(e,t)=>{const n=(0,c.og)(e,t);if("pin-input"!==n&&"pin-output"!==n)return[];const i=(0,o.RW)(e,t);if(!i)return[];const s=(0,r.u)(i);return(0,c.M6)(e,s).map((e=>({nodeId:e,pinId:t})))}},3562:(e,t,n)=>{"use strict";n.d(t,{s:()=>r,Z:()=>i});var o=n(9963);const r=(0,o.R)("nodeGraph"),i=(0,o.e)("nodeGraph")},4150:(e,t,n)=>{"use strict";n.d(t,{g:()=>y});var o=n(2222),r=n(669),i=n.n(r),s=n(6604),c=n.n(s),a=n(8370),l=n(5213),d=n(3304),u=n(1486);const p=(0,o.createSelector)(d.MW,l.KO,((e,t)=>c()(t,(t=>{const n=e[t];return n?i()(n.visual.hitPath):[0,0,0,0]})))),y=(0,o.createSelector)(u.T,p,((e,t)=>c()(e,((e,n)=>{const o=t[n]||[0,0,0,0];return(0,a.Qu)({x:e.x+o[0],y:e.y+o[1]},{x:e.x+o[2],y:e.y+o[3]})}))))},9203:(e,t,n)=>{"use strict";n.d(t,{x:()=>a,G:()=>l});var o=n(2222),r=n(8370),i=n(5213),s=n(3304),c=n(1486);const a=(0,o.createSelector)(s.MW,c.T,i.KO,((e,t,n)=>{var o;const i={},s=Object.keys(n);for(const c of s){const s={};i[c]=s;const a=null!==(o=t[c])&&void 0!==o?o:r.Ds,l=n[c];if(!l)continue;const d=e[l];if(!d)continue;const u=Object.keys(d.pins);for(const e of u){const t=d.pins[e],n=(0,r.ZO)(a,t);s[e]=n}}return i})),l=(e,t,n)=>{var o;const i=a(e)[t];return i&&null!==(o=i[n])&&void 0!==o?o:r.Ds}},1486:(e,t,n)=>{"use strict";n.d(t,{T:()=>i,e:()=>s});var o=n(8370),r=n(2179);const i=(0,r.J)((e=>e.nodePositionsById)),s=(0,r.J)(((e,t)=>{var n;return null!==(n=e.nodePositionsById[t])&&void 0!==n?n:o.Ds}))},5393:(e,t,n)=>{"use strict";n.d(t,{qX:()=>l,wR:()=>d,II:()=>u,qq:()=>p,oW:()=>y,v5:()=>m});var o=n(8370),r=n(4368),i=n(2179),s=n(1486);const c={},a={},l=(e,t)=>{const{outputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],a=(0,r.m)(e,n);if(!a)return o.Ds;const l=(0,s.e)(e,n),d=c[t];if(d&&d.inputNodeDef===a&&d.inputNodePosition.x===l.x&&d.inputNodePosition.y===l.y)return d.outputPosition;let u=o.Ds;a&&a.pins[i]&&(u=a.pins[i]);const p=(0,o.ZO)(l,u);return c[t]={inputNodeDef:a,inputNodePosition:l,outputPosition:p},p},d=(e,t)=>{const{inputPin:{nodeId:n,pinId:i}}=e.services.nodeGraph.connectionsById[t],c=(0,r.m)(e,n);if(!c)return o.Ds;const l=(0,s.e)(e,n),d=a[t];if(d&&d.inputNodeDef===c&&d.inputNodePosition.x===l.x&&d.inputNodePosition.y===l.y)return d.outputPosition;let u=o.Ds;c&&c.pins[i]&&(u=c.pins[i]);const p=(0,o.ZO)(l,u);return a[t]={inputNodeDef:c,inputNodePosition:l,outputPosition:p},p},u=((0,i.J)((e=>Object.keys(e.wireJointPositionsByJointId))),(0,i.J)((e=>e.wireJointIdsByConnectionId))),p=(0,i.J)(((e,t)=>e.wireJointIdsByConnectionId[t])),y=(0,i.J)(((e,t)=>e.wireJointPositionsByJointId[t])),m=(0,i.J)((e=>e.wireJointPositionsByJointId))},2179:(e,t,n)=>{"use strict";n.d(t,{S:()=>r,J:()=>i});var o=n(9963);const r=(0,o.R)("nodeLayout"),i=(0,o.e)("nodeLayout")},4944:(e,t,n)=>{"use strict";n.d(t,{J:()=>l});var o=n(7294),r=n(9242),i=n(7165),s=n(1235),c=n(4405);const a=({circuitNodeId:e,shapePath:t,hitPath:n,isSelected:a,elementState:l})=>{const d=(0,r.I0)(),u=(0,i.Z)(c.se),p=o.useCallback((t=>{e&&(t.defaultPrevented||(t.preventDefault(),d((0,s.zN)([...u,e]))))}),[e,d,u]);var y,m;const f=(y=t,m=l,(Array.isArray(y)?y:[y]).map((e=>{if("string"==typeof e)return{path:e,fill:"black",stroke:"black",strokeWidth:2};const t="function"==typeof e.fill?e.fill(m||{}):e.fill,n="function"==typeof e.stroke?e.stroke(m||{}):e.stroke,o="function"==typeof e.strokeWidth?e.strokeWidth(m||{}):e.strokeWidth;return{path:e.path,fill:t,stroke:n,strokeWidth:o}}))).map(((e,t)=>o.createElement("path",{key:t,d:e.path,fill:a?"goldenrod":e.fill,stroke:a?"goldenrod":e.stroke,strokeWidth:e.strokeWidth})));return o.createElement("g",{onClick:p},o.createElement("path",{d:n,fill:"transparent",stroke:"none"}),f)};function l(e,t){return{component:n=>o.createElement(a,Object.assign({shapePath:t,hitPath:e},n)),hitPath:e}}},1089:(e,t,n)=>{"use strict";function o(e){return"ic-"+e}function r(e){return e.startsWith("ic-")?e.substr(3):null}n.d(t,{u:()=>o,X:()=>r})},1186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const o={type:"interaction-toggle",displayName:"Toggle Switch",elementProduction:"toggle",visual:(0,n(4944).J)("M5,5 L45,5 L45,45 L5,45 z",[{path:"M5,5 L45,5 L45,45 L5,45 z",fill:"#AFAFAF",stroke:"black"},{path:"M10,10 L40,10 L40,40 L10,40 z",fill:e=>e.toggleState?"lightgreen":"darkgreen",stroke:"black"}]),pins:{OUT:{direction:"output",x:45,y:25}}}},1894:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30z",i={type:"logic-and",displayName:"AND",elementProduction:"and",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M31 15H5M32 35H5"}),o.createElement("path",{className:"node-select-highlight--fill",d:"M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},357:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z",i={type:"logic-buffer",displayName:"Buffer",elementProduction:"buffer",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 72,25 L 95.085706,25"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"black",strokeWidth:"2",d:"M 29.043478,25 L 5.0434781,25"}),o.createElement("path",{className:"node-select-highlight--fill",stroke:"none",fill:"black",d:"M 28.96875,2.59375 L 28.96875,5 L 28.96875,45 L 28.96875,47.40625 L 31.125,46.34375 L 72.15625,26.34375 L 75,25 L 72.15625,23.65625 L 31.125,3.65625 L 28.96875,2.59375 z M 31.96875,7.40625 L 68.09375,25 L 31.96875,42.59375 L 31.96875,7.40625 z"}))},pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},2074:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",i={type:"logic-nor",displayName:"NOR",elementProduction:"nor",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79 25h16M31 15H5M32 35H5"}),o.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"3",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},8061:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625z",i={type:"logic-not",displayName:"NOT",elementProduction:"not",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M79.15691 25H95M29.043478 25h-24"}),o.createElement("path",{className:"node-select-highlight--fill",d:"M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"3",d:"M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"}))},pins:{IN:{direction:"input",x:0,y:25},OUT:{direction:"output",x:100,y:25}}}},6246:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375z",i={type:"logic-or",displayName:"OR",elementProduction:"or",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M31 15H5M32 35H5"}),o.createElement("path",{className:"node-select-highlight--fill",fillRule:"evenodd",d:"M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"}))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2356:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375z",i={type:"logic-xor",displayName:"XOR",elementProduction:"xor",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",fill:"none",stroke:"#000",strokeWidth:"2",d:"M70 25h25M30.38572 15H5M31.3621 35H5"}),o.createElement("g",{fillRule:"evenodd",className:"node-select-highlight--fill"},o.createElement("path",{d:"M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"}),o.createElement("path",{d:"M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"})))},pins:{A:{direction:"input",x:0,y:14.5},B:{direction:"input",x:0,y:35},OUT:{direction:"output",x:100,y:25}}}},2944:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const o=`M ${25-20}, 25\n    a 20,20 0 1,0 40,0\n    a 20,20 0 1,0 -40,0`;const r={type:"output-led",displayName:"Indicator Light",elementProduction:"led",visual:(0,n(4944).J)(o,{path:o,stroke:"black",strokeWidth:3,fill:e=>e.value?"lightgreen":"darkgreen"}),pins:{IN:{direction:"input",x:0,y:25}}}},1460:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(4944);const r=[15,0];function i(e,t){const n=t[0];let o=`M${3*n[0]+r[0]},${3*n[1]+r[1]}`;for(const e of t.slice(1)){const[t,n]=e;o+=`L${3*t+r[0]},${3*n+r[1]}`}return o+="z",{path:o,fill:t=>t[e]?"red":"gray"}}const s={type:"output-seg7",displayName:"7-Segment Display",elementProduction:"seg7",visual:(0,o.J)("M15,0 V63 H45 V0 z",[i("A",[[1,1],[2,0],[8,0],[9,1],[8,2],[2,2]]),i("B",[[9,1],[10,2],[10,8],[9,9],[8,8],[8,2]]),i("C",[[9,9],[10,10],[10,16],[9,17],[8,16],[8,10]]),i("D",[[9,17],[8,18],[2,18],[1,17],[2,16],[8,16]]),i("E",[[1,17],[0,16],[0,10],[1,9],[2,10],[2,16]]),i("F",[[1,9],[0,8],[0,2],[1,1],[2,2],[2,8]]),i("G",[[1,9],[2,8],[8,8],[9,9],[8,10],[2,10]])]),pins:{A:{direction:"input",x:0,y:5},B:{direction:"input",x:0,y:15},C:{direction:"input",x:0,y:25},D:{direction:"input",x:0,y:35},E:{direction:"input",x:0,y:45},F:{direction:"input",x:0,y:55},G:{direction:"input",x:0,y:65}}}},2554:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",i={type:"pin-input",displayName:"Input Pin",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M35,25 h5",stroke:"black",fill:"none"}))},pins:{OUT:{direction:"output",x:40,y:25}}}},8420:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var o=n(7294);const r="M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0",i={type:"pin-output",displayName:"Output Pin",visual:{hitPath:r,component:()=>o.createElement("g",null,o.createElement("path",{d:r,fill:"transparent",stroke:"none"}),o.createElement("path",{className:"node-select-highlight--stroke",d:"M15,25 a 10,10 0 1,0 20 0 a 10,10 0 1,0 -20,0 M15,25 h-5",stroke:"black",fill:"none"}))},pins:{IN:{direction:"input",x:10,y:25}}}},3304:(e,t,n)=>{"use strict";n.d(t,{yP:()=>S,MW:()=>M,NJ:()=>B});var o=n(4654),r=n.n(o),i=n(3311),s=n.n(i),c=n(5054),a=n(2222),l=n(9734),d=n.n(l),u=n(8133),p=n(6222),y=n(5213),m=n(1486),f=n(7294),g=n(9242),I=n(2334),v=n(7165),b=n(7930),h=n(9977),k=n(4405);function O(e,t){return`M10,10 h80 v${50*Math.max(e,t,1)-20} h-80 z`}const E=({circuitNodeId:e,circuitId:t,inputPinCount:n,outputPinCount:o})=>{const r=(0,g.I0)(),i=(0,v.Z)((e=>(0,h.w)(e,t))),s=O(n,o),c=(0,v.Z)(k.se),a=f.useCallback((n=>{e&&(n.defaultPrevented||(n.preventDefault(),r((0,b._A)(t,[...c,e]))))}),[t,e,r,c]),l=[];for(let e=0;e<n;e++){const t=50*e+25;l.push(f.createElement("line",{key:e,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:0,y1:t,x2:10,y2:t}))}const d=[];for(let e=0;e<o;e++){const t=50*e+25;d.push(f.createElement("line",{key:e,className:"node-select-highlight--stroke",stroke:"black",strokeWidth:2,x1:90,y1:t,x2:100,y2:t}))}return f.createElement("g",null,f.createElement("path",{className:"node-select-highlight--stroke",stroke:"black",fill:"transparent",d:s,onDoubleClick:a}),f.createElement("text",{className:I.Z["text-unselectable"],textAnchor:"middle",x:50,y:30},i),l,d)},C=()=>f.createElement("g",{stroke:"black",strokeWidth:1},f.createElement("rect",{x:10,y:10,width:30,height:30,fill:"none"}),f.createElement("line",{x1:10,y1:15,x2:5,y2:15}),f.createElement("line",{x1:40,y1:15,x2:45,y2:15}),f.createElement("line",{x1:10,y1:35,x2:5,y2:35}),f.createElement("line",{x1:40,y1:35,x2:45,y2:35}));function j(e,t,n){const o={circuitId:e,inputPinCount:t,outputPinCount:n};return{hitPath:O(t,n),trayComponent:e=>f.createElement(C,Object.assign({},o,e)),component:e=>f.createElement(E,Object.assign({},o,e))}}function x(e,t){return{x:"input"===t?0:100,y:50*e+25}}var N=n(1089);const w=[(0,a.createSelector)(u.oh,y.KO,m.T,h.nR,((e,t,n,o)=>Object.keys(e).filter((e=>e!==p.u)).map((r=>{var i,s;const c=null!==(i=e[r])&&void 0!==i?i:[],a=null!==(s=o[r])&&void 0!==s?s:r.substr(0,5);let l=c.filter((e=>t[e].startsWith("pin-")));l=d()(l,(e=>n[e].y),(e=>n[e].x));const u={};let p=0,y=0;for(const e of l){const n=t[e];"pin-input"===n?(u[e]=Object.assign({direction:"input"},x(p,"input")),p++):"pin-output"===n&&(u[e]=Object.assign({direction:"output"},x(y,"output")),y++)}return{type:(0,N.u)(r),displayName:a,elementProduction:{type:"circuit",circuitId:r},visual:j(r,p,y),pins:u}})))),n(1186).Z,n(1894).Z,n(357).Z,n(2074).Z,n(8061).Z,n(6246).Z,n(2356).Z,n(2944).Z,n(1460).Z,n(2554).Z,n(8420).Z];let P=[];const B=e=>{const t=r()(w,(t=>function(e,t){let n;return n="function"==typeof e?e(t):e,(0,c._)(n)}(t,e)));return t.every(((e,t)=>e===P[t]))?P:(P=t,t)},M=(0,a.createSelector)(B,(e=>{const t={};for(const n of e)t[n.type]=n;return t})),S=(e,t)=>{var n;const o=B(e);return null!==(n=s()(o,(e=>e.type===t)))&&void 0!==n?n:null}},7836:(e,t,n)=>{"use strict";n.d(t,{d4:()=>a,CP:()=>l,nG:()=>d,O5:()=>u,g7:()=>p});var o=n(2222),r=n(8718),i=n.n(r),s=n(5213),c=n(9286);const a=(0,c.m)((e=>e.selectedNodeIds)),l=(0,c.m)(((e,t)=>-1!==e.selectedNodeIds.indexOf(t))),d=((0,o.createSelector)(s.Xi,a,((e,t)=>i()(e,t))),(0,c.m)((e=>e.selectedConnectionIds)),(0,c.m)(((e,t)=>-1!==e.selectedConnectionIds.indexOf(t)))),u=(0,c.m)((e=>e.selectedJointIds)),p=(0,c.m)(((e,t)=>-1!==e.selectedJointIds.indexOf(t)))},9286:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,m:()=>i});var o=n(9963);const r=(0,o.R)("selection"),i=(0,o.e)("selection")},9963:(e,t,n)=>{"use strict";n.d(t,{R:()=>i,e:()=>s});var o=n(9188),r=n(6600);function i(e){return t=>(n=o._,i)=>{const s=t(n.services[e],i,n);return n.services[e]!=s?(0,r.cA)(n,"services",e,s):n}}function s(e){return t=>{const n=(n,...o)=>t(n.services[e],...o);return n.local=t,n}}},2619:(e,t,n)=>{"use strict";n.d(t,{D7:()=>r,yU:()=>i,Ro:()=>s,bg:()=>c});var o=n(4389);const r=(0,o.x)((e=>"edit"!==e.mode)),i=(0,o.x)((e=>"run"===e.mode)),s=(0,o.x)((e=>"pause"===e.mode)),c=(0,o.x)((e=>e.ticksPerSecond))},4389:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,x:()=>i});var o=n(9963);const r=(0,o.R)("simulatorControl"),i=(0,o.e)("simulatorControl")},1755:(e,t,n)=>{"use strict";n.d(t,{Ac:()=>a,OF:()=>l,F9:()=>d});var o=n(4654),r=n.n(o),i=n(7361),s=n.n(i),c=n(9963);const a=(0,c.R)("simulatorGraph"),l=(0,c.e)("simulatorGraph");function d(e,t){const n=r()(t,(e=>[e,"subCircuitIds"]));n.pop();const o=s()(e,n);if(!o)return null;const{simulatorNodeId:i}=o;return null!=i?i:null}},6036:(e,t,n)=>{"use strict";n.d(t,{X:()=>r,g:()=>i});var o=n(9963);const r=(0,o.R)("simulator"),i=(0,o.e)("simulator")},9188:(e,t,n)=>{"use strict";n.d(t,{_:()=>O,h:()=>qo});const o=Object.freeze({dragMode:null,dragModifierKeys:null,dragStart:null,dragEnd:null,dragNewNodeType:null,dragNewJointConnectionId:null,dragNewJointAfterJointId:null,dragWireSource:null});var r=n(6222);const i={editingCircuitId:r.u,editingCircuitNodeIdPath:null,viewScale:1},s=Object.freeze(i),c={circuitNamesByCircuitId:{[r.u]:"Root"},nodeIdsByCircuitId:{[r.u]:[]}},a=Object.freeze(c);var l=n(8370);const d=Object.freeze({clipboardNodes:[],clipboardPasteOrigin:l.Ds}),u=Object.freeze({dialogType:null,data:null}),p=Object.freeze({nodesById:{},connectionsById:{}}),y=Object.freeze({nodePositionsById:{},wireJointIdsByConnectionId:{},wireJointPositionsByJointId:{}}),m=Object.freeze({selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}),f=Object.freeze({tick:0,lastTickProcessingTimeMs:0,nodeStatesByNodeId:{},nodeOutputValuesByNodeId:{},transitionsById:{},transitionWindows:[]}),g=Object.freeze({mode:"edit",ticksPerSecond:1e3}),I=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{}}),v={circuitEditorUi:o,circuitEditorView:s,nodeGraph:p,nodeLayout:y,circuits:a,clipboard:d,dialog:u,selection:m,simulator:f,simulatorControl:g,simulatorGraph:I},b=Object.freeze(v),h=["circuitEditorView","circuits","nodeGraph","nodeLayout"],k={services:b,undo:Object.freeze({undoStack:[],redoStack:[]})},O=Object.freeze(k);var E=n(4890),C=n(2729),j=n.n(C),x=n(7172);const N="@init";var w=n(7252),P=n(5984),B=n(1314),M=n(5273),S=n(5054);const Z="@node/delete";function J(e){return e.type===Z}var D=n(4443),R=n(5409),T=n(2165);const L="@selection/move";var A=n(4586);const z="@wire/attach",W=(e,t,n)=>({type:z,payload:{connectionId:(0,A.Z)(),p1:e,p2:t,joints:(null==n?void 0:n.joints)||[]}});function U(e){return e.type===z}const F="@wire/detatch";function K(e){return e.type===F}const H="@wire/joint/add",V="@wire/joint/move",q=(e,t,n={})=>{var o,r;return{type:V,payload:{jointIds:(0,S._)(e),position:t,relative:null!==(o=n.relative)&&void 0!==o&&o,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},X="@wire/joint/delete";var _=n(5621),G=n(4),Q=n(3634),Y=n(5758),$=n(38);const ee="@project/receive",te=e=>({type:ee,payload:{saveData:e}}),ne=[w.q6,P.JP,B.QM,M.dd,Z,D.XT,R.R9,T.XE,L,z,F,H,X,V,Q.Um,Y.Nz,_.Fb,G.cN];function oe(e){return-1!==ne.indexOf(e.type)}$.Ny;var re=n(6600),ie=n(8718),se=n.n(ie);function ce(e){return se()(e.services,h)}var ae=n(928),le=n.n(ae);var de=n(8177),ue=n(1387),pe=n(152),ye=n(4882);const me=[de.NQ,ue.Cq,V,pe.rZ,ye.Sh];var fe=n(4970),ge=n(8764),Ie=n(8424),ve=n(5667),be=n(4875);const he="@dialog/show";var ke=n(5222);const Oe="@dialog/response/cancel";function*Ee(e,t){yield(0,fe.gz)(((e,t)=>({type:he,payload:{dialogType:e,data:t}}))(e,t));const n=yield(0,fe.qn)([ke.pR,Oe]);return n.type===ke.pR?n.payload.result:null}var Ce=n(4505),je=n(7516);const xe=je.Ry().shape({nodeId:je.Z_().required().min(1),pinId:je.Z_().required().min(1)});function Ne(e,t){return e.nodeId===t.nodeId&&e.pinId===t.pinId}const we=je.Ry().shape({circuitId:je.Z_().required().min(1),circuitName:je.Z_().required().min(1)}),Pe=je.Ry().shape({nodeId:je.Z_().required().min(1),nodeType:je.Z_().required().min(1),nodeName:je.Z_().nullable().min(1),circuitId:je.Z_().required().min(1),x:je.Rx().required(),y:je.Rx().required()}),Be=je.Ry().shape({output:xe.required(),input:xe.required(),joints:je.IX().of(l.tQ)}),Me=je.Ry().shape({circuits:je.IX().of(we).min(0),nodes:je.IX().of(Pe).min(0),wires:je.IX().of(Be).min(0)});var Se=n(9734),Ze=n.n(Se);function Je(...e){return[].concat(...e)}var De=n(4418);const Re=(0,De.X)(((e,t)=>{if(!(0,de.Xm)(t))return e;const{dragPos:n,modifierKeys:o}=t.payload;return Object.assign(Object.assign({},e),{dragEnd:n,dragModifierKeys:o})}));var Te=n(3871);const Le="@select/region";var Ae=n(6320),ze=n(1585),We=n(713),Ue=n(2571),Fe=n(7836),Ke=n(1883);const He=(0,De.X)(((e,t)=>{if(!(0,Ke.xl)(t))return e;const{connectionId:n,addAfterJointId:o,modifierKeys:r,x:i,y:s}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"new-joint",dragStart:{x:i,y:s},dragNewJointConnectionId:n,dragNewJointAfterJointId:o,dragModifierKeys:r})}));var Ve=n(8554);const qe=(0,De.X)(((e,t)=>{if(!(0,Ve.Q6)(t))return e;const{nodeType:n}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"new-node",dragNewNodeType:n})}));var Xe=n(8198),_e=n(4662),Ge=n(853);const Qe=(0,De.X)(((e,t)=>{if(!(0,Ge.dx)(t))return e;const{x:n,y:o}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"select",dragStart:{x:n,y:o}})}));var Ye=n(4206);const $e=Je(Re,(function(e=O,t){if(!(0,G.$V)(t))return e;const{x:n,y:o,modifierKeys:r}=t.payload,{dragMode:i,dragStart:s,dragEnd:c,dragNewNodeType:a,dragNewJointAfterJointId:d,dragNewJointConnectionId:u,dragWireSource:p}=e.services.circuitEditorUi;switch(i){case"select":if(s){const t=(0,Te.t)(r),i=(0,l.Qu)(s,{x:n,y:o});e=ko(e,((e,t="set")=>({type:Le,payload:{region:e,mode:t}}))(i,t))}break;case"move":if(s){let t=(0,l.sj)({x:n,y:o},s);const i=e.services.selection.selectedNodeIds.length>0;r.ctrlMetaKey||(t=i?(0,Ae.ph)(e,t):(0,Ae.aj)(e,t)),e=ko(e,((e,t,n={})=>{var o;return{type:L,payload:{offsetX:e,offsetY:t,snapMode:null!==(o=n.snapMode)&&void 0!==o?o:"none"}}})(t.x,t.y))}break;case"new-node":if(c){const t=(0,Ae.ph)(e,c);e=ko(e,(0,M.gz)(a,{position:t}))}break;case"new-joint":if(c){const t=(0,Ae.aj)(e,c);e=ko(e,((e,t,n,o)=>({type:H,payload:{connectionId:e,jointId:(0,A.Z)(),addAfterJointId:t,position:n}}))(u,d,t))}break;case"wire":{const t=(0,ze.qO)(e);p&&c&&t&&(e=ko(e,W(p,t)));break}}return(0,re.cA)(e,"services","circuitEditorUi",(e=>Object.assign(Object.assign({},e),{dragMode:null,dragModifierKeys:null,dragStart:null,dragEnd:null,dragNewNodeType:null,dragWireSource:null})))}),(function(e=O,t){if(!(0,We.Vl)(t))return e;const{jointId:n,x:o,y:r,modifierKeys:i}=t.payload;if(e=(0,re.cA)(e,"services","circuitEditorUi",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:o,y:r}}))),!(0,Fe.g7)(e,n)){const t=(0,Te.t)(i);e=ko(e,(0,Ue.a2)(n,t))}return e}),He,qe,(function(e=O,t){if(!(0,Xe.KH)(t))return e;const{nodeId:n,x:o,y:r,modifierKeys:i}=t.payload;if(e=(0,re.cA)(e,"services","circuitEditorUi",(e=>Object.assign(Object.assign({},e),{dragMode:"move",dragStart:{x:o,y:r}}))),!(0,Fe.CP)(e,n)){const t=(0,Te.t)(i);e=ko(e,(0,_e.lF)(n,t))}return e}),Qe,(0,De.X)(((e,t)=>{if(!(0,Ye.Zr)(t))return e;const{dragStart:n,pin:o}=t.payload;return Object.assign(Object.assign({},e),{dragMode:"wire",dragStart:n,dragWireSource:o})})),(0,De.X)(((e,t)=>(0,ue.hG)(t)?null==e.dragMode?e:Object.assign(Object.assign({},e),{dragEnd:null}):e)));var et=n(5191);const tt=(0,et.a)(((e,t)=>{if(!(0,P.Q$)(t))return e;const{circuitId:n}=t.payload;return e.editingCircuitId!==n?e:Object.assign(Object.assign({},e),{editingCircuitId:r.u})})),nt=(0,et.a)(((e,t)=>{if(!(0,w.U_)(t))return e;const{circuitId:n,edit:o}=t.payload;return o?Object.assign(Object.assign({},e),{editingCircuitId:n}):e}));var ot=n(7930),rt=n(9977);const it=Je(tt,nt,(0,et.a)(((e,t,n)=>{if(!(0,ot.k5)(t))return e;const{circuitId:o,circuitNodeIdPath:r}=t.payload;return-1===(0,rt.Nd)(n).indexOf(o)?e:Object.assign(Object.assign({},e),{editingCircuitId:o,editingCircuitNodeIdPath:r})})),(0,et.a)(((e,t)=>{if(!(0,ye.UO)(t))return e;const{viewScale:n}=e,{delta:o}=t.payload;return Object.assign(Object.assign({},e),{viewScale:o>0?n*o*1.03:n/(1.03*-o)})})));var st=n(8628);const ct=(0,st.v)(((e,t)=>{if(!(0,w.U_)(t))return e;const n=t.payload.circuitId;let o=t.payload.circuitName;return o||(o="Circuit "+(Object.keys(e.circuitNamesByCircuitId).length+1)),Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:o}),nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[n]:[]})})}));var at=n(6604),lt=n.n(at),dt=n(1966),ut=n.n(dt),pt=n(5213),yt=n(1089);const mt=(0,st.v)(((e,t,n)=>{if(!(0,P.Q$)(t))return e;const{circuitId:o}=t.payload,r=Object.keys(e.circuitNamesByCircuitId).filter((e=>e!==o)),i=(0,pt.M6)(n,(0,yt.u)(o));let s=se()(e.nodeIdsByCircuitId,r);return s=lt()(s,(e=>ut()(e,i))),Object.assign(Object.assign({},e),{nodeIdsByCircuitId:s,circuitNamesByCircuitId:se()(e.circuitNamesByCircuitId,r)})})),ft=(0,st.v)(((e,t)=>{if(!(0,B.lp)(t))return e;const{circuitId:n,circuitName:o}=t.payload,r=o.trim();return""===r?e:Object.assign(Object.assign({},e),{circuitNamesByCircuitId:Object.assign(Object.assign({},e.circuitNamesByCircuitId),{[n]:r})})}));var gt=n(4405);const It=(0,st.v)(((e,t,n)=>{if(!(0,M.g0)(t))return e;const{nodeId:o,circuitId:r}=t.payload,i=null!=r?r:(0,gt.Gl)(n);return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:Object.assign(Object.assign({},e.nodeIdsByCircuitId),{[i]:[...e.nodeIdsByCircuitId[i],o]})})})),vt=(0,st.v)(((e,t)=>{if(!J(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{nodeIdsByCircuitId:lt()(e.nodeIdsByCircuitId,(e=>e.filter((e=>-1===n.indexOf(e)))))})})),bt=Je(ct,mt,ft,It,vt,(0,st.v)(((e,t)=>(0,$.Tp)(t)?Object.assign(Object.assign({},e),{circuitNamesByCircuitId:{[r.u]:"Root"},nodeIdsByCircuitId:{[r.u]:[]}}):e)));var ht=n(5161),kt=n.n(ht),Ot=n(998),Et=n.n(Ot),Ct=n(7287),jt=n.n(Ct);const xt="@clipboard/copy";var Nt=n(3065),wt=n(1486),Pt=n(9963);const Bt=(0,Pt.R)("clipboard"),Mt=((0,Pt.e)("clipboard"),Bt(((e,t,n)=>{if(!function(e){return e.type===xt}(t))return e;const{nodeIds:o}=t.payload;if(0===o.length)return e;const r=(0,wt.T)(n),i=jt()(o,kt()(o,(()=>(0,A.Z)()))),s=r[o[0]],c=o.map((e=>{const t=(0,pt.yX)(n,e),c=(0,Nt.LK)(n,e);return{id:i[e],nodeType:t.nodeType,offset:(0,l.sj)(r[e],s),outputs:lt()(c,(e=>e.filter((e=>{return t=e.nodeId,-1!==Et()(o,(e=>e===t));var t})).map((e=>({nodeId:i[e.nodeId],pinId:e.pinId})))))}}));return Object.assign(Object.assign({},e),{clipboardNodes:c,clipboardPasteOrigin:s})})));var St=n(2628),Zt=n.n(St);const Jt=Je(Mt,(function(e=O,t){if(!(0,_.Ff)(t))return e;const{clipboardNodes:n,clipboardPasteOrigin:o}=e.services.clipboard,r=(0,Ae.pf)(e),i=(0,l.ZO)(o,{x:r,y:r}),s=jt()(n.map((e=>e.id)),kt()(n,(()=>(0,A.Z)())));for(const t of n){const{id:n,nodeType:o,offset:r}=t,c=(0,l.ZO)(i,r);e=ko(e,(0,M.gz)(o,{position:c,nodeId:s[n]}))}for(const t of n){const{id:n,outputs:o}=t,r=s[n];for(const t of Object.keys(o))for(const n of o[t]){const{nodeId:o,pinId:i}=n,c=s[o];e=ko(e,W({nodeId:r,pinId:t},{nodeId:c,pinId:i}))}}return e=(0,re.cA)(e,"services","clipboard","clipboardPasteOrigin",i),ko(e,(0,_e.lF)(Zt()(s)))}));var Dt=n(2047);const Rt=Je((0,Dt.L)(((e,t)=>(0,ke.W2)(t)?u:e)),(0,Dt.L)(((e,t)=>function(e){return e.type===Oe}(t)?u:e)),(0,Dt.L)(((e,t)=>{if(!function(e){return e.type===he}(t))return e;const{dialogType:n,data:o}=t.payload;return Object.assign(Object.assign({},e),{dialogType:n,data:o})})));function Tt(e,t){return t.weight=e,t}function Lt(e){var t;return(null!==(t=e.weight)&&void 0!==t?t:0)-1}var At=n(8133),zt=n(3562),Wt=n(5937),Ut=n.n(Wt),Ft=n(4654),Kt=n.n(Ft);function Ht(e,t,n){const o=ut()(Object.keys(e.nodesById),t),r=Kt()(t,(e=>(0,Nt.Su)(n,e)));return Object.assign(Object.assign({},e),{nodesById:se()(e.nodesById,o),connectionsById:Ut()(e.connectionsById,(function({inputPin:e,outputPin:n}){return-1===t.indexOf(e.nodeId)&&-1===t.indexOf(n.nodeId)&&!r.some((t=>Ne(t,e)||Ne(t,n)))}))})}const Vt=Tt(Lt(mt),(0,zt.s)(((e,t,n)=>{if(!(0,P.Q$)(t))return e;const{circuitId:o}=t.payload;return Ht(e,[...(0,At.U4)(n,o),...(0,pt.M6)(n,(0,yt.u)(o))],n)}))),qt=Tt(-10,(0,zt.s)(((e,t)=>{if(!(0,M.g0)(t))return e;const{nodeId:n,nodeType:o,nodeName:r}=t.payload;return Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:{nodeType:o,nodeName:null!=r?r:null}})})}))),Xt=Tt(Lt(vt),(0,zt.s)(((e,t,n)=>{if(!J(t))return e;const{nodeIds:o}=t.payload;return Ht(e,o,n)}))),_t=(0,zt.s)(((e,t)=>{if(!(0,D.HH)(t))return e;const{nodeId:n}=t.payload;if(!e.nodesById[n])return e;let o=t.payload.nodeName;return o||""!==o.trim()||(o=null),Object.assign(Object.assign({},e),{nodesById:Object.assign(Object.assign({},e.nodesById),{[n]:Object.assign(Object.assign({},e.nodesById[n]),{nodeName:o})})})})),Gt=(0,zt.s)(((e,t)=>(0,$.Tp)(t)?p:e));var Qt=n(3311),Yt=n.n(Qt),$t=n(3304);const en=Je(Vt,qt,Gt,Xt,_t,(0,zt.s)(((e,t,n)=>{if(!U(t))return e;const{connectionId:o,p1:r,p2:i}=t.payload,s=function(e,t,n,o){const r=e.nodesById[t.nodeId],i=e.nodesById[n.nodeId];if(!r||!i)return null;const s=(0,$t.yP)(o,r.nodeType),c=(0,$t.yP)(o,i.nodeType);if(!s||!c)return null;const a=s.pins[t.pinId],l=c.pins[n.pinId];if(!a||!l)return null;if(a.direction===l.direction)return null;return{outputPin:"output"===a.direction?t:n,inputPin:"input"===a.direction?t:n}}(e,r,i,n);if(!s)return e;const{inputPin:c}=s;return Yt()(e.connectionsById,(e=>Ne(e.inputPin,c)))?e:Object.assign(Object.assign({},e),{connectionsById:Object.assign(Object.assign({},e.connectionsById),{[o]:Object.assign({id:o},s)})})})),(0,zt.s)(((e,t)=>{if(!K(t))return e;const{connectionId:n}=t.payload,o=Object.keys(e.connectionsById).filter((e=>e!==n));return Object.assign(Object.assign({},e),{connectionsById:se()(e.connectionsById,o)})})));var tn=n(2179),nn=n(5637);function on(e,t,n){const o=t.reduce(((e,t)=>{const o=(0,nn.Me)(n,t),r=(0,nn.lZ)(n,t);return e.push(...o,...r),e}),[]),r=Kt()(t,(e=>(0,Nt.Su)(n,e))),i=(0,nn.DH)(n),s=Object.keys(i).filter((e=>{const{inputPin:t,outputPin:n}=i[e];return r.some((e=>Ne(e,t)||Ne(e,n)))})),c=[...o,...s].reduce(((t,n)=>(t.push(...e.wireJointIdsByConnectionId[n]),t)),[]),a=ut()(Object.keys(e.wireJointIdsByConnectionId),o),l=ut()(Object.keys(e.wireJointPositionsByJointId),c),d=ut()(Object.keys(e.nodePositionsById),t);return Object.assign(Object.assign({},e),{nodePositionsById:se()(e.nodePositionsById,d),wireJointIdsByConnectionId:se()(e.wireJointIdsByConnectionId,a),wireJointPositionsByJointId:se()(e.wireJointPositionsByJointId,l)})}const rn=Tt(Lt(Vt),(0,tn.S)(((e,t,n)=>{if(!(0,P.Q$)(t))return e;const{circuitId:o}=t.payload;return e=on(e,(0,At.U4)(n,o),n),on(e,(0,pt.M6)(n,(0,yt.u)(o)),n)}))),sn=(0,tn.S)(((e,t)=>{if(!(0,M.g0)(t))return e;const{nodeId:n,position:o=l.Ds}=t.payload;return(0,re.cA)(e,"nodePositionsById",n,o)})),cn=Tt(Lt(Xt),(0,tn.S)(((e,t,n)=>{if(!J(t))return e;const{nodeIds:o}=t.payload;return on(e,o,n)}))),an="@node/move",ln=(e,t,n={})=>{var o,r;return{type:an,payload:{nodeIds:(0,S._)(e),position:t,relative:null!==(o=n.relative)&&void 0!==o&&o,snapMode:null!==(r=n.snapMode)&&void 0!==r?r:"none"}}},dn=(0,tn.S)(((e,t,n)=>{if(!function(e){return e.type===an}(t))return e;const{nodeIds:o,position:r,relative:i,snapMode:s}=t.payload,c=lt()(se()(e.nodePositionsById,o),(e=>{let t={x:i?e.x+r.x:r.x,y:i?e.y+r.y:r.y};return"node"===s&&(t=(0,Ae.ph)(n,t)),t}));return Object.assign(Object.assign({},e),{nodePositionsById:Object.assign(Object.assign({},e.nodePositionsById),c)})})),un=Je(rn,sn,(0,tn.S)(((e,t)=>(0,$.Tp)(t)?y:e)),cn,dn,(0,tn.S)(((e,t)=>{if(!U(t))return e;const{connectionId:n,joints:o}=t.payload;if(o.length>0){const t=o.map((()=>(0,A.Z)()));e=(0,re.cA)(e,"wireJointIdsByConnectionId",n,t),e=(0,re.cA)(e,"wireJointPositionsByJointId",(e=>Object.assign(Object.assign({},e),jt()(t,o))))}else e=(0,re.cA)(e,"wireJointIdsByConnectionId",n,[]);return e})),(0,tn.S)(((e,t)=>{if(!K(t))return e;const{connectionId:n}=t.payload,o=Object.keys(e.wireJointIdsByConnectionId).filter((e=>e!=n)),r=ut()(Object.keys(e.wireJointPositionsByJointId),e.wireJointIdsByConnectionId[n]);return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:se()(e.wireJointIdsByConnectionId,o),wireJointPositionsByJointId:se()(e.wireJointPositionsByJointId,r)})})),(0,tn.S)(((e,t)=>{if(!function(e){return e.type===H}(t))return e;const{connectionId:n,addAfterJointId:o,position:r,jointId:i}=t.payload;let s=e.wireJointIdsByConnectionId[n];const c=o?s.indexOf(o)+1:0;return s=[...s.slice(0,c),i,...s.slice(c)],Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:Object.assign(Object.assign({},e.wireJointIdsByConnectionId),{[n]:s}),wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),{[i]:r})})})),(0,tn.S)(((e,t)=>{if(!function(e){return e.type===X}(t))return e;const{jointId:n}=t.payload,o=Object.keys(e.wireJointPositionsByJointId).filter((e=>e!==n));return Object.assign(Object.assign({},e),{wireJointIdsByConnectionId:lt()(e.wireJointIdsByConnectionId,(e=>e.filter((e=>e!==n)))),wireJointPositionsByJointId:se()(e.wireJointPositionsByJointId,o)})})),(0,tn.S)(((e,t,n)=>{if(!function(e){return e.type===V}(t))return e;const{jointIds:o,position:r,relative:i,snapMode:s}=t.payload,c=lt()(se()(e.wireJointPositionsByJointId,o),(e=>{let t={x:i?e.x+r.x:r.x,y:i?e.y+r.y:r.y};return"node"===s?t=(0,Ae.ph)(n,t):"joint"===s&&(t=(0,Ae.aj)(n,t)),t}));return Object.assign(Object.assign({},e),{wireJointPositionsByJointId:Object.assign(Object.assign({},e.wireJointPositionsByJointId),c)})}))),pn=Je(Tt(50,((e=O,t)=>{return oe(t)?(n=Eo(e),localStorage.setItem("autosave",JSON.stringify(n)),e):e;var n})),(function(e=O,t){return(0,$.Tp)(t)?(localStorage.removeItem("autosave"),e):e}),(function(e=O,t){if(!function(e){return e.type===N}(t))return e;const n=function(){const e=localStorage.getItem("autosave");if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}();if(!n)return e;try{return Co(e,n)}catch(t){return e}}),(function(e=O,t){if(!function(e){return e.type===ee}(t))return e;try{return Co(e,t.payload.saveData)}catch(t){return console.error("Failed to load save",t),e}}));var yn=n(9286);const mn=(0,yn.V)(((e,t)=>{if(!J(t))return e;const{nodeIds:n}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:ut()(e.selectedNodeIds,n),selectedConnectionIds:[]})})),fn=(0,yn.V)(((e,t)=>(0,$.Tp)(t)?m:e));var gn=n(5564),In=n.n(gn),vn=n(7243),bn=n(7547),hn=n(5393);const kn=(0,yn.V)(((e,t,n)=>{if(!(0,vn.ov)(t))return e;const o=(0,bn.f)(n);let r=(0,nn.PB)(n);const i=(0,nn.DH)(n);r=r.filter((e=>{const{inputPin:t,outputPin:n}=i[e];return-1!==o.indexOf(t.nodeId)&&-1!==o.indexOf(n.nodeId)}));const s=(0,hn.II)(n),c=In()(r.map((e=>s[e])));return Object.assign(Object.assign({},e),{selectedNodeIds:o,selectedConnectionIds:r,selectedJointIds:c})}));var On=n(1578);const En=(0,yn.V)(((e,t)=>(0,On.CH)(t)?Object.assign(Object.assign({},e),{selectedNodeIds:[],selectedConnectionIds:[],selectedJointIds:[]}):e)),Cn=(0,yn.V)(((e,t)=>{if(!(0,Ue.p6)(t))return e;const{jointIds:n,mode:o}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===o?[]:e.selectedNodeIds,selectedConnectionIds:"set"===o?[]:e.selectedConnectionIds,selectedJointIds:(0,Te.a)(e.selectedJointIds,n,o)})})),jn=(0,yn.V)(((e,t)=>{if(!(0,_e.xW)(t))return e;const{nodeIds:n,mode:o}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:(0,Te.a)(e.selectedNodeIds,n,o),selectedConnectionIds:"set"===o?[]:e.selectedConnectionIds,selectedJointIds:"set"===o?[]:e.selectedJointIds})}));var xn=n(2525),Nn=n.n(xn),wn=n(4150);const Pn=(0,yn.V)(((e,t,n)=>{if(!function(e){return e.type===Le}(t))return e;const{region:o,mode:r}=t.payload,i=(0,bn.f)(n),s=se()((0,wn.g)(n),i),c=[];Nn()(s,((e,t)=>{(0,l.kK)(e,o)&&c.push(t)}));const a=[],d=(0,hn.v5)(n);return Nn()(d,((e,t)=>{(0,l.PL)(e,o)&&a.push(t)})),Object.assign(Object.assign({},e),{selectedNodeIds:(0,Te.a)(e.selectedNodeIds,c,r),selectedConnectionIds:"set"===r?[]:e.selectedConnectionIds,selectedJointIds:(0,Te.a)(e.selectedJointIds,a,r)})}));var Bn=n(4691);const Mn=(0,yn.V)(((e,t)=>{if(!(0,Bn.GT)(t))return e;const{connectionIds:n,mode:o}=t.payload;return Object.assign(Object.assign({},e),{selectedNodeIds:"set"===o?[]:e.selectedNodeIds,selectedConnectionIds:(0,Te.a)(e.selectedConnectionIds,n,o),selectedJointIds:"set"===o?[]:e.selectedJointIds})}));var Sn=n(4484);const Zn=Je(fn,mn,kn,En,Cn,jn,Pn,Mn,(function(e=O,t){if(!(0,R.wr)(t))return e;const{selectedNodeIds:n,selectedJointIds:o}=e.services.selection,r=(0,wt.T)(e);for(const t of n){const n=r[t];if(!n)continue;const o=(0,Ae.ph)(e,n);(0,l.kg)(n,o)||(e=ko(e,ln(t,o)))}const i=(0,hn.v5)(e);for(const t of o){const n=i[t];if(!n)continue;const o=(0,Ae.aj)(e,n);(0,l.kg)(n,o)||(e=ko(e,q(t,o)))}return e}),(function(e=O,t){if(!(0,Sn.ww)(t))return e;const n=(0,Fe.d4)(e);return 0===n.length?e:ko(e,(o=n,{type:xt,payload:{nodeIds:Array.isArray(o)?o:[o]}}));var o}),(function(e=O,t){if(!(0,T.SB)(t))return e;const{selectedNodeIds:n,selectedConnectionIds:o,selectedJointIds:r}=e.services.selection;var i;return n.length>0&&(e=ko(e,(i=n,{type:Z,payload:{nodeIds:(0,S._)(i)}}))),e=o.reduce(((e,t)=>ko(e,(e=>({type:F,payload:{connectionId:e}}))(t))),e),r.reduce(((e,t)=>ko(e,(e=>({type:X,payload:{jointId:e}}))(t))),e)}),(function(e=O,t){if(!function(e){return e.type===L}(t))return e;const{offsetX:n,offsetY:o,snapMode:r}=t.payload,i=(0,Fe.d4)(e),s=(0,Fe.O5)(e),c={x:n,y:o};let a="none";"node"!==r&&"by-type"!==r||(a="node");let l="none";return l="by-type"===r?"joint":r,e=ko(e,ln(i,c,{relative:!0,snapMode:a})),ko(e,q(s,c,{relative:!0,snapMode:l}))}),(0,yn.V)(((e,t)=>{if(!K(t))return e;const{connectionId:n}=t.payload;return Object.assign(Object.assign({},e),{selectedConnectionIds:e.selectedConnectionIds.filter((e=>e!==n))})})));var Jn=n(6036);const Dn=(0,Jn.X)(((e,t)=>oe(t)?f:e));n(2603),n(9896);const Rn={and:n(2954).Z,or:n(1652).Z,nor:n(7814).Z,not:n(50).Z,buffer:n(5562).Z,led:n(2603).Z,toggle:n(9896).Z,seg7:n(9684).Z,xor:n(5978).Z};var Tn=n(1235),Ln=n(1755);const An=(0,Ln.OF)(((e,t)=>(0,Ln.F9)(e.simulatorNodeIdsByCircuitNodeId,t))),zn=(0,Ln.OF)((e=>Object.keys(e.simulatorNodesById))),Wn=(0,Ln.OF)(((e,t)=>{const n=e.simulatorNodesById[t];return n?n.elementType:null}));var Un=n(7513),Fn=n.n(Un);const Kn=(0,Ln.OF)(((e,t)=>{const n=e.simulatorNodesById[t];return n?Kt()(Zt()(n.outputsByPin),(e=>e.map((e=>e.simulatorNodeId)))):[]})),Hn=(0,Ln.OF)(((e,t)=>{const n=e.simulatorNodesById[t];return n?n.inputsByPin:{}}));function Vn(e,t,n){const o=e.tick+t;e=Object.assign(Object.assign({},e),{transitionWindows:[...e.transitionWindows]});let r=t+1;for(;e.transitionWindows.length>0&&e.transitionWindows[0].tick<=o;){if(0==--r)throw new Error("Maximum ticks per sim evolution exceeded.  This is an indication that windows are being generated for past ticks.");const t=e.transitionWindows.shift();e=qn(e,t,n)}return e.tick!=o&&(e=Object.assign(Object.assign({},e),{tick:o})),e}function qn(e,t,n){e=Object.assign(Object.assign({},e),{tick:t.tick,nodeOutputValuesByNodeId:Object.assign({},e.nodeOutputValuesByNodeId)});const o=[];for(const r of t.transitionIds){const{nodeId:t,valuesByOutputPin:i}=e.transitionsById[r];e.nodeOutputValuesByNodeId[t]=Object.assign(Object.assign({},e.nodeOutputValuesByNodeId[t]),i);const s=Kn(n,t);for(const e of s)-1===o.indexOf(e)&&o.push(e)}e.transitionsById=se()(e.transitionsById,ut()(Object.keys(e.transitionsById),t.transitionIds));for(const t of o)e=Xn(e,t,n);return e}function Xn(e,t,n){var o;const r=Wn(n,t);if(!r)return e;const i=Rn[r];if(!i||!i.evolve)return e;const s={},c=Hn(n,t);for(const t of Object.keys(c)){const n=c[t];if(!n){s[t]=!1;continue}const{simulatorNodeId:r,pinId:i}=n;s[t]=(null===(o=e.nodeOutputValuesByNodeId[r])||void 0===o?void 0:o[i])||!1}const a=i.evolve(e.nodeStatesByNodeId[t],s,e.tick);if(a.state&&(e=(0,re.cA)(e,"nodeStatesByNodeId",t,a.state)),a.transitions){const n=(0,S._)(a.transitions);for(const o of n){const{tickOffset:n,valuesByPin:r,transitionMerger:i="replace"}=o,s=e.tick+(n>0?n:1);"replace"===i&&(e=Gn(e,t)),e=_n(e,t,s,r)}}return e}function _n(e,t,n,o){const r=(0,A.Z)(),i={nodeId:t,tick:n,valuesByOutputPin:o},s=[...e.transitionWindows];let c=Fn()(s,n,((e,t)=>e.tick-t));if(c<0){c=-c-1;const e={tick:n,transitionIds:[]};s.splice(c,0,e)}return s[c]=Object.assign(Object.assign({},s[c]),{transitionIds:[...s[c].transitionIds,r]}),Object.assign(Object.assign({},e),{transitionsById:Object.assign(Object.assign({},e.transitionsById),{[r]:i}),transitionWindows:s})}function Gn(e,t){return Object.keys(e.transitionsById).filter((n=>e.transitionsById[n].nodeId===t)).reduce(((e,t)=>function(e,t){const n=e.transitionsById[t];if(!n)return e;const o=se()(e.transitionsById,Object.keys(e.transitionsById).filter((e=>e!==t)));let r=e.transitionWindows;const i=Et()(r,(e=>e.tick===n.tick));if(-1!==i){const e=r[i],n=e.transitionIds.indexOf(t);if(-1!==n)if(1===e.transitionIds.length)r=[...r.slice(0,i),...r.slice(i+1)];else{r=[...r];const e=r[i].transitionIds;r[i]=Object.assign(Object.assign({},r[i]),{transitionIds:[...e.slice(0,n),...e.slice(n+1)]})}}return Object.assign(Object.assign({},e),{transitionsById:o,transitionWindows:r})}(e,t)),e)}const Qn=(0,Jn.X)(((e,t,n)=>{if(!(0,Tn.ke)(t))return e;const{circuitNodeIdPath:o}=t.payload,r=An(n,o);if(!r)return e;const i=Wn(n,r);if(!i)return e;const s=Rn[i];if(!s||!s.interact)return e;const c=e.nodeStatesByNodeId[r],a=s.interact(c);return Xn(e=(0,re.cA)(e,"nodeStatesByNodeId",r,a),r,n)}));var Yn=n(7366);const $n=(0,Jn.X)(((e,t,n)=>{if(!(0,Yn.RC)(t))return e;const{tick:o,transitionWindows:r}=e;return 0===r.length?e:Vn(e,r[0].tick-o,n)}));var eo=n(8910);const to=Je(Dn,Qn,$n,(0,Jn.X)(((e,t,n)=>(0,eo.NL)(t)?function(e,t){const n=zn(t);return e=f,e=n.reduce(((e,n)=>function(e,t,n){const o=Wn(n,t);if(!o)return e;const r=Rn[o];if(!r)return e;const i={};for(const e of r.outputPins)i[e]=!1;return(0,re.cA)(e,"nodeOutputValuesByNodeId",t,i)}(e,n,t)),e),n.reduce(((e,n)=>Xn(e,n,t)),e)}(e,n):e)),(0,Jn.X)(((e,t,n)=>{if(!(0,pe.FD)(t))return e;const{tickCount:o}=t.payload,r=performance.now();e=Vn(e,o,n);const i=performance.now()-r;return Object.assign(Object.assign({},e),{lastTickProcessingTimeMs:i})})));var no=n(4389);const oo=(0,no.G)(((e,t)=>oe(t)?Object.assign(Object.assign({},e),{mode:"edit"}):e));var ro=n(8261),io=n(2619);const so=(0,no.G)(((e,t)=>{if(!(0,ro.Ie)(t))return e;const{mode:n}=t.payload;if(!io.D7.local(e))return e;let o=e.mode;switch(n){case!0:o="pause";break;case!1:o="run";break;case"toggle":o="run"==o?"pause":"run"}return Object.assign(Object.assign({},e),{mode:o})})),co=(0,no.G)(((e,t)=>(0,eo.NL)(t)?Object.assign(Object.assign({},e),{mode:"run"}):e));var ao=n(737);const lo=Je(oo,so,co,(0,no.G)(((e,t)=>(0,ao.qf)(t)?Object.assign(Object.assign({},g),{ticksPerSecond:e.ticksPerSecond}):e)));var uo=n(3857),po=n.n(uo),yo=n(7361),mo=n.n(yo),fo=n(4368);const go=Tt(-10,(0,Ln.Ac)(((e,t,n)=>{if(!(0,eo.NL)(t))return e;const{simulatorNodesById:o,simulatorNodeIdsByCircuitNodeId:i}=vo(r.u,n);return Object.assign(Object.assign({},e),{simulatorNodesById:o,simulatorNodeIdsByCircuitNodeId:i})}))),Io=Object.freeze({simulatorNodesById:{},simulatorNodeIdsByCircuitNodeId:{},inputElementPinsByCircuitPinId:{},outputElementPinsByCircuitPinId:{}});function vo(e,t){const n={},o={},r={},i={},s=[],c=[],a={},l={},d=(0,At.U4)(t,e);for(const e of d){const i=(0,pt.og)(t,e);if(!i)continue;if("pin-input"===i){s.push(e),r[e]=[];continue}if("pin-output"===i){c.push(e);continue}const d=bo(e,t);po()(n,d.simulatorNodesById),po()(o,d.simulatorNodeIdsByCircuitNodeId),a[e]=d.inputElementPinsByCircuitPinId,l[e]=d.outputElementPinsByCircuitPinId}const u=(0,nn.DH)(t);for(const e of Object.keys(u)){const{inputPin:t,outputPin:o}=u[e];if(-1===d.indexOf(t.nodeId)||-1===d.indexOf(o.nodeId))continue;const p=mo()(l,[o.nodeId,o.pinId]),y=mo()(a,[t.nodeId,t.pinId]);if(-1!==s.indexOf(o.nodeId)&&y){r[o.nodeId].push(...y);continue}if(-1!==c.indexOf(t.nodeId)&&p){i[t.nodeId]=p;continue}if(!p||!y)continue;const m=n[p.simulatorNodeId];let f=m.outputsByPin[p.pinId];null==f&&(m.outputsByPin[p.pinId]=f=[]);for(const e of y)f.push({simulatorNodeId:e.simulatorNodeId,pinId:e.pinId}),n[e.simulatorNodeId].inputsByPin[e.pinId]={simulatorNodeId:p.simulatorNodeId,pinId:p.pinId}}return{simulatorNodesById:n,simulatorNodeIdsByCircuitNodeId:o,inputElementPinsByCircuitPinId:r,outputElementPinsByCircuitPinId:i}}function bo(e,t){const n=(0,pt.og)(t,e);if(!n)return Io;const o=(0,$t.yP)(t,n);if(!o||!o.elementProduction)return Io;const r="string"==typeof(i=o.elementProduction)?{type:"element",elementType:i}:i;var i;switch(r.type){case"element":return function(e,t,n){const o=(0,fo.m)(n,e);if(!o)return Io;const r={},i={},s=(0,A.Z)();r[s]={elementType:t.elementType,inputsByPin:{},outputsByPin:{}},i[e]={simulatorNodeId:s,subCircuitIds:{}};const c={},a={};for(const e of Object.keys(o.pins)){const{direction:t}=o.pins[e];"input"===t?c[e]=[{pinId:e,simulatorNodeId:s}]:"output"===t&&(a[e]={pinId:e,simulatorNodeId:s})}return{simulatorNodesById:r,simulatorNodeIdsByCircuitNodeId:i,inputElementPinsByCircuitPinId:c,outputElementPinsByCircuitPinId:a}}(e,r,t);case"circuit":return function(e,t,n){const o=vo(t.circuitId,n);return Object.assign(Object.assign({},o),{simulatorNodeIdsByCircuitNodeId:{[e]:{simulatorNodeId:null,subCircuitIds:o.simulatorNodeIdsByCircuitNodeId}}})}(e,r,t);default:throw new Error("Unsupported production type "+r.type)}}const ho=Je(go,(0,Ln.Ac)(((e,t)=>(0,ao.qf)(t)?Object.assign({},I):e))),ko=function(e){const t=Ze()(e,(e=>e.weight||0));return(e=O,n)=>t.reduce(((e,t)=>t(e,n)),e)}(Je($e,it,bt,Jt,Rt,en,un,pn,Zn,to,lo,ho));class Oo extends Error{constructor(e){super(e),this.message=e,this.code="SAVE_FORMAT_ERROR"}}function Eo(e){const t=(0,hn.v5)(e);return{circuits:(0,rt.Nd)(e).map((t=>({circuitId:t,circuitName:(0,rt.w)(e,t)}))),nodes:(0,pt.Fm)(e).map((t=>{const n=(0,pt.yX)(e,t),o=(0,wt.e)(e,t),i=(0,At.RW)(e,t);return{nodeId:t,nodeType:n.nodeType,nodeName:n.nodeName,circuitId:null!=i?i:r.u,x:o.x,y:o.y}})),wires:(0,nn.PB)(e).map((n=>{const o=(0,nn.rl)(e,n),r=(0,hn.qq)(e,n);return{input:o.inputPin,output:o.outputPin,joints:r.map((e=>t[e]))}}))}}function Co(e,t){var n,o,r;try{Me.validateSync(t)}catch(e){throw new Oo(e.message)}e=O;try{e=(null!==(n=t.circuits)&&void 0!==n?n:[]).reduce(((e,{circuitId:t,circuitName:n})=>ko(e,(0,w._Y)({circuitId:t,circuitName:n}))),e),e=(null!==(o=t.nodes)&&void 0!==o?o:[]).reduce(((e,t)=>{var n;return ko(e,(0,M.gz)(t.nodeType,{nodeId:t.nodeId,circuitId:t.circuitId,position:{x:t.x,y:t.y},nodeName:null!==(n=t.nodeName)&&void 0!==n?n:void 0}))}),e),e=(null!==(r=t.wires)&&void 0!==r?r:[]).reduce(((e,t)=>ko(e,W(t.output,t.input,{joints:t.joints}))),e)}catch(e){throw console.error("Failed to rehydrate SaveData:",e),new Oo("Failed to load project.")}return e}function*jo(){yield(0,fe.ib)(Ce.WG,xo)}function*xo(){const e=yield(0,fe.Ys)();try{const t=Eo(e),n=JSON.stringify(t),o=(0,Ie.Wt)(n),r=ge.lW.from(o).toString("base64"),i=encodeURIComponent(r),s=ve.Wd+be.Z.createHref({pathname:"/import",search:"data="+i});yield(0,fe.RE)(Ee,"export-project-link",{projectLink:s})}catch(e){console.error("Failed to export project as link",e)}}var No=n(7198);function*wo(){yield(0,fe.ib)(No.Yk,Po)}function*Po(e){const{data:t}=e.payload;try{const e=decodeURIComponent(t),n=ge.lW.from(e,"base64"),o=(0,Ie.rr)(n,{to:"string"}),r=JSON.parse(o);yield(0,fe.gz)(te(r)),be.Z.push("/")}catch(e){console.error("Failed to import save from link",e)}}var Bo=n(4171),Mo=n.n(Bo),So=n(6577);function*Zo(){yield(0,fe.ib)(So.Wx,Jo)}function*Jo(){try{const[e]=yield(0,fe.RE)(Mo(),{accept:"application/json"}),t=yield(0,fe.RE)(e.text.bind(e)),n=JSON.parse(t);yield(0,fe.gz)(te(n))}catch(e){console.warn("Failed to load project:",e)}}var Do=n(3162),Ro=n(3069);function*To(){yield(0,fe.ib)(Ro.hq,Lo)}function*Lo(){const e=yield(0,fe.Ys)();try{window.showSaveFilePicker?yield(0,fe.RE)(Ao,e):yield(0,fe.RE)(zo,e)}catch(e){console.warn("Failed to save project",e)}}function*Ao(e){const t=yield(0,fe.RE)(window.showSaveFilePicker,{types:[{description:"Discrelog Project Files",accept:{"application/json":[".json"]}}]});if(!t)return;const n=Eo(e),o=yield(0,fe.RE)(t.createWritable.bind(t));yield(0,fe.RE)(o.write.bind(o),JSON.stringify(n,null,2)),yield(0,fe.RE)(o.close.bind(o))}function*zo(e){const t=Eo(e),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"});(0,Do.saveAs)(n,"discrelog-project.json")}function*Wo(){yield(0,fe.rM)(jo),yield(0,fe.rM)(wo),yield(0,fe.rM)(Zo),yield(0,fe.rM)(To)}function*Uo(){yield(0,fe.A7)([eo.pu,ro.l2],Fo)}function*Fo(){for(;yield(0,fe.Ys)(io.yU);){yield(0,fe.gz)((0,pe.jf)(1));const e=yield(0,fe.Ys)(io.bg),t=Math.max(Math.ceil(1e3/e),1);yield(0,fe.gw)(t)}}function*Ko(){yield(0,fe.rM)(Uo)}const Ho=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({actionSanitizer:function(e){return e},stateSanitizer:function(e){return e},actionsBlacklist:me})||E.qC,Vo=(0,x.ZP)(),qo=(0,E.MT)((function(e=O,t){return e=function(e=O,t){return function(e=O,t){if(!(0,Q.Qy)(t))return e;const{undoStack:n,redoStack:o}=e.undo,r=le()(n);return r?Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),r),undo:Object.assign(Object.assign({},e.undo),{undoStack:n.slice(0,n.length-1),redoStack:[...o,ce(e)]})}):e}(e=function(e=O,t){if(!(0,Y.rA)(t))return e;const{undoStack:n,redoStack:o}=e.undo,r=le()(o);return r?Object.assign(Object.assign({},e),{services:Object.assign(Object.assign({},e.services),r),undo:Object.assign(Object.assign({},e.undo),{undoStack:[...n,ce(e)],redoStack:o.slice(0,o.length-1)})}):e}(e=function(e=O,t){return!oe(t)||(0,Q.Qy)(t)||(0,Y.rA)(t)?e:(0,re.cA)(e,"undo",(t=>Object.assign(Object.assign({},t),{undoStack:[...t.undoStack.slice(0,25),ce(e)],redoStack:[]})))}(e,t),t),t)}(e,t),ko(e,t)}),Ho((0,E.md)(j(),Vo)));Vo.run((function*(){yield(0,fe.rM)(Wo),yield(0,fe.rM)(Ko)})),qo.dispatch({type:N})},6600:(e,t,n)=>{"use strict";function o(...e){return e.filter((e=>Boolean(e)&&""!=e)).join(" ")}function r(...e){let t=e[0];const n=e.slice(1,e.length-2).map(String),o=e[e.length-2],r=e[e.length-1],s=i(t);t=s;for(const e of n)t[e]=i(t[e]),t=t[e];return t[o]="function"==typeof r?r(t[o]):r,s}function i(e){return Array.isArray(e)?[...e]:Object.assign({},e)}n.d(t,{yI:()=>o,cA:()=>r})}},0,[[9193,1,956,874,14,80,744,845,105,699,937]]]);
//# sourceMappingURL=client.38efbde80e70abb05504.bundle.js.map